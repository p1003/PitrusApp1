function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("zUnb")},"6Joi":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,o=n("mrSG"),a=n("q/0M"),s=n("zVF4"),u=n("S+S0"),l=n("x7I3"),c=i.SDK_VERSION,h=new a.Logger("@firebase/firestore"),f=function(e){return e[e.DEBUG=0]="DEBUG",e[e.ERROR=1]="ERROR",e[e.SILENT=2]="SILENT",e}({});function d(){return h.logLevel===a.LogLevel.DEBUG?f.DEBUG:h.logLevel===a.LogLevel.SILENT?f.SILENT:f.ERROR}function p(e){switch(e){case f.DEBUG:h.logLevel=a.LogLevel.DEBUG;break;case f.ERROR:h.logLevel=a.LogLevel.ERROR;break;case f.SILENT:h.logLevel=a.LogLevel.SILENT;break;default:h.error("Firestore ("+c+"): Invalid value passed to `setLogLevel`")}}function v(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(h.logLevel<=a.LogLevel.DEBUG){var i=n.map(y);h.debug.apply(h,o.__spreadArrays(["Firestore ("+c+") ["+e+"]: "+t],i))}}function g(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(h.logLevel<=a.LogLevel.ERROR){var r=t.map(y);h.error.apply(h,o.__spreadArrays(["Firestore ("+c+"): "+e],r))}}function y(e){if("string"==typeof e)return e;var t=b.getPlatform();try{return t.formatJSON(e)}catch(n){return e}}function m(e){var t="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+e;throw g(t),new Error(t)}function _(e,t){e||m(t)}var b=function(){function e(){}return e.setPlatform=function(t){e.platform&&m("Platform already defined"),e.platform=t},e.getPlatform=function(){return e.platform||m("Platform not set"),e.platform},e}();function w(){return b.getPlatform().emptyByteString}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=function(e){function t(t,n){var r=e.call(this,n)||this;return r.code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return o.__extends(t,e),t}(Error);function E(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new k(C.INVALID_ARGUMENT,e)}for(var r in n.prototype=e.prototype,e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){return void 0!==e?e:t}function I(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function A(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function N(e){for(var t in _(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function D(e,t){if(0!==t.length)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+K(t.length,"argument")+".")}function x(e,t,n){if(t.length!==n)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires "+K(n,"argument")+", but was called with "+K(t.length,"argument")+".")}function R(e,t,n){if(t.length<n)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires at least "+K(n,"argument")+", but was called with "+K(t.length,"argument")+".")}function O(e,t,n,r){if(t.length<n||t.length>r)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+K(t.length,"argument")+".")}function P(e,t,n,r){q(e,t,G(n)+" argument",r)}function M(e,t,n,r){void 0!==r&&P(e,t,n,r)}function L(e,t,n,r){q(e,t,n+" option",r)}function F(e,t,n,r){void 0!==r&&L(e,t,n,r)}function V(e,t,n,r,i){void 0!==r&&function(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(j(u))}var l=j(r);throw new k(C.INVALID_ARGUMENT,"Invalid value "+l+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(e,0,n,r,i)}function U(e,t,n,r){if(!t.some((function(e){return e===r})))throw new k(C.INVALID_ARGUMENT,"Invalid value "+j(r)+" provided to function "+e+"() for its "+G(n)+" argument. Acceptable values: "+t.join(", "))}function q(e,t,n,r){if(!("object"===t?B(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var i=j(r);throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function B(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function j(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":m("Unknown wrong type: "+typeof e)}function W(e,t,n){if(void 0===n)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+G(t)+" argument, but it was undefined.")}function H(e,t,n){A(t,(function(t,r){if(n.indexOf(t)<0)throw new k(C.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))}))}function z(e,t,n,r){var i=j(r);return new k(C.INVALID_ARGUMENT,"Function "+e+"() requires its "+G(n)+" argument to be a "+t+", but it was: "+i)}function Q(e,t,n){if(n<=0)throw new k(C.INVALID_ARGUMENT,'Function "'+e+'()" requires its '+G(t)+" argument to be a positive number, but it was: "+n+".")}function G(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function K(e,t){return e+" "+t+(1===e?"":"s")}var Y=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return _(20===t.length,"Invalid auto ID: "+t),t},e}();function X(e,t){return e<t?-1:e>t?1:0}function J(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function $(e){return e+"\0"}function Z(){if("undefined"==typeof Uint8Array)throw new k(C.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ee(){if(!b.getPlatform().base64Available)throw new k(C.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var te=function(){function e(e){ee(),this._binaryString=e}return e.fromBase64String=function(t){x("Blob.fromBase64String",arguments,1),P("Blob.fromBase64String","string",1,t),ee();try{var n=b.getPlatform().atob(t);return new e(n)}catch(r){throw new k(C.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},e.fromUint8Array=function(t){if(x("Blob.fromUint8Array",arguments,1),Z(),!(t instanceof Uint8Array))throw z("Blob.fromUint8Array","Uint8Array",1,t);var n=Array.prototype.map.call(t,(function(e){return String.fromCharCode(e)})).join("");return new e(n)},e.prototype.toBase64=function(){return x("Blob.toBase64",arguments,0),ee(),b.getPlatform().btoa(this._binaryString)},e.prototype.toUint8Array=function(){x("Blob.toUint8Array",arguments,0),Z();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._binaryString===e._binaryString},e.prototype._compareTo=function(e){return X(this._binaryString,e._binaryString)},e}(),ne=E(te,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),re=function(e,t,n,r,i){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i},ie="(default)",oe=function(){function e(e,t){this.projectId=e,this.database=t||ie}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database===ie},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.compareTo=function(e){return X(this.projectId,e.projectId)||X(this.database,e.database)},e}(),ae=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}return e.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},e.INVALID=-1,e}(),se=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&m("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&m("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return _(this.length>=(e=void 0===e?1:e),"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return _(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return _(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return _(e<this.length,"Index out of range"),this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(e.indexOf("//")>=0)throw new k(C.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter((function(e){return e.length>0})))},t.EMPTY_PATH=new t([]),t}(se),le=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return le.test(e)},t.prototype.canonicalString=function(){return this.toArray().map((function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new k(C.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new k(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new k(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new k(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.EMPTY_PATH=new t([]),t}(se),he=function(){function e(t){this.path=t,_(e.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}return e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===ue.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return ue.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new ue(t.slice()))},e.fromPathString=function(t){return new e(ue.fromString(t))},e.EMPTY=new e(new ue([])),e}(),fe=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},de=function(e){return e.All="all",e.ListenStreamIdle="listen_stream_idle",e.ListenStreamConnectionBackoff="listen_stream_connection_backoff",e.WriteStreamIdle="write_stream_idle",e.WriteStreamConnectionBackoff="write_stream_connection_backoff",e.OnlineStateTimeout="online_state_timeout",e.ClientMetadataRefresh="client_metadata_refresh",e.LruGarbageCollection="lru_garbage_collection",e.RetryTransaction="retry_transaction",e}({}),pe=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new fe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new k(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}(),ve=function(){function e(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenAfterShutdown=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueEvenAfterShutdown=function(e){return this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueAndInitiateShutdown=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise((function(e){})):this.enqueueInternal(e)},e.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then((function(){return t.operationInProgress=!0,e().catch((function(e){t.failure=e,t.operationInProgress=!1;var n=e.stack||e.message||"";throw g("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw e}),0),e})).then((function(e){return t.operationInProgress=!1,e}))}));return this.tail=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),_(t>=0,"Attempted to schedule an operation with a negative delay of "+t),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);var i=pe.createAndSchedule(this,e,t,n,(function(e){return r.removeDelayedOperation(e)}));return this.delayedOperations.push(i),i},e.prototype.verifyNotFailed=function(){this.failure&&m("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){_(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueueEvenAfterShutdown((function(){return Promise.resolve()}))},e.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then((function(){_(e===de.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));for(var n=0,r=t.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),e!==de.All&&i.timerId===e)break}return t.drain()}))},e.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);_(t>=0,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}(),ge="\x01",ye="\x01",me="\x10",_e="\x11";function be(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Ce(t)),t=we(e.get(n),t);return Ce(t)}function we(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+=ge+me;break;case ge:n+=ge+_e;break;default:n+=o}}return n}function Ce(e){return e+ge+ye}function ke(e){var t=e.length;if(_(t>=2,"Invalid path "+e),2===t)return _(e.charAt(0)===ge&&e.charAt(1)===ye,"Non-empty path "+e+" had length 2"),ue.EMPTY_PATH;for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(ge,o);switch((a<0||a>n)&&m('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case ye:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case me:i+=e.substring(o,a),i+="\0";break;case _e:i+=e.substring(o,a+1);break;default:m('Invalid encoded resource path: "'+e+'"')}o=a+2}return new ue(r)}var Ee=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e}(),Se=function(){function e(e){this.timestamp=e}return e.fromMicroseconds=function(t){var n=Math.floor(t/1e6);return new e(new Ee(n,t%1e6*1e3))},e.fromTimestamp=function(t){return new e(t)},e.forDeletedDoc=function(){return e.MIN},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e.MIN=new e(new Ee(0,0)),e}(),Te=function(){function e(e,t){this.comparator=e,this.root=t||Ae.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ae.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ae.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))},e.prototype.toString=function(){var e=[];return this.inorderTraversal((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new Ie(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new Ie(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new Ie(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new Ie(this.root,e,this.comparator,!0)},e}(),Ie=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){_(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Ae=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw m("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw m("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw m("Black depths differ");return e+(this.isRed()?0:1)},e.EMPTY=null,e.RED=!0,e.BLACK=!1,e}(),Ne=function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw m("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw m("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw m("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw m("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw m("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Ae(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}();Ae.EMPTY=new Ne;var De=function(){function e(e){this.comparator=e,this.data=new Te(this.comparator)}return e.fromMapKeys=function(t){var n=new e(t.comparator);return t.forEach((function(e){n=n.add(e)})),n},e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new xe(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new xe(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return e.forEach((function(e){t=t.add(e)})),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),xe=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),Re=new Te(he.comparator);function Oe(){return Re}function Pe(){return Oe()}var Me=new Te(he.comparator);function Le(){return Me}var Fe=new Te(he.comparator);function Ve(){return Fe}var Ue=new De(he.comparator);function qe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Ue,r=0,i=e;r<i.length;r++)n=n.add(i[r]);return n}var Be=new De(X);function je(){return Be}var We=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r,_(r.length>0,"Cannot create an empty mutation batch")}return e.prototype.applyToRemoteDocument=function(e,t,n){t&&_(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;_(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(e)&&(t=o.applyToRemoteDocument(t,r[i]))}return t},e.prototype.applyToLocalView=function(e,t){t&&_(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(e)&&(t=s.applyToLocalView(t,t,this.localWriteTime));for(var i=t,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(e)&&(t=s.applyToLocalView(t,i,this.localWriteTime))}return t},e.prototype.applyToLocalDocumentSet=function(e){var t=this,n=e;return this.mutations.forEach((function(r){var i=t.applyToLocalView(r.key,e.get(r.key));i&&(n=n.insert(r.key,i))})),n},e.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),qe())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&J(this.mutations,e.mutations)&&J(this.baseMutations,e.baseMutations)},e}(),He=function(){function e(e,t,n,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return e.from=function(t,n,r,i){_(t.mutations.length===r.length,"Mutations sent "+t.mutations.length+" must equal results received "+r.length);for(var o=Ve(),a=t.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new e(t,n,r,i,o)},e}(),ze=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)}),(function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)}))}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&m("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))},e.prototype.toPromise=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)},e.resolve=function(t){return new e((function(e,n){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.waitFor=function(t){return new e((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(e){return n(e)}))})),o=!0,i===r&&e()}))},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next((function(n){return n?e.resolve(n):t()}))},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)},e}(),Qe="SimpleDb",Ge=function(){function e(t){this.db=t,12.2===e.getIOSVersion(s.getUA())&&g("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return _(e.isAvailable(),"IndexedDB not supported in current environment."),v(Qe,"Opening database:",t),new ze((function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){i(new e(t.target.result))},a.onblocked=function(){o(new k(C.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var t=e.target.error;o("VersionError"===t.name?new k(C.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):t)},a.onupgradeneeded=function(e){v(Qe,'Database "'+t+'" requires upgrade from version:',e.oldVersion),r.createOrUpgrade(e.target.result,a.transaction,e.oldVersion,nn).next((function(){v(Qe,"Database upgrade to version "+nn+" complete")}))}})).toPromise()},e.delete=function(e){return v(Qe,"Removing database:",e),Je(window.indexedDB.deleteDatabase(e)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(e.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=s.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.isMockPersistence=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},e.getStore=function(e,t){return e.store(t)},e.getIOSVersion=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(e){this.db.onversionchange=function(t){return e(t)}},e.prototype.runTransaction=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,u,l;return o.__generator(this,(function(c){switch(c.label){case 0:r=e.startsWith("readonly"),i=e.endsWith("idempotent"),a=0,s=function(){var e,s,l,c;return o.__generator(this,(function(o){switch(o.label){case 0:++a,e=Ye.open(u.db,r?"readonly":"readwrite",t),o.label=1;case 1:return o.trys.push([1,3,,4]),(s=n(e).catch((function(t){return e.abort(t),ze.reject(t)})).toPromise()).catch((function(){})),[4,e.completionPromise];case 2:return o.sent(),[2,{value:s}];case 3:return l=o.sent(),v(Qe,"Transaction failed with error: %s. Retrying: %s.",l.message,c=i&&"FirebaseError"!==l.name&&a<3),c?[3,4]:[2,{value:Promise.reject(l)}];case 4:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:return"object"==typeof(l=c.sent())?[2,l.value]:[3,1];case 3:return[2]}}))}))},e.prototype.close=function(){this.db.close()},e}(),Ke=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return Je(this.dbCursor.delete())},e}(),Ye=function(){function e(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new fe,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){var n=Ze(e.target.error);t.completionDeferred.reject(n)}}return e.open=function(t,n,r){return new e(t.transaction(r,n))},Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(v(Qe,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return _(!!t,"Object store not part of transaction: "+e),new Xe(t)},e}(),Xe=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(v(Qe,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(v(Qe,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Je(n)},e.prototype.add=function(e){return v(Qe,"ADD",this.store.name,e,e),Je(this.store.add(e))},e.prototype.get=function(e){var t=this;return Je(this.store.get(e)).next((function(n){return void 0===n&&(n=null),v(Qe,"GET",t.store.name,e,n),n}))},e.prototype.delete=function(e){return v(Qe,"DELETE",this.store.name,e),Je(this.store.delete(e))},e.prototype.count=function(){return v(Qe,"COUNT",this.store.name),Je(this.store.count())},e.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,(function(e,t){r.push(t)})).next((function(){return r}))},e.prototype.deleteAll=function(e,t){v(Qe,"DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,(function(e,t,n){return n.delete()}))},e.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},e.prototype.iterateSerial=function(e){var t=this.cursor({});return new ze((function(n,r){t.onerror=function(e){var t=Ze(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},e.prototype.iterateCursor=function(e,t){var n=[];return new ze((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new Ke(i),a=t(i.primaryKey,i.value,o);if(a instanceof ze){var s=a.catch((function(e){return o.done(),ze.reject(e)}));n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}})).next((function(){return ze.waitFor(n)}))},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(_(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function Je(e){return new ze((function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){var t=Ze(e.target.error);n(t)}}))}var $e=!1;function Ze(e){var t=Ge.getIOSVersion(s.getUA());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new k("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $e||($e=!0,setTimeout((function(){throw r}),0)),r}}return e}var et=function(){function e(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return e.forUser=function(t,n,r,i){return _(""!==t.uid,"UserID must not be an empty string."),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return it(e).iterate({index:un.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},e.prototype.acknowledgeBatch=function(e,t,n){return this.getMutationQueueMetadata(e).next((function(t){return t.lastStreamToken=rt(n),at(e).put(t)}))},e.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next((function(e){return e.lastStreamToken}))},e.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next((function(n){return n.lastStreamToken=rt(t),at(e).put(n)}))},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=ot(e),a=it(e);return a.add({}).next((function(s){_("number"==typeof s,"Auto-generated key is not a number");for(var u=new We(s,t,n,r),l=i.serializer.toDbMutationBatch(i.userId,u),c=[],h=new De((function(e,t){return X(e.canonicalString(),t.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=ln.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),c.push(a.put(l)),c.push(o.put(v,ln.PLACEHOLDER))}return h.forEach((function(t){c.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.documentKeysByBatchId[s]=u.keys()})),ze.waitFor(c).next((function(){return u}))}))},e.prototype.lookupMutationBatch=function(e,t){var n=this;return it(e).get(t).next((function(e){return e?(_(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.serializer.fromDbMutationBatch(e)):null}))},e.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?ze.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.documentKeysByBatchId[t]=r,r}return null}))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return it(e).iterate({index:un.userMutationsIndex,range:i},(function(e,t,i){t.userId===n.userId&&(_(t.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(t)),i.done()})).next((function(){return o}))},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return it(e).iterate({index:un.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return it(e).loadAll(un.userMutationsIndex,n).next((function(e){return e.map((function(e){return t.serializer.fromDbMutationBatch(e)}))}))},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=ln.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return ot(e).iterate({range:i},(function(r,i,a){var s=r[0],u=r[2],l=ke(r[1]);if(s===n.userId&&t.path.isEqual(l))return it(e).get(u).next((function(e){if(!e)throw m("Dangling document-mutation reference found: "+r+" which points to "+u);_(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+u),o.push(n.serializer.fromDbMutationBatch(e))}));a.done()})).next((function(){return o}))},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new De(X),i=[];return t.forEach((function(t){var o=ln.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=ot(e).iterate({range:a},(function(e,i,o){var a=e[0],s=e[2],u=ke(e[1]);a===n.userId&&t.path.isEqual(u)?r=r.add(s):o.done()}));i.push(s)})),ze.waitFor(i).next((function(){return n.lookupMutationBatches(e,r)}))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this;_(!t.isDocumentQuery(),"Document queries shouldn't go down this path"),_(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=t.path,i=r.length+1,o=ln.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new De(X);return ot(e).iterate({range:a},(function(e,t,o){var a=e[0],u=e[2],l=ke(e[1]);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(u)):o.done()})).next((function(){return n.lookupMutationBatches(e,s)}))},e.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(it(e).get(t).next((function(e){if(null===e)throw m("Dangling document-mutation reference found, which points to "+t);_(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(n.serializer.fromDbMutationBatch(e))})))})),ze.waitFor(i).next((function(){return r}))},e.prototype.removeMutationBatch=function(e,t){var n=this;return nt(e.simpleDbTransaction,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.removeCachedMutationKeys(t.batchId)})),ze.forEach(r,(function(t){return n.referenceDelegate.removeMutationReference(e,t)}))}))},e.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return ze.resolve();var r=IDBKeyRange.lowerBound(ln.prefixForUser(t.userId)),i=[];return ot(e).iterate({range:r},(function(e,n,r){if(e[0]===t.userId){var o=ke(e[1]);i.push(o)}else r.done()})).next((function(){_(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(e){return e.canonicalString()})))}))}))},e.prototype.containsKey=function(e,t){return tt(e,this.userId,t)},e.prototype.getMutationQueueMetadata=function(e){var t=this;return at(e).get(this.userId).next((function(e){return e||new sn(t.userId,-1,"")}))},e}();function tt(e,t,n){var r=ln.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return ot(e).iterate({range:o,keysOnly:!0},(function(e,n,r){e[0]===t&&e[1]===i&&(a=!0),r.done()})).next((function(){return a}))}function nt(e,t,n){var r=e.store(un.store),i=e.store(ln.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},(function(e,t,n){return s++,n.delete()}));o.push(u.next((function(){_(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var l=[],c=0,h=n.mutations;c<h.length;c++){var f=h[c],d=ln.key(t,f.key.path,n.batchId);o.push(i.delete(d)),l.push(f.key)}return ze.waitFor(o).next((function(){return l}))}function rt(e){return e instanceof Uint8Array?(_(Ge.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function it(e){return Un.getStore(e,un.store)}function ot(e){return Un.getStore(e,ln.store)}function at(e){return Un.getStore(e,sn.store)}var st=1,ut=function(e){return e[e.QueryCache=0]="QueryCache",e[e.SyncEngine=1]="SyncEngine",e}({}),lt=function(){function e(e,t){this.generatorId=e,_((e&st)===e,"Generator ID "+e+" contains more than "+st+" reserved bits"),this.seek(void 0!==t?t:this.generatorId)}return e.prototype.next=function(){var e=this.nextId;return this.nextId+=1<<st,e},e.prototype.after=function(e){return this.seek(e+(1<<st)),this.next()},e.prototype.seek=function(e){_((e&st)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},e.forTargetCache=function(){return new e(ut.QueryCache,2)},e.forSyncEngine=function(){return new e(ut.SyncEngine)},e}(),ct=function(){function e(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=lt.forTargetCache()}return e.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next((function(n){return n.highestTargetId=t.targetIdGenerator.after(n.highestTargetId),t.saveMetadata(e,n).next((function(){return n.highestTargetId}))}))},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next((function(e){return Se.fromTimestamp(new Ee(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},e.prototype.getHighestSequenceNumber=function(e){return dt(e.simpleDbTransaction)},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.retrieveMetadata(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.saveMetadata(e,i)}))},e.prototype.addTargetData=function(e,t){var n=this;return this.saveTargetData(e,t).next((function(){return n.retrieveMetadata(e).next((function(r){return r.targetCount+=1,n.updateMetadataFromTargetData(t,r),n.saveMetadata(e,r)}))}))},e.prototype.updateTargetData=function(e,t){return this.saveTargetData(e,t)},e.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return ht(e).delete(t.targetId)})).next((function(){return n.retrieveMetadata(e)})).next((function(t){return _(t.targetCount>0,"Removing from an empty target cache"),t.targetCount-=1,n.saveMetadata(e,t)}))},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return ht(e).iterate((function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(e,u)))})).next((function(){return ze.waitFor(o)})).next((function(){return i}))},e.prototype.forEachTarget=function(e,t){var n=this;return ht(e).iterate((function(e,r){var i=n.serializer.fromDbTarget(r);t(i)}))},e.prototype.retrieveMetadata=function(e){return ft(e.simpleDbTransaction)},e.prototype.saveMetadata=function(e,t){return(n=e,Un.getStore(n,gn.store)).put(gn.key,t);var n},e.prototype.saveTargetData=function(e,t){return ht(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromTargetData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getTargetCount=function(e){return this.retrieveMetadata(e).next((function(e){return e.targetCount}))},e.prototype.getTargetData=function(e,t){var n=this,r=t.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ht(e).iterate({range:i,index:pn.queryTargetsIndexName},(function(e,r,i){var a=n.serializer.fromDbTarget(r);t.isEqual(a.target)&&(o=a,i.done())})).next((function(){return o}))},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=pt(e);return t.forEach((function(t){var a=be(t.path);i.push(o.put(new vn(n,a))),i.push(r.referenceDelegate.addReference(e,t))})),ze.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=pt(e);return ze.forEach(t,(function(t){var o=be(t.path);return ze.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,t)])}))},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=pt(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=pt(e),i=qe();return r.iterate({range:n,keysOnly:!0},(function(e,t,n){var r=ke(e[1]),o=new he(r);i=i.add(o)})).next((function(){return i}))},e.prototype.containsKey=function(e,t){var n=be(t.path),r=IDBKeyRange.bound([n],[$(n)],!1,!0),i=0;return pt(e).iterate({index:vn.documentTargetsIndex,keysOnly:!0,range:r},(function(e,t,n){0!==e[0]&&(i++,n.done())})).next((function(){return i>0}))},e.prototype.getTargetDataForTarget=function(e,t){var n=this;return ht(e).get(t).next((function(e){return e?n.serializer.fromDbTarget(e):null}))},e}();function ht(e){return Un.getStore(e,pn.store)}function ft(e){return Ge.getStore(e,gn.store).get(gn.key).next((function(e){return _(null!==e,"Missing metadata row."),e}))}function dt(e){return ft(e).next((function(e){return e.highestListenSequenceNumber}))}function pt(e){return Un.getStore(e,vn.store)}var vt=function(){function e(e){this.fields=e}return e.fromSet=function(t){return new e(t)},e.fromArray=function(t){var n=new De(ce.comparator);return t.forEach((function(e){return n=n.add(e)})),new e(n)},e.prototype.covers=function(e){var t=!1;return this.fields.forEach((function(n){n.isPrefixOf(e)&&(t=!0)})),t},e.prototype.isEqual=function(e){return this.fields.isEqual(e.fields)},e}(),gt=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),yt=function(e,t){this.version=e,this.transformResults=t},mt=function(e){return e[e.Set=0]="Set",e[e.Patch=1]="Patch",e[e.Transform=2]="Transform",e[e.Delete=3]="Delete",e}({}),_t=function(){function e(e,t){this.updateTime=e,this.exists=t,_(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),e.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof Ht&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof Ht:(_(this.isNone,"Precondition should be empty"),!0)},e.prototype.isEqual=function(e){return n=e.updateTime,(null!=(t=this.updateTime)?!(!n||!t.isEqual(n)):t===n)&&this.exists===e.exists;var t,n},e.NONE=new e,e}(),bt=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&_(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof Ht?e.version:Se.MIN},e}(),wt=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.value=n,i.precondition=r,i.type=mt.Set,i}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),_(null==t.transformResults,"Transform results received by SetMutation."),new Ht(this.key,t.version,{hasCommittedMutations:!0},this.value)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=bt.getPostMutationVersion(e);return new Ht(this.key,r,{hasLocalMutations:!0},this.value)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(bt),Ct=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.key=t,o.data=n,o.fieldMask=r,o.precondition=i,o.type=mt.Patch,o}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),_(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new Qt(this.key,t.version);var n=this.patchDocument(e);return new Ht(this.key,t.version,{hasCommittedMutations:!0},n)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=bt.getPostMutationVersion(e),i=this.patchDocument(e);return new Ht(this.key,r,{hasLocalMutations:!0},i)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof Ht?e.data():Bt.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){var t=this;return this.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e=null!==r?e.set(n,r):e.delete(n)}})),e},t}(bt),kt=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.fieldTransforms=n,r.type=mt.Transform,r.precondition=_t.exists(!0),r}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),_(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new Qt(this.key,t.version);var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),i=t.version,o=this.transformObject(n.data(),r);return new Ht(this.key,i,{hasCommittedMutations:!0},o)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),i=this.localTransformResults(n,e,t),o=this.transformObject(r.data(),i);return new Ht(this.key,r.version,{hasLocalMutations:!0},o)},t.prototype.extractBaseValue=function(e){for(var t=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=e instanceof Ht?e.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(t=null==t?Bt.EMPTY.set(i.field,a):t.set(i.field,a))}return t},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&J(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){return _(e instanceof Ht,"Unknown MaybeDocument type "+e),_(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},t.prototype.serverTransformResults=function(e,t){var n=[];_(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;e instanceof Ht&&(a=e.field(i.field)),n.push(o.applyToRemoteDocument(a,t[r]))}return n},t.prototype.localTransformResults=function(e,t,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;t instanceof Ht&&(u=t.field(a.field)),null===u&&n instanceof Ht&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,e))}return r},t.prototype.transformObject=function(e,t){_(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++)e=e.set(this.fieldTransforms[n].field,t[n]);return e},t}(bt),Et=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.precondition=n,r.type=mt.Delete,r}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),_(null==t.transformResults,"Transform results received by DeleteMutation."),new zt(this.key,t.version,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&_(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new zt(this.key,Se.forDeletedDoc())):e},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(bt),St=function(e){return e[e.NullValue=0]="NullValue",e[e.BooleanValue=1]="BooleanValue",e[e.NumberValue=2]="NumberValue",e[e.TimestampValue=3]="TimestampValue",e[e.StringValue=4]="StringValue",e[e.BlobValue=5]="BlobValue",e[e.RefValue=6]="RefValue",e[e.GeoPointValue=7]="GeoPointValue",e[e.ArrayValue=8]="ArrayValue",e[e.ObjectValue=9]="ObjectValue",e}({}),Tt=function(e){return e[e.Default=0]="Default",e[e.Estimate=1]="Estimate",e[e.Previous=2]="Previous",e}({}),It=function(){function e(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return e.fromSnapshotOptions=function(t,n){switch(t.serverTimestamps){case"estimate":return new e(Tt.Estimate,n);case"previous":return new e(Tt.Previous,n);case"none":case void 0:return new e(Tt.Default,n);default:return m("fromSnapshotOptions() called with invalid options.")}},e}(),At=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return _(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),X(this.typeOrder,e.typeOrder)},e}(),Nt=function(e){function t(){var t=e.call(this)||this;return t.typeOrder=St.NullValue,t.internalValue=null,t}return o.__extends(t,e),t.prototype.value=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t},t.prototype.compareTo=function(e){return e instanceof t?0:this.defaultCompareTo(e)},t.INSTANCE=new t,t}(At),Dt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.BooleanValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?X(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(At),xt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.NumberValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?(n=this.internalValue)<(r=e.internalValue)?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(e);var n,r},t}(At);function Rt(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Rt(this.internalValue,e.internalValue)},t}(xt),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Rt(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(xt),Mt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.StringValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?X(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(At),Lt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.TimestampValue,n}return o.__extends(t,e),t.prototype.value=function(e){return!e||e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof Ft?-1:this.defaultCompareTo(e)},t}(At),Ft=function(e){function t(t,n){var r=e.call(this)||this;return r.localWriteTime=t,r.previousValue=n,r.typeOrder=St.TimestampValue,r}return o.__extends(t,e),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===Tt.Estimate?new Lt(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===Tt.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof Lt?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(At),Vt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.BlobValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(At),Ut=function(e){function t(t,n){var r=e.call(this)||this;return r.databaseId=t,r.key=n,r.typeOrder=St.RefValue,r}return o.__extends(t,e),t.prototype.value=function(e){return this.key},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},t.prototype.compareTo=function(e){if(e instanceof t){var n=this.databaseId.compareTo(e.databaseId);return 0!==n?n:he.comparator(this.key,e.key)}return this.defaultCompareTo(e)},t}(At),qt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.GeoPointValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(At),Bt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.ObjectValue,n}return o.__extends(t,e),t.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal((function(n,r){t[n]=r.value(e)})),t},t.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},t.prototype.isEqual=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=X(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return X(n.hasNext(),r.hasNext())}return this.defaultCompareTo(e)},t.prototype.set=function(e,n){if(_(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),n);var r=this.child(e.firstSegment());r instanceof t||(r=t.EMPTY);var i=r.set(e.popFirst(),n);return this.setChild(e.firstSegment(),i)},t.prototype.delete=function(e){if(_(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new t(this.internalValue.remove(e.firstSegment()));var n=this.child(e.firstSegment());if(n instanceof t){var r=n.delete(e.popFirst());return new t(this.internalValue.insert(e.firstSegment(),r))}return this},t.prototype.contains=function(e){return null!==this.field(e)},t.prototype.field=function(e){_(!e.isEmpty(),"Can't get field of empty path");var n=this;return e.forEach((function(e){n=n instanceof t?n.internalValue.get(e):null})),n},t.prototype.fieldMask=function(){var e=new De(ce.comparator);return this.internalValue.forEach((function(n,r){var i=new ce([n]);if(r instanceof t){var o=r.fieldMask().fields;o.isEmpty()?e=e.add(i):o.forEach((function(t){e=e.add(i.child(t))}))}else e=e.add(i)})),vt.fromSet(e)},t.prototype.toString=function(){return this.internalValue.toString()},t.prototype.child=function(e){return this.internalValue.get(e)||void 0},t.prototype.setChild=function(e,n){return new t(this.internalValue.insert(e,n))},t.EMPTY=new t(new Te(X)),t}(At),jt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=St.ArrayValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue.map((function(t){return t.value(e)}))},t.prototype.contains=function(e){for(var t=0,n=this.internalValue;t<n.length;t++)if(n[t].isEqual(e))return!0;return!1},t.prototype.forEach=function(e){this.internalValue.forEach(e)},t.prototype.isEqual=function(e){if(e instanceof t){if(this.internalValue.length!==e.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(e.internalValue[n]))return!1;return!0}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=Math.min(this.internalValue.length,e.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(e.internalValue[r]);if(i)return i}return X(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},t.prototype.toString=function(){return"["+this.internalValue.map((function(e){return e.toString()})).join(",")+"]"},t}(At),Wt=function(){function e(e,t){this.key=e,this.version=t}return e.compareByKey=function(e,t){return he.comparator(e.key,t.key)},e}(),Ht=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,_(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return o.__extends(t,e),t.prototype.field=function(e){if(this.objectValue)return this.objectValue.field(e);this.fieldValueCache||(this.fieldValueCache=new Map);var t=e.canonicalString(),n=this.fieldValueCache.get(t);if(void 0===n){var r=this.getProtoField(e);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(t,n)}return n},t.prototype.data=function(){var e=this;if(!this.objectValue){var t=Bt.EMPTY;A(this.proto.fields||{},(function(n,r){t=t.set(new ce([n]),e.converter(r))})),this.objectValue=t,this.fieldValueCache=void 0}return this.objectValue},t.prototype.value=function(){return this.data().value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.data().isEqual(e.data())},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.getProtoField=function(e){_(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var t=this.proto.fields?this.proto.fields[e.firstSegment()]:void 0,n=1;n<e.length;++n){if(!t||!t.mapValue||!t.mapValue.fields)return;t=t.mapValue.fields[e.get(n)]}return t},t.compareByField=function(e,t,n){var r=t.field(e),i=n.field(e);return null!==r&&null!==i?r.compareTo(i):m("Trying to compare documents on fields that don't exist")},t}(Wt),zt=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return o.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Wt),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Wt),Gt=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[1];if(o[0].isEqual(e))return a}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){A(this.inner,(function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];e(o[0],o[1])}}))},e.prototype.isEmpty=function(){return N(this.inner)},e}(),Kt=function(){function e(){this.changes=new Gt((function(e){return e.toString()})),this.changesApplied=!1}return Object.defineProperty(e.prototype,"readTime",{get:function(){return _(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(e){_(void 0===this._readTime||this._readTime.isEqual(e),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=e},enumerable:!0,configurable:!0}),e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.readTime=t,this.changes.set(e.key,e)},e.prototype.removeEntry=function(e,t){this.assertNotApplied(),t&&(this.readTime=t),this.changes.set(e,null)},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?ze.resolve(n):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){_(!this.changesApplied,"Changes have already been applied.")},e}(),Yt=function(){function e(e,t){this.serializer=e,this.indexManager=t}return e.prototype.addEntry=function(e,t,n){return Jt(e).put($t(t),n)},e.prototype.removeEntry=function(e,t){var n=Jt(e),r=$t(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.setMetadata(e,r)}))},e.prototype.getEntry=function(e,t){var n=this;return Jt(e).get($t(t)).next((function(e){return n.maybeDecodeDocument(e)}))},e.prototype.getSizedEntry=function(e,t){var n=this;return Jt(e).get($t(t)).next((function(e){var t=n.maybeDecodeDocument(e);return t?{maybeDocument:t,size:Zt(e)}:null}))},e.prototype.getEntries=function(e,t){var n=this,r=Pe();return this.forEachDbEntry(e,t,(function(e,t){var i=n.maybeDecodeDocument(t);r=r.insert(e,i)})).next((function(){return r}))},e.prototype.getSizedEntries=function(e,t){var n=this,r=Pe(),i=new Te(he.comparator);return this.forEachDbEntry(e,t,(function(e,t){var o=n.maybeDecodeDocument(t);o?(r=r.insert(e,o),i=i.insert(e,Zt(t))):(r=r.insert(e,null),i=i.insert(e,0))})).next((function(){return{maybeDocuments:r,sizeMap:i}}))},e.prototype.forEachDbEntry=function(e,t,n){if(t.isEmpty())return ze.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return Jt(e).iterate({range:r},(function(e,t,r){for(var a=he.fromSegments(e);o&&he.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this;_(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Le(),o=t.path.length+1,a={};if(n.isEqual(Se.MIN)){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),l=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,l],!0),a.index=fn.collectionReadTimeIndex}return Jt(e).iterate(a,(function(e,n,a){if(e.length===o){var s=r.serializer.fromDbRemoteDocument(n);t.path.isPrefixOf(s.key.path)?s instanceof Ht&&t.matches(s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},e.prototype.getNewDocumentChanges=function(e,t){var n=this,r=Oe(),i=this.serializer.toDbTimestampKey(t),o=Jt(e),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:fn.readTimeIndex,range:a},(function(e,t){var o=n.serializer.fromDbRemoteDocument(t);r=r.insert(o.key,o),i=t.readTime})).next((function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}}))},e.prototype.getLastDocumentChange=function(e){var t,n=this,r=Jt(e),i=Se.MIN;return r.iterate({index:fn.readTimeIndex,reverse:!0},(function(e,r,o){t=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()})).next((function(){return{changedDoc:t,readTime:i}}))},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this,!!t&&t.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},e.prototype.getMetadata=function(e){return Xt(e).get(dn.key).next((function(e){return _(!!e,"Missing document cache metadata"),e}))},e.prototype.setMetadata=function(e,t){return Xt(e).put(dn.key,t)},e.prototype.maybeDecodeDocument=function(e){if(e){var t=this.serializer.fromDbRemoteDocument(e);return t instanceof zt&&t.version.isEqual(Se.forDeletedDoc())?null:t}return null},e.RemoteDocumentChangeBuffer=function(e){function t(t,n){var r=e.call(this)||this;return r.documentCache=t,r.trackRemovals=n,r.documentSizes=new Gt((function(e){return e.toString()})),r}return o.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new De((function(e,t){return X(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(o,a){var s=t.documentSizes.get(o);if(_(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){_(!t.readTime.isEqual(Se.MIN),"Cannot add a document with a read time of zero");var u=t.documentCache.serializer.toDbRemoteDocument(a,t.readTime);i=i.add(o.path.popLast());var l=Zt(u);r+=l-s,n.push(t.documentCache.addEntry(e,o,u))}else if(r-=s,t.trackRemovals){var c=t.documentCache.serializer.toDbRemoteDocument(new zt(o,Se.forDeletedDoc()),t.readTime);n.push(t.documentCache.addEntry(e,o,c))}else n.push(t.documentCache.removeEntry(e,o))})),i.forEach((function(r){n.push(t.documentCache.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.documentCache.updateMetadata(e,r)),ze.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next((function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)}))},t.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next((function(e){var t=e.maybeDocuments;return e.sizeMap.forEach((function(e,t){n.documentSizes.set(e,t)})),t}))},t}(Kt),e}();function Xt(e){return Un.getStore(e,dn.store)}function Jt(e){return Un.getStore(e,fn.store)}function $t(e){return e.path.toArray()}function Zt(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw m("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var en=function(){function e(){this.collectionParentIndex=new tn}return e.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),ze.resolve()},e.prototype.getCollectionParents=function(e,t){return ze.resolve(this.collectionParentIndex.getEntries(t))},e}(),tn=function(){function e(){this.index={}}return e.prototype.add=function(e){_(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new De(ue.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new De(ue.comparator)).toArray()},e}(),nn=9,rn=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,n,r){var i=this;_(n<r&&n>=0&&r<=nn,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new Ye(t);n<1&&r>=1&&(function(e){e.createObjectStore(an.store)}(e),function(e){e.createObjectStore(sn.store,{keyPath:sn.keyPath}),e.createObjectStore(un.store,{keyPath:un.keyPath,autoIncrement:!0}).createIndex(un.userMutationsIndex,un.userMutationsKeyPath,{unique:!0}),e.createObjectStore(ln.store)}(e),mn(e),function(e){e.createObjectStore(fn.store)}(e));var a=ze.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(vn.store),e.deleteObjectStore(pn.store),e.deleteObjectStore(gn.store)}(e),mn(e)),a=a.next((function(){return function(e){var t=e.store(gn.store),n=new gn(0,0,Se.MIN.toTimestamp(),0);return t.put(gn.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(e,t){return t.store(un.store).loadAll().next((function(n){e.deleteObjectStore(un.store),e.createObjectStore(un.store,{keyPath:un.keyPath,autoIncrement:!0}).createIndex(un.userMutationsIndex,un.userMutationsKeyPath,{unique:!0});var r=t.store(un.store),i=n.map((function(e){return r.put(e)}));return ze.waitFor(i)}))}(e,o)}))),a=a.next((function(){!function(e){e.createObjectStore(_n.store,{keyPath:_n.keyPath})}(e)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(e){e.createObjectStore(dn.store)}(e),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(e,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(fn.store);t.createIndex(fn.readTimeIndex,fn.readTimeIndexPath,{unique:!1}),t.createIndex(fn.collectionReadTimeIndex,fn.collectionReadTimeIndexPath,{unique:!1})}(t)}))),a},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store(fn.store).iterate((function(e,n){t+=Zt(n)})).next((function(){var n=new dn(t);return e.store(dn.store).put(dn.key,n)}))},e.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(sn.store),r=e.store(un.store);return n.loadAll().next((function(n){return ze.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(un.userMutationsIndex,i).next((function(r){return ze.forEach(r,(function(r){_(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=t.serializer.fromDbMutationBatch(r);return nt(e,n.userId,i).next((function(){}))}))}))}))}))},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(vn.store),n=e.store(fn.store);return dt(e).next((function(e){var r=[];return n.iterate((function(n,i){var o=new ue(n),a=function(e){return[0,be(e)]}(o);r.push(t.get(a).next((function(n){return n?ze.resolve():function(n){return t.put(new vn(0,be(n),e))}(o)})))})).next((function(){return ze.waitFor(r)}))}))},e.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(yn.store,{keyPath:yn.keyPath});var n=t.store(yn.store),r=new tn,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:be(i)})}};return t.store(fn.store).iterate({keysOnly:!0},(function(e,t){var n=new ue(e);return i(n.popLast())})).next((function(){return t.store(ln.store).iterate({keysOnly:!0},(function(e,t){var n=ke(e[1]);return i(n.popLast())}))}))},e}(),on=function(e,t){this.seconds=e,this.nanoseconds=t},an=function(){function e(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}return e.store="owner",e.key="owner",e}(),sn=function(){function e(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}return e.store="mutationQueues",e.keyPath="userId",e}(),un=function(){function e(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return e.store="mutations",e.keyPath="batchId",e.userMutationsIndex="userMutationsIndex",e.userMutationsKeyPath=["userId","batchId"],e}(),ln=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,be(t)]},e.key=function(e,t,n){return[e,be(t),n]},e.store="documentMutations",e.PLACEHOLDER=new e,e}(),cn=function(e,t){this.path=e,this.readTime=t},hn=function(e,t){this.path=e,this.version=t},fn=function(){function e(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return e.store="remoteDocuments",e.readTimeIndex="readTimeIndex",e.readTimeIndexPath="readTime",e.collectionReadTimeIndex="collectionReadTimeIndex",e.collectionReadTimeIndexPath=["parentPath","readTime"],e}(),dn=function(){function e(e){this.byteSize=e}return e.store="remoteDocumentGlobal",e.key="remoteDocumentGlobalKey",e}(),pn=function(){function e(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),vn=function(){function e(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n,_(0===e==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),gn=function(){function e(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return e.key="targetGlobalKey",e.store="targetGlobal",e}(),yn=function(){function e(e,t){this.collectionId=e,this.parent=t}return e.store="collectionParents",e.keyPath=["collectionId","parent"],e}();function mn(e){e.createObjectStore(vn.store,{keyPath:vn.keyPath}).createIndex(vn.documentTargetsIndex,vn.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(pn.store,{keyPath:pn.keyPath}).createIndex(pn.queryTargetsIndexName,pn.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(gn.store)}var _n=function(){function e(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}return e.store="clientMetadata",e.keyPath="clientId",e}(),bn=o.__spreadArrays([sn.store,un.store,ln.store,fn.store,pn.store,an.store,gn.store,vn.store],[_n.store]),wn=o.__spreadArrays(bn,[dn.store]),Cn=o.__spreadArrays(wn,[yn.store]),kn=function(){function e(){this.collectionParentsCache=new tn}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(_(t.length%2==1,"Expected a collection path."),!this.collectionParentsCache.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.collectionParentsCache.add(t)}));var o={collectionId:r,parent:be(i)};return En(e).put(o)}return ze.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[$(t),""],!1,!0);return En(e).loadAll(r).next((function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(ke(o.parent))}return n}))},e}();function En(e){return Un.getStore(e,yn.store)}var Sn=function(e){return e[e.Listen=0]="Listen",e[e.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",e[e.LimboResolution=2]="LimboResolution",e}({}),Tn=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=Se.MIN),void 0===o&&(o=Se.MIN),void 0===a&&(a=w()),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(e.lastLimboFreeSnapshotVersion)&&this.resumeToken===e.resumeToken&&this.target.isEqual(e.target)},e}(),In=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=he.fromSegments(e.noDocument.path),n=this.fromDbTimestamp(e.noDocument.readTime);return new zt(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(t=he.fromSegments(e.unknownDocument.path),n=this.fromDbTimestamp(e.unknownDocument.version),new Qt(t,n)):m("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e,t){var n=this.toDbTimestampKey(t),r=e.key.path.popLast().toArray();if(e instanceof Ht){var i=e.proto?e.proto:this.remoteSerializer.toDocument(e);return new fn(null,null,i,s=e.hasCommittedMutations,n,r)}if(e instanceof zt){var o=e.key.path.toArray(),a=this.toDbTimestamp(e.version),s=e.hasCommittedMutations;return new fn(null,new cn(o,a),null,s,n,r)}if(e instanceof Qt){o=e.key.path.toArray();var u=this.toDbTimestamp(e.version);return new fn(new hn(o,u),null,null,!0,n,r)}return m("Unexpected MaybeDocument")},e.prototype.toDbTimestampKey=function(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]},e.prototype.fromDbTimestampKey=function(e){var t=new Ee(e[0],e[1]);return Se.fromTimestamp(t)},e.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new on(t.seconds,t.nanoseconds)},e.prototype.fromDbTimestamp=function(e){var t=new Ee(e.seconds,e.nanoseconds);return Se.fromTimestamp(t)},e.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.baseMutations.map((function(e){return n.remoteSerializer.toMutation(e)})),i=t.mutations.map((function(e){return n.remoteSerializer.toMutation(e)}));return new un(e,t.batchId,t.localWriteTime.toMillis(),r,i)},e.prototype.fromDbMutationBatch=function(e){var t=this,n=(e.baseMutations||[]).map((function(e){return t.remoteSerializer.fromMutation(e)})),r=e.mutations.map((function(e){return t.remoteSerializer.fromMutation(e)})),i=Ee.fromMillis(e.localWriteTimeMs);return new We(e.batchId,i,n,r)},e.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach((function(e){t.push(be(e.path))})),t},e.prototype.fromDbResourcePaths=function(e){for(var t=qe(),n=0,r=e;n<r.length;n++)t=t.add(new he(ke(r[n])));return t},e.prototype.fromDbTarget=function(e){var t,n=this.fromDbTimestamp(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(e.lastLimboFreeSnapshotVersion):Se.MIN,i=e.resumeToken;return t=void 0!==e.query.documents?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new Tn(t,e.targetId,Sn.Listen,e.lastListenSequenceNumber,n,r,i)},e.prototype.toDbTarget=function(e){_(Sn.Listen===e.purpose,"Only queries with purpose "+Sn.Listen+" may be stored, got "+e.purpose);var t,n,r=this.toDbTimestamp(e.snapshotVersion),i=this.toDbTimestamp(e.lastLimboFreeSnapshotVersion);return t=e.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.target):this.remoteSerializer.toQueryTarget(e.target),e.resumeToken instanceof Uint8Array?(_(Ge.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),n=e.resumeToken.toString()):n=e.resumeToken,new pn(e.targetId,e.target.canonicalId(),r,n,e.sequenceNumber,i,t)},e}();function An(e,t){var n=e[1],r=t[1],i=X(e[0],t[0]);return 0===i?X(n,r):i}var Nn=function(){function e(e){this.maxElements=e,this.buffer=new De(An),this.previousIndex=0}return e.prototype.nextIndex=function(){return++this.previousIndex},e.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();An(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),e}(),Dn={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xn=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e.COLLECTION_DISABLED=-1,e.MINIMUM_CACHE_SIZE_BYTES=1048576,e.DEFAULT=new e(e.DEFAULT_CACHE_SIZE_BYTES=41943040,e.DEFAULT_COLLECTION_PERCENTILE=10,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),e.DISABLED=new e(e.COLLECTION_DISABLED,0,0),e}(),Rn=function(){function e(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.hasRun=!1,this.gcTask=null}return e.prototype.start=function(){_(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==xn.COLLECTION_DISABLED&&this.scheduleGC()},e.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),e.prototype.scheduleGC=function(){var e=this;_(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;v("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(de.LruGarbageCollection,t,(function(){return e.gcTask=null,e.hasRun=!0,e.localStore.collectGarbage(e.garbageCollector).then((function(){return e.scheduleGC()})).catch(qn)}))},e}(),On=function(){function e(e,t){this.delegate=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next((function(e){return Math.floor(t/100*e)}))},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return ze.resolve(ae.INVALID);var r=new Nn(t);return this.delegate.forEachTarget(e,(function(e){return r.addElement(e.sequenceNumber)})).next((function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,(function(e){return r.addElement(e)}))})).next((function(){return r.maxValue}))},e.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return this.params.cacheSizeCollectionThreshold===xn.COLLECTION_DISABLED?(v("LruGarbageCollector","Garbage collection skipped; disabled"),ze.resolve(Dn)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(v("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Dn):n.runGarbageCollection(e,t)}))},e.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},e.prototype.runGarbageCollection=function(e,t){var n,r,i,o,a,s,u,l=this,c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>l.params.maximumSequenceNumbersToCollect?(v("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+t),r=l.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),l.nthSequenceNumber(e,r)})).next((function(r){return n=r,a=Date.now(),l.removeTargets(e,n,t)})).next((function(t){return i=t,s=Date.now(),l.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),d()<=f.DEBUG&&v("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-c)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-c)+"ms"),ze.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))},e}(),Pn=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(e){return e()}))},e}(),Mn="IndexedDbPersistence",Ln="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Vn=function(e){function t(t,n){var r=e.call(this)||this;return r.simpleDbTransaction=t,r.currentSequenceNumber=n,r}return o.__extends(t,e),t}(Pn),Un=function(){function e(t,n,r,i,o,a,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},this.referenceDelegate=new Wn(this,o),this.dbName=n+e.MAIN_DATABASE,this.serializer=new In(s),this.document=i.document,this.targetCache=new ct(this.referenceDelegate,this.serializer),this.indexManager=new kn,this.remoteDocumentCache=new Yt(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new k(C.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return e.getStore=function(e,t){if(e instanceof Vn)return Ge.getStore(e.simpleDbTransaction,t);throw m("IndexedDbPersistence must use instances of IndexedDbTransaction")},e.createIndexedDbPersistence=function(t){return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!e.isAvailable())throw new k(C.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new e(t.allowTabSynchronization,t.persistenceKey,t.clientId,t.platform,t.lruParams,t.queue,t.serializer,t.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){var e=this;return _(!this.started,"IndexedDbPersistence double-started!"),_(null!==this.window,"Expected 'window' to be defined"),Ge.openOrCreate(this.dbName,nn,new rn(this.serializer)).then((function(t){return e.simpleDb=t,e.updateClientMetadataAndTryBecomePrimary()})).then((function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.scheduleClientMetadataAndPrimaryLeaseRefreshes(),e.simpleDb.runTransaction("readonly-idempotent",[gn.store],(function(e){return dt(e)}))})).then((function(t){e.listenSequence=new ae(t,e.sequenceNumberSyncer)})).then((function(){e._started=!0})).catch((function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)}))},e.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(n){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(t){return this.started?[2,e(n)]:[2]}))}))},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.simpleDb.setVersionChangeListener((function(n){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return null!==n.newVersion?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget((function(){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},e.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite-idempotent",Cn,(function(t){return jn(t).put(new _n(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next((function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next((function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget((function(){return e.primaryStateListener(!1)})))}))})).next((function(){return e.canActAsPrimary(t)})).next((function(n){return e.isPrimary&&!n?e.releasePrimaryLeaseIfHeld(t).next((function(){return!1})):!!n&&e.acquireOrExtendPrimaryLease(t).next((function(){return!0}))}))})).catch((function(t){if(!e.allowTabSynchronization)throw t;return v(Mn,"Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.queue.enqueueAndForget((function(){return e.primaryStateListener(t)})),e.isPrimary=t}))},e.prototype.verifyPrimaryLease=function(e){var t=this;return Bn(e).get(an.key).next((function(e){return ze.resolve(t.isLocalClient(e))}))},e.prototype.removeClientMetadata=function(e){return jn(e).delete(this.clientId)},e.prototype.maybeGarbageCollectMultiClientState=function(){return o.__awaiter(this,void 0,void 0,(function(){var t=this;return o.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(n){var r=e.getStore(n,_n.store);return r.loadAll().next((function(e){var n=t.filterActiveClients(e,18e5),i=e.filter((function(e){return-1===n.indexOf(e)}));return ze.forEach(i,(function(e){return r.delete(e.clientId)})).next((function(){return i}))}))}))]);case 1:n.sent().forEach((function(e){t.window.localStorage.removeItem(t.zombiedClientLocalStorageKey(e.clientId))})),n.label=2;case 2:return[2]}}))}))},e.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(de.ClientMetadataRefresh,4e3,(function(){return e.updateClientMetadataAndTryBecomePrimary().then((function(){return e.maybeGarbageCollectMultiClientState()})).then((function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()}))}))},e.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.canActAsPrimary=function(e){var t=this;return Bn(e).get(an.key).next((function(n){if(null!==n&&t.isWithinAge(n.leaseTimestampMs,5e3)&&!t.isClientZombied(n.ownerId)){if(t.isLocalClient(n)&&t.networkEnabled)return!0;if(!t.isLocalClient(n)){if(!n.allowTabSynchronization)throw new k(C.FAILED_PRECONDITION,Fn);return!1}}return!(!t.networkEnabled||!t.inForeground)||jn(e).loadAll().next((function(e){return void 0===t.filterActiveClients(e,5e3).find((function(e){return!(t.clientId===e.clientId||!(!t.networkEnabled&&e.networkEnabled||!t.inForeground&&e.inForeground&&t.networkEnabled===e.networkEnabled))}))}))})).next((function(e){return t.isPrimary!==e&&v(Mn,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},e.prototype.shutdown=function(){return o.__awaiter(this,void 0,void 0,(function(){var e=this;return o.__generator(this,(function(t){switch(t.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[an.store,_n.store],(function(t){return e.releasePrimaryLeaseIfHeld(t).next((function(){return e.removeClientMetadata(t)}))}))];case 1:return t.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}}))}))},e.prototype.filterActiveClients=function(e,t){var n=this;return e.filter((function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)}))},e.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly-idempotent",[_n.store],(function(t){return jn(t).loadAll().next((function(t){return e.filterActiveClients(t,18e5).map((function(e){return e.clientId}))}))}))},e.clearPersistence=function(t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){switch(n.label){case 0:return e.isAvailable()?[4,Ge.delete(t+e.MAIN_DATABASE)]:[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getMutationQueue=function(e){return _(this.started,"Cannot initialize MutationQueue before persistence is started."),et.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},e.prototype.getTargetCache=function(){return _(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},e.prototype.getRemoteDocumentCache=function(){return _(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},e.prototype.getIndexManager=function(){return _(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},e.prototype.runTransaction=function(e,t,n){var r=this;v(Mn,"Starting transaction:",e);var i,o=t.endsWith("idempotent"),a=t.startsWith("readonly");return this.simpleDb.runTransaction(a?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite",Cn,(function(o){return i=new Vn(o,r.listenSequence.next()),"readwrite-primary"===t||"readwrite-primary-idempotent"===t?r.verifyPrimaryLease(o).next((function(e){return!!e||r.canActAsPrimary(o)})).next((function(t){if(!t)throw g("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.queue.enqueueAndForget((function(){return r.primaryStateListener(!1)})),new k(C.FAILED_PRECONDITION,Ln);return n(i)})).next((function(e){return r.acquireOrExtendPrimaryLease(o).next((function(){return e}))})):r.verifyAllowTabSynchronization(o).next((function(){return n(i)}))})).then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.verifyAllowTabSynchronization=function(e){var t=this;return Bn(e).get(an.key).next((function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new k(C.FAILED_PRECONDITION,Fn)}))},e.prototype.acquireOrExtendPrimaryLease=function(e){var t=new an(this.clientId,this.allowTabSynchronization,Date.now());return Bn(e).put(an.key,t)},e.isAvailable=function(){return Ge.isAvailable()},e.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},e.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=Bn(e);return n.get(an.key).next((function(e){return t.isLocalClient(e)?(v(Mn,"Releasing primary lease."),n.delete(an.key)):ze.resolve()}))},e.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(g("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()}))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},e.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(_(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},e.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.windowUnloadHandler))},e.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(_("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},e.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return v(Mn,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(n){return g(Mn,"Failed to get zombied client id.",n),!1}},e.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){g("Failed to set zombie client id.",e)}},e.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},e.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e.MAIN_DATABASE="main",e}();function qn(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){if(!function(e){return e.code===C.FAILED_PRECONDITION&&e.message===Ln}(e))throw e;return v(Mn,"Unexpectedly lost primary lease"),[2]}))}))}function Bn(e){return e.store(an.store)}function jn(e){return e.store(_n.store)}var Wn=function(){function e(e,t){this.db=e,this.inMemoryPins=null,this.garbageCollector=new On(this,t)}return e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,(function(e,n){return t(n)}))},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return Hn(e,t)},e.prototype.removeReference=function(e,t){return Hn(e,t)},e.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},e.prototype.removeMutationReference=function(e,t){return Hn(e,t)},e.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?ze.resolve(!0):function(e,t){var n=!1;return at(e).iterateSerial((function(r){return tt(e,r,t).next((function(e){return e&&(n=!0),ze.resolve(!e)}))})).next((function(){return n}))}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(e,(function(a,s){if(s<=t){var u=n.isPinned(e,a).next((function(t){if(!t)return o++,r.getEntry(e,a).next((function(){return r.removeEntry(a),pt(e).delete([0,be(a.path)])}))}));i.push(u)}})).next((function(){return ze.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return o}))},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},e.prototype.updateLimboDocument=function(e,t){return Hn(e,t)},e.prototype.forEachOrphanedDocument=function(e,t){var n,r=pt(e),i=ae.INVALID;return r.iterate({index:vn.documentTargetsIndex},(function(e,r){var o=r.path,a=r.sequenceNumber;0===e[0]?(i!==ae.INVALID&&t(new he(ke(n)),i),i=a,n=o):i=ae.INVALID})).next((function(){i!==ae.INVALID&&t(new he(ke(n)),i)}))},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function Hn(e,t){return pt(e).put(function(e,t){return new vn(0,be(e.path),t)}(t,e.currentSequenceNumber))}var zn=Number,Qn=zn.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Gn=zn.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Kn=zn.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function Yn(e){return null==e}function Xn(e){return Kn(e)&&e<=Gn&&e>=Qn}var Jn=function(){function e(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return e.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();null!==this.collectionGroup&&(e+="|cg:"+this.collectionGroup),e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)e+=i[r].canonicalId(),e+=",";Yn(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},e.prototype.toString=function(){var e=this.path.canonicalString();return null!==this.collectionGroup&&(e+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(e+=", filters: ["+this.filters.join(", ")+"]"),Yn(this.limit)||(e+=", limit: "+this.limit),this.orderBy.length>0&&(e+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),"Target("+e+")"},e.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return this.collectionGroup===e.collectionGroup&&!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},e.prototype.isDocumentQuery=function(){return he.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},e}(),$n=function(e){return e.First="F",e.Last="L",e}({}),Zn=function(){function e(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=$n.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return e.atPath=function(t){return new e(t)},Object.defineProperty(e.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)this.memoizedOrderBy=e.isKeyField()?[hr]:[new cr(e),hr];else{_(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}n||this.memoizedOrderBy.push((this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:ur.ASCENDING)===ur.ASCENDING?hr:fr)}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),e.prototype.addFilter=function(t){_(null==this.getInequalityFilterField()||!(t instanceof nr)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),_(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([t]);return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.addOrderBy=function(t){_(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([t]);return new e(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.withLimitToFirst=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,$n.First,this.startAt,this.endAt)},e.prototype.withLimitToLast=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,$n.Last,this.startAt,this.endAt)},e.prototype.withStartAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,t,this.endAt)},e.prototype.withEndAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,t)},e.prototype.asCollectionQueryAtPath=function(t){return new e(t,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},e.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},e.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},e.prototype.isEqual=function(e){return this.toTarget().isEqual(e.toTarget())&&this.limitType===e.limitType},e.prototype.docComparator=function(e,t){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return _(n,"orderBy used that doesn't compare on key field"),0},e.prototype.matches=function(e){return this.matchesPathAndCollectionGroup(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},e.prototype.hasLimitToFirst=function(){return!Yn(this.limit)&&this.limitType===$n.First},e.prototype.hasLimitToLast=function(){return!Yn(this.limit)&&this.limitType===$n.Last},e.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},e.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof nr&&n.isInequality())return n.field}return null},e.prototype.findFilterOperator=function(e){for(var t=0,n=this.filters;t<n.length;t++){var r=n[t];if(r instanceof nr&&e.indexOf(r.op)>=0)return r.op}return null},e.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},e.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},e.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===$n.First)this.memoizedTarget=new Jn(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var e=[],t=0,n=this.orderBy;t<n.length;t++){var r=n[t];e.push(new cr(r.field,r.dir===ur.DESCENDING?ur.ASCENDING:ur.DESCENDING))}var i=this.endAt?new lr(this.endAt.position,!this.endAt.before):null,o=this.startAt?new lr(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new Jn(this.path,this.collectionGroup,e,this.filters,this.limit,i,o)}return this.memoizedTarget},e.prototype.matchesPathAndCollectionGroup=function(e){var t=e.key.path;return null!==this.collectionGroup?e.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(t):he.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isImmediateParentOf(t)},e.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&null===e.field(r.field))return!1}return!0},e.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},e.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},e.prototype.assertValidBound=function(e){_(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},e}(),er=function(){},tr=function(){function e(e){this.name=e}return e.fromString=function(t){switch(t){case"<":return e.LESS_THAN;case"<=":return e.LESS_THAN_OR_EQUAL;case"==":return e.EQUAL;case">=":return e.GREATER_THAN_OR_EQUAL;case">":return e.GREATER_THAN;case"array-contains":return e.ARRAY_CONTAINS;case"in":return e.IN;case"array-contains-any":return e.ARRAY_CONTAINS_ANY;default:return m("Unknown FieldFilter operator: "+t)}},e.prototype.toString=function(){return this.name},e.prototype.isEqual=function(e){return this.name===e.name},e.LESS_THAN=new e("<"),e.LESS_THAN_OR_EQUAL=new e("<="),e.EQUAL=new e("=="),e.GREATER_THAN=new e(">"),e.GREATER_THAN_OR_EQUAL=new e(">="),e.ARRAY_CONTAINS=new e("array-contains"),e.IN=new e("in"),e.ARRAY_CONTAINS_ANY=new e("array-contains-any"),e}(),nr=function(e){function t(t,n,r){var i=e.call(this)||this;return i.field=t,i.op=n,i.value=r,i}return o.__extends(t,e),t.create=function(e,n,r){if(e.isKeyField())return n===tr.IN?(_(r instanceof jt,"Comparing on key with IN, but filter value not an ArrayValue"),_(r.internalValue.every((function(e){return e instanceof Ut})),"Comparing on key with IN, but an array value was not a RefValue"),new ir(e,r)):(_(r instanceof Ut,"Comparing on key, but filter value not a RefValue"),_(n!==tr.ARRAY_CONTAINS&&n!==tr.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new rr(e,n,r));if(r.isEqual(Nt.INSTANCE)){if(n!==tr.EQUAL)throw new k(C.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new t(e,n,r)}if(r.isEqual(Pt.NAN)){if(n!==tr.EQUAL)throw new k(C.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new t(e,n,r)}return n===tr.ARRAY_CONTAINS?new or(e,r):n===tr.IN?(_(r instanceof jt,"IN filter has invalid value: "+r.toString()),new ar(e,r)):n===tr.ARRAY_CONTAINS_ANY?(_(r instanceof jt,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new sr(e,r)):new t(e,n,r)},t.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case tr.LESS_THAN:return e<0;case tr.LESS_THAN_OR_EQUAL:return e<=0;case tr.EQUAL:return 0===e;case tr.GREATER_THAN:return e>0;case tr.GREATER_THAN_OR_EQUAL:return e>=0;default:return m("Unknown FieldFilter operator: "+this.op)}},t.prototype.isInequality=function(){return[tr.LESS_THAN,tr.LESS_THAN_OR_EQUAL,tr.GREATER_THAN,tr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(er),rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.matches=function(e){var t=he.comparator(e.key,this.value.key);return this.matchesComparison(t)},t}(nr),ir=function(e){function t(t,n){var r=e.call(this,t,tr.IN,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){return this.value.internalValue.some((function(t){return e.key.isEqual(t.key)}))},t}(nr),or=function(e){function t(t,n){return e.call(this,t,tr.ARRAY_CONTAINS,n)||this}return o.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return t instanceof jt&&t.contains(this.value)},t}(nr),ar=function(e){function t(t,n){var r=e.call(this,t,tr.IN,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){var t=this.value,n=e.field(this.field);return null!==n&&t.contains(n)},t}(nr),sr=function(e){function t(t,n){var r=e.call(this,t,tr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){var t=this,n=e.field(this.field);return n instanceof jt&&n.internalValue.some((function(e){return t.value.contains(e)}))},t}(nr),ur=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),lr=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},e.prototype.sortsBeforeDocument=function(e,t){_(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=e[r],o=this.position[r];if(i.field.isKeyField())_(o instanceof Ut,"Bound has a non-key value where the key path is being used."),n=he.comparator(o.key,t.key);else{var a=t.field(i.field);_(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===ur.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++)if(!this.position[t].isEqual(e.position[t]))return!1;return!0},e}(),cr=function(){function e(e,t){this.field=e,void 0===t&&(t=ur.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var n=this.isKeyOrderBy?Ht.compareByKey(e,t):Ht.compareByField(this.field,e,t);switch(this.dir){case ur.ASCENDING:return n;case ur.DESCENDING:return-1*n;default:return m("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),hr=new cr(ce.keyField(),ur.ASCENDING),fr=new cr(ce.keyField(),ur.DESCENDING),dr=function(){function e(){}return e.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var i=this;return _(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),t.matchesAllDocuments()?this.executeFullCollectionScan(e,t):n.isEqual(Se.MIN)?this.executeFullCollectionScan(e,t):this.localDocumentsView.getDocuments(e,r).next((function(o){var a=i.applyQuery(t,o);return(t.hasLimitToFirst()||t.hasLimitToLast())&&i.needsRefill(t.limitType,a,r,n)?i.executeFullCollectionScan(e,t):(d()<=f.DEBUG&&v("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),t.toString()),i.localDocumentsView.getDocumentsMatchingQuery(e,t,n).next((function(e){return a.forEach((function(t){e=e.insert(t.key,t)})),e})))}))},e.prototype.applyQuery=function(e,t){var n=new De((function(t,n){return e.docComparator(t,n)}));return t.forEach((function(t,r){r instanceof Ht&&e.matches(r)&&(n=n.add(r))})),n},e.prototype.needsRefill=function(e,t,n,r){if(n.size!==t.size)return!0;var i=e===$n.First?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},e.prototype.executeFullCollectionScan=function(e,t){return d()<=f.DEBUG&&v("IndexFreeQueryEngine","Using full collection scan to execute query: %s",t.toString()),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Se.MIN)},e}(),pr=function(){function e(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}return e.prototype.getDocument=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.getDocumentInternal(e,t,r)}))},e.prototype.getDocumentInternal=function(e,t,n){return this.remoteDocumentCache.getEntry(e,t).next((function(e){for(var r=0,i=n;r<i.length;r++)e=i[r].applyToLocalView(t,e);return e}))},e.prototype.applyLocalMutationsToDocuments=function(e,t,n){var r=Pe();return t.forEach((function(e,t){for(var i=0,o=n;i<o.length;i++)t=o[i].applyToLocalView(e,t);r=r.insert(e,t)})),r},e.prototype.getDocuments=function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t)}))},e.prototype.getLocalViewOfDocuments=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(r){var i=n.applyLocalMutationsToDocuments(e,t,r),o=Oe();return i.forEach((function(e,t){t||(t=new zt(e,Se.forDeletedDoc())),o=o.insert(e,t)})),o}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return t.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(e,t.path):t.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new he(t)).next((function(e){var t=Le();return e instanceof Ht&&(t=t.insert(e.key,e)),t}))},e.prototype.getDocumentsMatchingCollectionGroupQuery=function(e,t,n){var r=this;_(t.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=t.collectionGroup,o=Le();return this.indexManager.getCollectionParents(e,i).next((function(a){return ze.forEach(a,(function(a){var s=t.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))},e.prototype.getDocumentsMatchingCollectionQuery=function(e,t,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n).next((function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)})).next((function(t){return o.addMissingBaseDocuments(e,i=t,r).next((function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],l=u.key,c=r.get(l),h=u.applyToLocalView(c,c,o.localWriteTime);r=h instanceof Ht?r.insert(l,h):r.remove(l)}}))})).next((function(){return r.forEach((function(e,n){t.matches(n)||(r=r.remove(e))})),r}))},e.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=qe(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Ct&&null===n.get(u.key)&&(r=r.add(u.key))}var l=n;return this.remoteDocumentCache.getEntries(e,r).next((function(e){return e.forEach((function(e,t){null!==t&&t instanceof Ht&&(l=l.insert(e,t))})),l}))},e}(),vr=function(){function e(){this.refsByKey=new De(gr.compareByKey),this.refsByTarget=new De(gr.compareByTargetId)}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var n=new gr(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},e.prototype.addReferences=function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))},e.prototype.removeReference=function(e,t){this.removeRef(new gr(e,t))},e.prototype.removeReferences=function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))},e.prototype.removeReferencesForId=function(e){var t=this,n=he.EMPTY,r=new gr(n,e),i=new gr(n,e+1),o=[];return this.refsByTarget.forEachInRange([r,i],(function(e){t.removeRef(e),o.push(e.key)})),o},e.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach((function(t){return e.removeRef(t)}))},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},e.prototype.referencesForId=function(e){var t=he.EMPTY,n=new gr(t,e),r=new gr(t,e+1),i=qe();return this.refsByTarget.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i},e.prototype.containsKey=function(e){var t=new gr(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),gr=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return he.comparator(e.key,t.key)||X(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return X(e.targetOrBatchId,t.targetOrBatchId)||he.comparator(e.key,t.key)},e}(),yr=function(){function e(e,t,n){this.persistence=e,this.queryEngine=t,this.localViewReferences=new vr,this.targetDataByTarget=new Te(X),this.targetIdByTarget=new Gt((function(e){return e.canonicalId()})),this.lastDocumentChangeReadTime=Se.MIN,_(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(n),this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.localDocuments=new pr(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return e.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},e.prototype.handleUserChange=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i=this;return o.__generator(this,(function(o){switch(o.label){case 0:return t=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next((function(a){return o=a,t=i.persistence.getMutationQueue(e),n=new pr(i.remoteDocuments,t,i.persistence.getIndexManager()),t.getAllMutationBatches(r)})).next((function(e){for(var t=[],i=[],a=qe(),s=0,u=o;s<u.length;s++){t.push((d=u[s]).batchId);for(var l=0,c=d.mutations;l<c.length;l++)a=a.add(c[l].key)}for(var h=0,f=e;h<f.length;h++){var d;i.push((d=f[h]).batchId);for(var p=0,v=d.mutations;p<v.length;p++)a=a.add(v[p].key)}return n.getDocuments(r,a).next((function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:i}}))}))}))];case 1:return r=o.sent(),this.mutationQueue=t,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}}))}))},e.prototype.localWrite=function(e){var t,n=this,r=Ee.now(),i=e.reduce((function(e,t){return e.add(t.key)}),qe());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.localDocuments.getDocuments(o,i).next((function(i){t=i;for(var a=[],s=0,u=e;s<u.length;s++){var l=u[s],c=l.extractBaseValue(t.get(l.key));null!=c&&a.push(new Ct(l.key,c,c.fieldMask(),_t.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,e)}))})).then((function(e){var n=e.applyToLocalDocumentSet(t);return{batchId:e.batchId,changes:n}}))},e.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return t.mutationQueue.lookupMutationKeys(n,e).next((function(e){return e?t.localDocuments.getDocuments(n,e):ze.resolve(null)}))}))},e.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=e.batch.keys(),i=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return t.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next((function(){return t.applyWriteToRemoteDocuments(n,e,i)})).next((function(){return i.apply(n)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},e.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return t.mutationQueue.lookupMutationBatch(n,e).next((function(e){return _(null!==e,"Attempt to reject nonexistent batch!"),r=e.keys(),t.mutationQueue.removeMutationBatch(n,e)})).next((function(){return t.mutationQueue.performConsistencyCheck(n)})).next((function(){return t.localDocuments.getDocuments(n,r)}))}))},e.prototype.getHighestUnacknowledgedBatchId=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(t){return e.mutationQueue.getHighestUnacknowledgedBatchId(t)}))},e.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(t){return e.mutationQueue.getLastStreamToken(t)}))},e.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return t.mutationQueue.setLastStreamToken(n,e)}))},e.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(t){return e.targetCache.getLastRemoteSnapshotVersion(t)}))},e.prototype.applyRemoteEvent=function(t){var n=this,r=t.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.targetDataByTarget;var s=[];I(t.targetChanges,(function(t,a){var u=i.get(t);if(u){s.push(n.targetCache.removeMatchingKeys(o,a.removedDocuments,t).next((function(){return n.targetCache.addMatchingKeys(o,a.addedDocuments,t)})));var l=a.resumeToken;if(l.length>0){var c=u.withResumeToken(l,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(t,c),e.shouldPersistTargetData(u,c,a)&&s.push(n.targetCache.updateTargetData(o,c))}}}));var u=Oe(),l=qe();if(t.documentUpdates.forEach((function(e,t){l=l.add(e)})),s.push(a.getEntries(o,l).next((function(e){t.documentUpdates.forEach((function(i,l){var c=e.get(i);l instanceof zt&&l.version.isEqual(Se.MIN)?(a.removeEntry(i,r),u=u.insert(i,l)):null==c||l.version.compareTo(c.version)>0||0===l.version.compareTo(c.version)&&c.hasPendingWrites?(_(!Se.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),a.addEntry(l,r),u=u.insert(i,l)):v("LocalStore","Ignoring outdated watch update for ",i,". Current version:",c.version," Watch version:",l.version),t.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))}))}))),!r.isEqual(Se.MIN)){var c=n.targetCache.getLastRemoteSnapshotVersion(o).next((function(e){return _(r.compareTo(e)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+e),n.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,r)}));s.push(c)}return ze.waitFor(s).next((function(){return a.apply(o)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(o,u)}))})).then((function(e){return n.targetDataByTarget=i,e}))},e.shouldPersistTargetData=function(e,t,n){return _(t.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===e.resumeToken.length||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0},e.prototype.notifyLocalViewChanges=function(e){for(var t=this,n=0,r=e;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);_(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.withLastLimboFreeSnapshotVersion(a.snapshotVersion);this.targetDataByTarget=this.targetDataByTarget.insert(o,s)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return ze.forEach(e,(function(e){return ze.forEach(e.removedKeys,(function(e){return t.persistence.referenceDelegate.removeReference(n,e)}))}))}))},e.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)}))},e.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return t.localDocuments.getDocument(n,e)}))},e.prototype.allocateTarget=function(e){var t=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return t.targetCache.getTargetData(n,e).next((function(i){return i?ze.resolve(r=i):t.targetCache.allocateTargetId(n).next((function(i){return r=new Tn(e,i,Sn.Listen,n.currentSequenceNumber),t.targetCache.addTargetData(n,r).next((function(){return r}))}))}))})).then((function(n){return null===t.targetDataByTarget.get(n.targetId)&&(t.targetDataByTarget=t.targetDataByTarget.insert(n.targetId,n),t.targetIdByTarget.set(e,n.targetId)),n}))},e.prototype.getTargetData=function(e,t){var n=this.targetIdByTarget.get(t);return void 0!==n?ze.resolve(this.targetDataByTarget.get(n)):this.targetCache.getTargetData(e,t)},e.prototype.releaseTarget=function(e,t){var n=this,r=this.targetDataByTarget.get(e);return _(null!==r,"Tried to release nonexistent target: "+e),this.persistence.runTransaction("Release target",t?"readwrite-idempotent":"readwrite-primary-idempotent",(function(i){var o=n.localViewReferences.removeReferencesForId(e);return t?ze.resolve():ze.forEach(o,(function(e){return n.persistence.referenceDelegate.removeReference(i,e)})).next((function(){n.persistence.referenceDelegate.removeTarget(i,r)}))})).then((function(){n.targetDataByTarget=n.targetDataByTarget.remove(e),n.targetIdByTarget.delete(r.target)}))},e.prototype.executeQuery=function(e,t){var n=this,r=Se.MIN,i=qe();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.getTargetData(o,e.toTarget()).next((function(e){if(e)return r=e.lastLimboFreeSnapshotVersion,n.targetCache.getMatchingKeysForTargetId(o,e.targetId).next((function(e){i=e}))})).next((function(){return n.queryEngine.getDocumentsMatchingQuery(o,e,t?r:Se.MIN,t?i:qe())})).next((function(e){return{documents:e,remoteKeys:i}}))}))},e.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return t.targetCache.getMatchingKeysForTargetId(n,e)}))},e.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},e.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},e.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},e.prototype.applyWriteToRemoteDocuments=function(e,t,n){var r=this,i=t.batch,o=i.keys(),a=ze.resolve();return o.forEach((function(r){a=a.next((function(){return n.getEntry(e,r)})).next((function(e){var o=e,a=t.docVersions.get(r);_(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,t))?n.addEntry(o,t.commitVersion):_(!e,"Mutation batch "+i+" applied to document "+e+" resulted in null"))}))})),a.next((function(){return r.mutationQueue.removeMutationBatch(e,i)}))},e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return e.collect(n,t.targetDataByTarget)}))},e.prototype.getTarget=function(e){var t=this,n=this.targetDataByTarget.get(e);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return t.targetCache.getTargetDataForTarget(n,e).next((function(e){return e?e.target:null}))}))},e.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(t){return e.remoteDocuments.getNewDocumentChanges(t,e.lastDocumentChangeReadTime)})).then((function(t){var n=t.changedDocs;return e.lastDocumentChangeReadTime=t.readTime,n}))},e.prototype.synchronizeLastDocumentChangeReadTime=function(){return o.__awaiter(this,void 0,void 0,(function(){var e,t=this;return o.__generator(this,(function(n){return this.remoteDocuments instanceof Yt?(e=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(t){return e.getLastDocumentChange(t)})).then((function(e){t.lastDocumentChangeReadTime=e.readTime}))]):[2]}))}))},e.RESUME_TOKEN_MAX_AGE_MICROS=3e8,e}(),mr=function(){function e(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=w(),this.batchesByDocumentKey=new De(gr.compareByKey)}return e.prototype.checkEmpty=function(e){return ze.resolve(0===this.mutationQueue.length)},e.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");_(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return _(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,ze.resolve()},e.prototype.getLastStreamToken=function(e){return ze.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,ze.resolve()},e.prototype.addMutationBatch=function(e,t,n,r){_(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&_(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new We(i,t,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new gr(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}return ze.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return ze.resolve(this.findMutationBatch(t))},e.prototype.lookupMutationKeys=function(e,t){var n=this.findMutationBatch(t);return _(null!=n,"Failed to find local mutation batch."),ze.resolve(n.keys())},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this.indexOfBatchId(t+1),r=n<0?0:n;return ze.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return ze.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},e.prototype.getAllMutationBatches=function(e){return ze.resolve(this.mutationQueue.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new gr(t,0),i=new gr(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],(function(e){_(t.isEqual(e.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(e.targetOrBatchId);_(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),ze.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new De(X);return t.forEach((function(e){var t=new gr(e,0),i=new gr(e,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([t,i],(function(t){_(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.targetOrBatchId)}))})),ze.resolve(this.findMutationBatches(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){_(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,i=n;he.isDocumentKey(i)||(i=i.child(""));var o=new gr(new he(i),0),a=new De(X);return this.batchesByDocumentKey.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)}),o),ze.resolve(this.findMutationBatches(a))},e.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.findMutationBatch(e);null!==r&&n.push(r)})),n},e.prototype.removeMutationBatch=function(e,t){var n=this;_(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return ze.forEach(t.mutations,(function(i){var o=new gr(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(e,i.key)})).next((function(){n.batchesByDocumentKey=r}))},e.prototype.removeCachedMutationKeys=function(e){},e.prototype.containsKey=function(e,t){var n=new gr(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return ze.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&_(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),ze.resolve()},e.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return _(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return _(n.batchId===e,"If found batch must match"),n},e}(),_r=function(){function e(e,t){this.indexManager=e,this.sizer=t,this.docs=new Te(he.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){_(!n.isEqual(Se.MIN),"Cannot add a document with a read time of zero");var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(t);return this.docs=this.docs.insert(r,{maybeDocument:t,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return ze.resolve(n?n.maybeDocument:null)},e.prototype.getEntries=function(e,t){var n=this,r=Pe();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)})),ze.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){_(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Le(),i=new he(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.value,u=s.maybeDocument,l=s.readTime;if(!t.path.isPrefixOf(a.key.path))break;l.compareTo(n)<=0||u instanceof Ht&&t.matches(u)&&(r=r.insert(u.key,u))}return ze.resolve(r)},e.prototype.forEachDocumentKey=function(e,t){return ze.forEach(this.docs,(function(e){return t(e)}))},e.prototype.getNewDocumentChanges=function(e,t){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this)},e.prototype.getSize=function(e){return ze.resolve(this.size)},e.RemoteDocumentChangeBuffer=function(e){function t(t){var n=e.call(this)||this;return n.documentCache=t,n}return o.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i?n.push(t.documentCache.addEntry(e,i,t.readTime)):t.documentCache.removeEntry(r)})),ze.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},t}(Kt),e}(),br=function(){function e(e){this.persistence=e,this.targets=new Gt((function(e){return e.canonicalId()})),this.lastRemoteSnapshotVersion=Se.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new vr,this.targetCount=0,this.targetIdGenerator=lt.forTargetCache()}return e.prototype.forEachTarget=function(e,t){return this.targets.forEach((function(e,n){return t(n)})),ze.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return ze.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return ze.resolve(this.highestSequenceNumber)},e.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,ze.resolve(t)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),ze.resolve()},e.prototype.saveTargetData=function(e){this.targets.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return _(!this.targets.has(t.target),"Adding a target that already exists"),this.saveTargetData(t),this.targetCount+=1,ze.resolve()},e.prototype.updateTargetData=function(e,t){return _(this.targets.has(t.target),"Updating a non-existent target"),this.saveTargetData(t),ze.resolve()},e.prototype.removeTargetData=function(e,t){return _(this.targetCount>0,"Removing a target from an empty cache"),_(this.targets.has(t.target),"Removing a non-existent target from the cache"),this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,ze.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.targets.forEach((function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.targets.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),ze.waitFor(o).next((function(){return i}))},e.prototype.getTargetCount=function(e){return ze.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var n=this.targets.get(t)||null;return ze.resolve(n)},e.prototype.getTargetDataForTarget=function(e,t){return m("Not yet implemented.")},e.prototype.addMatchingKeys=function(e,t,n){this.references.addReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.addReference(e,t))})),ze.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){this.references.removeReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.removeReference(e,t))})),ze.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),ze.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return ze.resolve(n)},e.prototype.containsKey=function(e,t){return ze.resolve(this.references.containsKey(t))},e}(),wr=function(){function e(e,t){var n=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new ae(0),this._started=!1,this._started=!0,this.referenceDelegate=t(this),this.targetCache=new br(this),this.indexManager=new en,this.remoteDocumentCache=new _r(this.indexManager,(function(e){return n.referenceDelegate.documentSize(e)}))}return e.createLruPersistence=function(t,n,r){return new e(t,(function(e){return new Er(e,new In(n),r)}))},e.createEagerPersistence=function(t){return new e(t,(function(e){return new kr(e)}))},e.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getActiveClients=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return[2,[this.clientId]]}))}))},e.prototype.setPrimaryStateListener=function(e){return e(!0)},e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(e){},e.prototype.getIndexManager=function(){return this.indexManager},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new mr(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.targetCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,n){var r=this;v("MemoryPersistence","Starting transaction:",e);var i=new Cr(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next((function(e){return r.referenceDelegate.onTransactionCommitted(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.mutationQueuesContainKey=function(e,t){return ze.or((n=this.mutationQueues,r=[],A(n,(function(e,t){return r.push(t)})),r).map((function(n){return function(){return n.containsKey(e,t)}})));var n,r},e}(),Cr=function(e){function t(t){var n=e.call(this)||this;return n.currentSequenceNumber=t,n}return o.__extends(t,e),t}(Pn),kr=function(){function e(e){this.persistence=e,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(e.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw m("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),ze.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),ze.resolve()},e.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),ze.resolve()},e.prototype.removeTarget=function(e,t){var n=this,r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.orphanedDocuments.add(e)}))})).next((function(){return r.removeTargetData(e,t)}))},e.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},e.prototype.onTransactionCommitted=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ze.forEach(this.orphanedDocuments,(function(r){return t.isReferenced(e,r).next((function(e){e||n.removeEntry(r)}))})).next((function(){return t._orphanedDocuments=null,n.apply(e)}))},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next((function(e){e?n.orphanedDocuments.delete(t):n.orphanedDocuments.add(t)}))},e.prototype.documentSize=function(e){return 0},e.prototype.isReferenced=function(e,t){var n=this;return ze.or([function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return ze.resolve(n.inMemoryPins.containsKey(t))}])},e}(),Er=function(){function e(e,t,n){this.persistence=e,this.serializer=t,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Gt((function(e){return be(e.path)})),this.garbageCollector=new On(this,n)}return e.prototype.onTransactionStarted=function(){},e.prototype.onTransactionCommitted=function(e){return ze.resolve()},e.prototype.forEachTarget=function(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)},e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var n=this;return ze.forEach(this.orphanedSequenceNumbers,(function(r,i){return n.isPinned(e,r,i).next((function(e){return e?ze.resolve():t(i)}))}))},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.removeTargets=function(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(e,(function(i){return n.isPinned(e,i,t).next((function(e){e||(r++,o.removeEntry(i))}))})).next((function(){return o.apply(e)})).next((function(){return r}))},e.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)},e.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.documentSize=function(e){var t,n=this.serializer.toDbRemoteDocument(e,e.version);if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw m("Unknown remote document type");t=n.noDocument}return JSON.stringify(t).length},e.prototype.isPinned=function(e,t,n){var r=this;return ze.or([function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return ze.resolve(r.inMemoryPins.containsKey(t))},function(){return r.persistence.getTargetCache().containsKey(e,t)},function(){var e=r.orphanedSequenceNumbers.get(t);return ze.resolve(void 0!==e&&e>n)}])},e.prototype.getCacheSize=function(e){return this.persistence.getRemoteDocumentCache().getSize(e)},e}(),Sr=1e3,Tr=1.5,Ir=6e4,Ar=function(){function e(e,t,n,r,i){void 0===n&&(n=Sr),void 0===r&&(r=Tr),void 0===i&&(i=Ir),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&v("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,(function(){return t.lastAttemptTime=Date.now(),e()})),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}(),Nr=function(e){return e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.Open=2]="Open",e[e.Error=3]="Error",e[e.Backoff=4]="Backoff",e}({}),Dr=function(){function e(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Nr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Ar(e,t)}return e.prototype.isStarted=function(){return this.state===Nr.Starting||this.state===Nr.Open||this.state===Nr.Backoff},e.prototype.isOpen=function(){return this.state===Nr.Open},e.prototype.start=function(){this.state!==Nr.Error?(_(this.state===Nr.Initial,"Already started"),this.auth()):this.performBackoff()},e.prototype.stop=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(Nr.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.inhibitBackoff=function(){_(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Nr.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,(function(){return e.handleIdleCloseTimer()})))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this.isOpen()?[2,this.close(Nr.Initial)]:[2]}))}))},e.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},e.prototype.close=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(n){switch(n.label){case 0:return _(this.isStarted(),"Only started streams should be closed."),_(e===Nr.Error||Yn(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==Nr.Error?this.backoff.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(g(t.toString()),g("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===C.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.tearDown=function(){},e.prototype.auth=function(){var e=this;_(this.state===Nr.Initial,"Must be in initial state to auth"),this.state=Nr.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then((function(t){e.closeCount===n&&e.startStream(t)}),(function(n){t((function(){var t=new k(C.UNKNOWN,"Fetching auth token failed: "+n.message);return e.handleStreamClose(t)}))}))},e.prototype.startStream=function(e){var t=this;_(this.state===Nr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen((function(){n((function(){return _(t.state===Nr.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=Nr.Open,t.listener.onOpen()}))})),this.stream.onClose((function(e){n((function(){return t.handleStreamClose(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},e.prototype.performBackoff=function(){var e=this;_(this.state===Nr.Error,"Should only perform backoff when in Error state"),this.state=Nr.Backoff,this.backoff.backoffAndRun((function(){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){return _(this.state===Nr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Nr.Initial,this.start(),_(this.isStarted(),"PersistentStream should have started"),[2]}))}))}))},e.prototype.handleStreamClose=function(e){return _(this.isStarted(),"Can't handle server close on non-started stream"),v("PersistentStream","close with error: "+e),this.stream=null,this.close(Nr.Error,e)},e.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(n){t.queue.enqueueAndForget((function(){return t.closeCount===e?n():(v("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},e}(),xr=function(e){function t(t,n,r,i,o){var a=e.call(this,t,de.ListenStreamConnectionBackoff,de.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return o.__extends(t,e),t.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},t.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},t.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},t.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},t}(Dr),Rr=function(e){function t(t,n,r,i,o){var a=e.call(this,t,de.WriteStreamConnectionBackoff,de.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=w(),a}return o.__extends(t,e),Object.defineProperty(t.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.handshakeComplete_=!1,e.prototype.start.call(this)},t.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},t.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},t.prototype.onMessage=function(e){if(_(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return _(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},t.prototype.writeHandshake=function(){_(this.isOpen(),"Writing handshake requires an opened stream"),_(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},t.prototype.writeMutations=function(e){var t=this;_(this.isOpen(),"Writing mutations requires an opened stream"),_(this.handshakeComplete_,"Handshake must be complete before writing mutations"),_(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map((function(e){return t.serializer.toMutation(e)}))};this.sendRequest(n)},t}(Dr),Or=function(){function e(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}return e.prototype.newPersistentWriteStream=function(e){return new Rr(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.newPersistentWatchStream=function(e){return new xr(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map((function(e){return t.serializer.toMutation(e)}))};return this.invokeRPC("Commit",n).then((function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)}))},e.prototype.lookup=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,documents:e.map((function(e){return t.serializer.toName(e)}))};return this.invokeStreamingRPC("BatchGetDocuments",n).then((function(n){var r=Oe();n.forEach((function(e){var n=t.serializer.fromMaybeDocument(e);r=r.insert(n.key,n)}));var i=[];return e.forEach((function(e){var t=r.get(e);_(!!t,"Missing entity in write response for "+e),i.push(t)})),i}))},e.prototype.invokeRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeRPC(e,t,r)})).catch((function(e){throw e.code===C.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},e.prototype.invokeStreamingRPC=function(e,t){var n=this;return this.credentials.getToken().then((function(r){return n.connection.invokeStreamingRPC(e,t,r)})).catch((function(e){throw e.code===C.UNAUTHENTICATED&&n.credentials.invalidateToken(),e}))},e}(),Pr=function(){function e(e){this.datastore=e,this.readVersions=Ve(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(C.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(e)];case 1:return(t=r.sent()).forEach((function(e){e instanceof zt||e instanceof Ht?n.recordVersion(e):m("Document in a transaction was a "+e.constructor.name)})),[2,t]}}))}))},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e)},e.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e)},e.prototype.delete=function(e){this.write([new Et(e,this.precondition(e))]),this.writtenDocs.add(e)},e.prototype.commit=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(e=this.readVersions,this.mutations.forEach((function(t){e=e.remove(t.key)})),!e.isEmpty())throw new k(C.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}}))}))},e.prototype.recordVersion=function(e){var t;if(e instanceof Ht)t=e.version;else{if(!(e instanceof zt))throw m("Document in a transaction was a "+e.constructor.name);t=Se.forDeletedDoc()}var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new k(C.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return!this.writtenDocs.has(e)&&t?_t.updateTime(t):_t.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(!this.writtenDocs.has(e)&&t){if(t.isEqual(Se.forDeletedDoc()))throw new k(C.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _t.updateTime(t)}return _t.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},e.prototype.ensureCommitNotCalled=function(){_(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},e}(),Mr=function(e){return e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Offline=2]="Offline",e}({}),Lr=function(e){return e[e.RemoteStore=0]="RemoteStore",e[e.SharedClientState=1]="SharedClientState",e}({}),Fr=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=Mr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Mr.Unknown),_(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(de.OnlineStateTimeout,1e4,(function(){return e.onlineStateTimer=null,_(e.state===Mr.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast(Mr.Offline),Promise.resolve()})))},e.prototype.handleWatchStreamFailure=function(e){this.state===Mr.Online?(this.setAndBroadcast(Mr.Unknown),_(0===this.watchStreamFailures,"watchStreamFailures must be 0"),_(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast(Mr.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===Mr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(g(t),this.shouldWarnClientIsOffline=!1):v("OnlineStateTracker",t)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}(),Vr=function(e){return e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e}({});function Ur(e){switch(e){case C.OK:return m("Treated status OK as error");case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0;default:return m("Unknown status code: "+e)}}function qr(e){if(void 0===e)return g("GRPC error has no .code"),C.UNKNOWN;switch(e){case Vr.OK:return C.OK;case Vr.CANCELLED:return C.CANCELLED;case Vr.UNKNOWN:return C.UNKNOWN;case Vr.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case Vr.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case Vr.INTERNAL:return C.INTERNAL;case Vr.UNAVAILABLE:return C.UNAVAILABLE;case Vr.UNAUTHENTICATED:return C.UNAUTHENTICATED;case Vr.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case Vr.NOT_FOUND:return C.NOT_FOUND;case Vr.ALREADY_EXISTS:return C.ALREADY_EXISTS;case Vr.PERMISSION_DENIED:return C.PERMISSION_DENIED;case Vr.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case Vr.ABORTED:return C.ABORTED;case Vr.OUT_OF_RANGE:return C.OUT_OF_RANGE;case Vr.UNIMPLEMENTED:return C.UNIMPLEMENTED;case Vr.DATA_LOSS:return C.DATA_LOSS;default:return m("Unknown status code: "+e)}}function Br(e){if(void 0===e)return Vr.OK;switch(e){case C.OK:return Vr.OK;case C.CANCELLED:return Vr.CANCELLED;case C.UNKNOWN:return Vr.UNKNOWN;case C.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case C.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case C.INTERNAL:return Vr.INTERNAL;case C.UNAVAILABLE:return Vr.UNAVAILABLE;case C.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case C.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case C.NOT_FOUND:return Vr.NOT_FOUND;case C.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case C.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case C.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case C.ABORTED:return Vr.ABORTED;case C.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case C.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case C.DATA_LOSS:return Vr.DATA_LOSS;default:return m("Unknown status code: "+e)}}var jr=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||he.comparator(t.key,n.key)}:function(e,t){return he.comparator(e.key,t.key)},this.keyedMap=Le(),this.sortedSet=new Te(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),Wr=function(e){return e[e.Added=0]="Added",e[e.Removed=1]="Removed",e[e.Modified=2]="Modified",e[e.Metadata=3]="Metadata",e}({}),Hr=function(e){return e[e.Local=0]="Local",e[e.Synced=1]="Synced",e}({}),zr=function(){function e(){this.changeMap=new Te(he.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==Wr.Added&&n.type===Wr.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===Wr.Metadata&&n.type!==Wr.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===Wr.Modified&&n.type===Wr.Modified?this.changeMap=this.changeMap.insert(t,{type:Wr.Modified,doc:e.doc}):e.type===Wr.Modified&&n.type===Wr.Added?this.changeMap=this.changeMap.insert(t,{type:Wr.Added,doc:e.doc}):e.type===Wr.Removed&&n.type===Wr.Added?this.changeMap=this.changeMap.remove(t):e.type===Wr.Removed&&n.type===Wr.Modified?this.changeMap=this.changeMap.insert(t,{type:Wr.Removed,doc:n.doc}):e.type===Wr.Added&&n.type===Wr.Removed?this.changeMap=this.changeMap.insert(t,{type:Wr.Modified,doc:e.doc}):m("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal((function(t,n){e.push(n)})),e},e}(),Qr=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach((function(e){o.push({type:Wr.Added,doc:e})})),new e(t,n,jr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),Gr=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r,i=((r={})[t]=Kr.createSynthesizedTargetChangeForCurrentChange(t,n),r);return new e(Se.MIN,i,je(),Oe(),qe())},e}(),Kr=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(w(),n,qe(),qe(),qe())},e}(),Yr=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},Xr=function(e,t){this.targetId=e,this.existenceFilter=t},Jr=function(e){return e[e.NoChange=0]="NoChange",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Current=3]="Current",e[e.Reset=4]="Reset",e}({}),$r=function(e,t,n,r){void 0===n&&(n=w()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Zr=function(){function e(){this.pendingResponses=0,this.documentChanges=ni(),this._resumeToken=w(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),e.prototype.updateResumeToken=function(e){e.length>0&&(this._hasPendingChanges=!0,this._resumeToken=e)},e.prototype.toTargetChange=function(){var e=qe(),t=qe(),n=qe();return this.documentChanges.forEach((function(r,i){switch(i){case Wr.Added:e=e.add(r);break;case Wr.Modified:t=t.add(r);break;case Wr.Removed:n=n.add(r);break;default:m("Encountered invalid change type: "+i)}})),new Kr(this._resumeToken,this._current,e,t,n)},e.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=ni()},e.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},e.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},e.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},e.prototype.recordTargetResponse=function(){this.pendingResponses-=1},e.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},e}(),ei=function(){function e(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=Oe(),this.pendingDocumentTargetMapping=ti(),this.pendingTargetResets=new De(X)}return e.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof Ht?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof zt&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)this.removeDocumentFromTarget(r=o[i],e.key,e.newDoc)},e.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.ensureTargetState(n);switch(e.state){case Jr.NoChange:t.isActiveTarget(n)&&r.updateResumeToken(e.resumeToken);break;case Jr.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case Jr.Removed:r.recordTargetResponse(),r.isPending||t.removeTarget(n),_(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case Jr.Current:t.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case Jr.Reset:t.isActiveTarget(n)&&(t.resetTarget(n),r.updateResumeToken(e.resumeToken));break;default:m("Unknown target watch change state: "+e.state)}}))},e.prototype.forEachTarget=function(e,t){e.targetIds.length>0?e.targetIds.forEach(t):I(this.targetStates,t)},e.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,r=this.targetDataForActiveTarget(t);if(r){var i=r.target;if(i.isDocumentQuery())if(0===n){var o=new he(i.path);this.removeDocumentFromTarget(t,o,new zt(o,Se.forDeletedDoc()))}else _(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},e.prototype.createRemoteEvent=function(e){var t=this,n={};I(this.targetStates,(function(r,i){var o=t.targetDataForActiveTarget(r);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new he(o.target.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(r,a)||t.removeDocumentFromTarget(r,a,new zt(a,e))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}}));var r=qe();this.pendingDocumentTargetMapping.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.targetDataForActiveTarget(e);return!n||n.purpose===Sn.LimboResolution||(i=!1,!1)})),i&&(r=r.add(e))}));var i=new Gr(e,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Oe(),this.pendingDocumentTargetMapping=ti(),this.pendingTargetResets=new De(X),i},e.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var n=this.targetContainsDocument(e,t.key)?Wr.Modified:Wr.Added;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},e.prototype.removeDocumentFromTarget=function(e,t,n){if(this.isActiveTarget(e)){var r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,Wr.Removed):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}},e.prototype.removeTarget=function(e){delete this.targetStates[e]},e.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},e.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new Zr),this.targetStates[e]},e.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new De(X),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},e.prototype.isActiveTarget=function(e){var t=null!==this.targetDataForActiveTarget(e);return t||v("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.targetDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)},e.prototype.resetTarget=function(e){var t=this;_(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new Zr,this.metadataProvider.getRemoteKeysForTarget(e).forEach((function(n){t.removeDocumentFromTarget(e,n,null)}))},e.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},e}();function ti(){return new Te(he.comparator)}function ni(){return new Te(he.comparator)}var ri="RemoteStore",ii=function(){function e(e,t,n,r,i){var a=this;this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback((function(e){n.enqueueAndForget((function(){return o.__awaiter(a,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(v(ri,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.onlineStateTracker=new Fr(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.enableNetwork=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Mr.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.disableNetwork=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Mr.Offline),[2]}}))}))},e.prototype.disableNetworkInternal=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),this.writePipeline.length>0&&(v(ri,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}}))}))},e.prototype.shutdown=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return v(ri,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Mr.Unknown),[2]}}))}))},e.prototype.listen=function(e){S(this.listenTargets,e.targetId)||(this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e))},e.prototype.unlisten=function(e){_(S(this.listenTargets,e),"unlisten called on target no currently watched: "+e),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),N(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Mr.Unknown))},e.prototype.getTargetDataForTarget=function(e){return this.listenTargets[e]||null},e.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},e.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.startWatchStream=function(){_(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new ei(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!N(this.listenTargets)},e.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},e.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},e.prototype.onWatchStreamOpen=function(){return o.__awaiter(this,void 0,void 0,(function(){var e=this;return o.__generator(this,(function(t){return I(this.listenTargets,(function(t,n){e.sendWatchRequest(n)})),[2]}))}))},e.prototype.onWatchStreamClose=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return void 0===e&&_(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(Mr.Unknown),[2]}))}))},e.prototype.onWatchStreamChange=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Mr.Online),e instanceof $r&&e.state===Jr.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof Yr?this.watchChangeAggregator.handleDocumentChange(e):e instanceof Xr?this.watchChangeAggregator.handleExistenceFilter(e):(_(e instanceof $r,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(Se.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),t.compareTo(n)>=0?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.raiseWatchSnapshot=function(e){var t=this;_(!e.isEqual(Se.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(e);return I(n.targetChanges,(function(n,r){if(r.resumeToken.length>0){var i=t.listenTargets[n];i&&(t.listenTargets[n]=i.withResumeToken(r.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.listenTargets[e];if(n){t.listenTargets[e]=n.withResumeToken(w(),n.snapshotVersion),t.sendUnwatchRequest(e);var r=new Tn(n.target,e,Sn.ExistenceFilterMismatch,n.sequenceNumber);t.sendWatchRequest(r)}})),this.syncEngine.applyRemoteEvent(n)},e.prototype.handleTargetError=function(e){var t=this;_(!!e.cause,"Handling target error without a cause");var n=e.cause,r=Promise.resolve();return e.targetIds.forEach((function(e){r=r.then((function(){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(t){return S(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,n)]):[2]}))}))}))})),r},e.prototype.fillWritePipeline=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return this.canAddToWritePipeline()?[4,this.localStore.nextMutationBatch(this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1)]:[3,4];case 1:return null!==(e=t.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:t.sent(),t.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}}))}))},e.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},e.prototype.outstandingWrites=function(){return this.writePipeline.length},e.prototype.addToWritePipeline=function(e){_(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},e.prototype.startWriteStream=function(){_(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},e.prototype.onWriteStreamOpen=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this.writeStream.writeHandshake(),[2]}))}))},e.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then((function(){for(var t=0,n=e.writePipeline;t<n.length;t++)e.writeStream.writeMutations(n[t].mutations)})).catch(qn)},e.prototype.onMutationResult=function(e,t){var n=this;_(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=He.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then((function(){return n.fillWritePipeline()}))},e.prototype.onWriteStreamClose=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t=this;return o.__generator(this,(function(n){return void 0===e&&_(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&this.writePipeline.length>0?[2,(this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e)).then((function(){t.shouldStartWriteStream()&&t.startWriteStream()}))]:[2]}))}))},e.prototype.handleHandshakeError=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return Ur(e.code)?(v(ri,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=w(),[2,this.localStore.setLastStreamToken(w()).catch(qn)]):[2]}))}))},e.prototype.handleWriteError=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n=this;return o.__generator(this,(function(r){return Ur(i=e.code)&&i!==C.ABORTED?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then((function(){return n.fillWritePipeline()}))]):[2];var i}))}))},e.prototype.createTransaction=function(){return new Pr(this.datastore)},e.prototype.restartNetwork=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Mr.Unknown),[4,this.enableNetwork()];case 2:return e.sent(),[2]}}))}))},e.prototype.handleCredentialChange=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.canUseNetwork()?(v(ri,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.applyPrimaryState=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.isPrimary=e,e&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(Mr.Unknown),t.label=4;case 4:return[2]}}))}))},e}(),oi=function(){function e(e,t){if(x("GeoPoint",arguments,2),P("GeoPoint","number",1,e),P("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new k(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return X(this._lat,e._lat)||X(this._long,e._long)},e}(),ai=function(){function e(){}return e.prototype.applyToLocalView=function(e,t){return new Ft(t,e)},e.prototype.applyToRemoteDocument=function(e,t){return t},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e},e.instance=new e,e}(),si=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=ci(e),n=function(e){t.find((function(t){return t.isEqual(e)}))||t.push(e)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new jt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&J(t.elements,this.elements)},e}(),ui=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=ci(e),n=function(e){t=t.filter((function(t){return!t.isEqual(e)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new jt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&J(t.elements,this.elements)},e}(),li=function(){function e(e){this.operand=e}return e.prototype.applyToLocalView=function(e,t){var n=this.computeBaseValue(e);return n instanceof Ot&&this.operand instanceof Ot?new Ot(n.internalValue+this.operand.internalValue):new Pt(n.internalValue+this.operand.internalValue)},e.prototype.applyToRemoteDocument=function(e,t){return _(null!==t,"Didn't receive transformResult for NUMERIC_ADD transform"),t},e.prototype.computeBaseValue=function(e){return e instanceof xt?e:new Ot(0)},e.prototype.isEqual=function(t){return t instanceof e&&this.operand.isEqual(t.operand)},e}();function ci(e){return e instanceof jt?e.internalValue.slice():[]}var hi,fi,di=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}(),pi=((hi={})[ur.ASCENDING.name]="ASCENDING",hi[ur.DESCENDING.name]="DESCENDING",hi),vi=((fi={})[tr.LESS_THAN.name]="LESS_THAN",fi[tr.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",fi[tr.GREATER_THAN.name]="GREATER_THAN",fi[tr.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",fi[tr.EQUAL.name]="EQUAL",fi[tr.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",fi[tr.IN.name]="IN",fi[tr.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",fi),gi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yi(e,t){_(!Yn(e),t+" is missing")}function mi(e){return"number"==typeof e?e:"string"==typeof e?Number(e):m("can't parse "+e)}var _i=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?C.UNKNOWN:qr(e.code);return new k(t,e.message||"")},e.prototype.toInt32Value=function(e){return this.options.useProto3Json||Yn(e)?e:{value:e}},e.prototype.fromInt32Value=function(e){var t;return Yn(t="object"==typeof e?e.value:e)?null:t},e.prototype.toTimestamp=function(e){return this.options.useProto3Json?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);_(!!e,"Cannot deserialize null or undefined timestamp.");var t=mi(e.seconds||"0");return new Ee(t,e.nanos||0)},e.prototype.fromIso8601String=function(e){var t=0,n=gi.exec(e);if(_(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new Ee(o,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(_(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),te.fromBase64String(e)):(_(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),te.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return _(!!e,"Trying to deserialize version that isn't set"),Se.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=ue.fromString(e);return _(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return _(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),_(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new he(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?ue.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new ue(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new ue(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return _(e.length>4&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof Nt)return{nullValue:"NULL_VALUE"};if(e instanceof Dt)return{booleanValue:e.value()};if(e instanceof Ot)return{integerValue:""+e.value()};if(e instanceof Pt){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof Mt?{stringValue:e.value()}:e instanceof Bt?{mapValue:this.toMapValue(e)}:e instanceof jt?{arrayValue:this.toArrayValue(e)}:e instanceof Lt?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof qt?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof Vt?{bytesValue:this.toBytes(e.value())}:e instanceof Ut?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:m("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this;if("nullValue"in e)return Nt.INSTANCE;if("booleanValue"in e)return Dt.of(e.booleanValue);if("integerValue"in e)return new Ot(mi(e.integerValue));if("doubleValue"in e){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return Pt.NAN;if("Infinity"===e.doubleValue)return Pt.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return Pt.NEGATIVE_INFINITY}return new Pt(e.doubleValue)}if("stringValue"in e)return new Mt(e.stringValue);if("mapValue"in e)return this.fromFields(e.mapValue.fields||{});if("arrayValue"in e)return yi(e.arrayValue,"arrayValue"),new jt((e.arrayValue.values||[]).map((function(e){return t.fromValue(e)})));if("timestampValue"in e)return yi(e.timestampValue,"timestampValue"),new Lt(this.fromTimestamp(e.timestampValue));if("geoPointValue"in e)return yi(e.geoPointValue,"geoPointValue"),new qt(new oi(e.geoPointValue.latitude||0,e.geoPointValue.longitude||0));if("bytesValue"in e){yi(e.bytesValue,"bytesValue");var n=this.fromBlob(e.bytesValue);return new Vt(n)}if("referenceValue"in e){yi(e.referenceValue,"referenceValue");var r=this.fromResourceName(e.referenceValue),i=new oe(r.get(1),r.get(3)),o=new he(this.extractLocalPathFromResourceName(r));return new Ut(i,o)}return m("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return _(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e,t){var n=this,r=this.fromName(e.name),i=this.fromVersion(e.updateTime);return new Ht(r,i,{hasCommittedMutations:!!t},void 0,e,(function(e){return n.fromValue(e)}))},e.prototype.toFields=function(e){var t=this,n={};return e.forEach((function(e,r){n[e]=t.toValue(r)})),n},e.prototype.fromFields=function(e){var t=this,n=Bt.EMPTY;return A(e,(function(e,r){n=n.set(new ce([e]),t.fromValue(r))})),n},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach((function(e){n.push(t.toValue(e))})),{values:n}},e.prototype.fromFound=function(e){var t=this;_(!!e.found,"Tried to deserialize a found document from a missing document."),yi(e.found.name,"doc.found.name"),yi(e.found.updateTime,"doc.found.updateTime");var n=this.fromName(e.found.name),r=this.fromVersion(e.found.updateTime);return new Ht(n,r,{},void 0,e.found,(function(e){return t.fromValue(e)}))},e.prototype.fromMissing=function(e){_(!!e.missing,"Tried to deserialize a missing document from a found document."),_(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new zt(t,n)},e.prototype.fromMaybeDocument=function(e){return"found"in e?this.fromFound(e):"missing"in e?this.fromMissing(e):m("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case Jr.Added:return"ADD";case Jr.Current:return"CURRENT";case Jr.NoChange:return"NO_CHANGE";case Jr.Removed:return"REMOVE";case Jr.Reset:return"RESET";default:return m("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof Xr)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof Yr){var t;if(e.newDoc instanceof Ht)return{documentChange:{document:{name:this.toName((t=e.newDoc).key),fields:this.toFields(t.data()),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}};if(e.newDoc instanceof zt)return{documentDelete:{document:this.toName((t=e.newDoc).key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}};if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof $r){var n=void 0;return e.cause&&(n={code:Br(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return m("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,n=this;if("targetChange"in e){yi(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new $r(r,i,o,s||null)}else if("documentChange"in e){yi(e.documentChange,"documentChange");var u=e.documentChange;yi(u.document,"documentChange.name"),yi(u.document.name,"documentChange.document.name"),yi(u.document.updateTime,"documentChange.document.updateTime");var l=this.fromName(u.document.name),c=this.fromVersion(u.document.updateTime),h=new Ht(l,c,{},void 0,u.document,(function(e){return n.fromValue(e)}));t=new Yr(u.targetIds||[],u.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){yi(e.documentDelete,"documentDelete");var f=e.documentDelete;yi(f.document,"documentDelete.document"),l=this.fromName(f.document),c=f.readTime?this.fromVersion(f.readTime):Se.forDeletedDoc(),h=new zt(l,c),t=new Yr([],f.removedTargetIds||[],h.key,h)}else if("documentRemove"in e){yi(e.documentRemove,"documentRemove");var d=e.documentRemove;yi(d.document,"documentRemove"),l=this.fromName(d.document),t=new Yr([],d.removedTargetIds||[],l,null)}else{if(!("filter"in e))return m("Unknown change type "+JSON.stringify(e));yi(e.filter,"filter");var p=e.filter;yi(p.targetId,"filter.targetId");var v=new di(p.count||0);t=new Xr(p.targetId,v)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?Jr.NoChange:"ADD"===e?Jr.Added:"REMOVE"===e?Jr.Removed:"CURRENT"===e?Jr.Current:"RESET"===e?Jr.Reset:m("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!("targetChange"in e))return Se.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?Se.MIN:t.readTime?this.fromVersion(t.readTime):Se.MIN},e.prototype.toMutation=function(e){var t,n=this;if(e instanceof wt)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof Et)t={delete:this.toName(e.key)};else if(e instanceof Ct)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else{if(!(e instanceof kt))return m("Unknown mutation type "+e.type);t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map((function(e){return n.toFieldTransform(e)}))}}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):_t.NONE;if(e.update){yi(e.update.name,"name");var r=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new Ct(r,i,o,n)}return new wt(r,i,n)}if(e.delete)return r=this.fromName(e.delete),new Et(r,n);if(e.transform){r=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map((function(e){return t.fromFieldTransform(e)}));return _(!0===n.exists,'Transforms only support precondition "exists == true"'),new kt(r,a)}return m("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return _(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?_t.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?_t.exists(e.exists):_t.NONE},e.prototype.fromWriteResult=function(e,t){var n=this,r=this.fromVersion(e.updateTime?e.updateTime:t);r.isEqual(Se.MIN)&&(r=this.fromVersion(t));var i=null;return e.transformResults&&e.transformResults.length>0&&(i=e.transformResults.map((function(e){return n.fromValue(e)}))),new yt(r,i)},e.prototype.fromWriteResults=function(e,t){var n=this;return e&&e.length>0?(_(void 0!==t,"Received a write result without a commit time"),e.map((function(e){return n.fromWriteResult(e,t)}))):[]},e.prototype.toFieldTransform=function(e){var t=this,n=e.transform;if(n instanceof ai)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof si)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof ui)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map((function(e){return t.toValue(e)}))}};if(n instanceof li)return{fieldPath:e.field.canonicalString(),increment:this.toValue(n.operand)};throw m("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,n=null;if("setToServerValue"in e)_("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),n=ai.instance;else if("appendMissingElements"in e)n=new si((e.appendMissingElements.values||[]).map((function(e){return t.fromValue(e)})));else if("removeAllFromArray"in e)n=new ui((e.removeAllFromArray.values||[]).map((function(e){return t.fromValue(e)})));else if("increment"in e){var r=this.fromValue(e.increment);_(r instanceof xt,"NUMERIC_ADD transform requires a NumberValue"),n=new li(r)}else m("Unknown transform proto: "+JSON.stringify(e));var i=ce.fromServerFormat(e.fieldPath);return new gt(i,n)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;return _(1===t,"DocumentsTarget contained other than 1 document: "+t),Zn.atPath(this.fromQueryPath(e.documents[0])).toTarget()},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(_(n.length%2==0,"Collection Group queries should be within a document path or root."),t.parent=this.toQueryPath(n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(_(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var l=null;n.startAt&&(l=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new Zn(t,i,s,a,u,$n.First,l,c).toTarget()},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case Sn.Listen:return null;case Sn.ExistenceFilterMismatch:return"existence-filter-mismatch";case Sn.LimboResolution:return"limbo-document";default:return m("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,n=e.target;return(t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=e.targetId,e.resumeToken.length>0&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map((function(e){return e instanceof nr?t.toUnaryOrFieldFilter(e):m("Unrecognized filter: "+JSON.stringify(e))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromFieldFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t.fromFilter(e)})).reduce((function(e,t){return e.concat(t)})):m("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map((function(e){return t.toPropertyOrder(e)}))},e.prototype.fromOrder=function(e){var t=this;return e.map((function(e){return t.fromPropertyOrder(e)}))},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map((function(e){return t.toValue(e)}))}},e.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map((function(e){return t.fromValue(e)}));return new lr(r,n)},e.prototype.toDirection=function(e){return pi[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return ur.ASCENDING;case"DESCENDING":return ur.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return vi[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return tr.EQUAL;case"GREATER_THAN":return tr.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return tr.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return tr.LESS_THAN;case"LESS_THAN_OR_EQUAL":return tr.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return tr.ARRAY_CONTAINS;case"IN":return tr.IN;case"ARRAY_CONTAINS_ANY":return tr.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return m("Unspecified operator");default:return m("Unknown operator")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return ce.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new cr(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.fromFieldFilter=function(e){return nr.create(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryOrFieldFilter=function(e){if(e.op===tr.EQUAL){if(e.value.isEqual(Pt.NAN))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}};if(e.value.isEqual(Nt.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return nr.create(t,tr.EQUAL,Pt.NAN);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return nr.create(n,tr.EQUAL,Nt.INSTANCE);case"OPERATOR_UNSPECIFIED":return m("Unspecified filter");default:return m("Unknown filter")}},e.prototype.toDocumentMask=function(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map((function(e){return ce.fromServerFormat(e)}));return vt.fromArray(t)},e}(),bi=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},wi=function(){function e(e){this.syncEngine=e,this.queries=new Gt((function(e){return e.canonicalId()})),this.onlineState=Mr.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return e.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new bi,this.queries.set(t,r)),r.listeners.push(e),_(!e.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap&&e.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent(),n?this.syncEngine.listen(t).then((function(e){return r.targetId=e,e})):Promise.resolve(r.targetId)},e.prototype.unlisten=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i;return o.__generator(this,(function(o){return n=!1,(r=this.queries.get(t=e.query))&&(i=r.listeners.indexOf(e))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]}))}))},e.prototype.onWatchChange=function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var i=r[n],o=this.queries.get(i.query);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(i)&&(t=!0);o.viewSnap=i}}t&&this.raiseSnapshotsInSyncEvent()},e.prototype.onWatchError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(t);this.queries.delete(e)},e.prototype.onOnlineStateChange=function(e){this.onlineState=e;var t=!1;this.queries.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].applyOnlineStateChange(e)&&(t=!0)})),t&&this.raiseSnapshotsInSyncEvent()},e.prototype.addSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.add(e),e.next()},e.prototype.removeSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.delete(e)},e.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach((function(e){e.next()}))},e}(),Ci=function(){function e(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=Mr.Unknown,this.options=n||{}}return e.prototype.onViewSnapshot=function(e){if(_(e.docChanges.length>0||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];i.type!==Wr.Metadata&&t.push(i)}e=new Qr(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},e.prototype.onError=function(e){this.queryObserver.error(e)},e.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},e.prototype.shouldRaiseInitialEvent=function(e,t){return _(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache||(this.options.waitForSyncWhenOnline&&t!==Mr.Offline?(_(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===Mr.Offline)},e.prototype.shouldRaiseEvent=function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges},e.prototype.raiseInitialEvent=function(e){_(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=Qr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},e}(),ki=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}return e.fromSnapshot=function(t,n){for(var r=qe(),i=qe(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Wr.Added:r=r.add(s.doc.key);break;case Wr.Removed:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),Ei=function(e){this.key=e},Si=function(e){this.key=e},Ti=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=qe(),this.mutatedKeys=qe(),this.documentSet=new jr(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var n=this,r=t?t.changeSet:new zr,i=t?t.documentSet:this.documentSet,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,l=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var c=i.get(e),h=t instanceof Ht?t:null;h&&(_(e.isEqual(h.key),"Mismatching keys found in document changes: "+e+" != "+h.key),h=n.query.matches(h)?h:null);var f=!!c&&n.mutatedKeys.has(c.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;c&&h?c.data().isEqual(h.data())?f!==d&&(r.track({type:Wr.Metadata,doc:h}),p=!0):n.shouldWaitForSyncedDocument(c,h)||(r.track({type:Wr.Modified,doc:h}),p=!0,(u&&n.query.docComparator(h,u)>0||l&&n.query.docComparator(h,l)<0)&&(s=!0)):!c&&h?(r.track({type:Wr.Added,doc:h}),p=!0):c&&!h&&(r.track({type:Wr.Removed,doc:c}),p=!0,(u||l)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))})),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var c=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Wr.Removed,doc:c})}return _(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},e.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this;_(!e.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var o=e.changeSet.getChanges();o.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case Wr.Added:return 1;case Wr.Modified:case Wr.Metadata:return 2;case Wr.Removed:return 0;default:return m("Unknown ChangeType: "+e)}};return n(e)-n(t)}(e.type,t.type)||r.query.docComparator(e.doc,t.doc)})),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Hr.Synced:Hr.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Qr(this.query,e.documentSet,i,o,e.mutatedKeys,s===Hr.Local,u,!1),limboChanges:a}:{limboChanges:a}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===Mr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new zr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},e.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.add(e)})),e.modifiedDocuments.forEach((function(e){return _(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")})),e.removedDocuments.forEach((function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)})),this.current=e.current)},e.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=qe(),this.documentSet.forEach((function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))}));var n=[];return t.forEach((function(t){e.limboDocuments.has(t)||n.push(new Si(t))})),this.limboDocuments.forEach((function(e){t.has(e)||n.push(new Ei(e))})),n},e.prototype.synchronizeWithPersistedState=function(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=qe();var t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)},e.prototype.computeInitialSnapshot=function(){return Qr.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Hr.Local)},e}(),Ii=5,Ai=function(){function e(e,t,n,r){this.asyncQueue=e,this.remoteStore=t,this.updateFunction=n,this.deferred=r,this.retries=Ii,this.backoff=new Ar(this.asyncQueue,de.RetryTransaction)}return e.prototype.run=function(){this.runWithBackOff()},e.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun((function(){return o.__awaiter(e,void 0,void 0,(function(){var e,t,n=this;return o.__generator(this,(function(r){return e=this.remoteStore.createTransaction(),(t=this.tryRunUpdateFunction(e))&&t.then((function(t){n.asyncQueue.enqueueAndForget((function(){return e.commit().then((function(){n.deferred.resolve(t)})).catch((function(e){n.handleTransactionError(e)}))}))})).catch((function(e){n.handleTransactionError(e)})),[2]}))}))}))},e.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!Yn(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(g){return this.deferred.reject(g),null}},e.prototype.handleTransactionError=function(e){var t=this;this.retries>0&&this.isRetryableTransactionError(e)?(this.retries-=1,this.asyncQueue.enqueueAndForget((function(){return t.runWithBackOff(),Promise.resolve()}))):this.deferred.reject(e)},e.prototype.isRetryableTransactionError=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!Ur(t)}return!1},e}(),Ni=function(e,t,n){this.query=e,this.targetId=t,this.view=n},Di=function(e){this.key=e,this.receivedDocument=!1},xi=function(){function e(e,t,n,r){this.localStore=e,this.remoteStore=t,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Gt((function(e){return e.canonicalId()})),this.queriesByTarget={},this.limboTargetsByKey=new Te(he.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new vr,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=lt.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Mr.Unknown}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){_(null!==e,"SyncEngine listener cannot be null"),_(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},e.prototype.listen=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(e))?(this.sharedClientState.addLocalQueryTarget(t=r.targetId),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(e.toTarget())];case 2:return i=o.sent(),a=this.sharedClientState.addLocalQueryTarget(i.targetId),[4,this.initializeViewAndComputeSnapshot(e,t=i.targetId,"current"===a)];case 3:n=o.sent(),this.isPrimary&&this.remoteStore.listen(i),o.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,t]}}))}))},e.prototype.initializeViewAndComputeSnapshot=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,u,l;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return r=o.sent(),i=new Ti(e,r.remoteKeys),a=i.computeDocChanges(r.documents),s=Kr.createSynthesizedTargetChangeForCurrentChange(t,n&&this.onlineState!==Mr.Offline),_(0===(u=i.applyChanges(a,!0===this.isPrimary,s)).limboChanges.length,"View returned limbo docs before target ack from the server."),_(!!u.snapshot,"applyChanges for new view should always return a snapshot"),l=new Ni(e,t,i),this.queryViewsByQuery.set(e,l),this.queriesByTarget[t]||(this.queriesByTarget[t]=[]),this.queriesByTarget[t].push(e),[2,u.snapshot]}}))}))},e.prototype.synchronizeViewAndComputeSnapshot=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(e.query,!0)];case 1:return t=r.sent(),n=e.view.synchronizeWithPersistedState(t),this.isPrimary&&this.updateTrackedLimbos(e.targetId,n.limboChanges),[2,n]}}))}))},e.prototype.unlisten=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r=this;return o.__generator(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),_(!!(t=this.queryViewsByQuery.get(e)),"Trying to unlisten on query not found:"+e),(n=this.queriesByTarget[t.targetId]).length>1?(this.queriesByTarget[t.targetId]=n.filter((function(t){return!t.isEqual(e)})),this.queryViewsByQuery.delete(e),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.sharedClientState.isActiveQueryTarget(t.targetId)?[3,2]:[4,this.localStore.releaseTarget(t.targetId,!1).then((function(){r.sharedClientState.clearQueryState(t.targetId),r.remoteStore.unlisten(t.targetId),r.removeAndCleanupTarget(t.targetId)})).catch(qn)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(t.targetId),[4,this.localStore.releaseTarget(t.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},e.prototype.write=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(e)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,t),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}}))}))},e.prototype.runTransaction=function(e,t,n){new Ai(e,this.remoteStore,t,n).run()},e.prototype.applyRemoteEvent=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n=this;return o.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(e)];case 2:return t=r.sent(),A(e.targetChanges,(function(e,t){var r=n.limboResolutionsByTarget[Number(e)];r&&(_(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),t.addedDocuments.size>0?r.receivedDocument=!0:t.modifiedDocuments.size>0?_(r.receivedDocument,"Received change for limbo target document without add."):t.removedDocuments.size>0&&(_(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))})),[4,this.emitNewSnapsAndNotifyLocalStore(t,e)];case 3:return r.sent(),[3,6];case 4:return[4,qn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===Lr.RemoteStore||!this.isPrimary&&t===Lr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach((function(t,r){var i=r.view.applyOnlineStateChange(e);_(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(n),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},e.prototype.rejectListen=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a,s,u=this;return o.__generator(this,(function(o){switch(o.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),(r=(n=this.limboResolutionsByTarget[e])&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[e],i=(i=new Te(he.comparator)).insert(r,new zt(r,Se.forDeletedDoc())),a=qe().add(r),s=new Gr(Se.MIN,{},new De(X),i,a),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return[4,this.localStore.releaseTarget(e,!1).then((function(){return u.removeAndCleanupTarget(e,t)})).catch(qn)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.applyBatchState=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function(){var r;return o.__generator(this,(function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(r=i.sent())?(v("SyncEngine","Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,n||null),this.localStore.removeCachedMutationBatchMetadata(e)):m("Unknown batchState: "+t),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}}))}))},e.prototype.applySuccessfulWrite=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t=e.batch.batchId,null),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,qn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.rejectFailedWrite=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"rejected",t),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,qn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.registerPendingWritesCallback=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||v("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(t=r.sent())?(e.resolve(),[2]):((n=this.pendingWritesCallbacks.get(t)||[]).push(e),this.pendingWritesCallbacks.set(t,n),[2])}}))}))},e.prototype.triggerPendingWritesCallbacks=function(e){(this.pendingWritesCallbacks.get(e)||[]).forEach((function(e){e.resolve()})),this.pendingWritesCallbacks.delete(e)},e.prototype.rejectOutstandingPendingWritesCallbacks=function(e){this.pendingWritesCallbacks.forEach((function(t){t.forEach((function(t){t.reject(new k(C.CANCELLED,e))}))})),this.pendingWritesCallbacks.clear()},e.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Te(X)),n=n.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},e.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(_(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},e.prototype.removeAndCleanupTarget=function(e,t){var n=this;void 0===t&&(t=null),this.sharedClientState.removeLocalQueryTarget(e),_(this.queriesByTarget[e]&&0!==this.queriesByTarget[e].length,"There are no queries mapped to target id "+e);for(var r=0,i=this.queriesByTarget[e];r<i.length;r++){var o=i[r];this.queryViewsByQuery.delete(o),t&&this.syncEngineListener.onWatchError(o,t)}if(delete this.queriesByTarget[e],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(e);this.limboDocumentRefs.removeReferencesForId(e),a.forEach((function(e){n.limboDocumentRefs.containsKey(e)||n.removeLimboTarget(e)}))}},e.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},e.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];i instanceof Ei?(this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i)):i instanceof Si?(v("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):m("Unknown limbo change: "+JSON.stringify(i))}},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){v("SyncEngine","New document in limbo: "+t);var n=this.limboTargetIdGenerator.next(),r=Zn.atPath(t.path);this.limboResolutionsByTarget[n]=new Di(t),this.remoteStore.listen(new Tn(r.toTarget(),n,Sn.LimboResolution,ae.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a=this;return o.__generator(this,(function(o){switch(o.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach((function(o,s){i.push(Promise.resolve().then((function(){var t=s.view.computeDocChanges(e);return t.needsRefill?a.localStore.executeQuery(s.query,!1).then((function(e){return s.view.computeDocChanges(e.documents,t)})):t})).then((function(e){var i=s.view.applyChanges(e,!0===a.isPrimary,t&&t.targetChanges[s.targetId]);if(a.updateTrackedLimbos(s.targetId,i.limboChanges),i.snapshot){a.isPrimary&&a.sharedClientState.updateQueryState(s.targetId,i.snapshot.fromCache?"not-current":"current"),n.push(i.snapshot);var o=ki.fromSnapshot(s.targetId,i.snapshot);r.push(o)}})))})),[4,Promise.all(i)];case 1:return o.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return o.sent(),[2]}}))}))},e.prototype.assertSubscribed=function(e){_(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleCredentialChange=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(e)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}}))}))},e.prototype.applyPrimaryState=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,a,s,u=this;return o.__generator(this,(function(o){switch(o.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return o.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(n=o.sent(),r=0,i=n;r<i.length;r++)this.remoteStore.listen(i[r]);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),I(this.queriesByTarget,(function(e,t){u.sharedClientState.isLocalQueryTarget(e)?a.push(e):s=s.then((function(){return u.removeAndCleanupTarget(e),u.localStore.releaseTarget(e,!0)})),u.remoteStore.unlisten(e)})),[4,s]);case 4:return o.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return o.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:o.sent(),o.label=7;case 7:return[2]}}))}))},e.prototype.resetLimboDocuments=function(){var e=this;I(this.limboResolutionsByTarget,(function(t){e.remoteStore.unlisten(t)})),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Te(he.comparator)},e.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,a,s,u,l,c,h,f,d,p;return o.__generator(this,(function(o){switch(o.label){case 0:t=[],n=[],r=0,i=e,o.label=1;case 1:return r<i.length?(s=void 0,(u=this.queriesByTarget[a=i[r]])&&0!==u.length?[4,this.localStore.releaseTarget(a,!0)]:[3,8]):[3,14];case 2:return o.sent(),[4,this.localStore.allocateTarget(u[0].toTarget())];case 3:s=o.sent(),l=0,c=u,o.label=4;case 4:return l<c.length?(_(!!(f=this.queryViewsByQuery.get(h=c[l])),"No query view found for "+h),[4,this.synchronizeViewAndComputeSnapshot(f)]):[3,7];case 5:(d=o.sent()).snapshot&&n.push(d.snapshot),o.label=6;case 6:return l++,[3,4];case 7:return[3,12];case 8:return _(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(a)];case 9:return _(!!(p=o.sent()),"Target for id "+a+" not found"),[4,this.localStore.allocateTarget(p)];case 10:return s=o.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(p),a,!1)];case 11:o.sent(),o.label=12;case 12:t.push(s),o.label=13;case 13:return r++,[3,1];case 14:return this.syncEngineListener.onWatchChange(n),[2,t]}}))}))},e.prototype.synthesizeTargetToQuery=function(e){return new Zn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,$n.First,e.startAt,e.endAt)},e.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},e.prototype.applyTargetState=function(e,t,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return v("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[e])return[3,7];switch(t){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=Gr.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(e,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(e,n),[3,7];case 6:m("Unexpected target state: "+t),o.label=7;case 7:return[2]}}))}))},e.prototype.applyActiveTargetsChange=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a,s,u,l,c,h,f=this;return o.__generator(this,(function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=e,d.label=1;case 1:return n<r.length?(_(!this.queriesByTarget[h=r[n]],"Trying to add an already active target"),[4,this.localStore.getTarget(h)]):[3,6];case 2:return _(!!(i=d.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return a=d.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),a.targetId,!1)];case 4:d.sent(),this.remoteStore.listen(a),d.label=5;case 5:return n++,[3,1];case 6:s=function(e){return o.__generator(this,(function(t){switch(t.label){case 0:return u.queriesByTarget[e]?[4,u.localStore.releaseTarget(e,!1).then((function(){f.remoteStore.unlisten(e),f.removeAndCleanupTarget(e)})).catch(qn)]:[2,"continue"];case 1:return t.sent(),[2]}}))},u=this,l=0,c=t,d.label=7;case 7:return l<c.length?[5,s(h=c[l])]:[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))},e.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},e.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},e.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];if(t&&t.receivedDocument)return qe().add(t.key);var n=qe(),r=this.queriesByTarget[e];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);_(!!s,"No query view found for "+a),n=n.unionWith(s.view.syncedDocuments)}return n},e}(),Ri=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),Oi="firestore_clients";function Pi(e,t){return _(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),Oi+"_"+e+"_"+t}var Mi="firestore_mutations";function Li(e,t,n){var r=Mi+"_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}var Fi="firestore_targets";function Vi(e,t){return Fi+"_"+e+"_"+t}var Ui="firestore_online_state",qi="firestore_sequence_number",Bi="SharedClientState",ji=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r,_(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new k(i.error.code,i.error.message)),o?new e(t,n,i.state,a):(g(Bi,"Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Wi=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n,_(void 0!==n==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new k(r.error.code,r.error.message)),i?new e(t,r.state,o):(g(Bi,"Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Hi=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.fromWebStorageEntry=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=je(),a=0;i&&a<r.activeTargetIds.length;++a)i=Xn(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(g(Bi,"Failed to parse client data for instance '"+t+"': "+n),null)},e}(),zi=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.fromWebStorageEntry=function(t){var n=JSON.parse(t);return"object"==typeof n&&n.onlineState in Mr&&"string"==typeof n.clientId?new e(n.clientId,Mr[n.onlineState]):(g(Bi,"Failed to parse online state: "+t),null)},e}(),Qi=function(){function e(){this.activeTargetIds=je()}return e.prototype.addQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),Gi=function(){function e(t,n,r,i,o){if(this.queue=t,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!e.isAvailable(this.platform))throw new k(C.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=Pi(this.persistenceKey,this.localClientId),this.sequenceNumberKey=function(e){return qi+"_"+e}(this.persistenceKey),this.activeClients[this.localClientId]=new Qi,this.clientStateKeyRe=new RegExp("^"+Oi+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Mi+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+Fi+"_"+a+"_(\\d+)$"),this.onlineStateKey=function(e){return Ui+"_"+e}(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}return e.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},e.prototype.start=function(){return o.__awaiter(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,u,l,c,h=this;return o.__generator(this,(function(o){switch(o.label){case 0:return _(!this.started,"WebStorageSharedClientState already started"),_(null!==this.syncEngine,"syncEngine property must be set before calling start()"),_(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=o.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(Pi(this.persistenceKey,r)))&&(a=Hi.fromWebStorageEntry(r,i))&&(this.activeClients[a.clientId]=a);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),l=0,c=this.earlyEvents;l<c.length;l++)this.handleWebStorageEvent(c[l]);return this.earlyEvents=[],this.platform.window.addEventListener("unload",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},e.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){var e=je();return A(this.activeClients,(function(t,n){e=e.unionWith(n.activeTargetIds)})),e},e.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},e.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Vi(this.persistenceKey,e));if(n){var r=Wi.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},e.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},e.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(Vi(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach((function(e){r.removeMutationState(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))},e.prototype.setOnlineState=function(e){this.persistOnlineState(e)},e.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return v(Bi,"READ",e,t),t},e.prototype.setItem=function(e,t){v(Bi,"SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){v(Bi,"REMOVE",e),this.storage.removeItem(e)},e.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(v(Bi,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void g("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget((function(){return o.__awaiter(t,void 0,void 0,(function(){var t,n,r,i,a,s;return o.__generator(this,(function(o){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return n=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(n,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(r=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(i=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(a=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(a)]}else e.key===this.sequenceNumberKey&&(_(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(e){var t=ae.INVALID;if(null!=e)try{var n=JSON.parse(e);_("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(r){g(Bi,"Failed to read sequence number from WebStorage",r)}return t}(e.newValue))!==ae.INVALID&&this.sequenceNumberHandler(s));return[2]}))}))}))}},Object.defineProperty(e.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),e.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},e.prototype.persistMutationState=function(e,t,n){var r=new ji(this.currentUser,e,t,n),i=Li(this.persistenceKey,this.currentUser,e);this.setItem(i,r.toWebStorageJSON())},e.prototype.removeMutationState=function(e){var t=Li(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.persistOnlineState=function(e){this.storage.setItem(this.onlineStateKey,JSON.stringify({clientId:this.localClientId,onlineState:Mr[e]}))},e.prototype.persistQueryTargetState=function(e,t,n){var r=Vi(this.persistenceKey,e),i=new Wi(e,t,n);this.setItem(r,i.toWebStorageJSON())},e.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},e.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return _(null!==n,"Cannot parse client state key '"+e+"'"),Hi.fromWebStorageEntry(n,t)},e.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);_(null!==n,"Cannot parse mutation batch key '"+e+"'");var r=Number(n[1]);return ji.fromWebStorageEntry(new Ri(void 0!==n[2]?n[2]:null),r,t)},e.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);_(null!==n,"Cannot parse query target key '"+e+"'");var r=Number(n[1]);return Wi.fromWebStorageEntry(r,t)},e.prototype.fromWebStorageOnlineState=function(e){return zi.fromWebStorageEntry(e)},e.prototype.handleMutationBatchEvent=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return e.user.uid!==this.currentUser.uid?(v(Bi,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]}))}))},e.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},e.prototype.handleClientStateEvent=function(e,t){var n=this,r=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var i=this.getAllActiveQueryTargets(),a=[],s=[];return i.forEach((function(e){return o.__awaiter(n,void 0,void 0,(function(){return o.__generator(this,(function(t){return r.has(e)||a.push(e),[2]}))}))})),r.forEach((function(e){return o.__awaiter(n,void 0,void 0,(function(){return o.__generator(this,(function(t){return i.has(e)||s.push(e),[2]}))}))})),this.syncEngine.applyActiveTargetsChange(a,s)},e.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},e}(),Ki=function(){function e(){this.localState=new Qi,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},e.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.queryState[e]},e.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.start=function(){return this.localState=new Qi,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e}(),Yi=function(){function e(e,t){this.cacheSizeBytes=e,this.synchronizeTabs=t}return e.prototype.lruParams=function(){return xn.withCacheSize(this.cacheSizeBytes)},e}(),Xi=function(){},Ji=function(){function e(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r,this.clientId=Y.newId()}return e.prototype.start=function(e){var t=this;this.verifyNotTerminated();var n=new fe,r=new fe,i=!1;return this.credentials.setChangeListener((function(o){i?t.asyncQueue.enqueueAndForget((function(){return t.handleCredentialChange(o)})):(i=!0,t.initializePersistence(e,r,o).then((function(e){return t.initializeRest(o,e)})).then(n.resolve,n.reject))})),this.asyncQueue.enqueueAndForget((function(){return n.promise})),r.promise},e.prototype.enableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.enableNetwork()}))},e.prototype.initializePersistence=function(e,t,n){var r=this;return e instanceof Yi?this.startIndexedDbPersistence(n,e).then((function(e){return t.resolve(),e})).catch((function(e){if(t.reject(e),!r.canFallback(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.startMemoryPersistence()})):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e instanceof k?e.code===C.FAILED_PRECONDITION||e.code===C.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new k(C.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.startIndexedDbPersistence=function(e,t){var n=this,r=Un.buildStoragePrefix(this.databaseInfo),i=new _i(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then((function(){return o.__awaiter(n,void 0,void 0,(function(){var n,a;return o.__generator(this,(function(o){switch(o.label){case 0:if(t.synchronizeTabs&&!Gi.isAvailable(this.platform))throw new k(C.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=t.lruParams(),this.sharedClientState=t.synchronizeTabs?new Gi(this.asyncQueue,this.platform,r,this.clientId,e):new Ki,[4,Un.createIndexedDbPersistence({allowTabSynchronization:t.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return a=o.sent(),this.persistence=a,[2,a.referenceDelegate.garbageCollector]}}))}))}))},e.prototype.startMemoryPersistence=function(){return this.persistence=wr.createEagerPersistence(this.clientId),this.sharedClientState=new Ki,Promise.resolve(null)},e.prototype.initializeRest=function(e,t){var n=this;return v("FirestoreClient","Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then((function(r){return o.__awaiter(n,void 0,void 0,(function(){var n,i,a,s,u,l=this;return o.__generator(this,(function(c){switch(c.label){case 0:return n=new dr,this.localStore=new yr(this.persistence,n,e),[4,this.localStore.start()];case 1:return c.sent(),t&&(this.lruScheduler=new Rn(t,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),a=this.platform.newSerializer(this.databaseInfo.databaseId),s=new Or(this.asyncQueue,r,this.credentials,a),u=function(e){return l.syncEngine.applyOnlineStateChange(e,Lr.SharedClientState)},this.remoteStore=new ii(this.localStore,s,this.asyncQueue,(function(e){return l.syncEngine.applyOnlineStateChange(e,Lr.RemoteStore)}),i),this.syncEngine=new xi(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new wi(this.syncEngine),[4,this.sharedClientState.start()];case 2:return c.sent(),[4,this.remoteStore.start()];case 3:return c.sent(),[4,this.persistence.setPrimaryStateListener((function(e){return o.__awaiter(l,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this.syncEngine.applyPrimaryState(e)];case 1:return t.sent(),this.lruScheduler&&(e&&!this.lruScheduler.started?this.lruScheduler.start():e||this.lruScheduler.stop()),[2]}}))}))}))];case 4:return c.sent(),[4,this.persistence.setDatabaseDeletedListener((function(){return o.__awaiter(l,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}}))}))}))];case 5:return c.sent(),[2]}}))}))}))},e.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),v("FirestoreClient","Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return e.syncEngine.disableNetwork()}))},e.prototype.terminate=function(){var e=this;return this.asyncQueue.enqueueAndInitiateShutdown((function(){return o.__awaiter(e,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown()];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}}))}))}))},e.prototype.waitForPendingWrites=function(){var e=this;this.verifyNotTerminated();var t=new fe;return this.asyncQueue.enqueueAndForget((function(){return e.syncEngine.registerPendingWritesCallback(t)})),t.promise},e.prototype.listen=function(e,t,n){var r=this;this.verifyNotTerminated();var i=new Ci(e,t,n);return this.asyncQueue.enqueueAndForget((function(){return r.eventMgr.listen(i)})),i},e.prototype.unlisten=function(e){var t=this;this.clientTerminated||this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.unlisten(e)}))},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return t.localStore.readDocument(e)})).then((function(e){if(e instanceof Ht)return e;if(e instanceof zt)return null;throw new k(C.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},e.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue((function(){return o.__awaiter(t,void 0,void 0,(function(){var t,n,r;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return t=i.sent(),n=new Ti(e,t.remoteKeys),r=n.computeDocChanges(t.documents),[2,n.applyChanges(r,!1).snapshot]}}))}))}))},e.prototype.write=function(e){var t=this;this.verifyNotTerminated();var n=new fe;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.write(e,n)})),n.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.addSnapshotsInSyncListener=function(e){var t=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget((function(){return t.eventMgr.addSnapshotsInSyncListener(e),Promise.resolve()}))},e.prototype.removeSnapshotsInSyncListener=function(e){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(e)},Object.defineProperty(e.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.transaction=function(e){var t=this;this.verifyNotTerminated();var n=new fe;return this.asyncQueue.enqueueAndForget((function(){return t.syncEngine.runTransaction(t.asyncQueue,e,n),Promise.resolve()})),n.promise},e}(),$i=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},e}(),Zi=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!function(e,t,n,r){if(!(t instanceof Array)||t.length<1)throw new k(C.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+K(1,"element")+".")}(0,e);for(var n=0;n<e.length;++n)if(P("FieldPath","string",n,e[n]),0===e[n].length)throw new k(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ce(e)}return e.documentId=function(){return e._DOCUMENT_ID},e.prototype.isEqual=function(t){if(!(t instanceof e))throw z("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},e._DOCUMENT_ID=new e(ce.keyField().canonicalString()),e}(),eo=new RegExp("[~\\*/\\[\\]]"),to=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},no=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){_(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(Ri.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){_(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},e}(),ro=function(){function e(e){var t=this;this.tokenListener=null,this.currentUser=Ri.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),e.get().then((function(e){t.auth=e,t.tokenListener&&t.auth.addAuthTokenListener(t.tokenListener)}),(function(){})))}return e.prototype.getToken=function(){var e=this;_(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(e.tokenCounter!==t)throw new k(C.ABORTED,"getToken aborted due to token change.");return n?(_("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new to(n.accessToken,e.currentUser)):null})):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){_(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},e.prototype.removeChangeListener=function(){_(null!=this.tokenListener,"removeChangeListener() called twice"),_(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},e.prototype.getUser=function(){var e=this.auth&&this.auth.getUid();return _(null===e||"string"==typeof e,"Received invalid UID: "+e),new Ri(e)},e}(),io=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=Ri.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!0,configurable:!0}),e}(),oo=function(){function e(e,t){this.gapi=e,this.sessionIndex=t}return e.prototype.getToken=function(){return Promise.resolve(new io(this.gapi,this.sessionIndex))},e.prototype.setChangeListener=function(e){e(Ri.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function ao(e){if(!e)return new no;switch(e.type){case"gapi":var t=e.client;return _(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new oo(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new k(C.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function so(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}var uo=function(){function e(e){this._methodName=e}return e.delete=function(){return D("FieldValue.delete",arguments),lo.instance},e.serverTimestamp=function(){return D("FieldValue.serverTimestamp",arguments),co.instance},e.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return R("FieldValue.arrayUnion",arguments,1),new ho(e)},e.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return R("FieldValue.arrayRemove",arguments,1),new fo(e)},e.increment=function(e){return P("FieldValue.increment","number",1,e),x("FieldValue.increment",arguments,1),new po(e)},e.prototype.isEqual=function(e){return this===e},e}(),lo=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return o.__extends(t,e),t.instance=new t,t}(uo),co=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return o.__extends(t,e),t.instance=new t,t}(uo),ho=function(e){function t(t){var n=e.call(this,"FieldValue.arrayUnion")||this;return n._elements=t,n}return o.__extends(t,e),t}(uo),fo=function(e){function t(t){var n=e.call(this,"FieldValue.arrayRemove")||this;return n._elements=t,n}return o.__extends(t,e),t}(uo),po=function(e){function t(t){var n=e.call(this,"FieldValue.increment")||this;return n._operand=t,n}return o.__extends(t,e),t}(uo),vo=E(uo,"Use FieldValue.<field>() instead."),go=/^__.*__$/,yo=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[];return n.push(null!==this.fieldMask?new Ct(e,this.data,this.fieldMask,t):new wt(e,this.data,t)),this.fieldTransforms.length>0&&n.push(new kt(e,this.fieldTransforms)),n},e}(),mo=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[new Ct(e,this.data,this.fieldMask,t)];return this.fieldTransforms.length>0&&n.push(new kt(e,this.fieldTransforms)),n},e}(),_o=function(e){return e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.MergeSet=2]="MergeSet",e[e.Argument=3]="Argument",e[e.ArrayArgument=4]="ArrayArgument",e}({});function bo(e){switch(e){case _o.Set:case _o.MergeSet:case _o.Update:return!0;case _o.Argument:case _o.ArrayArgument:return!1;default:throw m("Unexpected case for UserDataSource: "+e)}}var wo=function(){function e(e,t,n,r,i,o){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return e.prototype.childContextForField=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(t),r},e.prototype.childContextForFieldPath=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},e.prototype.childContextForArray=function(t){return new e(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},e.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new k(C.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))},e.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},e.prototype.validatePathSegment=function(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(bo(this.dataSource)&&go.test(e))throw this.createError('Document fields cannot begin and end with "__"')},e}(),Co=function(e,t){this.databaseId=e,this.key=t},ko=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var n=new wo(_o.Set,e,ce.EMPTY_PATH);So("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new yo(r,null,n.fieldTransforms)},e.prototype.parseMergeData=function(e,t,n){var r=new wo(_o.MergeSet,e,ce.EMPTY_PATH);So("Data must be an object, but it was:",r,t);var i,o,a=this.parseData(t,r);if(n){for(var s=new De(ce.comparator),u=0,l=n;u<l.length;u++){var c=l[u],h=void 0;if(c instanceof Zi)h=c._internalPath;else{if("string"!=typeof c)throw m("Expected stringOrFieldPath to be a string or a FieldPath");h=Io(e,c)}if(!r.contains(h))throw new k(C.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=vt.fromSet(s),o=r.fieldTransforms.filter((function(e){return i.covers(e.field)}))}else i=vt.fromArray(r.fieldMask),o=r.fieldTransforms;return new yo(a,i,o)},e.prototype.parseUpdateData=function(e,t){var n=this,r=new wo(_o.Update,e,ce.EMPTY_PATH);So("Data must be an object, but it was:",r,t);var i=new De(ce.comparator),o=Bt.EMPTY;A(t,(function(t,a){var s=Io(e,t),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof lo)i=i.add(s);else{var l=n.parseData(a,u);null!=l&&(i=i.add(s),o=o.set(s,l))}}));var a=vt.fromSet(i);return new mo(o,a,r.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,n,r){var i=new wo(_o.Update,e,ce.EMPTY_PATH),o=[To(e,t)],a=[n];if(r.length%2!=0)throw new k(C.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(To(e,r[s])),a.push(r[s+1]);var u=new De(ce.comparator),l=Bt.EMPTY;for(s=0;s<o.length;++s){var c=o[s],h=i.childContextForFieldPath(c),f=this.runPreConverter(a[s],h);if(f instanceof lo)u=u.add(c);else{var d=this.parseData(f,h);null!=d&&(u=u.add(c),l=l.set(c,d))}}var p=vt.fromSet(u);return new mo(l,p,i.fieldTransforms)},e.prototype.parseQueryValue=function(e,t,n){void 0===n&&(n=!1);var r=new wo(n?_o.ArrayArgument:_o.Argument,e,ce.EMPTY_PATH),i=this.parseData(t,r);return _(null!=i,"Parsed data should not be null."),_(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(r){var n=Ao(r);throw t.createError(n)}},e.prototype.parseData=function(e,t){if(Eo(e=this.runPreConverter(e,t)))return So("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof uo)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement&&t.dataSource!==_o.ArrayArgument)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,t){var n=this,r=new Te(X);return N(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):A(e,(function(e,i){var o=n.parseData(i,t.childContextForField(e));null!=o&&(r=r.insert(e,o))})),new Bt(r)},e.prototype.parseArray=function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=this.parseData(o[i],t.childContextForArray(r));null==a&&(a=Nt.INSTANCE),n.push(a),r++}return new jt(n)},e.prototype.parseSentinelFieldValue=function(e,t){if(!bo(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof lo){if(t.dataSource!==_o.MergeSet)throw t.dataSource===_o.Update?(_(t.path.length>0,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof co)t.fieldTransforms.push(new gt(t.path,ai.instance));else if(e instanceof ho){var n=this.parseArrayTransformElements(e._methodName,e._elements),r=new si(n);t.fieldTransforms.push(new gt(t.path,r))}else if(e instanceof fo){n=this.parseArrayTransformElements(e._methodName,e._elements);var i=new ui(n);t.fieldTransforms.push(new gt(t.path,i))}else if(e instanceof po){var o=this.parseQueryValue("FieldValue.increment",e._operand),a=new li(o);t.fieldTransforms.push(new gt(t.path,a))}else m("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return Nt.INSTANCE;if("number"==typeof e)return Xn(e)?new Ot(e):new Pt(e);if("boolean"==typeof e)return Dt.of(e);if("string"==typeof e)return new Mt(e);if(e instanceof Date)return new Lt(Ee.fromDate(e));if(e instanceof Ee)return new Lt(new Ee(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof oi)return new qt(e);if(e instanceof te)return new Vt(e);if(e instanceof Co)return new Ut(e.databaseId,e.key);throw t.createError("Unsupported field value: "+j(e))},e.prototype.parseArrayTransformElements=function(e,t){var n=this;return t.map((function(t,r){var i=new wo(_o.Argument,e,ce.EMPTY_PATH);return n.parseData(t,i.childContextForArray(r))}))},e}();function Eo(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ee||e instanceof oi||e instanceof te||e instanceof Co||e instanceof uo)}function So(e,t,n){if(!Eo(n)||!B(n)){var r=j(n);throw t.createError("an object"===r?e+" a custom object":e+" "+r)}}function To(e,t){if(t instanceof Zi)return t._internalPath;if("string"==typeof t)return Io(e,t);throw new k(C.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Io(e,t){try{return function(e){if(e.search(eo)>=0)throw new k(C.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Zi.bind.apply(Zi,o.__spreadArrays([void 0],e.split("."))))}catch(t){throw new k(C.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t)._internalPath}catch(r){var n=Ao(r);throw new k(C.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function Ao(e){return e instanceof Error?e.message:e.toString()}var No="firestore.googleapis.com",Do=!0,xo=!0,Ro=!1,Oo=xn.COLLECTION_DISABLED,Po=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new k(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=No,this.ssl=Do}else L("settings","non-empty string","host",e.host),this.host=e.host,F("settings","boolean","ssl",e.ssl),this.ssl=T(e.ssl,Do);if(H("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),F("settings","object","credentials",e.credentials),this.credentials=e.credentials,F("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),!0===e.timestampsInSnapshots?g("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===e.timestampsInSnapshots&&g("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=T(e.timestampsInSnapshots,xo),F("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=xn.DEFAULT_CACHE_SIZE_BYTES;else{if(e.cacheSizeBytes!==Oo&&e.cacheSizeBytes<xn.MINIMUM_CACHE_SIZE_BYTES)throw new k(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+xn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=e.cacheSizeBytes}F("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.forceLongPolling=void 0===e.experimentalForceLongPolling?Ro:e.experimentalForceLongPolling}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.forceLongPolling===e.forceLongPolling},e}(),Mo=function(){function e(t,n){var r=this;if(this._firebaseApp=null,this._queue=new ve,this.INTERNAL={delete:function(){return o.__awaiter(r,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return e.sent(),[2]}}))}))}},"object"==typeof t.options){var i=t;this._firebaseApp=i,this._databaseId=e.databaseIdFromApp(i),this._persistenceKey=i.name,this._credentials=new ro(n)}else{var a=t;if(!a.projectId)throw new k(C.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new oe(a.projectId,a.database),this._persistenceKey="[DEFAULT]",this._credentials=new no}this._settings=new Po({}),this._dataConverter=this.createDataConverter(this._databaseId)}return e.prototype.settings=function(e){if(x("Firestore.settings",arguments,1),P("Firestore.settings","object",1,e),S(e,"persistence"))throw new k(C.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new Po(e);if(this._firestoreClient&&!this._settings.isEqual(t))throw new k(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=t,void 0!==t.credentials&&(this._credentials=ao(t.credentials))},e.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},e.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},e.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new k(C.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var t=!1;return e&&(void 0!==e.experimentalTabSynchronization&&g("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),t=T(void 0!==e.synchronizeTabs?e.synchronizeTabs:e.experimentalTabSynchronization,!1)),this.configureClient(new Yi(this._settings.cacheSizeBytes,t))},e.prototype.clearPersistence=function(){var e=this,t=Un.buildStoragePrefix(this.makeDatabaseInfo()),n=new fe;return this._queue.enqueueAndForgetEvenAfterShutdown((function(){return o.__awaiter(e,void 0,void 0,(function(){var e;return o.__generator(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new k(C.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Un.clearPersistence(t)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(e){return this.ensureClientConfigured(),so(e)?this.onSnapshotsInSyncInternal(e):(P("Firestore.onSnapshotsInSync","function",1,e),this.onSnapshotsInSyncInternal({next:e}))},e.prototype.onSnapshotsInSyncInternal=function(e){var t=this,n=new $i({next:function(){e.next&&e.next()},error:function(e){throw m("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),t._firestoreClient.removeSnapshotsInSyncListener(n)}},e.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new Xi),this._firestoreClient},e.prototype.makeDatabaseInfo=function(){return new re(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},e.prototype.configureClient=function(e){_(!!this._settings.host,"FirestoreSettings.host is not set"),_(!this._firestoreClient,"configureClient() called multiple times");var t=this.makeDatabaseInfo();return this._firestoreClient=new Ji(b.getPlatform(),t,this._credentials,this._queue),this._firestoreClient.start(e)},e.prototype.createDataConverter=function(e){return new ko((function(t){if(t instanceof Vo){var n=e,r=t.firestore._databaseId;if(!r.isEqual(n))throw new k(C.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Co(e,t._key)}return t}))},e.databaseIdFromApp=function(e){var t=e.options;if(!S(t,"projectId"))throw new k(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=t.projectId;if(!n||"string"!=typeof n)throw new k(C.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new oe(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this._firebaseApp)throw new k(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){return x("Firestore.collection",arguments,1),P("Firestore.collection","non-empty string",1,e),this.ensureClientConfigured(),new Ho(ue.fromString(e),this)},e.prototype.doc=function(e){return x("Firestore.doc",arguments,1),P("Firestore.doc","non-empty string",1,e),this.ensureClientConfigured(),Vo.forPath(ue.fromString(e),this)},e.prototype.collectionGroup=function(e){if(x("Firestore.collectionGroup",arguments,1),P("Firestore.collectionGroup","non-empty string",1,e),e.indexOf("/")>=0)throw new k(C.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new jo(new Zn(ue.EMPTY_PATH,e),this)},e.prototype.runTransaction=function(e){var t=this;return x("Firestore.runTransaction",arguments,1),P("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction((function(n){return e(new Lo(t,n))}))},e.prototype.batch=function(){return this.ensureClientConfigured(),new Fo(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(d()){case f.DEBUG:return"debug";case f.ERROR:return"error";case f.SILENT:return"silent";default:return m("Unknown log level: "+d())}},enumerable:!0,configurable:!0}),e.setLogLevel=function(e){switch(x("Firestore.setLogLevel",arguments,1),P("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":p(f.DEBUG);break;case"error":p(f.ERROR);break;case"silent":p(f.SILENT);break;default:throw new k(C.INVALID_ARGUMENT,"Invalid log level: "+e)}},e.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},e}(),Lo=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var t=this;x("Transaction.get",arguments,1);var n=Ko("Transaction.get",e,this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return m("Mismatch in docs returned from document lookup.");var r=e[0];if(r instanceof zt)return new qo(t._firestore,n._key,null,!1,!1,n._converter);if(r instanceof Ht)return new qo(t._firestore,n._key,r,!1,!1,n._converter);throw m("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},e.prototype.set=function(e,t,n){O("Transaction.set",arguments,2,3);var r=Ko("Transaction.set",e,this._firestore);n=zo("Transaction.set",n);var i=Xo(r._converter,t,"Transaction.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(r._key,s),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof t||t instanceof Zi?(R("Transaction.update",arguments,3),r=Ko("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,o)):(x("Transaction.update",arguments,2),r=Ko("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(r._key,i),this},e.prototype.delete=function(e){x("Transaction.delete",arguments,1);var t=Ko("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),Fo=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,n){O("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Ko("WriteBatch.set",e,this._firestore);n=zo("WriteBatch.set",n);var i=Xo(r._converter,t,"WriteBatch.set"),o=i[0],a=i[1],s=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,n.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(r._key,_t.NONE)),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof t||t instanceof Zi?(R("WriteBatch.update",arguments,3),r=Ko("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,o)):(x("WriteBatch.update",arguments,2),r=Ko("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(i.toMutations(r._key,_t.exists(!0))),this},e.prototype.delete=function(e){x("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=Ko("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new Et(t._key,_t.NONE)),this},e.prototype.commit=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]}))}))},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new k(C.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),Vo=function(){function e(e,t,n){this._key=e,this.firestore=t,this._converter=n,this._firestoreClient=this.firestore.ensureClientConfigured()}return e.forPath=function(t,n,r){if(t.length%2!=0)throw new k(C.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(new he(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ho(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(x("DocumentReference.collection",arguments,1),P("DocumentReference.collection","non-empty string",1,e),!e)throw new k(C.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=ue.fromString(e);return new Ho(this._key.path.child(t),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw z("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)&&this._converter===t._converter},e.prototype.set=function(e,t){O("DocumentReference.set",arguments,1,2),t=zo("DocumentReference.set",t);var n=Xo(this._converter,e,"DocumentReference.set"),r=n[0],i=n[1],o=t.merge||t.mergeFields?this.firestore._dataConverter.parseMergeData(i,r,t.mergeFields):this.firestore._dataConverter.parseSetData(i,r);return this._firestoreClient.write(o.toMutations(this._key,_t.NONE))},e.prototype.update=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof e||e instanceof Zi?(R("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,r)):(x("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(n.toMutations(this._key,_t.exists(!0)))},e.prototype.delete=function(){return x("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Et(this._key,_t.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];O("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||so(e[i])||(H("DocumentReference.onSnapshot",r=e[i],["includeMetadataChanges"]),F("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return so(e[i])?n=e[i]:(P("DocumentReference.onSnapshot","function",i,e[i]),M("DocumentReference.onSnapshot","function",i+1,e[i+1]),M("DocumentReference.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new $i({next:function(e){if(t.next){_(e.docs.size<=1,"Too many documents returned on a document query");var r=e.docs.get(n._key);t.next(new qo(n.firestore,n._key,r,e.fromCache,e.hasPendingWrites,n._converter))}},error:r}),o=this._firestoreClient.listen(Zn.atPath(this._key.path),i,e);return function(){i.mute(),n._firestoreClient.unlisten(o)}},e.prototype.get=function(e){var t=this;return O("DocumentReference.get",arguments,0,1),Go("DocumentReference.get",e),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then((function(e){n(new qo(t.firestore,t._key,e,!0,e instanceof Ht&&e.hasLocalMutations,t._converter))}),r):t.getViaSnapshotListener(n,r,e)}))},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?t(new k(C.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?t(new k(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(i)},error:t})},e.prototype.withConverter=function(t){return new e(this._key,this.firestore,t)},e}(),Uo=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),qo=function(){function e(e,t,n,r,i,o){this._firestore=e,this._key=t,this._document=n,this._fromCache=r,this._hasPendingWrites=i,this._converter=o}return e.prototype.data=function(e){if(O("DocumentSnapshot.data",arguments,0,1),e=Qo("DocumentSnapshot.data",e),this._document){if(this._converter){var t=new Bo(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(t,e)}return this.toJSObject(this._document.data(),It.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},e.prototype.get=function(e,t){if(O("DocumentSnapshot.get",arguments,1,2),t=Qo("DocumentSnapshot.get",t),this._document){var n=this._document.data().field(To("DocumentSnapshot.get",e));if(null!==n)return this.toJSValue(n,It.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Vo(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new Uo(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw z("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))&&this._converter===t._converter},e.prototype.toJSObject=function(e,t){var n=this,r={};return e.forEach((function(e,i){r[e]=n.toJSValue(i,t)})),r},e.prototype.toJSValue=function(e,t){if(e instanceof Bt)return this.toJSObject(e,t);if(e instanceof jt)return this.toJSArray(e,t);if(e instanceof Ut){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||g("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Vo(n,this._firestore,this._converter)}return e.value(t)},e.prototype.toJSArray=function(e,t){var n=this;return e.internalValue.map((function(e){return n.toJSValue(e,t)}))},e}(),Bo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.data=function(t){var n=e.prototype.data.call(this,t);return _(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},t}(qo),jo=function(){function e(e,t,n){this._query=e,this.firestore=t,this._converter=n}return e.prototype.where=function(t,n,r){x("Query.where",arguments,3),W("Query.where",3,r);var i,o=["<","<=","==",">=",">","array-contains","in","array-contains-any"];U("Query.where",o,2,n);var a=To("Query.where",t),s=tr.fromString(n);if(a.isKeyField()){if(s===tr.ARRAY_CONTAINS||s===tr.ARRAY_CONTAINS_ANY)throw new k(C.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===tr.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],l=0,c=r;l<c.length;l++){var h=c[l];u.push(this.parseDocumentIdValue(h))}i=new jt(u)}else i=this.parseDocumentIdValue(r)}else s!==tr.IN&&s!==tr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),i=this.firestore._dataConverter.parseQueryValue("Query.where",r,s===tr.IN);var f=nr.create(a,s,i);return this.validateNewFilter(f),new e(this._query.addFilter(f),this.firestore,this._converter)},e.prototype.orderBy=function(t,n){var r;if(O("Query.orderBy",arguments,1,2),M("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=ur.ASCENDING;else{if("desc"!==n)throw new k(C.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=ur.DESCENDING}if(null!==this._query.startAt)throw new k(C.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new k(C.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=To("Query.orderBy",t),o=new cr(i,r);return this.validateNewOrderBy(o),new e(this._query.addOrderBy(o),this.firestore,this._converter)},e.prototype.limit=function(t){return x("Query.limit",arguments,1),P("Query.limit","number",1,t),Q("Query.limit",1,t),new e(this._query.withLimitToFirst(t),this.firestore,this._converter)},e.prototype.limitToLast=function(t){return x("Query.limitToLast",arguments,1),P("Query.limitToLast","number",1,t),Q("Query.limitToLast",1,t),new e(this._query.withLimitToLast(t),this.firestore,this._converter)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",t,n,!0);return new e(this._query.withStartAt(i),this.firestore,this._converter)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",t,n,!1);return new e(this._query.withStartAt(i),this.firestore,this._converter)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",t,n,!0);return new e(this._query.withEndAt(i),this.firestore,this._converter)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",t,n,!1);return new e(this._query.withEndAt(i),this.firestore,this._converter)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw z("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},e.prototype.withConverter=function(t){return new e(this._query,this.firestore,t)},e.prototype.boundFromDocOrFields=function(e,t,n,r){if(W(e,1,t),t instanceof qo){if(n.length>0)throw new k(C.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new k(C.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,r)}var o=[t].concat(n);return this.boundFromFields(e,o,r)},e.prototype.boundFromDocument=function(e,t,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Ut(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(s instanceof Ft)throw new k(C.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new k(C.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new lr(r,n)},e.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new k(C.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new k(C.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ue.fromString(a));if(!he.isDocumentKey(s))throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new he(s);i.push(new Ut(this.firestore._databaseId,u))}else{var l=this.firestore._dataConverter.parseQueryValue(e,a);i.push(l)}}return new lr(i,n)},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];O("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof e[i]||so(e[i])||(H("Query.onSnapshot",r=e[i],["includeMetadataChanges"]),F("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),so(e[i])?n=e[i]:(P("Query.onSnapshot","function",i,e[i]),M("Query.onSnapshot","function",i+1,e[i+1]),M("Query.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(r,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new $i({next:function(e){t.next&&t.next(new Wo(n.firestore,n._query,e,n._converter))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},e.prototype.validateHasExplicitOrderByForLimitToLast=function(e){if(e.hasLimitToLast()&&0===e.explicitOrderBy.length)throw new k(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},e.prototype.get=function(e){var t=this;return O("Query.get",arguments,0,1),Go("Query.get",e),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise((function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then((function(e){n(new Wo(t.firestore,t._query,e,t._converter))}),r):t.getViaSnapshotListener(n,r,e)}))},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?t(new k(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(i)},error:t})},e.prototype.parseDocumentIdValue=function(e){if("string"==typeof e){if(""===e)throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==e.indexOf("/"))throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+e+"' contains a '/' character.");var t=this._query.path.child(ue.fromString(e));if(!he.isDocumentKey(t))throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return new Ut(this.firestore._databaseId,new he(t))}if(e instanceof Vo)return new Ut(this.firestore._databaseId,e._key);throw new k(C.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+j(e)+".")},e.prototype.validateDisjunctiveFilterElements=function(e,t){if(!Array.isArray(e)||0===e.length)throw new k(C.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new k(C.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if(e.indexOf(null)>=0)throw new k(C.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(e.filter((function(e){return Number.isNaN(e)})).length>0)throw new k(C.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")},e.prototype.validateNewFilter=function(e){if(e instanceof nr){var t=[tr.ARRAY_CONTAINS,tr.ARRAY_CONTAINS_ANY],n=[tr.IN,tr.ARRAY_CONTAINS_ANY],r=t.indexOf(e.op)>=0,i=n.indexOf(e.op)>=0;if(e.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(e.field))throw new k(C.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+e.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(e.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(t)),null!=s)throw new k(C.INVALID_ARGUMENT,s===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},e.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},e.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new k(C.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},e}(),Wo=function(){function e(e,t,n,r){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._converter=r,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Uo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;O("QuerySnapshot.forEach",arguments,1,2),P("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach((function(r){e.call(t,n.convertToDocumentImpl(r))}))},Object.defineProperty(e.prototype,"query",{get:function(){return new jo(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),e.prototype.docChanges=function(e){e&&(H("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),F("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new k(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t,n,r){if(n.oldDocs.isEmpty()){var i,o=0;return n.docChanges.map((function(t){var a=new Bo(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key),r);return _(t.type===Wr.Added,"Invalid event type for first snapshot"),_(!i||n.query.docComparator(i,t.doc)<0,"Got added events in wrong order"),i=t.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}}))}var a=n.oldDocs;return n.docChanges.filter((function(e){return t||e.type!==Wr.Metadata})).map((function(t){var i=new Bo(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key),r),o=-1,s=-1;return t.type!==Wr.Added&&(_((o=a.indexOf(t.doc.key))>=0,"Index for document not found"),a=a.delete(t.doc.key)),t.type!==Wr.Removed&&(s=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:Yo(t.type),doc:i,oldIndex:o,newIndex:s}}))}(this._firestore,t,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e.prototype.isEqual=function(t){if(!(t instanceof e))throw z("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)&&this._converter===t._converter},e.prototype.convertToDocumentImpl=function(e){return new Bo(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key),this._converter)},e}();o.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(e){try{Object.defineProperty(Wo.prototype.docChanges,e,{get:function(){return function(){throw new k(C.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var Ho=function(e){function t(t,n,r){var i=e.call(this,Zn.atPath(t),n,r)||this;if(i._path=t,t.length%2!=1)throw new k(C.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return i}return o.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new Vo(new he(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if(O("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=Y.newId()),P("CollectionReference.doc","non-empty string",1,e),""===e)throw new k(C.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=ue.fromString(e);return Vo.forPath(this._query.path.child(t),this.firestore,this._converter)},t.prototype.add=function(e){x("CollectionReference.add",arguments,1),P("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then((function(){return t}))},t.prototype.withConverter=function(e){return new t(this._path,this.firestore,e)},t}(jo);function zo(e,t){if(void 0===t)return{merge:!1};if(H(e,t,["merge","mergeFields"]),F(e,"boolean","merge",t.merge),void 0!==(n=t.mergeFields)&&function(e,t,n,r,i){if(!(r instanceof Array))throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires its mergeFields option to be an array, but it was: "+j(r));for(var o=0;o<r.length;++o)if(!("string"==typeof(a=r[o])||a instanceof Zi))throw new k(C.INVALID_ARGUMENT,"Function "+e+"() requires all mergeFields elements to be a string or a FieldPath, but the value at index "+o+" was: "+j(r[o]));var a}(e,0,0,n),void 0!==t.mergeFields&&void 0!==t.merge)throw new k(C.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');var n;return t}function Qo(e,t){return void 0===t?{}:(H(e,t,["serverTimestamps"]),V(e,0,"serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function Go(e,t){M(e,"object",1,t),t&&(H(e,t,["source"]),V(e,0,"source",t.source,["default","server","cache"]))}function Ko(e,t,n){if(t instanceof Vo){if(t.firestore!==n)throw new k(C.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw z(e,"DocumentReference",1,t)}function Yo(e){switch(e){case Wr.Added:return"added";case Wr.Modified:case Wr.Metadata:return"modified";case Wr.Removed:return"removed";default:return m("Unknown change type: "+e)}}function Xo(e,t,n){var r;return e?(r=e.toFirestore(t),n="toFirestore() in "+n):r=t,[r,n]}var Jo=E(Mo,"Use firebase.firestore() instead."),$o=E(Lo,"Use firebase.firestore().runTransaction() instead."),Zo=E(Fo,"Use firebase.firestore().batch() instead."),ea=E(Vo,"Use firebase.firestore().doc() instead."),ta=E(qo),na=E(Bo),ra=E(jo),ia=E(Wo),oa=E(Ho,"Use firebase.firestore().collection() instead."),aa={Firestore:Jo,GeoPoint:oi,Timestamp:Ee,Blob:ne,Transaction:$o,WriteBatch:Zo,DocumentReference:ea,DocumentSnapshot:ta,Query:ra,QueryDocumentSnapshot:na,QuerySnapshot:ia,CollectionReference:oa,FieldPath:Zi,FieldValue:vo,setLogLevel:Mo.setLogLevel,CACHE_SIZE_UNLIMITED:Oo},sa=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.shutdown=function(){},e}(),ua=function(){function e(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return e.prototype.addCallback=function(e){this.callbacks.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},e.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},e.prototype.onNetworkAvailable=function(){v("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(0)},e.prototype.onNetworkUnavailable=function(){v("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(1)},e.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),la=function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){_(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){_(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){_(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){_(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){_(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){_(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}(),ca="Connection",ha={BatchGetDocuments:"batchGet",Commit:"commit"},fa="gl-js/ fire/"+c,da=function(){function e(e){this.databaseId=e.databaseId,this.baseUrl=(e.ssl?"https":"http")+"://"+e.host,this.forceLongPolling=e.forceLongPolling}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=fa},e.prototype.invokeRPC=function(e,t,n){var r=this,i=this.makeUrl(e);return new Promise((function(a,s){var u=new l.XhrIo;u.listenOnce(l.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case l.ErrorCode.NO_ERROR:var t=u.getResponseJson();v(ca,"XHR received:",JSON.stringify(t)),a(t);break;case l.ErrorCode.TIMEOUT:v(ca,'RPC "'+e+'" timed out'),s(new k(C.DEADLINE_EXCEEDED,"Request time out"));break;case l.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(v(ca,'RPC "'+e+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=(o=r.status.toLowerCase().replace("_","-"),Object.values(C).indexOf(o)>=0?o:C.UNKNOWN);s(new k(i,r.message))}else s(new k(C.UNKNOWN,"Server responded with status "+u.getStatus()))}else v(ca,'RPC "'+e+'" failed'),s(new k(C.UNAVAILABLE,"Connection failed."));break;default:m('RPC "'+e+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{v(ca,'RPC "'+e+'" completed.')}var o}));var c=o.__assign({},t);delete c.database;var h=JSON.stringify(c);v(ca,"XHR sending: ",i+" "+h);var f={"Content-Type":"text/plain"};r.modifyHeadersForRequest(f,n),u.send(i,"POST",h,f,15)}))},e.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},e.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=l.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,t),s.isReactNative()||s.isElectron()||s.isIE()||s.isUWP()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");v(ca,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),u=!1,c=!1,h=new la({sendFn:function(e){c?v(ca,"Not sending because WebChannel is closed:",e):(u||(v(ca,"Opening WebChannel transport."),a.open(),u=!0),v(ca,"WebChannel sending:",e),a.send(e))},closeFn:function(){return a.close()}}),f=function(e,t){a.listen(e,(function(e){try{t(e)}catch(n){setTimeout((function(){throw n}),0)}}))};return f(l.WebChannel.EventType.OPEN,(function(){c||v(ca,"WebChannel transport opened.")})),f(l.WebChannel.EventType.CLOSE,(function(){c||(c=!0,v(ca,"WebChannel transport closed"),h.callOnClose())})),f(l.WebChannel.EventType.ERROR,(function(e){c||(c=!0,v(ca,"WebChannel transport errored:",e),h.callOnClose(new k(C.UNAVAILABLE,"The operation could not be completed")))})),f(l.WebChannel.EventType.MESSAGE,(function(e){var t;if(!c){var n=e.data[0];_(!!n,"Got a webchannel message without data.");var r=n.error||(null===(t=n[0])||void 0===t?void 0:t.error);if(r){v(ca,"WebChannel received error:",r);var i=r.status,o=function(e){var t=Vr[e];if(void 0!==t)return qr(t)}(i),s=r.message;void 0===o&&(o=C.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.callOnClose(new k(o,s)),a.close()}else v(ca,"WebChannel received:",n),h.callOnMessage(n)}})),setTimeout((function(){h.callOnOpen()}),0),h},e.prototype.makeUrl=function(e){var t=ha[e];return _(void 0!==t,"Unknown REST mapping for: "+e),this.baseUrl+"/v1/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+t},e}();b.setPlatform(new(function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(e.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),e.prototype.loadConnection=function(e){return Promise.resolve(new da(e))},e.prototype.newConnectivityMonitor=function(){return ua.isAvailable()?new ua:new sa},e.prototype.newSerializer=function(e){return new _i(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}()));var pa="@firebase/firestore",va="1.9.2";function ga(e){(function(e){e.INTERNAL.registerComponent(new u.Component("firestore",(function(e){var t=e.getProvider("app").getImmediate();return new Mo(t,e.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(function(e){_(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(aa)))})(e),e.registerVersion(pa,va)}ga(i),t.registerFirestore=ga},NSPt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,a=n("mrSG"),s=n("zVF4"),u=n("q/0M"),l=n("S+S0"),c=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),s.stringify(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:s.jsonEval(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),h=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return s.contains(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),f=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new c(t)}}catch(n){}return new h},d=f("localStorage"),p=f("sessionStorage"),v=new u.Logger("@firebase/database"),g=(i=1,function(){return i++}),y=function(e){var t=s.stringToByteArray(e),n=new s.Sha1;n.update(t);var r=n.digest();return s.base64.encodeByteArray(r)},m=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var o=t[i];Array.isArray(o)||o&&"object"==typeof o&&"number"==typeof o.length?r+=e.apply(null,o):r+="object"==typeof o?s.stringify(o):o,r+=" "}return r},_=null,b=!0,w=function(e,t){s.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(v.logLevel=u.LogLevel.VERBOSE,_=v.log.bind(v),t&&p.set("logging_enabled",!0)):"function"==typeof e?_=e:(_=null,p.remove("logging_enabled"))},C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===b&&(b=!1,null===_&&!0===p.get("logging_enabled")&&w(!0)),_){var n=m.apply(null,e);_(n)}},k=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];C.apply(void 0,a.__spread([e],t))}},E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,a.__spread(e));v.error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,a.__spread(e));throw v.error(n),new Error(n)},T=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+m.apply(void 0,a.__spread(e));v.warn(n)},I=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",N="[MAX_NAME]",D=function(e,t){if(e===t)return 0;if(e===A||t===N)return-1;if(t===A||e===N)return 1;var n=K(e),r=K(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},x=function(e,t){return e===t?0:e<t?-1:1},R=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+s.stringify(t))},O=function e(t){if("object"!=typeof t||null===t)return s.stringify(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",o=0;o<n.length;o++)0!==o&&(i+=","),i+=s.stringify(n[o]),i+=":",i+=e(t[n[o]]);return i+"}"},P=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function M(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var L,F,V,U,q,B,j,W,H,z,Q=function(e){var t,n,r,i,o;s.assert(!I(e),"Invalid JSON number"),0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();var u=a.join(""),l="";for(o=0;o<64;o+=8){var c=parseInt(u.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),l+=c}return l.toLowerCase()},G=new RegExp("^-?(0*)\\d{1,10}$"),K=function(e){if(G.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Y=function(e){try{e()}catch(t){setTimeout((function(){throw T("Exception was thrown by user callback.",t.stack||""),t}),Math.floor(0))}},X=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},J=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},$=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)t.push(this.pieces_[n]);return new e(t,0)},e.prototype.child=function(t){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(t instanceof e)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new e(n,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=D(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},e}(),Z=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=s.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=s.stringLength(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=s.stringLength(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),ee="long_polling",te=function(){function e(e,t,n,r,i,o){void 0===i&&(i=""),void 0===o&&(o=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.includeNamespaceInQueryParams=o,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=d.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&d.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var n;if(s.assert("string"==typeof e,"typeof type must == string"),s.assert("object"==typeof t,"typeof params must == object"),"websocket"===e)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==ee)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return M(t,(function(e,t){r.push(e+"="+t)})),n+r.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}(),ne=function(e){var t=re(e),n=t.namespace;return"firebase"===t.domain&&S(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!==n||"localhost"===t.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&T("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new te(t.host,t.secure,n,"ws"===t.scheme||"wss"===t.scheme,"",n!==t.subdomain),path:new $(t.pathString)}},re=function(e){var t="",n="",r="",i="",o="",s=!0,u="https",l=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(u=e.substring(0,c-1),e=e.substring(c+2));var h=e.indexOf("/");-1===h&&(h=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(h,f)),h<f&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}(e.substring(h,f)));var d=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=a.__values(e.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):T("Invalid query segment '"+s+"' in query '"+e+"'")}}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,f)));(c=t.indexOf(":"))>=0?(s="https"===u||"wss"===u,l=parseInt(t.substring(c+1),10)):c=e.length;var p=t.split(".");3===p.length?(n=p[1],o=r=p[0].toLowerCase()):2===p.length?n=p[0]:"localhost"===p[0].slice(0,c).toLowerCase()&&(n="localhost"),"ns"in d&&(o=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},ie=/[\[\].#$\/\u0000-\u001F\u007F]/,oe=/[\[\].#$\u0000-\u001F\u007F]/,ae=function(e){return"string"==typeof e&&0!==e.length&&!ie.test(e)},se=function(e){return"string"==typeof e&&0!==e.length&&!oe.test(e)},ue=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!I(e)||e&&"object"==typeof e&&s.contains(e,".sv")},le=function(e,t,n,r,i){i&&void 0===n||ce(s.errorPrefix(e,t,i),n,r)},ce=function e(t,n,r){var i=r instanceof $?new Z(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+i.toErrorString());if("function"==typeof n)throw new Error(t+"contains a function "+i.toErrorString()+" with contents = "+n.toString());if(I(n))throw new Error(t+"contains "+n.toString()+" "+i.toErrorString());if("string"==typeof n&&n.length>10485760/3&&s.stringLength(n)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+i.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var o=!1,a=!1;if(M(n,(function(n,r){if(".value"===n)o=!0;else if(".priority"!==n&&".sv"!==n&&(a=!0,!ae(n)))throw new Error(t+" contains an invalid key ("+n+") "+i.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');i.push(n),e(t,r,i),i.pop()})),o&&a)throw new Error(t+' contains ".value" child '+i.toErrorString()+" in addition to actual children.")}},he=function(e,t,n,r,i){if(!i||void 0!==n){var o=s.errorPrefix(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];M(n,(function(e,t){var n=new $(e);if(ce(o,t,r.child(n)),".priority"===n.getBack()&&!ue(t))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=(r=t[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!ae(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort($.comparePaths);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&a.contains(r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},fe=function(e,t,n,r){if(!r||void 0!==n){if(I(n))throw new Error(s.errorPrefix(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ue(n))throw new Error(s.errorPrefix(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},de=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(s.errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},pe=function(e,t,n,r){if(!(r&&void 0===n||ae(n)))throw new Error(s.errorPrefix(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ve=function(e,t,n,r){if(!(r&&void 0===n||se(n)))throw new Error(s.errorPrefix(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ge=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ve(e,t,n,r)},ye=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},me=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!ae(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),se(e)}(r))throw new Error(s.errorPrefix(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},_e=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(s.errorPrefix(e,t,r)+"must be a boolean.")},be=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){s.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),s.validateCallback("OnDisconnect.cancel",1,e,!0);var t=new s.Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){s.validateArgCount("OnDisconnect.remove",0,1,arguments.length),ye("OnDisconnect.remove",this.path_),s.validateCallback("OnDisconnect.remove",1,e,!0);var t=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){s.validateArgCount("OnDisconnect.set",1,2,arguments.length),ye("OnDisconnect.set",this.path_),le("OnDisconnect.set",1,e,this.path_,!1),s.validateCallback("OnDisconnect.set",2,t,!0);var n=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){s.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),ye("OnDisconnect.setWithPriority",this.path_),le("OnDisconnect.setWithPriority",1,e,this.path_,!1),fe("OnDisconnect.setWithPriority",2,t,!1),s.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new s.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},e.prototype.update=function(e,t){if(s.validateArgCount("OnDisconnect.update",1,2,arguments.length),ye("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,T("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}he("OnDisconnect.update",1,e,this.path_,!1),s.validateCallback("OnDisconnect.update",2,t,!0);var i=new s.Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),we=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return s.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Ce=(L="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",F=0,V=[],function(e){var t,n=e===F;F=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=L.charAt(e%64),e=Math.floor(e/64);s.assert(0===e,"Cannot push at time == 0");var i=r.join("");if(n){for(t=11;t>=0&&63===V[t];t--)V[t]=0;V[t]++}else for(t=0;t<12;t++)V[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)i+=L.charAt(V[t]);return s.assert(20===i.length,"nextPushId: Length should be 20."),i}),ke=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Ee=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new ke(A,e),r=new ke(A,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return ke.MIN},e}(),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return U},set:function(e){U=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return D(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw s.assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return ke.MIN},t.prototype.maxPost=function(){return new ke(N,U)},t.prototype.makePost=function(e,t){return s.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new ke(e,U)},t.prototype.toString=function(){return".key"},t}(Ee),Te=new Se,Ie=function(e){return"number"==typeof e?"number:"+Q(e):"string:"+e},Ae=function(e){if(e.isLeafNode()){var t=e.val();s.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&s.contains(t,".sv"),"Priority must be a string or number.")}else s.assert(e===q||e.isEmpty(),"priority of unexpected type.");s.assert(e===q||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ne=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,s.assert(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Ae(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return B},set:function(e){B=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=t.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(s.assert(".priority"!==r||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ie(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?Q(this.value_):this.value_,this.lazyHash_=y(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(s.assert(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return s.assert(i>=0,"Unknown leaf type: "+n),s.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),De=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?D(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return ke.MIN},t.prototype.maxPost=function(){return new ke(N,new Ne("[PRIORITY-POST]",W))},t.prototype.makePost=function(e,t){var n=j(e);return new ke(t,new Ne("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Ee)),xe=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Re=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:Pe.EMPTY_NODE,this.right=null!=o?o:Pe.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Pe.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Pe.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Oe=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Re(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Pe=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Re.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Re.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new xe(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new xe(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new xe(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new xe(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Oe,e}(),Me=Math.log(2),Le=function(){function e(e){this.count=parseInt(Math.log(e+1)/Me,10),this.current_=this.count-1;var t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Fe=function(e,t,n,r){e.sort(t);var i=function(t){for(var r=null,i=null,o=e.length,a=function(t,r){var i=o-t,a=o;o-=t;var u=function t(r,i){var o,a,s=i-r;if(0===s)return null;if(1===s)return o=e[r],a=n?n(o):o,new Re(a,o.node,Re.BLACK,null,null);var u=parseInt(s/2,10)+r,l=t(r,u),c=t(u+1,i);return o=e[u],a=n?n(o):o,new Re(a,o.node,Re.BLACK,l,c)}(i+1,a),l=e[i],c=n?n(l):l;s(new Re(c,l.node,r,null,u))},s=function(e){r?(r.left=e,r=e):(i=e,r=e)},u=0;u<t.count;++u){var l=t.nextBitIsOne(),c=Math.pow(2,t.count-(u+1));l?a(c,Re.BLACK):(a(c,Re.BLACK),a(c,Re.RED))}return i}(new Le(e.length));return new Pe(r||t,i)},Ve={},Ue=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return s.assert(Ve&&De,"ChildrenNode.ts has not been loaded"),H=H||new e({".priority":Ve},{".priority":De})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=s.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Pe?t:null},e.prototype.hasIndex=function(e){return s.contains(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){s.assert(t!==Te,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,u=n.getIterator(ke.Wrap),l=u.getNext();l;)o=o||t.isDefinedOn(l.node),i.push(l),l=u.getNext();r=o?Fe(i,t.getCompare()):Ve;var c=t.toString(),h=a.__assign({},this.indexSet_);h[c]=t;var f=a.__assign({},this.indexes_);return f[c]=r,new e(f,h)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(s.map(this.indexes_,(function(e,i){var o=s.safeGet(r.indexSet_,i);if(s.assert(o,"Missing index implementation for "+i),e===Ve){if(o.isDefinedOn(t.node)){for(var a=[],u=n.getIterator(ke.Wrap),l=u.getNext();l;)l.name!==t.name&&a.push(l),l=u.getNext();return a.push(t),Fe(a,o.getCompare())}return Ve}var c=n.get(t.name),h=e;return c&&(h=h.remove(new ke(t.name,c))),h.insert(t,t.node)})),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(s.map(this.indexes_,(function(e){if(e===Ve)return e;var r=n.get(t.name);return r?e.remove(new ke(t.name,r)):e})),this.indexSet_)},e}();function qe(e,t){return D(e.name,t.name)}function Be(e,t){return D(e,t)}var je=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ae(this.priorityNode_),this.children_.isEmpty()&&s.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return z||(z=new e(new Pe(Be),null,Ue.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||z},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?z:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(s.assert(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new ke(t,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?z:this.priorityNode_;return new e(i,a,o)},e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;s.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(De,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Ie(this.getPriority().val())+":"),this.forEachChild(De,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":y(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new ke(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new ke(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new ke(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,ke.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,ke.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===We?-1:0},e.prototype.withIndex=function(t){if(t===Te||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Te||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(De),r=t.getIterator(De),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Te?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),We=new(function(e){function t(){return e.call(this,new Pe(Be),je.EMPTY_NODE,Ue.Default)||this}return a.__extends(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return je.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(je));Object.defineProperties(ke,{MIN:{value:new ke(A,je.EMPTY_NODE)},MAX:{value:new ke(N,We)}}),Se.__EMPTY_NODE=je.EMPTY_NODE,Ne.__childrenNodeConstructor=je,q=We,W=We;var He=!0;function ze(e,t){if(void 0===t&&(t=null),null===e)return je.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),s.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Ne(e,ze(t));if(e instanceof Array||!He){var n=je.EMPTY_NODE;return M(e,(function(t,r){if(s.contains(e,t)&&"."!==t.substring(0,1)){var i=ze(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(ze(t))}var r=[],i=!1;if(M(e,(function(e,t){if("."!==e.substring(0,1)){var n=ze(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new ke(e,n)))}})),0===r.length)return je.EMPTY_NODE;var o=Fe(r,qe,(function(e){return e.name}),Be);if(i){var a=Fe(r,De.getCompare());return new je(o,ze(t),new Ue({".priority":a},{".priority":De}))}return new je(o,ze(t),Ue.Default)}j=ze;var Qe,Ge,Ke,Ye=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?D(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return ke.MIN},t.prototype.maxPost=function(){return ke.MAX},t.prototype.makePost=function(e,t){var n=ze(e);return new ke(t,n)},t.prototype.toString=function(){return".value"},t}(Ee)),Xe=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,s.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return a.__extends(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?D(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=ze(e),r=je.EMPTY_NODE.updateChild(this.indexPath_,n);return new ke(t,r)},t.prototype.maxPost=function(){var e=je.EMPTY_NODE.updateChild(this.indexPath_,We);return new ke(N,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(Ee),Je=function(){function e(e,t,n){this.node_=e,this.ref_=t,this.index_=n}return e.prototype.val=function(){return s.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return s.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return s.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return s.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){s.validateArgCount("DataSnapshot.child",0,1,arguments.length),t=String(t),ve("DataSnapshot.child",1,t,!1);var n=new $(t),r=this.ref_.child(n);return new e(this.node_.getChild(n),r,De)},e.prototype.hasChild=function(e){s.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),ve("DataSnapshot.hasChild",1,e,!1);var t=new $(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return s.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var n=this;if(s.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),s.validateCallback("DataSnapshot.forEach",1,t,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return t(new e(i,n.ref_.child(r),De))}))},e.prototype.hasChildren=function(){return s.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return s.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return s.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),$e=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+s.stringify(this.snapshot.exportVal())},e}(),Ze=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),et=function(){function e(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new $e("value",this,new Je(e.snapshotNode,t.getRef(),n))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ze(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),tt=function(){function e(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return s.contains(this.callbacks_,t="children_removed"===t?"child_removed":t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ze(this,e,t):null},e.prototype.createEvent=function(e,t){s.assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),r=t.getQueryParams().getIndex();return new $e(e.type,this,new Je(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){var n=this;if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var r=Object.keys(t.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var a=r[0],s=i[0];return!(s!==a||t.callbacks_[a]&&this.callbacks_[s]&&t.callbacks_[a]!==this.callbacks_[s])}return i.every((function(e){return t.callbacks_[e]===n.callbacks_[e]}))}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),nt=function(){function e(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return s.assert(Qe,"Reference.ts has not been loaded"),Qe},set:function(e){Qe=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Te){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==A)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==N)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===De){if(null!=t&&!ue(t)||null!=n&&!ue(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s.assert(e.getIndex()instanceof Xe||e.getIndex()===Ye,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return s.validateArgCount("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,n,r,i){s.validateArgCount("Query.on",2,4,arguments.length),de("Query.on",1,t,!1),s.validateCallback("Query.on",2,n,!1);var o=e.getCancelAndContextArgs_("Query.on",r,i);if("value"===t)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[t]=n,this.onChildEvent(a,o.cancel,o.context)}return n},e.prototype.onValueEvent=function(e,t,n){var r=new et(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},e.prototype.onChildEvent=function(e,t,n){var r=new tt(e,t,n);this.repo.addEventCallbackForQuery(this,r)},e.prototype.off=function(e,t,n){s.validateArgCount("Query.off",0,3,arguments.length),de("Query.off",1,e,!0),s.validateCallback("Query.off",2,t,!0),s.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===e){var o=t||null;r=new et(o,null,n||null)}else e&&(t&&((i={})[e]=t),r=new tt(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},e.prototype.once=function(t,n,r,i){var o=this;s.validateArgCount("Query.once",1,4,arguments.length),de("Query.once",1,t,!1),s.validateCallback("Query.once",2,n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),u=!0,l=new s.Deferred;l.promise.catch((function(){}));var c=function e(r){u&&(u=!1,o.off(t,e),n&&n.bind(a.context)(r),l.resolve(r))};return this.on(t,c,(function(e){o.off(t,c),a.cancel&&a.cancel.bind(a.context)(e),l.reject(e)})),l.promise},e.prototype.limitToFirst=function(t){if(s.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(s.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(s.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ve("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new $(t);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Xe(n),i=this.queryParams_.orderBy(r);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){s.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Te);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){s.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(De);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){s.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(Ye);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,n){void 0===t&&(t=null),s.validateArgCount("Query.startAt",0,2,arguments.length),le("Query.startAt",1,t,this.path,!0),pe("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,n=null),new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.endAt=function(t,n){void 0===t&&(t=null),s.validateArgCount("Query.endAt",0,2,arguments.length),le("Query.endAt",1,t,this.path,!0),pe("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(s.validateArgCount("Query.equalTo",1,2,arguments.length),le("Query.equalTo",1,e,this.path,!1),pe("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return s.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return s.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=O(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(s.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===t.repo,i=this.path.equals(t.path),o=this.queryIdentifier()===t.queryIdentifier();return r&&i&&o},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,s.validateCallback(e,3,r.cancel,!0),r.context=n,s.validateContextObject(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(s.errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),rt=function(){function e(){this.value=null,this.children=new Map}return e.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&this.children.size>0){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},e.prototype.remember=function(t,n){if(t.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,n);else{var r=t.getFront();this.children.has(r)||this.children.set(r,new e);var i=this.children.get(r);t=t.popFront(),i.remember(t,n)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var n=this;return t.forEachChild(De,(function(e,t){n.remember(new $(e),t)})),this.forget(e)}if(this.children.size>0){var r=e.getFront();return e=e.popFront(),this.children.has(r)&&this.children.get(r).forget(e)&&this.children.delete(r),0===this.children.size}return!0},e.prototype.forEachTree=function(e,t){null!==this.value?t(e,this.value):this.forEachChild((function(n,r){var i=new $(e.toString()+"/"+n);r.forEachTree(i,t)}))},e.prototype.forEachChild=function(e){this.children.forEach((function(t,n){e(n,t)}))},e}(),it=function(e,t){return e&&"object"==typeof e?(s.assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},ot=function e(t,n){var r,i=t.getPriority().val(),o=it(i,n);if(t.isLeafNode()){var a=t,s=it(a.getValue(),n);return s!==a.getValue()||o!==a.getPriority().val()?new Ne(s,ze(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Ne(o))),u.forEachChild(De,(function(t,i){var o=e(i,n);o!==i&&(r=r.updateImmediateChild(t,o))})),r},at=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}({}),st=function(){function e(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,s.assert(!r||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),ut=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=at.ACK_USER_WRITE,this.source=st.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return s.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new $(t));return new e($.Empty,n,this.revert)}return s.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),lt=function(){return Ge||(Ge=new Pe(x)),Ge},ct=function(){function e(e,t){void 0===t&&(t=lt()),this.value=e,this.children=t}return e.fromObject=function(t){var n=e.Empty;return M(t,(function(e,t){n=n.set(new $(e),t)})),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:$.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new $(n).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront(),r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront(),i=(this.children.get(r)||e.Empty).set(t.popFront(),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront(),r=this.children.get(n);if(r){var i=r.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r,i=t.getFront(),o=(this.children.get(i)||e.Empty).setTree(t.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new e(this.value,r)},e.prototype.fold=function(e){return this.fold_($.Empty,e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(e.child(r),t)})),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,$.Empty,t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,$.Empty,t)},e.prototype.foreachOnPath_=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),n.child(i),r):e.Empty},e.prototype.foreach=function(e){this.foreach_($.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(e.child(n),t)})),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},e.Empty=new e(null),e}(),ht=function(){function e(e,t){this.source=e,this.path=t,this.type=at.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,$.Empty):new e(this.source,this.path.popFront())},e}(),ft=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=at.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,$.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),dt=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=at.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new $(t));return n.isEmpty()?null:n.value?new ft(this.source,$.Empty,n.value):new e(this.source,$.Empty,n)}return s.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),pt=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),vt=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,n,r){return new e(new pt(t,n,r),this.serverCache_)},e.prototype.updateServerSnap=function(t,n,r){return new e(this.eventCache_,new pt(t,n,r))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new pt(je.EMPTY_NODE,!1,!1),new pt(je.EMPTY_NODE,!1,!1)),e}(),gt=function(){function e(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)},e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)},e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)},e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),yt=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){s.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(gt.childRemovedChange(t,a)):s.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(gt.childAddedChange(t,n)):o.trackChildChange(gt.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(De,(function(e,r){t.hasChild(e)||n.trackChildChange(gt.childRemovedChange(e,r))})),t.isLeafNode()||t.forEachChild(De,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(gt.childChangedChange(t,r,i))}else n.trackChildChange(gt.childAddedChange(t,r))}))),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?je.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),mt=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;s.assert(t===gt.CHILD_ADDED||t===gt.CHILD_CHANGED||t===gt.CHILD_REMOVED,"Only child changes supported for tracking"),s.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(t===gt.CHILD_ADDED&&i===gt.CHILD_REMOVED)this.changeMap.set(n,gt.childChangedChange(n,e.snapshotNode,r.snapshotNode));else if(t===gt.CHILD_REMOVED&&i===gt.CHILD_ADDED)this.changeMap.delete(n);else if(t===gt.CHILD_REMOVED&&i===gt.CHILD_CHANGED)this.changeMap.set(n,gt.childRemovedChange(n,r.oldSnap));else if(t===gt.CHILD_CHANGED&&i===gt.CHILD_ADDED)this.changeMap.set(n,gt.childAddedChange(n,e.snapshotNode));else{if(t!==gt.CHILD_CHANGED||i!==gt.CHILD_CHANGED)throw s.assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,gt.childChangedChange(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),_t=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),bt=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new pt(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}(),wt=function(e,t){this.viewCache=e,this.changes=t},Ct=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){s.assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),s.assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,n,r,i){var o,a,u=new mt;if(n.type===at.OVERWRITE){var l=n;l.source.fromUser?o=this.applyUserOverwrite_(t,l.path,l.snap,r,i,u):(s.assert(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.getServerCache().isFiltered()&&!l.path.isEmpty(),o=this.applyServerOverwrite_(t,l.path,l.snap,r,i,a,u))}else if(n.type===at.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(t,c.path,c.children,r,i,u):(s.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.getServerCache().isFiltered(),o=this.applyServerMerge_(t,c.path,c.children,r,i,a,u))}else if(n.type===at.ACK_USER_WRITE){var h=n;o=h.revert?this.revertUserWrite_(t,h.path,r,i,u):this.ackUserWrite_(t,h.path,h.affectedTree,r,i,u)}else{if(n.type!==at.LISTEN_COMPLETE)throw s.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(t,n.path,r,u)}var f=u.getChanges();return e.maybeAddValueEvent_(t,o,f),new wt(o,f)},e.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(gt.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a=void 0,u=void 0;if(t.isEmpty())if(s.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var l=e.getCompleteServerSnap(),c=n.calcCompleteEventChildren(l instanceof je?l:je.EMPTY_NODE);a=this.filter_.updateFullNode(e.getEventCache().getNode(),c,i)}else{var h=n.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}else{var f=t.getFront();if(".priority"===f){s.assert(1===t.getLength(),"Can't have a priority with additional path components");var d=o.getNode();u=e.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(t,d,u);a=null!=p?this.filter_.updatePriority(d,p):o.getNode()}else{var v=t.popFront(),g=void 0;if(o.isCompleteForChild(f)){u=e.getServerCache().getNode();var y=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),u);g=null!=y?o.getNode().getImmediateChild(f).updateChild(v,y):o.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,e.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),f,g,v,r,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s,u=e.getServerCache(),l=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=l.updateFullNode(u.getNode(),n,null);else if(l.filtersNodes()&&!u.isFiltered()){var c=u.getNode().updateChild(t,n);s=l.updateFullNode(u.getNode(),c,null)}else{var h=t.getFront();if(!u.isCompleteForPath(t)&&t.getLength()>1)return e;var f=t.popFront(),d=u.getNode().getImmediateChild(h).updateChild(f,n);s=".priority"===h?l.updatePriority(u.getNode(),d):l.updateChild(u.getNode(),h,d,f,_t,null)}var p=e.updateServerSnap(s,u.isFullyInitialized()||t.isEmpty(),l.filtersNodes()),v=new bt(r,p,i);return this.generateEventCacheAfterServerEvent_(p,t,r,v,a)},e.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,s,u=e.getEventCache(),l=new bt(r,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),a=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var c=t.getFront();if(".priority"===c)s=this.filter_.updatePriority(e.getEventCache().getNode(),n),a=e.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=t.popFront(),f=u.getNode().getImmediateChild(c),d=void 0;if(h.isEmpty())d=n;else{var p=l.getCompleteChild(c);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):je.EMPTY_NODE}if(f.equals(d))a=e;else{var v=this.filter_.updateChild(u.getNode(),c,d,h,l,o);a=e.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,n,r,i,o,a){var s=this,u=t;return r.foreach((function(r,l){var c=n.child(r);e.cacheHasChild_(t,c.getFront())&&(u=s.applyUserOverwrite_(u,c,l,i,o,a))})),r.foreach((function(r,l){var c=n.child(r);e.cacheHasChild_(t,c.getFront())||(u=s.applyUserOverwrite_(u,c,l,i,o,a))})),u},e.prototype.applyMerge_=function(e,t){return t.foreach((function(t,n){e=e.updateChild(t,n)})),e},e.prototype.applyServerMerge_=function(e,t,n,r,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var u,l=e;u=t.isEmpty()?n:ct.Empty.setTree(t,n);var c=e.getServerCache().getNode();return u.children.inorderTraversal((function(t,n){if(c.hasChild(t)){var u=e.getServerCache().getNode().getImmediateChild(t),h=s.applyMerge_(u,n);l=s.applyServerOverwrite_(l,new $(t),h,r,i,o,a)}})),u.children.inorderTraversal((function(t,n){var u=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!c.hasChild(t)&&!u){var h=e.getServerCache().getNode().getImmediateChild(t),f=s.applyMerge_(h,n);l=s.applyServerOverwrite_(l,new $(t),f,r,i,o,a)}})),l},e.prototype.ackUserWrite_=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),r,i,a,o);if(t.isEmpty()){var u=ct.Empty;return s.getNode().forEachChild(Te,(function(e,t){u=u.set(new $(e),t)})),this.applyServerMerge_(e,t,u,r,i,a,o)}return e}var l=ct.Empty;return n.foreach((function(e,n){var r=t.child(e);s.isCompleteForPath(r)&&(l=l.set(e,s.getNode().getChild(r)))})),this.applyServerMerge_(e,t,l,r,i,a,o)},e.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,_t,r)},e.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a=new bt(n,e,r),u=e.getEventCache().getNode(),l=void 0;if(t.isEmpty()||".priority"===t.getFront()){var c=void 0;if(e.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var h=e.getServerCache().getNode();s.assert(h instanceof je,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(h)}l=this.filter_.updateFullNode(u,c=c,i)}else{var f=t.getFront(),d=n.calcCompleteChild(f,e.getServerCache());null==d&&e.getServerCache().isCompleteForChild(f)&&(d=u.getImmediateChild(f)),(l=null!=d?this.filter_.updateChild(u,f,d,t.popFront(),a,i):e.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,je.EMPTY_NODE,t.popFront(),a,i):u).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(l=this.filter_.updateFullNode(l,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite($.Empty),e.updateEventSnap(l,o,this.filter_.filtersNodes())},e}(),kt=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach((function(e){e.type===gt.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(gt.childMovedChange(e.childName,e.snapshotNode))})),this.generateEventsForType_(i,gt.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,gt.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,gt.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,gt.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,gt.VALUE,e,n,t),i},e.prototype.generateEventsForType_=function(e,t,n,r,i){var o=this,a=n.filter((function(e){return e.type===t}));a.sort(this.compareChanges_.bind(this)),a.forEach((function(t){var n=o.materializeSingleChange_(t,i);r.forEach((function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.query_))}))}))},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw s.assertionError("Should only compare child_ events.");var n=new ke(e.childName,e.snapshotNode),r=new ke(t.childName,t.snapshotNode);return this.index_.compare(n,r)},e}(),Et=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new yt(n.getIndex()),i=n.getNodeFilter();this.processor_=new Ct(i);var o=t.getServerCache(),a=t.getEventCache(),s=r.updateFullNode(je.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(je.EMPTY_NODE,a.getNode(),null),l=new pt(s,o.isFullyInitialized(),r.filtersNodes()),c=new pt(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new vt(c,l),this.eventGenerator_=new kt(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){s.assert(null==e,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(e){var i=e.createCancelEvent(t=t,r);i&&n.push(i)}))}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},e.prototype.applyOperation=function(e,t,n){e.type===at.MERGE&&null!==e.source.queryId&&(s.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),s.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(i.viewCache),s.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(De,(function(e,t){n.push(gt.childAddedChange(e,t))})),t.isFullyInitialized()&&n.push(gt.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,n){return this.eventGenerator_.generateEventsForChanges(e,t,n?[n]:this.eventRegistrations_)},e}(),St=function(){function e(){this.views=new Map}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return s.assert(Ke,"Reference.ts has not been loaded"),Ke},set:function(e){s.assert(!Ke,"__referenceConstructor has already been defined"),Ke=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.views.size},e.prototype.applyOperation=function(e,t,n){var r,i,o=e.source.queryId;if(null!==o){var u=this.views.get(o);return s.assert(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(e,t,n)}var l=[];try{for(var c=a.__values(this.views.values()),h=c.next();!h.done;h=c.next())l=l.concat((u=h.value).applyOperation(e,t,n))}catch(f){r={error:f}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return l},e.prototype.addEventRegistration=function(e,t,n,r,i){var o=e.queryIdentifier(),a=this.views.get(o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof je?(s=n.calcCompleteEventChildren(r),u=!1):(s=je.EMPTY_NODE,u=!1);var l=new vt(new pt(s,u,!1),new pt(r,i,!1));a=new Et(e,l),this.views.set(o,a)}return a.addEventRegistration(t),a.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,n,r){var i,o,s=t.queryIdentifier(),u=[],l=[],c=this.hasCompleteView();if("default"===s)try{for(var h=a.__values(this.views.entries()),f=h.next();!f.done;f=h.next()){var d,p=a.__read(f.value,2),v=p[0];l=l.concat((d=p[1]).removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(v),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery()))}}catch(g){i={error:g}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(d=this.views.get(s))&&(l=l.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(s),d.getQuery().getQueryParams().loadsAllData()||u.push(d.getQuery())));return c&&!this.hasCompleteView()&&u.push(new e.__referenceConstructor(t.repo,t.path)),{removed:u,events:l}},e.prototype.getQueryViews=function(){var e,t,n=[];try{for(var r=a.__values(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.getCompleteServerCache=function(e){var t,n,r=null;try{for(var i=a.__values(this.views.values()),o=i.next();!o.done;o=i.next())r=r||o.value.getCompleteServerCache(e)}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return this.views.get(t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){var e,t;try{for(var n=a.__values(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},e}(),Tt=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new ct(n));var r=this.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=$.relativePath(i,t);return o=o.updateChild(a,n),new e(this.writeTree_.set(i,o))}var s=new ct(n);return new e(this.writeTree_.setTree(t,s))},e.prototype.addWrites=function(e,t){var n=this;return M(t,(function(t,r){n=n.addWrite(e.child(t),r)})),n},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,ct.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild($.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(De,(function(t,n){e.push(new ke(t,n))})):this.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new ke(t,n.value))})),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new ct(n):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(e){return function e(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal((function(n,o){".priority"===n?(s.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e(t.child(n),o,r)})),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i)),r}($.Empty,this.writeTree_,e)},e.Empty=new e(new ct(null)),e}(),It=function(){function e(){this.visibleWrites_=Tt.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new At(e,this)},e.prototype.addOverwrite=function(e,t,n,r){s.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},e.prototype.addMerge=function(e,t,n){s.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},e.prototype.removeWrite=function(e){var t=this,n=this.allWrites_.findIndex((function(t){return t.writeId===e}));s.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(o=!0)),a--}return!!i&&(o?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):M(r.children,(function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(r.path.child(e))})),!0))},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(t);return!i&&o.isEmpty()?n:i||null!=n||o.hasCompleteWrite($.Empty)?e.layerTree_(this.allWrites_,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))}),t).apply(n||je.EMPTY_NODE):null}var a=this.visibleWrites_.getCompleteNode(t);if(null!=a)return a;var s=this.visibleWrites_.childCompoundWrite(t);return s.isEmpty()?n:null!=n||s.hasCompleteWrite($.Empty)?s.apply(n||je.EMPTY_NODE):null},e.prototype.calcCompleteEventChildren=function(e,t){var n=je.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(De,(function(e,t){n=n.updateImmediateChild(e,t)})),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(De,(function(e,t){var r=i.childCompoundWrite(new $(e)).apply(t);n=n.updateImmediateChild(e,r)})),i.getCompleteChildren().forEach((function(e){n=n.updateImmediateChild(e.name,e.node)})),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach((function(e){n=n.updateImmediateChild(e.name,e.node)})),n},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){s.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(t):o.apply(r.getChild(t))},e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e),u=s.getCompleteNode($.Empty);if(null!=u)a=u;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var l=[],c=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();f&&l.length<r;)0!==c(f,n)&&l.push(f),f=h.getNext();return l},e.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&e.path.child(n).contains(t))return!0;return!1},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,$.Empty),this.lastWriteId_=this.allWrites_.length>0?this.allWrites_[this.allWrites_.length-1].writeId:-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,n){for(var r=Tt.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,u=void 0;if(o.snap)n.contains(a)?(u=$.relativePath(n,a),r=r.addWrite(u,o.snap)):a.contains(n)&&(u=$.relativePath(a,n),r=r.addWrite($.Empty,o.snap.getChild(u)));else{if(!o.children)throw s.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))u=$.relativePath(n,a),r=r.addWrites(u,o.children);else if(a.contains(n))if((u=$.relativePath(a,n)).isEmpty())r=r.addWrites($.Empty,o.children);else{var l=s.safeGet(o.children,u.getFront());if(l){var c=l.getChild(u.popFront());r=r.addWrite($.Empty,c)}}}}}return r},e}(),At=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),Nt=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=ct.Empty,this.pendingWriteTree_=new It,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new ft(st.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=ct.fromObject(t);return this.applyOperationToSyncPoints_(new dt(st.User,e,r))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=ct.Empty;return null!=n.snap?r=r.set($.Empty,!0):M(n.children,(function(e,t){r=r.set(new $(e),t)})),this.applyOperationToSyncPoints_(new ut(n.path,r,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new ft(st.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var n=ct.fromObject(t);return this.applyOperationToSyncPoints_(new dt(st.Server,e,n))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new ht(st.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,u=$.relativePath(a,t),l=new ft(st.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.queryKeyForTag_(r);if(i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,u=$.relativePath(a,t),l=ct.fromObject(n),c=new dt(st.forServerTaggedQuery(s),u,l);return this.applyTaggedOperation_(a,c)}return[]},e.prototype.applyTaggedListenComplete=function(t,n){var r=this.queryKeyForTag_(n);if(r){var i=e.parseQueryKey_(r),o=i.path,a=i.queryId,s=$.relativePath(o,t),u=new ht(st.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},e.prototype.addEventRegistration=function(t,n){var r=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,(function(e,t){var n=$.relativePath(e,r);i=i||t.getCompleteServerCache(n),o=o||t.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);u?(o=o||u.hasCompleteView(),i=i||u.getCompleteServerCache($.Empty)):(u=new St,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?a=!0:(a=!1,i=je.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(e,t){var n=t.getCompleteServerCache($.Empty);n&&(i=i.updateImmediateChild(e,n))})));var l=u.viewExistsForQuery(t);if(!l&&!t.getQueryParams().loadsAllData()){var c=e.makeQueryKey_(t);s.assert(!this.queryToTagMap.has(c),"View does not exist, but we have a tag");var h=e.getNextQueryTag_();this.queryToTagMap.set(c,h),this.tagToQueryMap.set(h,c)}var f=this.pendingWriteTree_.childWrites(r),d=u.addEventRegistration(t,n,f,i,a);if(!l&&!o){var p=u.viewForQuery(t);d=d.concat(this.setupListener_(t,p))}return d},e.prototype.removeEventRegistration=function(t,n,r){var i=this,o=t.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var u=a.removeEventRegistration(t,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var l=u.removed;s=u.events;var c=-1!==l.findIndex((function(e){return e.getQueryParams().loadsAllData()})),h=this.syncPointTree_.findOnPath(o,(function(e,t){return t.hasCompleteView()}));if(c&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(f),p=0;p<d.length;++p){var v=d[p],g=v.getQuery(),y=this.createListenerForView_(v);this.listenProvider_.startListening(e.queryForListening_(g),this.tagForQuery_(g),y.hashFn,y.onComplete)}}!h&&l.length>0&&!r&&(c?this.listenProvider_.stopListening(e.queryForListening_(t),null):l.forEach((function(t){var n=i.queryToTagMap.get(e.makeQueryKey_(t));i.listenProvider_.stopListening(e.queryForListening_(t),n)}))),this.removeTags_(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(e,(function(t,n){var r=$.relativePath(t,e),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(e,r,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold((function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),M(n,(function(e,t){r=r.concat(t)})),r}))},e.prototype.removeTags_=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,n){var r=t.path,i=this.tagForQuery_(t),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(e.queryForListening_(t),i,o.hashFn,o.onComplete),u=this.syncPointTree_.subtree(r);if(i)s.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var l=u.fold((function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map((function(e){return e.getQuery()})))),M(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<l.length;++c){var h=l[c];this.listenProvider_.stopListening(e.queryForListening_(h),this.tagForQuery_(h))}return a},e.prototype.createListenerForView_=function(e){var t=this,n=e.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(e.getServerCache()||je.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);return r.code=e.toUpperCase(),r}(e,n);return t.removeEventRegistration(n,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return s.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new $(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},e.prototype.tagForQuery_=function(t){var n=e.makeQueryKey_(t);return this.queryToTagMap.get(n)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);s.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,r,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites($.Empty))},e.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get($.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache($.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var l=n?n.getImmediateChild(a):null,c=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,l,c))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,n,r){var i=this,o=t.get($.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache($.Empty));var a=[];return t.children.inorderTraversal((function(t,o){var s=n?n.getImmediateChild(t):null,u=r.child(t),l=e.operationForChild(t);l&&(a=a.concat(i.applyOperationDescendantsHelper_(l,o,s,u)))})),o&&(a=a.concat(o.applyOperation(e,r,n))),a},e.nextQueryTag_=1,e}(),Dt=function(){function e(){this.rootNode_=je.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),xt=function(){function e(e,t){var n=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then((function(e){return n.auth_=e}))}return e.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(C("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):Promise.resolve(null)},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout((function(){return e(null)}),0),this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)})))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';T(e+="credential"in this.app_.options?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},e}(),Rt=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),s.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return s.deepCopy(this.counters_)},e}(),Ot=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new Rt),this.collections_[t]},e.getOrCreateReporter=function(e,t){var n=e.toString();return this.reporters_[n]||(this.reporters_[n]=t()),this.reporters_[n]},e.collections_={},e.reporters_={},e}(),Pt=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=a.__assign({},e);return this.last_&&M(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},e}(),Mt=1e4,Lt=3e4,Ft=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Pt(e);var n=Mt+(Lt-Mt)*Math.random();J(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;M(t,(function(t,i){i>0&&s.contains(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),J(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),Vt=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new Ut(i)),t.add(r)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_((function(t){return t.equals(e)}))},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_((function(t){return t.contains(e)||e.contains(t)}))},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1)}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),Ut=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();_&&C("event: "+t.toString()),Y(n)}}},e.prototype.getPath=function(){return this.path_},e}(),qt=function(){function e(e){this.allowedEvents_=e,this.listeners_={},s.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=a.__spread(this.listeners_[e]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){s.assert(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},e}(),Bt=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))}),!1),r}return a.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return s.assert("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(qt),jt=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||s.isMobileCordova()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return a.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return s.assert("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(qt),Wt=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Y((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},e}(),Ht="pLPCommand",zt="pRTLPCB",Qt=function(){function e(e,t,n,r){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=k(e),this.stats_=Ot.getCollection(t),this.urlFn=function(e){return t.connectionURL(ee,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Wt(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(s.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Gt((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=a.__read(e,5),i=r[0],o=r[1],s=r[2];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=o,n.password=s;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=a.__read(e,2),i=r[0],o=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!(s.isNodeSdk()||!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=s.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=s.base64Encode(t),r=P(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!s.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=s.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),Gt=function(){function e(t,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,s.isNodeSdk())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=g(),window[Ht+this.uniqueCallbackIdentifier]=t,window[zt+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(u){C("frame writing exception"),u.stack&&C(u.stack),C(u)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||C("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(t+=n,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))},e.prototype.addTag=function(e,t){var n=this;s.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){C("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},e}(),Kt="",Yt=null;"undefined"!=typeof MozWebSocket?Yt=MozWebSocket:"undefined"!=typeof WebSocket&&(Yt=WebSocket);var Xt=function(){function e(t,n,r,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=k(this.connId),this.stats_=Ot.getCollection(n),this.connURL=e.connectionURL_(n,r,i)}return e.connectionURL_=function(e,t,n){var r={v:"5"};return!s.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),e.connectionURL("websocket",r)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if(s.isNodeSdk()){var r={headers:{"User-Agent":"Firebase/5/"+Kt+"/"+process.platform+"/"+(s.CONSTANTS.NODE_ADMIN?"AdminNode":"Node")}},i=process.env,o=0===this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;o&&(r.proxy={origin:o}),this.mySock=new Yt(this.connURL,[],r)}else this.mySock=new Yt(this.connURL)}catch(u){this.log_("Error instantiating WebSocket.");var a=u.message||u.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==Yt&&!e.forceDisallow_},e.previouslyFailed=function(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){d.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=s.jsonEval(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(s.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=s.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=P(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),Jt=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Qt,Xt]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=Xt&&Xt.isAvailable(),o=i&&!Xt.previouslyFailed();if(t.webSocketOnly&&(i||T("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Xt];else{var s=this.transports_=[];try{for(var u=a.__values(e.ALL_TRANSPORTS),l=u.next();!l.done;l=u.next()){var c=l.value;c&&c.isAvailable()&&s.push(c)}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),$t=function(){function e(e,t,n,r,i,o,a){this.id=e,this.repoInfo_=t,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=k("c:"+this.id+":"),this.transportManager_=new Jt(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=J((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){this.sendData_({t:"d",d:e})},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=R("t",e),n=R("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=R("t",e),n=R("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=R("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?E("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&T("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),J((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):J((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),Zt=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),en=1e3,tn=3e5,nn=function(e){function t(n,r,i,o,a,u){var l=e.call(this)||this;if(l.repoInfo_=n,l.onDataUpdate_=r,l.onConnectStatus_=i,l.onServerInfoUpdate_=o,l.authTokenProvider_=a,l.authOverride_=u,l.id=t.nextPersistentConnectionId_++,l.log_=k("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingPutCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=en,l.maxReconnectDelay_=tn,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,u&&!s.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),Bt.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&jt.getInstance().on("online",l.onOnline_,l),l}return a.__extends(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(s.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;t.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))}))},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&s.contains(e,"w")){var n=s.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',i=t.path.toString();T("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||s.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=s.isValidFormat(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}},t.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)}))}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+s.stringify(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):E("Unrecognized action received from server: "+s.stringify(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=en),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this,a=this.lastSessionId,u=!1,l=null,c=function(){l?l.close():(u=!0,r())};this.realtime_={close:c,sendRequest:function(e){s.assert(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)}};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then((function(t){u?C("getToken() completed but was canceled"):(C("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,l=new $t(i,o.repoInfo_,e,n,r,(function(e){T(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")}),a))})).then(null,(function(e){o.log_("Failed to get token: "+e),u||(s.CONSTANTS.NODE_ADMIN&&T(e),c())}))}},t.prototype.interrupt=function(e){C("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){C("Resuming connection for reason: "+e),delete this.interruptReasons_[e],s.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map((function(e){return O(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new $(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){C("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=a.__values(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,a.__values(s.values())),l=u.next();!l.done;l=u.next())this.sendListen_(l.value)}catch(f){n={error:f}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){e={error:d}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var c=0;c<this.outstandingPuts_.length;c++)this.outstandingPuts_[c]&&this.sendPut_(c);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";s.CONSTANTS.NODE_ADMIN?t="admin_node":s.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+Kt.replace(/\./g,"-")]=1,s.isMobileCordova()?e["framework.cordova"]=1:s.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=jt.getInstance().currentlyOnline();return s.isEmpty(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(Zt),rn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=k("p:rest:"),i.listens_={},i}return a.__extends(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(s.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var u=t.getListenId_(e,r),l={};this.listens_[u]=l;var c=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,(function(e,t){var n=t;404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===l&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var o=i&&i.accessToken;o&&(t.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+s.querystring(t);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var e=null;if(u.status>=200&&u.status<300){try{e=s.jsonEval(u.responseText)}catch(t){T("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,e)}else 401!==u.status&&404!==u.status&&T("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},t}(Zt),on=function(){function e(e,t,n,r){var i=this;this.repoInfo_=e,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Vt,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new rt,this.persistentConnection_=null;var o=new xt(n,r);if(this.stats_=Ot.getCollection(e),t||X())this.server_=new rn(this.repoInfo_,this.onDataUpdate_.bind(this),o),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var a=n.options.databaseAuthVariableOverride;if(null!=a){if("object"!=typeof a)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{s.stringify(a)}catch(u){throw new Error("Invalid authOverride provided: "+u)}}this.persistentConnection_=new nn(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),o,a),this.server_=this.persistentConnection_}o.addTokenChangeListener((function(e){i.server_.refreshAuthToken(e)})),this.statsReporter_=Ot.getOrCreateReporter(e,(function(){return new Ft(i.stats_,i.server_)})),this.transactionsInit_(),this.infoData_=new Dt,this.infoSyncTree_=new Nt({startListening:function(e,t,n,r){var o=[],a=i.infoData_.getNode(e.path);return a.isEmpty()||(o=i.infoSyncTree_.applyServerOverwrite(e.path,a),setTimeout((function(){r("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Nt({startListening:function(e,t,n,r){return i.server_.listen(e,n,t,(function(t,n){var o=r(t,n);i.eventQueue_.raiseEventsForChangedPath(e.path,o)})),[]},stopListening:function(e,t){i.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new $(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},e.prototype.generateServerValues=function(){return(e=(e={timestamp:this.serverTime()})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e},e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new $(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(r)if(n){var a=s.map(t,(function(e){return ze(e)}));o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=ze(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var l=s.map(t,(function(e){return ze(e)}));o=this.serverSyncTree_.applyServerMerge(i,l)}else{var c=ze(t);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;M(e,(function(e,n){t.updateInfo_(e,n)}))},e.prototype.updateInfo_=function(e,t){var n=new $("/.info/"+e),r=ze(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,n,r){var i=this;this.log_("set",{path:e.toString(),value:t,priority:n});var o=this.generateServerValues(),a=ze(t,n),s=ot(a,o),u=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(e,s,u,!0);this.eventQueue_.queueEvents(l),this.server_.put(e.toString(),a.val(!0),(function(t,n){var o="ok"===t;o||T("set at "+e+" failed: "+t);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(e,a),i.callOnCompleteCallback(r,t,n)}));var c=this.abortTransactions_(e);this.rerunTransactions_(c),this.eventQueue_.raiseEventsForChangedPath(c,[])},e.prototype.update=function(e,t,n){var r=this;this.log_("update",{path:e.toString(),value:t});var i=!0,o=this.generateServerValues(),a={};if(M(t,(function(e,t){i=!1;var n=ze(t);a[e]=ot(n,o)})),i)C("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(e,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(e.toString(),t,(function(t,i){var o="ok"===t;o||T("update at "+e+" failed: "+t);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(e):e;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,t,i)})),M(t,(function(t){var n=r.abortTransactions_(e.child(t));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),n=function(e,t){var n=new rt;return e.forEachTree(new $(""),(function(e,r){n.remember(e,ot(r,t))})),n}(this.onDisconnect_,t),r=[];n.forEachTree($.Empty,(function(t,n){r=r.concat(e.serverSyncTree_.applyServerOverwrite(t,n));var i=e.abortTransactions_(t);e.rerunTransactions_(i)})),this.onDisconnect_=new rt,this.eventQueue_.raiseEventsForChangedPath($.Empty,r)},e.prototype.onDisconnectCancel=function(e,t){var n=this;this.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(e),n.callOnCompleteCallback(t,r,i)}))},e.prototype.onDisconnectSet=function(e,t,n){var r=this,i=ze(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),(function(t,o){"ok"===t&&r.onDisconnect_.remember(e,i),r.callOnCompleteCallback(n,t,o)}))},e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var i=this,o=ze(t,n);this.server_.onDisconnectPut(e.toString(),o.val(!0),(function(t,n){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(r,t,n)}))},e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if(s.isEmpty(t))return C("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(e.toString(),t,(function(i,o){"ok"===i&&M(t,(function(t,n){var i=ze(n);r.onDisconnect_.remember(e.child(t),i)})),r.callOnCompleteCallback(n,i,o)}))},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Pt(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var n=Object.keys(t).reduce((function(e,t){return Math.max(t.length,e)}),0);M(t,(function(e,t){for(var r=e,i=e.length;i<n+2;i++)r+=" ";console.log(r+t)}))}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),C.apply(void 0,a.__spread([n],e))},e.prototype.callOnCompleteCallback=function(e,t,n){e&&Y((function(){if("ok"===t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,e(o)}}))},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new vn(this))},enumerable:!0,configurable:!0}),e}(),an=function(){function e(t){this.indexedFilter_=new yt(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new ke(t,n))||(n=je.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=je.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(je.EMPTY_NODE);var i=this;return t.forEachChild(De,(function(e,t){i.matches(new ke(e,t))||(r=r.updateImmediateChild(e,je.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),sn=function(){function e(e){this.rangedFilter_=new an(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new ke(t,n))||(n=je.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=je.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=je.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(je.EMPTY_NODE);var s=void 0,u=void 0,l=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var c=this.index_.getCompare();l=function(e,t){return c(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&l(s,a)<=0&&(h=!0),h&&o<this.limit_&&l(a,u)<=0?o++:r=r.updateImmediateChild(a.name,je.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var u=e;s.assert(u.numChildren()===this.limit_,"");var l=new ke(t,n),c=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(u.hasChild(t)){for(var f=u.getImmediateChild(t),d=r.getChildAfterChild(this.index_,c,this.reverse_);null!=d&&(d.name===t||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:o(d,l);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(gt.childChangedChange(t,n,f)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(gt.childRemovedChange(t,f));var v=u.updateImmediateChild(t,je.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(gt.childAddedChange(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?e:h&&o(c,l)>=0?(null!=i&&(i.trackChildChange(gt.childRemovedChange(c.name,c.node)),i.trackChildChange(gt.childAddedChange(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(c.name,je.EMPTY_NODE)):e},e}(),un=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=De}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return s.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},e.prototype.limitToLast=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},e.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},e.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[t.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=r}return this.index_!==De&&(n[t.INDEX]=this.index_.toString()),n},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===De},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new yt(this.getIndex()):this.hasLimit()?new sn(this):new an(this)},e.prototype.toRestQueryStringParameters=function(){var t,n=e.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===De?t=n.PRIORITY_INDEX:this.index_===Ye?t=n.VALUE_INDEX:this.index_===Te?t=n.KEY_INDEX:(s.assert(this.index_ instanceof Xe,"Unrecognized index type!"),t=this.index_.toString()),r[n.ORDER_BY]=s.stringify(t),this.startSet_&&(r[n.START_AT]=s.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+s.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=s.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+s.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),ln=function(e){function t(t,n){if(!(t instanceof on))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,n,un.DEFAULT,!1)||this}return a.__extends(t,e),t.prototype.getKey=function(){return s.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return s.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof $||(null===this.path.getFront()?ge("Reference.child",1,e,!1):ve("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){s.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){s.validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){s.validateArgCount("Reference.set",1,2,arguments.length),ye("Reference.set",this.path),le("Reference.set",1,e,this.path,!1),s.validateCallback("Reference.set",2,t,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if(s.validateArgCount("Reference.update",1,2,arguments.length),ye("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,T("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}he("Reference.update",1,e,this.path,!1),s.validateCallback("Reference.update",2,t,!0);var i=new s.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if(s.validateArgCount("Reference.setWithPriority",2,3,arguments.length),ye("Reference.setWithPriority",this.path),le("Reference.setWithPriority",1,e,this.path,!1),fe("Reference.setWithPriority",2,t,!1),s.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new s.Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return s.validateArgCount("Reference.remove",0,1,arguments.length),ye("Reference.remove",this.path),s.validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,n){if(s.validateArgCount("Reference.transaction",1,3,arguments.length),ye("Reference.transaction",this.path),s.validateCallback("Reference.transaction",1,e,!1),s.validateCallback("Reference.transaction",2,t,!0),_e("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new s.Deferred;"function"==typeof t&&r.promise.catch((function(){}));var i=function(e,n,i){e?r.reject(e):r.resolve(new we(n,i)),"function"==typeof t&&t(e,n,i)};return this.repo.startTransaction(this.path,e,i,n),r.promise},t.prototype.setPriority=function(e,t){s.validateArgCount("Reference.setPriority",1,2,arguments.length),ye("Reference.setPriority",this.path),fe("Reference.setPriority",1,e,!1),s.validateCallback("Reference.setPriority",2,t,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){s.validateArgCount("Reference.push",0,2,arguments.length),ye("Reference.push",this.path),le("Reference.push",1,e,this.path,!0),s.validateCallback("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=Ce(r),o=this.child(i),a=this.child(i);return n=null!=e?o.set(e,t).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&n.catch((function(){})),o},t.prototype.onDisconnect=function(){return ye("Reference.onDisconnect",this.path),new be(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(nt);nt.__referenceConstructor=ln,St.__referenceConstructor=ln;var cn=function(){this.children={},this.childCount=0,this.value=null},hn=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new cn),this.name_=e,this.parent_=t,this.node_=n}return e.prototype.subTree=function(t){for(var n=t instanceof $?t:new $(t),r=this,i=n.getFront();null!==i;)r=new e(i,r,s.safeGet(r.node_.children,i)||new cn),i=(n=n.popFront()).getFront();return r},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){s.assert(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var n=this;M(this.node_.children,(function(r,i){t(new e(r,n,i))}))},e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild((function(t){t.forEachDescendant(e,!0,n)})),t&&n&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild((function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)}))},e.prototype.path=function(){return new $(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=s.contains(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}(),fn=function(e){return e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT",e}({});on.MAX_TRANSACTION_RETRIES_=25,on.prototype.transactionsInit_=function(){this.transactionQueueTree_=new hn},on.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);var i=function(){},o=new ln(this,e);o.on("value",i);var a={path:e,update:t,onComplete:n,status:null,order:g(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(e);a.currentInputSnapshot=u;var l=a.update(u.val());if(void 0===l){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var c=new Je(a.currentInputSnapshot,new ln(this,a.path),De);a.onComplete(null,!1,c)}}else{ce("transaction failed: Data returned ",l,a.path),a.status=fn.RUN;var h=this.transactionQueueTree_.subTree(e),f=h.getValue()||[];f.push(a),h.setValue(f);var d=void 0;"object"==typeof l&&null!==l&&s.contains(l,".priority")?(d=s.safeGet(l,".priority"),s.assert(ue(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(this.serverSyncTree_.calcCompleteEventCache(e)||je.EMPTY_NODE).getPriority().val(),d=d;var p=this.generateServerValues(),v=ze(l,d),y=ot(v,p);a.currentOutputSnapshotRaw=v,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(e,y,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,m),this.sendReadyTransactions_()}},on.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||je.EMPTY_NODE},on.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var n=this.buildTransactionQueue_(e);s.assert(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return e.status===fn.RUN}))&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild((function(e){t.sendReadyTransactions_(e)}))},on.prototype.sendTransactionQueue_=function(e,t){for(var n=this,r=t.map((function(e){return e.currentWriteId})),i=this.getLatestState_(e,r),o=i,a=i.hash(),u=0;u<t.length;u++){var l=t[u];s.assert(l.status===fn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=fn.SENT,l.retryCount++;var c=$.relativePath(e,l.path);o=o.updateChild(c,l.currentOutputSnapshotRaw)}var h=o.val(!0),f=e;this.server_.put(f.toString(),h,(function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<t.length;a++){if(t[a].status=fn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(t[a].currentWriteId)),t[a].onComplete){var s=t[a].currentOutputSnapshotResolved,u=new ln(n,t[a].path),l=new Je(s,u,De);o.push(t[a].onComplete.bind(null,null,!0,l))}t[a].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(e)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(e,i),a=0;a<o.length;a++)Y(o[a])}else{if("datastale"===r)for(a=0;a<t.length;a++)t[a].status=t[a].status===fn.SENT_NEEDS_ABORT?fn.NEEDS_ABORT:fn.RUN;else for(T("transaction at "+f.toString()+" failed: "+r),a=0;a<t.length;a++)t[a].status=fn.NEEDS_ABORT,t[a].abortReason=r;n.rerunTransactions_(e)}}),a)},on.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),n=t.path(),r=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(r,n),n},on.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],r=[],i=e.filter((function(e){return e.status===fn.RUN})).map((function(e){return e.currentWriteId})),o=0;o<e.length;o++){var a=e[o],u=$.relativePath(t,a.path),l=!1,c=void 0;if(s.assert(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===fn.NEEDS_ABORT)l=!0,c=a.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===fn.RUN)if(a.retryCount>=on.MAX_TRANSACTION_RETRIES_)l=!0,c="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var h=this.getLatestState_(a.path,i);a.currentInputSnapshot=h;var f=e[o].update(h.val());if(void 0!==f){ce("transaction failed: Data returned ",f,a.path);var d=ze(f);"object"==typeof f&&null!=f&&s.contains(f,".priority")||(d=d.updatePriority(h.getPriority()));var p=a.currentWriteId,v=this.generateServerValues(),g=ot(d,v);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(p),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(a.path,g,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else l=!0,c="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,r),r=[],l&&(e[o].status=fn.COMPLETED,setTimeout(e[o].unwatcher,Math.floor(0)),e[o].onComplete))if("nodata"===c){var y=new ln(this,e[o].path),m=new Je(e[o].currentInputSnapshot,y,De);n.push(e[o].onComplete.bind(null,null,!1,m))}else n.push(e[o].onComplete.bind(null,new Error(c),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),o=0;o<n.length;o++)Y(n[o]);this.sendReadyTransactions_()}},on.prototype.getAncestorTransactionNode_=function(e){var t,n=this.transactionQueueTree_;for(t=e.getFront();null!==t&&null===n.getValue();)n=n.subTree(t),t=(e=e.popFront()).getFront();return n},on.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort((function(e,t){return e.order-t.order})),t},on.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild((function(e){n.aggregateTransactionQueuesForNode_(e,t)}))},on.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==fn.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(n.length>0?n:null)}e.forEachChild((function(e){t.pruneCompletedTransactionsBelowNode_(e)}))},on.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),r=this.transactionQueueTree_.subTree(e);return r.forEachAncestor((function(e){t.abortTransactionsOnNode_(e)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(e){t.abortTransactionsOnNode_(e)})),n},on.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++)t[o].status===fn.SENT_NEEDS_ABORT||(t[o].status===fn.SENT?(s.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=fn.SENT_NEEDS_ABORT,t[o].abortReason="set"):(s.assert(t[o].status===fn.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r),o=0;o<n.length;o++)Y(n[o])}};var dn,pn=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return dn||(dn=new e),dn},e.prototype.interrupt=function(){var e,t,n,r;try{for(var i=a.__values(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,a.__values(Object.keys(this.repos_[s]))),l=u.next();!l.done;l=u.next())this.repos_[s][l.value].interrupt()}catch(c){n={error:c}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.resume=function(){var e,t,n,r;try{for(var i=a.__values(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,a.__values(Object.keys(this.repos_[s]))),l=u.next();!l.done;l=u.next())this.repos_[s][l.value].resume()}catch(c){n={error:c}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.databaseFromApp=function(e,t,n){var r=n||e.options.databaseURL;void 0===r&&S("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var i=ne(r),o=i.repoInfo,a=void 0;return"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a&&(o=(i=ne(r="http://"+a+"?ns="+o.namespace)).repoInfo),me("Invalid Firebase Database URL",1,i),i.path.isEmpty()||S("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(o,e,t).database},e.prototype.deleteRepo=function(e){var t=s.safeGet(this.repos_,e.app.name);t&&s.safeGet(t,e.repoInfo_.toURLString())===e||S("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t,n){var r=s.safeGet(this.repos_,t.name);r||(this.repos_[t.name]=r={});var i=s.safeGet(r,e.toURLString());return i&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new on(e,this.useRestClient_,t,n),r[e.toURLString()]=i,i},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),vn=function(){function e(e){this.repo_=e,e instanceof on||S("Don't call new Database() directly - please use firebase.database()."),this.root_=new ln(e,$.Empty),this.INTERNAL=new gn(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),s.validateArgCount("database.ref",0,1,arguments.length),e instanceof ln?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),s.validateArgCount(t,1,1,arguments.length);var n=ne(e);me(t,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&S(t+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&S("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){s.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){s.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),gn=function(){function e(e){this.database=e}return e.prototype.delete=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return this.database.checkDeleted_("delete"),pn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},e}(),yn=Object.freeze({__proto__:null,forceLongPolling:function(){Xt.forceDisallow(),Qt.forceAllow()},forceWebSockets:function(){Qt.forceDisallow()},isWebSocketsAvailable:function(){return Xt.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)}}),mn=nn;nn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},nn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var _n=Object.freeze({__proto__:null,DataConnection:mn,RealTimeConnection:$t,hijackHash:function(e){var t=nn.prototype.put;return nn.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){nn.prototype.put=t}},ConnectionTarget:te,queryIdentifier:function(e){return e.queryIdentifier()},forceRestClient:function(e){pn.getInstance().forceRestClient(e)}}),bn="@firebase/database",wn="0.5.18",Cn=vn.ServerValue;function kn(t){!function(e){Kt=e}(t.SDK_VERSION);var n=t.INTERNAL.registerComponent(new l.Component("database",(function(e,t){var n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal");return pn.getInstance().databaseFromApp(n,r,t)}),"PUBLIC").setServiceProps({Reference:ln,Query:nt,Database:vn,DataSnapshot:Je,enableLogging:w,INTERNAL:yn,ServerValue:Cn,TEST_ACCESS:_n}).setMultipleInstances(!0));t.registerVersion(bn,wn),s.isNodeSdk()&&(e.exports=n)}kn(o),t.DataSnapshot=Je,t.Database=vn,t.OnDisconnect=be,t.Query=nt,t.Reference=ln,t.ServerValue=Cn,t.enableLogging=w,t.registerDatabase=kn},"S+S0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mrSG"),i=n("zVF4"),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e}(),a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e="[DEFAULT]");var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=r.__assign({identifier:"[DEFAULT]",optional:!1},e),n=t.optional,i=this.normalizeInstanceIdentifier(t.identifier);try{var o=this.getOrInitializeService(i);if(!o){if(n)return null;throw Error("Service "+this.name+" is not available")}return o}catch(a){if(n)return null;throw a}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService("[DEFAULT]")}catch(c){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=r.__read(o.value,2),s=a[1],u=this.normalizeInstanceIdentifier(a[0]);try{var l=this.getOrInitializeService(u);s.resolve(l)}catch(c){}}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,function(e){return"[DEFAULT]"===e?void 0:e}(e)),this.instances.set(e,t)),t||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e}(),s=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=o,t.ComponentContainer=s,t.Provider=a},Wcq6:function(e,t,n){"use strict";var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;i.registerVersion("firebase","7.6.2","app"),e.exports=i},mrSG:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return l})),n.d(t,"__awaiter",(function(){return c})),n.d(t,"__generator",(function(){return h})),n.d(t,"__exportStar",(function(){return f})),n.d(t,"__values",(function(){return d})),n.d(t,"__read",(function(){return p})),n.d(t,"__spread",(function(){return v})),n.d(t,"__spreadArrays",(function(){return g})),n.d(t,"__await",(function(){return y})),n.d(t,"__asyncGenerator",(function(){return m})),n.d(t,"__asyncDelegator",(function(){return _})),n.d(t,"__asyncValues",(function(){return b})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return C})),n.d(t,"__importDefault",(function(){return k}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function m(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(u,l):c(o[0][2],n)}catch(r){c(o[0][3],r)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}},"q/0M":function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}n.r(t),n.d(t,"LogLevel",(function(){return o})),n.d(t,"Logger",(function(){return u})),n.d(t,"setLogLevel",(function(){return l}));var i=[],o=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}({}),a=o.INFO,s=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var a=(new Date).toISOString();switch(t){case o.DEBUG:case o.VERBOSE:console.log.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.INFO:console.info.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.WARN:console.warn.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.ERROR:console.error.apply(console,r(["["+a+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},u=function(){function e(e){this.name=e,this._logLevel=a,this._logHandler=s,i.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.ERROR],e))},e}();function l(e){i.forEach((function(t){t.logLevel=e}))}},wj3C:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=n("mrSG"),a=n("zVF4"),s=n("S+S0"),u=n("q/0M"),l=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),c=new a.ErrorFactory("app","Firebase",l),h="@firebase/app",f="[DEFAULT]",d=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.Logger("@firebase/app"),v=function(){function e(e,t,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(e),this.container=new s.ComponentContainer(t.name),this._addComponent(new s.Component("app",(function(){return u}),"PUBLIC"));try{for(var l=o.__values(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next())this._addComponent(c.value)}catch(h){r={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){return void 0===t&&(t=f),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=f),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){p.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},e}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!=typeof s||!s)throw c.create("bad-app-name",{appName:String(s)});if(a.contains(t,s))throw c.create("duplicate-app",{appName:s});var u=new e(n,o,r);return t[s]=u,u},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=d[e])&&void 0!==r?r:e;n&&(i+="-"+n);var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var l=['Unable to register library "'+i+'" with version "'+t+'":'];return o&&l.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&l.push("and"),a&&l.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void p.warn(l.join(" "))}u(new s.Component(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},apps:null,SDK_VERSION:"7.6.2",INTERNAL:{registerComponent:u,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function i(e){if(!a.contains(t,e=e||f))throw c.create("no-app",{appName:e});return t[e]}function u(s){var u,l,h=s.name;if(n.has(h))return p.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var f=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[h])throw c.create("invalid-app-argument",{appName:h});return e[h]()};void 0!==s.serviceProps&&a.deepExtend(f,s.serviceProps),r[h]=f,e.prototype[h]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?e:[])}}try{for(var d=o.__values(Object.keys(t)),v=d.next();!v.done;v=d.next())t[v.value]._addComponent(s)}catch(g){u={error:g}}finally{try{v&&!v.done&&(l=d.return)&&l.call(d)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r}(v);return t.INTERNAL=o.__assign(o.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){a.deepExtend(t,e)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),t}(),y=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t;return"VERSION"===(null===(t=e.getComponent())||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();if(a.isBrowser()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=g.initializeApp;g.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.isNode()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),_.apply(void 0,e)};var b=g;!function(e,t){e.INTERNAL.registerComponent(new s.Component("platform-logger",(function(e){return new y(e)}),"PRIVATE")),e.registerVersion(h,"0.5.1",void 0),e.registerVersion("fire-js","")}(b),t.default=b,t.firebase=b},x7I3:function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorCode",(function(){return sr})),n.d(t,"EventType",(function(){return ur})),n.d(t,"WebChannel",(function(){return lr})),n.d(t,"XhrIo",(function(){return cr})),n.d(t,"createWebChannelTransport",(function(){return ar}));var r,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=o||{},a=i;function s(e){return"string"==typeof e}function u(e){return"number"==typeof e}function l(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function c(){}function h(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function f(e){return"array"==h(e)}function d(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(e,t,n){return e.call.apply(e.bind,arguments)}function m(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _(e,t,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:m).apply(null,arguments)}function b(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var w=Date.now||function(){return+new Date};function C(e,t){function n(){}n.prototype=t.prototype,e.N=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.xb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function k(){this.j=this.j,this.i=this.i}k.prototype.j=!1,k.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[v]||(this[v]=++g))},k.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(s(e))return s(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},S=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=s(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function T(e){return Array.prototype.concat.apply([],arguments)}function I(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function A(e){return/^[\s\xa0]*$/.test(e)}var N,D=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function x(e,t){return-1!=e.indexOf(t)}function R(e,t){return e<t?-1:e>t?1:0}e:{var O=a.navigator;if(O){var P=O.userAgent;if(P){N=P;break e}}N=""}function M(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function L(e){var t,n={};for(t in e)n[t]=e[t];return n}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function U(e){return U[" "](e),e}U[" "]=c;var q,B,j=x(N,"Opera"),W=x(N,"Trident")||x(N,"MSIE"),H=x(N,"Edge"),z=H||W,Q=x(N,"Gecko")&&!(x(N.toLowerCase(),"webkit")&&!x(N,"Edge"))&&!(x(N,"Trident")||x(N,"MSIE"))&&!x(N,"Edge"),G=x(N.toLowerCase(),"webkit")&&!x(N,"Edge");function K(){var e=a.document;return e?e.documentMode:void 0}e:{var Y="",X=(B=N,Q?/rv:([^\);]+)(\)|;)/.exec(B):H?/Edge\/([\d\.]+)/.exec(B):W?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(B):G?/WebKit\/(\S+)/.exec(B):j?/(?:Version)[ \/]?(\S+)/.exec(B):void 0);if(X&&(Y=X?X[1]:""),W){var J=K();if(null!=J&&J>parseFloat(Y)){q=String(J);break e}}q=Y}var $,Z={};function ee(e){return function(e,t){var n=Z;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,(function(){for(var t=0,n=D(String(q)).split("."),r=D(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=R(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||R(0==a[2].length,0==s[2].length)||R(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}var te=a.document;$=te&&W?K()||("CSS1Compat"==te.compatMode?parseInt(q,10):5):void 0;var ne=!W||9<=Number($),re=W&&!ee("9"),ie=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",c,t),a.removeEventListener("test",c,t)}catch(n){}return e}();function oe(e,t){this.type=e,this.a=this.target=t,this.Ia=!0}function ae(e,t){if(oe.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(Q){e:{try{U(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=s(e.pointerType)?e.pointerType:se[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}oe.prototype.b=function(){this.Ia=!1},C(ae,oe);var se={2:"touch",3:"pen",4:"mouse"};ae.prototype.b=function(){ae.N.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,re)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}};var ue="closure_listenable_"+(1e6*Math.random()|0),le=0;function ce(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.da=i,this.key=++le,this.X=this.Z=!1}function he(e){e.X=!0,e.listener=null,e.proxy=null,e.src=null,e.da=null}function fe(e){this.src=e,this.a={},this.b=0}function de(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=E(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(he(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function pe(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.X&&o.listener==t&&o.capture==!!n&&o.da==r)return i}return-1}fe.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=pe(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new ce(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var ve="closure_lm_"+(1e6*Math.random()|0),ge={};function ye(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(f(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}return r=Ee(r),t&&t[ue]?t.Aa(n,r,p(i)?!!i.capture:!!i,o):me(t,n,r,!0,i,o)}(e,t,n,r,i);if(f(t)){for(var o=0;o<t.length;o++)ye(e,t[o],n,r,i);return null}return n=Ee(n),e&&e[ue]?e.za(t,n,p(r)?!!r.capture:!!r,i):me(e,t,n,!1,r,i)}function me(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i;if(a&&!ne)return null;var s=Ce(e);if(s||(e[ve]=s=new fe(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=we,t=ne?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ie||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function _e(e){if(!u(e)&&e&&!e.X){var t=e.src;if(t&&t[ue])de(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ce(t))?(de(n,e),0==n.b&&(n.src=null,t[ve]=null)):he(e)}}}function be(e){return e in ge?ge[e]:ge[e]="on"+e}function we(e,t){return!!e.X||function(e,t){var n=e.listener,r=e.da||e.src;return e.Z&&_e(e),n.call(r,t)}(e,ne?new ae(t,this):t=new ae(t||l("window.event"),this))}function Ce(e){return(e=e[ve])instanceof fe?e:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(e){return"function"==h(e)?e:(e[ke]||(e[ke]=function(t){return e.handleEvent(t)}),e[ke])}function Se(){k.call(this),this.c=new fe(this),this.J=this,this.B=null}function Te(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&de(e.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ia}C(Se,k),Se.prototype[ue]=!0,(r=Se.prototype).addEventListener=function(e,t,n,r){ye(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(f(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=Ee(r),t&&t[ue]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=pe(a=t.a[n],r,i,o))&&(he(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):t&&(t=Ce(t))&&(n=t.a[n.toString()],t=-1,n&&(t=pe(n,r,i,o)),(r=-1<t?n[t]:null)&&_e(r))}(this,e,t,n,r)},r.dispatchEvent=function(e){var t,n=this.B;if(n)for(t=[];n;n=n.B)t.push(n);n=this.J;var r=e.type||e;if(s(e))e=new oe(e,n);else if(e instanceof oe)e.target=e.target||n;else{var i=e;V(e=new oe(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.a=t[o];i=Te(a,r,!0,e)&&i}if(i=Te(a=e.a=n,r,!0,e)&&i,i=Te(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Te(a=e.a=t[o],r,!1,e)&&i;return i},r.G=function(){if(Se.N.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)he(n[r]);delete t.a[e],t.b--}}this.B=null},r.za=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},r.Aa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Ie=a.JSON.stringify;function Ae(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function Ne(){this.b=this.a=null}Ae.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var De,xe=new Ae((function(){return new Oe}),(function(e){e.reset()}));function Re(){var e=Fe,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function Oe(){this.next=this.b=this.a=null}function Pe(e){a.setTimeout((function(){throw e}),0)}function Me(e,t){De||function(){var e=a.Promise.resolve(void 0);De=function(){e.then(Ve)}}(),Le||(De(),Le=!0),Fe.add(e,t)}Ne.prototype.add=function(e,t){var n=xe.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Oe.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},Oe.prototype.reset=function(){this.next=this.b=this.a=null};var Le=!1,Fe=new Ne;function Ve(){for(var e;e=Re();){try{e.a.call(e.b)}catch(n){Pe(n)}var t=xe;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Le=!1}function Ue(e,t){Se.call(this),this.b=e||1,this.a=t||a,this.f=_(this.fb,this),this.g=w()}function qe(e){e.ba=!1,e.L&&(e.a.clearTimeout(e.L),e.L=null)}function Be(e,t,n){if("function"==h(e))n&&(e=_(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function je(e,t,n){k.call(this),this.f=null!=n?_(e,n):e,this.c=t,this.b=_(this.$a,this),this.a=[]}function We(e){e.U=Be(e.b,e.c),e.f.apply(null,e.a)}function He(e){k.call(this),this.b=e,this.a={}}C(Ue,Se),(r=Ue.prototype).ba=!1,r.L=null,r.fb=function(){if(this.ba){var e=w()-this.g;0<e&&e<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-e):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(qe(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){Ue.N.G.call(this),qe(this),delete this.a},C(je,k),(r=je.prototype).ea=!1,r.U=null,r.Ta=function(e){this.a=arguments,this.U?this.ea=!0:We(this)},r.G=function(){je.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.$a=function(){this.U=null,this.ea&&(this.ea=!1,We(this))},C(He,k);var ze=[];function Qe(e,t,n,r){f(n)||(n&&(ze[0]=n.toString()),n=ze);for(var i=0;i<n.length;i++){var o=ye(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Ge(e){M(e.a,(function(e,t){this.a.hasOwnProperty(t)&&_e(e)}),e),e.a={}}function Ke(){}He.prototype.G=function(){He.N.G.call(this),Ge(this)},He.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ye=new Se;function Xe(e){oe.call(this,"serverreachability",e)}function Je(e){Ye.dispatchEvent(new Xe(Ye,e))}function $e(e){oe.call(this,"statevent",e)}function Ze(e){Ye.dispatchEvent(new $e(Ye,e))}function et(e){oe.call(this,"timingevent",e)}function tt(e,t){if("function"!=h(e))throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}C(Xe,oe),C($e,oe),C(et,oe);var nt={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},rt={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function it(){}function ot(){}it.prototype.a=null;var at,st={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function ut(){oe.call(this,"d")}function lt(){oe.call(this,"c")}function ct(){}function ht(e,t,n){this.g=e,this.W=t,this.V=n||1,this.I=new He(this),this.O=ft,this.P=new Ue(e=z?125:void 0),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}C(ut,oe),C(lt,oe),C(ct,it),at=new ct;var ft=45e3,dt={},pt={};function vt(e,t,n){e.F=1,e.f=qt(Ot(t)),e.l=n,e.H=!0,yt(e,null)}function gt(e,t,n,r){e.F=1,e.f=qt(Ot(t)),e.l=null,e.H=n,yt(e,r)}function yt(e,t){e.v=w(),bt(e),e.D=Ot(e.f),Ut(e.D,"t",e.V),e.A=0,e.a=e.g.$(e.g.Y()?t:null),0<e.J&&(e.B=new je(_(e.Ja,e,e.a),e.J)),Qe(e.I,e.a,"readystatechange",e.cb),t=e.h?L(e.h):{},e.l?(e.w||(e.w="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ca(e.D,e.w,e.l,t)):(e.w="GET",e.a.ca(e.D,e.w,null,t)),Je(1)}function mt(e,t,n){for(var r=!0;!e.m&&e.A<n.length;){var i=_t(e,n);if(i==pt){4==t&&(e.c=4,Ze(14),r=!1);break}if(i==dt){e.c=4,Ze(15),r=!1;break}St(e,i)}4==t&&0==n.length&&(e.c=1,Ze(16),r=!1),e.b=e.b&&r,r||(Et(e),kt(e))}function _t(e,t){var n=e.A,r=t.indexOf("\n",n);return-1==r?pt:(n=Number(t.substring(n,r)),isNaN(n)?dt:(r+=1)+n>t.length?pt:(t=t.substr(r,n),e.A=r+n,t))}function bt(e){e.R=w()+e.O,wt(e,e.O)}function wt(e,t){if(null!=e.i)throw Error("WatchDog timer not null");e.i=tt(_(e.ab,e),t)}function Ct(e){e.i&&(a.clearTimeout(e.i),e.i=null)}function kt(e){e.g.Ca()||e.m||e.g.na(e)}function Et(e){Ct(e);var t=e.B;t&&"function"==typeof t.la&&t.la(),e.B=null,qe(e.P),Ge(e.I),e.a&&(t=e.a,e.a=null,t.abort(),t.la())}function St(e,t){try{e.g.Fa(e,t),Je(4)}catch(n){}}function Tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||s(e))S(e,t,void 0);else{if(e.K&&"function"==typeof e.K)var n=e.K();else if(e.C&&"function"==typeof e.C)n=void 0;else if(d(e)||s(e)){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.C&&"function"==typeof e.C)return e.C();if(s(e))return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function It(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof It)for(n=e.K(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function At(e,t){Dt(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Nt(e))}function Nt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Dt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Dt(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Dt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(r=ht.prototype).setTimeout=function(e){this.O=e},r.cb=function(e){e=e.target;var t=this.B;t&&3==On(e)?t.Ta():this.Ja(e)},r.Ja=function(e){try{if(e==this.a)e:{var t=On(this.a),n=this.a.ya(),r=this.a.T();if(!(3>t||3==t&&!z&&!this.a.aa())){this.m||4!=t||7==n||Je(8==n||0>=r?3:2),Ct(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){t:{if(this.a){var a=Pn(this.a,"X-HTTP-Initial-Response");if(a&&!A(a)){var s=a;break t}}s=null}if(!s){this.b=!1,this.c=3,Ze(12),Et(this),kt(this);break e}this.s=!0,St(this,s)}this.H?(mt(this,t,o),z&&this.b&&3==t&&(Qe(this.I,this.P,"tick",this.bb),this.P.start())):St(this,o),4==t&&Et(this),this.b&&!this.m&&(4==t?this.g.na(this):(this.b=!1,bt(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Ze(12)):(this.c=0,Ze(13)),Et(this),kt(this)}}}catch(u){}},r.bb=function(){if(this.a){var e=On(this.a),t=this.a.aa();this.A<t.length&&(Ct(this),mt(this,e,t),this.b&&4!=e&&bt(this))}},r.cancel=function(){this.m=!0,Et(this)},r.ab=function(){this.i=null;var e=w();0<=e-this.R?(2!=this.F&&(Je(3),Ze(17)),Et(this),this.c=2,kt(this)):wt(this,this.R-e)},(r=It.prototype).C=function(){Nt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},r.K=function(){return Nt(this),this.a.concat()},r.get=function(e,t){return Dt(this.b,e)?this.b[e]:t},r.set=function(e,t){Dt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},r.forEach=function(e,t){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var xt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rt(e,t){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,e instanceof Rt?(this.h=void 0!==t?t:e.h,Pt(this,e.f),this.j=e.j,Mt(this,e.b),Lt(this,e.i),this.a=e.a,Ft(this,en(e.c)),this.g=e.g):e&&(n=String(e).match(xt))?(this.h=!!t,Pt(this,n[1]||"",!0),this.j=Bt(n[2]||""),Mt(this,n[3]||"",!0),Lt(this,n[4]),this.a=Bt(n[5]||"",!0),Ft(this,n[6]||"",!0),this.g=Bt(n[7]||"")):(this.h=!!t,this.c=new Yt(null,this.h))}function Ot(e){return new Rt(e)}function Pt(e,t,n){e.f=n?Bt(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Mt(e,t,n){e.b=n?Bt(t,!0):t}function Lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.i=t}else e.i=null}function Ft(e,t,n){t instanceof Yt?(e.c=t,function(e,t){t&&!e.f&&(Xt(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Jt(this,t),Zt(this,n,e))}),e)),e.f=t}(e.c,e.h)):(n||(t=jt(t,Gt)),e.c=new Yt(t,e.h))}function Vt(e,t,n){e.c.set(t,n)}function Ut(e,t,n){f(n)||(n=[String(n)]),Zt(e.c,t,n)}function qt(e){return Vt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),e}function Bt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function jt(e,t,n){return s(e)?(e=encodeURI(e).replace(t,Wt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Wt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Rt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(jt(t,Ht,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(jt(t,Ht,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(jt(n,"/"==n.charAt(0)?Qt:zt,!0))),(n=this.c.toString())&&e.push("?",n),(n=this.g)&&e.push("#",jt(n,Kt)),e.join("")},Rt.prototype.resolve=function(e){var t=Ot(this),n=!!e.f;n?Pt(t,e.f):n=!!e.j,n?t.j=e.j:n=!!e.b,n?Mt(t,e.b):n=null!=e.i;var r=e.a;if(n)Lt(t,e.i);else if(n=!!e.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=t.a.lastIndexOf("/");-1!=i&&(r=t.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(x(i,"./")||x(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.a=r:n=""!==e.c.toString(),n?Ft(t,en(e.c)):n=!!e.g,n&&(t.g=e.g),t};var Ht=/[#\/\?@]/g,zt=/[#\?:]/g,Qt=/[#\?]/g,Gt=/[#\?@]/g,Kt=/#/g;function Yt(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Xt(e){e.a||(e.a=new It,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Jt(e,t){Xt(e),t=tn(e,t),Dt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,At(e.a,t))}function $t(e,t){return Xt(e),t=tn(e,t),Dt(e.a.b,t)}function Zt(e,t,n){Jt(e,t),0<n.length&&(e.c=null,e.a.set(tn(e,t),I(n)),e.b+=n.length)}function en(e){var t=new Yt;return t.c=e.c,e.a&&(t.a=new It(e.a),t.b=e.b),t}function tn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function nn(e){this.a=e,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function rn(e){var t=e.a.F.a;if(null!=t)Ze(4),t?(Ze(10),Qn(e.a,e,!1)):(Ze(11),Qn(e.a,e,!0));else{e.b=new ht(e,void 0,void 0),e.b.h=e.h,t=Jn(t=e.a,t.Y()?e.f:null,e.i),Ze(4),Ut(t,"TYPE","xmlhttp");var n=e.a.j,r=e.a.I;n&&r&&Vt(t,n,r),gt(e.b,t,!1,e.f)}}function on(){this.a=this.b=null}function an(){this.a=new It}function sn(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[v]||(e[v]=++g)):t.charAt(0)+e}function un(e,t){this.b=e,this.a=t}function ln(e){this.g=e||cn,e=a.PerformanceNavigationTiming?0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.ka&&a.ka.Da&&a.ka.Da()&&a.ka.Da().yb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new an),this.b=null,this.c=[]}(r=Yt.prototype).add=function(e,t){Xt(this),this.c=null,e=tn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},r.forEach=function(e,t){Xt(this),this.a.forEach((function(n,r){S(n,(function(n){e.call(t,n,r,this)}),this)}),this)},r.K=function(){Xt(this);for(var e=this.a.C(),t=this.a.K(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},r.C=function(e){Xt(this);var t=[];if(s(e))$t(this,e)&&(t=T(t,this.a.get(tn(this,e))));else{e=this.a.C();for(var n=0;n<e.length;n++)t=T(t,e[n])}return t},r.set=function(e,t){return Xt(this),this.c=null,$t(this,e=tn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},r.get=function(e,t){return e&&0<(e=this.C(e)).length?String(e[0]):t},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.K(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")},C((function(){}),(function(){})),(r=nn.prototype).M=null,r.$=function(e){return this.a.$(e)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Ca=function(){return!1},r.Fa=function(e,t){if(this.c=e.o,0==this.M){if(!this.a.o&&(e=e.a)){var n=Pn(e,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(e=Pn(e,"X-HTTP-Session-Id"))&&(this.a.I=e)}if(t){try{var r=this.a.ja.a.parse(t)}catch(i){return(t=this.a).m=this.c,void Yn(t,2)}this.f=r[0]}else(t=this.a).m=this.c,Yn(t,2)}else 1==this.M&&(this.g?Ze(6):"11111"==t?(Ze(5),this.g=!0,(!W||10<=Number($))&&(this.c=200,this.b.cancel(),Ze(11),Qn(this.a,this,!0))):(Ze(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,rn(this)):1==this.M&&(this.g?(Ze(11),Qn(this.a,this,!0)):(Ze(10),Qn(this.a,this,!1)));else{0==this.M?Ze(8):1==this.M&&Ze(9);var e=this.a;e.m=this.c,Yn(e,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},an.prototype.add=function(e){this.a.set(sn(e),e)},an.prototype.C=function(){return this.a.C()};var cn=10;function hn(e,t){!e.a&&(x(t,"spdy")||x(t,"quic")||x(t,"h2"))&&(e.f=e.g,e.a=new an,e.b&&(vn(e,e.b),e.b=null))}function fn(e){return!!e.b||!!e.a&&e.a.a.c>=e.f}function dn(e){return e.b?1:e.a?e.a.a.c:0}function pn(e,t){return e.b?e=e.b==t:e.a?(t=sn(t),e=Dt(e.a.a.b,t)):e=!1,e}function vn(e,t){e.a?e.a.add(t):e.b=t}function gn(e,t){var n;e.b&&e.b==t?e.b=null:((n=e.a)&&(n=sn(t),n=Dt(e.a.a.b,n)),n&&At(e.a.a,sn(t)))}function yn(e){if(null!=e.b)return e.c.concat(e.b.j);if(null!=e.a&&0!=e.a.a.c){var t=e.c;return S(e.a.C(),(function(e){t=t.concat(e.j)})),t}return I(e.c)}function mn(){}function _n(){this.a=new mn}function bn(e,t,n){var r=n||"";try{Tt(e,(function(e,n){var i=e;p(e)&&(i=Ie(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function wn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(o){}}ln.prototype.cancel=function(){this.c=yn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(S(this.a.C(),(function(e){e.cancel()})),function(e){e.b={},e.a.length=0,e.c=0}(this.a.a))},mn.prototype.stringify=function(e){return a.JSON.stringify(e,void 0)},mn.prototype.parse=function(e){return a.JSON.parse(e,void 0)};var Cn=a.JSON.parse;function kn(e){Se.call(this),this.headers=new It,this.H=e||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=En,this.D=this.F=!1}C(kn,Se);var En="",Sn=/^https?$/i,Tn=["POST","PUT"];function In(e){return"content-type"==e.toLowerCase()}function An(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Nn(e),xn(e)}function Nn(e){e.v||(e.v=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Dn(e){if(e.b&&void 0!==o&&(!e.s[1]||4!=On(e)||2!=e.T()))if(e.l&&4==On(e))Be(e.Ea,0,e);else if(e.dispatchEvent("readystatechange"),4==On(e)){e.b=!1;try{var t,n=e.T();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.A).match(xt)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!Sn.test(s?s.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{e.h=6;try{var l=2<On(e)?e.a.statusText:""}catch(c){l=""}e.f=l+" ["+e.T()+"]",Nn(e)}}finally{xn(e)}}}function xn(e,t){if(e.a){Rn(e);var n=e.a,r=e.s[0]?c:null;e.a=null,e.s=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Rn(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(a.clearTimeout(e.m),e.m=null)}function On(e){return e.a?e.a.readyState:0}function Pn(e,t){return e.a?e.a.getResponseHeader(t):null}function Mn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}if(r)return e;if(n=function(e){var t="";return M(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),s(e)){if(t=encodeURIComponent(String(t)),t+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=e.indexOf("#"))&&(n=e.length),0>(r=e.indexOf("?"))||r>n){r=n;var i=""}else i=e.substring(r+1,n);n=(e=[e.substr(0,r),i,e.substr(n)])[1],e[1]=t?n?n+"&"+t:t:n,e=e[0]+(e[1]?"?"+e[1]:"")+e[2]}return e}return Vt(e,t,n),e}function Ln(e){this.f=[],this.F=new on,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!l("internalChannelParams.failFast",e),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=l("internalChannelParams.baseRetryDelayMs",e)||5e3,this.Ra=l("internalChannelParams.retryDelaySeedMs",e)||1e4,this.Pa=l("internalChannelParams.forwardChannelMaxRetries",e)||2,this.qa=l("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.Ka=e&&e.zb||void 0,this.D=void 0,this.R=e&&e.supportsCrossDomainXhr||!1,this.H="",this.b=new ln(e&&e.concurrentRequestLimit),this.ja=new _n,this.o=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.W=e&&e.fastHandshake||!1)&&!this.o&&(this.o=!0),e&&e.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Fn(e){if(Vn(e),3==e.u){var t=e.P++,n=Ot(e.B);Vt(n,"SID",e.H),Vt(n,"RID",t),Vt(n,"TYPE","terminate"),jn(e,n),(t=new ht(e,t,void 0)).F=2,t.f=qt(Ot(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(t.f.toString(),"")),!n&&a.Image&&((new Image).src=t.f,n=!0),n||(t.a=t.g.$(null),t.a.ca(t.f)),t.v=w(),bt(t)}Xn(e)}function Vn(e){e.w&&(e.w.abort(),e.w=null),e.a&&(e.a.cancel(),e.a=null),e.l&&(a.clearTimeout(e.l),e.l=null),Gn(e),e.b.cancel(),e.h&&(u(e.h)&&a.clearTimeout(e.h),e.h=null)}function Un(e,t){e.f.push(new un(e.Qa++,t)),3==e.u&&qn(e)}function qn(e){fn(e.b)||e.h||(e.h=!0,Me(e.Ha,e),e.A=0)}function Bn(e,t){var n;n=t?t.W:e.P++;var r=Ot(e.B);Vt(r,"SID",e.H),Vt(r,"RID",n),Vt(r,"AID",e.O),jn(e,r),e.g&&e.i&&Mn(r,e.g,e.i),n=new ht(e,n,e.A+1),null===e.g&&(n.h=e.i),t&&(e.f=t.j.concat(e.f)),t=Wn(e,n,1e3),n.setTimeout(Math.round(.5*e.qa)+Math.round(.5*e.qa*Math.random())),vn(e.b,n),vt(n,r,t)}function jn(e,t){e.c&&Tt({},(function(e,n){Vt(t,n,e)}))}function Wn(e,t,n){n=Math.min(e.f.length,n);var r=e.c?_(e.c.Sa,e.c,e):null;e:for(var i=e.f,o=-1;;){var a=["count="+n];-1==o?0<n?a.push("ofs="+(o=i[0].b)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var l=i[u].b,c=i[u].a;if(0>(l-=o))o=Math.max(0,i[u].b-100),s=!1;else try{bn(c,a,"req"+l+"_")}catch(h){r&&r(c)}}if(s){r=a.join("&");break e}}return e=e.f.splice(0,n),t.j=e,r}function Hn(e){e.a||e.l||(e.S=1,Me(e.Ga,e),e.v=0)}function zn(e){return!(e.a||e.l||3<=e.v||(e.S++,e.l=tt(_(e.Ga,e),Kn(e,e.v)),e.v++,0))}function Qn(e,t,n){var r=t.l;r&&hn(e.b,r),e.ia=e.oa&&n,e.m=t.c,e.B=Jn(e,null,e.ha),qn(e)}function Gn(e){null!=e.s&&(a.clearTimeout(e.s),e.s=null)}function Kn(e,t){var n=e.Na+Math.floor(Math.random()*e.Ra);return e.ma()||(n*=2),n*t}function Yn(e,t){if(2==t){var n=null;e.c&&(n=null);var r=_(e.eb,e);n||(n=new Rt("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Pt(n,"https"),qt(n)),function(e,t){var n=new Ke;if(a.Image){var r=new Image;r.onload=b(wn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=b(wn,n,r,"TestLoadImage: error",!1,t),r.onabort=b(wn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=b(wn,n,r,"TestLoadImage: timeout",!1,t),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Ze(2);e.u=0,e.c&&e.c.ta(t),Xn(e),Vn(e)}function Xn(e){e.u=0,e.m=-1,e.c&&(0==yn(e.b).length&&0==e.f.length||(e.b.c.length=0,I(e.f),e.f.length=0),e.c.sa())}function Jn(e,t,n){var r=function(e){return e instanceof Rt?Ot(e):new Rt(e,void 0)}(n);if(""!=r.b)t&&Mt(r,t+"."+r.b),Lt(r,r.i);else{var i=a.location;r=function(e,t,n,r){var i=new Rt(null,void 0);return e&&Pt(i,e),t&&Mt(i,t),n&&Lt(i,n),r&&(i.a=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&M(e.V,(function(e,t){Vt(r,t,e)})),n=e.I,(t=e.j)&&n&&Vt(r,t,n),Vt(r,"VER",e.wa),jn(e,r),r}function $n(){}function Zn(){if(W&&!(10<=Number($)))throw Error("Environmental error: no available transport.")}function er(e,t){Se.call(this),this.a=new Ln(t),this.g=e,this.m=t&&t.testUrl?t.testUrl:function(e){for(var t=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?t=i:((r=""==t)||(r=0<=(r=t.length-1)&&t.indexOf("/",r)==r),t+=r?i:"/"+i)}return t}(this.g,"test"),this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.i=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.xa&&(e?e["X-WebChannel-Client-Profile"]=t.xa:e={"X-WebChannel-Client-Profile":t.xa}),this.a.J=e,(e=t&&t.httpHeadersOverwriteParam)&&!A(e)&&(this.a.g=e),this.l=t&&t.supportsCrossDomainXhr||!1,this.h=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!A(t)&&(this.a.j=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new rr(this)}function tr(e){ut.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function nr(){lt.call(this),this.status=1}function rr(e){this.a=e}(r=kn.prototype).ca=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+e);t=t?t.toUpperCase():"GET",this.A=e,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(e){var t;return(t=e.a)||(t=e.a={}),t}(this.H?this.H:at),this.a.onreadystatechange=_(this.Ea,this);try{this.w=!0,this.a.open(t,String(e),!0),this.w=!1}catch(o){return void An(this,o)}e=n||"";var i=new It(this.headers);r&&Tt(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=In,n=e.length,r=s(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:s(e)?e.charAt(t):e[t]}(i.K()),n=a.FormData&&e instanceof a.FormData,!(0<=E(Tn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=function(e){return W&&ee(9)&&u(e.timeout)&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.Ba,this)):this.m=Be(this.Ba,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(o){An(this,o)}},r.Ba=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),kn.N.G.call(this)},r.Ea=function(){this.j||(this.w||this.l||this.g?Dn(this):this.Za())},r.Za=function(){Dn(this)},r.T=function(){try{return 2<On(this)?this.a.status:-1}catch(B){return-1}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(B){return""}},r.Ua=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Cn(t)}},r.ya=function(){return this.h},r.Xa=function(){return s(this.f)?this.f:String(this.f)},(r=Ln.prototype).wa=8,r.u=1,r.Ca=function(){return 0==this.u},r.Ha=function(e){if(this.h)if(this.h=null,1==this.u){if(!e){this.P=Math.floor(1e5*Math.random());var t,n=new ht(this,e=this.P++,void 0),r=this.i;if(this.J&&(r?V(r=L(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)e:{for(var i=t=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&s(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.f.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Wn(this,n,t),Vt(i=Ot(this.B),"RID",e),Vt(i,"CVER",22),this.o&&this.j&&Vt(i,"X-HTTP-Session-Id",this.j),jn(this,i),this.g&&r&&Mn(i,this.g,r),vn(this.b,n),this.W?(Vt(i,"$req",t),Vt(i,"SID","null"),n.S=!0,vt(n,i,null)):vt(n,i,t),this.u=2}}else 3==this.u&&(e?Bn(this,e):0==this.f.length||fn(this.b)||Bn(this))},r.Ga=function(){this.l=null,this.a=new ht(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var e=Ot(this.pa);Vt(e,"RID","rpc"),Vt(e,"SID",this.H),Vt(e,"CI",this.ia?"0":"1"),Vt(e,"AID",this.O),jn(this,e),Vt(e,"TYPE","xmlhttp"),this.g&&this.i&&Mn(e,this.g,this.i),this.D&&this.a.setTimeout(this.D),gt(this.a,e,!0,this.ga)},r.Fa=function(e,t){if(0!=this.u&&(this.a==e||pn(this.b,e)))if(this.m=e.o,!e.s&&pn(this.b,e)&&3==this.u){try{var n=this.ja.a.parse(t)}catch(o){n=null}if(f(n)&&3==n.length){if(0==(t=n)[0]){e:if(!this.l){if(this.a){if(!(this.a.v+3e3<e.v))break e;Gn(this),this.a.cancel(),this.a=null}zn(this),Ze(18)}}else this.ra=t[1],0<this.ra-this.O&&37500>t[2]&&this.ia&&0==this.v&&!this.s&&(this.s=tt(_(this.Ya,this),6e3));if(1>=dn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else Yn(this,11)}else if((e.s||this.a==e)&&Gn(this),!A(t))for(t=n=this.ja.a.parse(t),n=0;n<t.length;n++){var r=t[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=e.a)&&((i=Pn(r,"X-Client-Wire-Protocol"))&&hn(this.b,i),this.j&&(r=Pn(r,"X-HTTP-Session-Id")))&&(this.I=r,Vt(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=e,this.pa=Jn(this,this.Y()?this.ga:null,this.ha),r.s?(gn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ct(r),bt(r)),this.a=r):Hn(this),0<this.f.length&&qn(this)}else"stop"!=r[0]&&"close"!=r[0]||Yn(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Yn(this,7):Fn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,zn(this),Ze(19))},r.na=function(e){var t=null;if(this.a==e){Gn(this),this.a=null;var n=2}else{if(!pn(this.b,e))return;t=e.j,gn(this.b,e),n=1}if(this.m=e.o,0!=this.u)if(e.b)1==n?(t=w()-e.v,Ye.dispatchEvent(new et(Ye,e.l?e.l.length:0,t,this.A)),qn(this)):Hn(this);else{var r=e.c;if(3==r||0==r&&0<this.m||!(1==n&&function(e,t){return!(dn(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=t.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Oa?0:e.Pa)||(e.h=tt(_(e.Ha,e,t),Kn(e,e.A)),e.A++,0)))}(this,e)||2==n&&zn(this)))switch(t&&0<t.length&&(e=this.b,e.c=e.c.concat(t)),r){case 1:Yn(this,5);break;case 4:Yn(this,10);break;case 3:Yn(this,6);break;default:Yn(this,2)}}},r.eb=function(e){Ze(e?2:1)},r.$=function(e){if(e&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(this.Ka)).F=this.R,e},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=$n.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Sa=function(){},Zn.prototype.a=function(e,t){return new er(e,t)},C(er,Se),(r=er.prototype).addEventListener=function(e,t,n,r){er.N.addEventListener.call(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){er.N.removeEventListener.call(this,e,t,n,r)},r.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var e=this.a,t=this.m,n=this.g,r=this.b||void 0;Ze(0),e.ha=n,e.V=r||{},e.o&&(e.F.b=[],e.F.a=!1),e.w=new nn(e),null===e.g&&(e.w.h=e.i),n=t,e.g&&e.i&&(n=Mn(t,e.g,e.i)),(e=e.w).i=n,t=Jn(e.a,null,e.i),Ze(3),null!=(n=e.a.F.b)?(e.f=n[0],e.M=1,rn(e)):(Ut(t,"MODE","init"),!e.a.o&&e.a.j&&Ut(t,"X-HTTP-Session-Id",e.a.j),e.b=new ht(e,void 0,void 0),e.b.h=e.h,gt(e.b,t,!1,null),e.M=0)},r.close=function(){Fn(this.a)},r.Wa=function(e){if(s(e)){var t={};t.__data__=e,Un(this.a,t)}else this.h?((t={}).__data__=Ie(e),Un(this.a,t)):Un(this.a,e)},r.G=function(){this.a.c=null,delete this.f,Fn(this.a),delete this.a,er.N.G.call(this)},C(tr,ut),C(nr,lt),C(rr,$n),rr.prototype.va=function(){this.a.dispatchEvent("a")},rr.prototype.ua=function(e){this.a.dispatchEvent(new tr(e))},rr.prototype.ta=function(e){this.a.dispatchEvent(new nr(e))},rr.prototype.sa=function(){this.a.dispatchEvent("b")};var ir=b((function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r}),Zn);Zn.prototype.createWebChannel=Zn.prototype.a,er.prototype.send=er.prototype.Wa,er.prototype.open=er.prototype.Va,er.prototype.close=er.prototype.close,nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,rt.COMPLETE="complete",ot.EventType=st,st.OPEN="a",st.CLOSE="b",st.ERROR="c",st.MESSAGE="d",Se.prototype.listen=Se.prototype.za,kn.prototype.listenOnce=kn.prototype.Aa,kn.prototype.getLastError=kn.prototype.Xa,kn.prototype.getLastErrorCode=kn.prototype.ya,kn.prototype.getStatus=kn.prototype.T,kn.prototype.getResponseJson=kn.prototype.Ua,kn.prototype.getResponseText=kn.prototype.aa,kn.prototype.send=kn.prototype.ca;var or={createWebChannelTransport:ir,ErrorCode:nt,EventType:rt,WebChannel:ot,XhrIo:kn},ar=or.createWebChannelTransport,sr=or.ErrorCode,ur=or.EventType,lr=or.WebChannel,cr=or.XhrIo;t.default=or},zUnb:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.r(t);var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=e},get useDeprecatedSynchronousErrorHandling(){return i}};function a(e){setTimeout((function(){throw e}))}var s={closed:!0,next:function(e){},error:function(e){if(o.useDeprecatedSynchronousErrorHandling)throw e;a(e)},complete:function(){}},u=Array.isArray||function(e){return e&&"number"==typeof e.length};function l(e){return null!==e&&"object"==typeof e}function c(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}c.prototype=Object.create(Error.prototype);var h,f=c,d=((h=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var e,t=!1;if(!this.closed){var n=this._parent,i=this._parents,o=this._unsubscribe,a=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=i?i.length:0;n;)n.remove(this),n=++s<c&&i[s]||null;if(r(o))try{o.call(this)}catch(d){t=!0,e=d instanceof f?p(d.errors):[d]}if(u(a))for(s=-1,c=a.length;++s<c;){var h=a[s];if(l(h))try{h.unsubscribe()}catch(d){t=!0,e=e||[],d instanceof f?e=e.concat(p(d.errors)):e.push(d)}}if(t)throw new f(e)}}},{key:"add",value:function(t){var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(n._addParent(this)){var i=this._subscriptions;i?i.push(n):this._subscriptions=[n]}return n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}},{key:"_addParent",value:function(e){var t=this._parent,n=this._parents;return t!==e&&(t?n?-1===n.indexOf(e)&&(n.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new h),h);function p(e){return e.reduce((function(e,t){return e.concat(t instanceof f?t.errors:t)}),[])}var v="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),g=function(e){function t(e,n,r){var i;switch(_classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=s;break;case 1:if(!e){i.destination=s;break}if("object"==typeof e){e instanceof t?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(_assertThisInitialized(i))):(i.syncErrorThrowable=!0,i.destination=new y(_assertThisInitialized(i),e));break}default:i.syncErrorThrowable=!0,i.destination=new y(_assertThisInitialized(i),e,n,r)}return i}return _inherits(t,e),_createClass(t,[{key:v,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(t.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this}}],[{key:"create",value:function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i}}]),t}(d),y=function(e){function t(e,n,i,o){var a,u;_classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parentSubscriber=e;var l=_assertThisInitialized(a);return r(n)?u=n:n&&(u=n.next,i=n.error,o=n.complete,n!==s&&(r((l=Object.create(n)).unsubscribe)&&a.add(l.unsubscribe.bind(l)),l.unsubscribe=a.unsubscribe.bind(_assertThisInitialized(a)))),a._context=l,a._next=u,a._error=i,a._complete=o,a}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=o.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):a(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;a(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(a(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(g),m="function"==typeof Symbol&&Symbol.observable||"@@observable";function _(){}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(t)}function w(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:_}var C,k=((C=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof g)return e;if(e[v])return e[v]()}return e||t||n?new g(e,t,n):new g(s)}(e,t,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){o.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof g?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=E(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(n){r(n),i&&i.unsubscribe()}}),r,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:m,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:w(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=E(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))}}]),e}()).create=function(e){return new C(e)},C);function E(e){if(e||(e=o.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function S(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}S.prototype=Object.create(Error.prototype);var T,I=S,A=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).subject=e,r.subscriber=n,r.closed=!1,r}return _inherits(t,e),_createClass(t,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),t}(d),N=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).destination=e,n}return _inherits(t,e),t}(g),D=((T=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _inherits(t,e),_createClass(t,[{key:v,value:function(){return new N(this)}},{key:"lift",value:function(e){var t=new x(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new I;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)}},{key:"error",value:function(e){if(this.closed)throw new I;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new I;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new I;return _get(_getPrototypeOf(t.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new I;return this.hasError?(e.error(this.thrownError),d.EMPTY):this.isStopped?(e.complete(),d.EMPTY):(this.observers.push(e),new A(this,e))}},{key:"asObservable",value:function(){var e=new k;return e.source=this,e}}]),t}(k)).create=function(e,t){return new x(e,t)},T),x=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).destination=e,r.source=n,r}return _inherits(t,e),_createClass(t,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):d.EMPTY}}]),t}(D);function R(e){return e&&"function"==typeof e.schedule}var O=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}(g),P=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.closed||t.complete()}},M=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,a),t}};var L="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",F=function(e){return function(t){for(var n=e[L]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}},V=function(e){return function(t){var n=e[m]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},U=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function q(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var B=function(e){if(e instanceof k)return function(t){return e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t)};if(e&&"function"==typeof e[m])return V(e);if(U(e))return P(e);if(q(e))return M(e);if(e&&"function"==typeof e[L])return F(e);var t=l(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(t," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function j(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new O(e,n,r);if(!i.closed)return B(t)(i)}var W=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),t}(g);function H(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new z(e,t))}}var z=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Q(e,this.project,this.thisArg))}}]),e}(),Q=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,i.count=0,i.thisArg=r||_assertThisInitialized(i),i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(g);function G(e,t){return new k(t?function(n){var r=new d,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}:P(e))}function K(e,t){if(!t)return e instanceof k?e:new k(B(e));if(null!=e){if(function(e){return e&&"function"==typeof e[m]}(e))return function(e,t){return new k(t?function(n){var r=new d;return r.add(t.schedule((function(){var i=e[m]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}:V(e))}(e,t);if(q(e))return function(e,t){return new k(t?function(n){var r=new d;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}:M(e))}(e,t);if(U(e))return G(e,t);if(function(e){return e&&"function"==typeof e[L]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new k(t?function(n){var r,i=new d;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[L](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(o){return void n.error(o)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}:F(e))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(r){return r.pipe(Y((function(n,r){return K(e(n,r)).pipe(H((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new X(e,n))})}var X=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new J(e,this.project,this.concurrent))}}]),e}(),J=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,r.concurrent=i,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new O(this,void 0,void 0);this.destination.add(r),j(this,e,t,n,r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),t}(W);function $(e){return e}function Z(){return Y($,arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY)}function ee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Number.POSITIVE_INFINITY,i=null,o=t[t.length-1];return R(o)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof o&&(r=t.pop()),null===i&&1===t.length&&t[0]instanceof k?t[0]:Z(r)(G(t,i))}function te(){return function(e){return e.lift(new ne(e))}}var ne=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new re(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),e}(),re=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,e),_createClass(t,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),t}(g),ie=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return _inherits(t,e),_createClass(t,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new d).add(this.source.subscribe(new ae(this.getSubject(),this))),e.closed?(this._connection=null,e=d.EMPTY):this._connection=e),e}},{key:"refCount",value:function(){return te()(this)}}]),t}(k).prototype,oe={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:ie._subscribe},_isComplete:{value:ie._isComplete,writable:!0},getSubject:{value:ie.getSubject},connect:{value:ie.connect},refCount:{value:ie.refCount}},ae=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,e),_createClass(t,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),t}(N);function se(){return new D}function ue(){return function(e){return te()((t=se,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,oe);return r.source=e,r.subjectFactory=n,r})(e));var t}}var le="__parameters__";function ce(e,t,n){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var o=_construct(i,t);return a.annotation=o,a;function a(e,t,n){for(var r=e.hasOwnProperty(le)?e[le]:Object.defineProperty(e,le,{value:[]})[le];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(o),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i}var he=ce("Inject",(function(e){return{token:e}})),fe=ce("Optional"),de=ce("Self"),pe=ce("SkipSelf"),ve=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function ge(e){for(var t in e)if(e[t]===ge)return t;throw Error("Could not find renamed property on target object.")}function ye(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function me(e){var t=e[_e];return t&&t.token===e?t:null}var _e=ge({ngInjectableDef:ge});function be(e){if("string"==typeof e)return e;if(e instanceof Array)return"["+e.map(be).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}var we=ge({__forward_ref__:ge});function Ce(e){return e.__forward_ref__=Ce,e.toString=function(){return be(this())},e}function ke(e){var t=e;return"function"==typeof t&&t.hasOwnProperty(we)&&t.__forward_ref__===Ce?t():e}var Ee,Se="undefined"!=typeof globalThis&&globalThis,Te="undefined"!=typeof window&&window,Ie="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ae="undefined"!=typeof global&&global,Ne=Se||Ae||Te||Ie,De=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.ngInjectableDef=ye({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),xe=new De("INJECTOR",-1),Re=new Object,Oe=/\n/gm,Pe="\u0275",Me="__source",Le=ge({provide:String,useValue:ge}),Fe=void 0;function Ve(e){var t=Fe;return Fe=e,t}function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve.Default;if(void 0===Fe)throw new Error("inject() must be called from an injection context");return null===Fe?function(e,t,n){var r=me(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ve.Optional)return null;throw new Error("Injector: NOT_FOUND [".concat(be(e),"]"))}(e,0,t):Fe.get(e,t&ve.Optional?null:void 0,t)}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve.Default;return(Ee||Ue)(e,t)}var Be=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Re;if(t===Re){var n=new Error("NullInjectorError: No provider for ".concat(be(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}();function je(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&e.charAt(1)==Pe?e.substr(2):e;var i=be(t);if(t instanceof Array)i=t.map(be).join(" -> ");else if("object"==typeof t){var o=[];for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):be(s)))}i="{".concat(o.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Oe,"\n  "))}var We=function e(){_classCallCheck(this,e)},He=function e(){_classCallCheck(this,e)};function ze(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Qe(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var Ge=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),Ke=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ne),Ye="ngDebugContext",Xe="ngOriginalError",Je="ngErrorLogger";function $e(e){return e[Ye]}function Ze(e){return e[Xe]}function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var tt=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e[Je]||et}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?$e(e)?$e(e):this._findContext(Ze(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=Ze(e);t&&Ze(t);)t=Ze(t);return t}}]),e}(),nt=!0,rt=!1;function it(){return rt=!0,nt}var ot=function(){function e(t){if(_classCallCheck(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n),this.inertBodyElement=this.inertDocument.createElement("body"),n.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(e,[{key:"getInertBodyElement_XHR",value:function(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(r){return null}var t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);var n=t.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(e){e="<body><remove></remove>"+e+"</body>";try{var t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(e){var t=this.inertDocument.createElement("template");return"content"in t?(t.innerHTML=e,t):(this.inertBodyElement.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),at=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,st=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function ut(e){return(e=String(e)).match(at)||e.match(st)?e:(it()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(e," (see http://g.co/ng/security#xss)")),"unsafe:"+e)}function lt(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e.split(",")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){t[o.value]=!0}}catch(s){r=!0,i=s}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}function ct(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)a.hasOwnProperty(s)&&(e[s]=!0)}return e}var ht,ft=lt("area,br,col,hr,img,wbr"),dt=lt("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),pt=lt("rp,rt"),vt=ct(pt,dt),gt=ct(ft,ct(dt,lt("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ct(pt,lt("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),vt),yt=lt("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),mt=lt("srcset"),_t=ct(yt,mt,lt("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),lt("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),bt=lt("script,style,template"),wt=function(){function e(){_classCallCheck(this,e),this.sanitizedSomething=!1,this.buf=[]}return _createClass(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!gt.hasOwnProperty(t))return this.sanitizedSomething=!0,!bt.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n,r=e.attributes,i=0;i<r.length;i++){var o=r.item(i),a=o.name,s=a.toLowerCase();if(_t.hasOwnProperty(s)){var u=o.value;yt[s]&&(u=ut(u)),mt[s]&&(n=u,u=(n=String(n)).split(",").map((function(e){return ut(e.trim())})).join(", ")),this.buf.push(" ",a,'="',Et(u),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();gt.hasOwnProperty(t)&&!ft.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(Et(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),Ct=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,kt=/([^\#-~ |!])/g;function Et(e){return e.replace(/&/g,"&amp;").replace(Ct,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(kt,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function St(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Tt=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),It=function e(){_classCallCheck(this,e)},At=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Nt=/^url\(([^)]+)\)$/,Dt=/([A-Z])/g;function xt(e){try{return null!=e?e.toString().slice(0,30):e}catch(t){return"[ERROR] Exception while trying to serialize the value"}}var Rt=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Ot()},e}(),Ot=function(){},Pt=new De("The presence of this token marks an injector as being the root injector."),Mt=function(e,t,n){return new Bt(e,t,n)},Lt=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Mt(e,t,""):Mt(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Re,e.NULL=new Be,e.ngInjectableDef=ye({token:e,providedIn:"any",factory:function(){return qe(xe)}}),e.__NG_ELEMENT_ID__=-1,e}(),Ft=function(e){return e},Vt=[],Ut=Ft,qt=function(){return Array.prototype.slice.call(arguments)},Bt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lt.NULL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,e),this.parent=n,this.source=r;var i=this._records=new Map;i.set(Lt,{token:Lt,fn:Ft,deps:Vt,value:this,useNew:!1}),i.set(xe,{token:xe,fn:Ft,deps:Vt,value:this,useNew:!1}),function e(t,n){if(n)if((n=ke(n))instanceof Array)for(var r=0;r<n.length;r++)e(t,n[r]);else{if("function"==typeof n)throw Wt("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Wt("Unexpected provider",n);var i=ke(n.provide),o=function(e){var t=function(e){var t=Vt,n=e.deps;if(n&&n.length){t=[];for(var r=0;r<n.length;r++){var i=6,o=ke(n[r]);if(o instanceof Array)for(var a=0,s=o;a<s.length;a++){var u=s[a];u instanceof fe||u==fe?i|=1:u instanceof pe||u==pe?i&=-3:u instanceof de||u==de?i&=-5:o=u instanceof he?u.token:ke(u)}t.push({token:o,options:i})}}else if(e.useExisting)t=[{token:ke(e.useExisting),options:6}];else if(!(n||Le in e))throw Wt("'deps' required",e);return t}(e),n=Ft,r=Vt,i=!1,o=ke(e.provide);if(Le in e)r=e.useValue;else if(e.useFactory)n=e.useFactory;else if(e.useExisting);else if(e.useClass)i=!0,n=ke(e.useClass);else{if("function"!=typeof o)throw Wt("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",e);i=!0,n=o}return{deps:t,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){var a=t.get(i);if(a){if(a.fn!==qt)throw jt(i)}else t.set(i,a={token:n.provide,deps:[],useNew:!1,fn:qt,value:Vt});a.deps.push({token:i=n,options:6})}var s=t.get(i);if(s&&s.fn==qt)throw jt(i);t.set(i,o)}}(i,t)}return _createClass(e,[{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ve.Default,r=this._records.get(e);try{return function e(t,n,r,i,o,a){try{return function(t,n,r,i,o,a){var s;if(!n||a&ve.SkipSelf)a&ve.Self||(s=i.get(t,o,ve.Default));else{if((s=n.value)==Ut)throw Error("\u0275Circular dependency");if(s===Vt){n.value=Ut;var u=n.useNew,l=n.fn,c=n.deps,h=Vt;if(c.length){h=[];for(var f=0;f<c.length;f++){var d=c[f],p=d.options,v=2&p?r.get(d.token):void 0;h.push(e(d.token,v,r,v||4&p?i:Lt.NULL,1&p?null:Lt.THROW_IF_NOT_FOUND,ve.Default))}}n.value=s=u?_construct(l,_toConsumableArray(h)):l.apply(void 0,h)}}return s}(t,n,r,i,o,a)}catch(s){throw s instanceof Error||(s=new Error(s)),(s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(t),n&&n.value==Ut&&(n.value=Vt),s}}(e,r,this._records,this.parent,t,n)}catch(i){return function(e,t,n,r){var i=e.ngTempTokenPath;throw t[Me]&&i.unshift(t[Me]),e.message=je("\n"+e.message,i,"StaticInjectorError",r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(i,e,0,this.source)}}},{key:"toString",value:function(){var e=[];return this._records.forEach((function(t,n){return e.push(be(n))})),"StaticInjector[".concat(e.join(", "),"]")}}]),e}();function jt(e){return Wt("Cannot mix multi providers and regular providers",e)}function Wt(e,t){return new Error(je(e,t,"StaticInjectorError"))}var Ht=new De("AnalyzeForEntryComponents"),zt=null;function Qt(){if(!zt){var e=Ne.Symbol;if(e&&e.iterator)zt=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(zt=r)}}return zt}function Gt(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function Kt(e,t){var n=Xt(e),r=Xt(t);return n&&r?function(e,t,n){for(var r=e[Qt()](),i=t[Qt()]();;){var o=r.next(),a=i.next();if(o.done&&a.done)return!0;if(o.done||a.done)return!1;if(!n(o.value,a.value))return!1}}(e,t,Kt):!(n||!(e&&("object"==typeof e||"function"==typeof e))||r||!(t&&("object"==typeof t||"function"==typeof t)))||Gt(e,t)}var Yt=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Xt(e){return!!Jt(e)&&(Array.isArray(e)||!(e instanceof Map)&&Qt()in e)}function Jt(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function $t(e){return!!e&&"function"==typeof e.then}function Zt(e){return!!e&&"function"==typeof e.subscribe}var en=function(){function e(t,n,r){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}(),tn=function e(){_classCallCheck(this,e)},nn=function e(){_classCallCheck(this,e)};function rn(e){var t=Error("No component factory found for ".concat(be(e),". Did you add it to @NgModule.entryComponents?"));return t[on]=e,t}var on="ngComponent",an=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw rn(e)}}]),e}(),sn=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new an,e}(),un=function(){function e(t,n,r){_classCallCheck(this,e),this._parent=n,this._ngModule=r,this._factories=new Map;for(var i=0;i<t.length;i++){var o=t[i];this._factories.set(o.componentType,o)}}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){var t=this._factories.get(e);if(!t&&this._parent&&(t=this._parent.resolveComponentFactory(e)),!t)throw rn(e);return new ln(t,this._ngModule)}}]),e}(),ln=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).factory=e,r.ngModule=n,r.selector=e.selector,r.componentType=e.componentType,r.ngContentSelectors=e.ngContentSelectors,r.inputs=e.inputs,r.outputs=e.outputs,r}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e,t,n,r){return this.factory.create(e,t,n,r||this.ngModule)}}]),t}(nn);function cn(){}var hn=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return fn(e)},e}(),fn=cn,dn=function e(){_classCallCheck(this,e)},pn=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),vn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return gn()},e}(),gn=cn,yn=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("8.2.14"),mn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return Xt(e)}},{key:"create",value:function(e){return new bn(e)}}]),e}(),_n=function(e,t){return t},bn=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||_n}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var o=!n||t&&t.currentIndex<En(n,r,i)?t:n,a=En(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);var u=a-r,l=s-r;if(u!=l){for(var c=0;c<u;c++){var h=c<i.length?i[c]:i[c]=0,f=h+c;l<=f&&f<u&&(i[c]=h+1)}i[o.previousIndex]=l-u}}a!==s&&e(o,a,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Xt(e))throw new Error("Error trying to diff '".concat(be(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)i=this._trackByFn(s,r=e[s]),null!==o&&Gt(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),Gt(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[Qt()]();!(r=i.next()).done;)t(r.value)}(e,(function(e){i=t._trackByFn(n,e),null!==o&&Gt(o.trackById,i)?(a&&(o=t._verifyReinsertion(o,e,i,n)),Gt(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,i,n),a=!0),o=o._next,n++})),this.length=n;return this._truncate(o),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Gt(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Gt(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):e=this._addAfter(new wn(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new kn),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kn),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),wn=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},Cn=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Gt(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),kn=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new Cn,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function En(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var Sn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||Jt(e)}},{key:"create",value:function(){return new Tn}}]),e}(),Tn=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Jt(e)))throw new Error("Error trying to diff '".concat(be(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new In(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Gt(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),In=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},An=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new pe,new fe]]}}}]),e}();return e.ngInjectableDef=ye({token:e,providedIn:"root",factory:function(){return new e([new mn])}}),e}(),Nn=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new pe,new fe]]}}}]),e}();return e.ngInjectableDef=ye({token:e,providedIn:"root",factory:function(){return new e([new Sn])}}),e}(),Dn=[new Sn],xn=new An([new mn]),Rn=new Nn(Dn),On=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Pn(e,hn)},e}(),Pn=cn,Mn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Ln(e,hn)},e}(),Ln=cn;function Fn(e,t,n,r){var i="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '".concat(t,"'. Current value: '").concat(n,"'.");return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(e,t){var n=new Error(e);return Vn(n,t),n}(i,e)}function Vn(e,t){e[Ye]=t,e[Je]=t.logError.bind(t)}function Un(e){return new Error("ViewDestroyedError: Attempt to use a destroyed view: ".concat(e))}function qn(e,t,n){var r=e.state,i=1792&r;return i===t?(e.state=-1793&r|n,e.initIndex=-1,!0):i===n}function Bn(e,t,n){return(1792&e.state)===t&&e.initIndex<=n&&(e.initIndex=n+1,!0)}function jn(e,t){return e.nodes[t]}function Wn(e,t){return e.nodes[t]}function Hn(e,t){return e.nodes[t]}function zn(e,t){return e.nodes[t]}function Qn(e,t){return e.nodes[t]}var Gn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Kn=function(){},Yn=new Map;function Xn(e){var t=Yn.get(e);return t||(t=be(e)+"_"+Yn.size,Yn.set(e,t)),t}var Jn="$$undefined",$n="$$empty";function Zn(e){return{id:Jn,styles:e.styles,encapsulation:e.encapsulation,data:e.data}}var er=0;function tr(e,t,n,r){return!(!(2&e.state)&&Gt(e.oldValues[t.bindingIndex+n],r))}function nr(e,t,n,r){return!!tr(e,t,n,r)&&(e.oldValues[t.bindingIndex+n]=r,!0)}function rr(e,t,n,r){var i=e.oldValues[t.bindingIndex+n];if(1&e.state||!Kt(i,r)){var o=t.bindings[n].name;throw Fn(Gn.createDebugContext(e,t.nodeIndex),"".concat(o,": ").concat(i),"".concat(o,": ").concat(r),0!=(1&e.state))}}function ir(e){for(var t=e;t;)2&t.def.flags&&(t.state|=8),t=t.viewContainerParent||t.parent}function or(e,t){for(var n=e;n&&n!==t;)n.state|=64,n=n.viewContainerParent||n.parent}function ar(e,t,n,r){try{return ir(33554432&e.def.nodes[t].flags?Wn(e,t).componentView:e),Gn.handleEvent(e,t,n,r)}catch(i){e.root.errorHandler.handleError(i)}}function sr(e){return e.parent?Wn(e.parent,e.parentNodeDef.nodeIndex):null}function ur(e){return e.parent?e.parentNodeDef.parent:null}function lr(e,t){switch(201347067&t.flags){case 1:return Wn(e,t.nodeIndex).renderElement;case 2:return jn(e,t.nodeIndex).renderText}}function cr(e){return!!e.parent&&!!(32768&e.parentNodeDef.flags)}function hr(e){return!(!e.parent||32768&e.parentNodeDef.flags)}function fr(e){var t={},n=0,r={};return e&&e.forEach((function(e){var i=_slicedToArray(e,2),o=i[0],a=i[1];"number"==typeof o?(t[o]=a,n|=function(e){return 1<<e%32}(o)):r[o]=a})),{matchedQueries:t,references:r,matchedQueryIds:n}}function dr(e,t){return e.map((function(e){var n,r,i;return Array.isArray(e)?(i=(n=_slicedToArray(e,2))[0],r=n[1]):(i=0,r=e),r&&("function"==typeof r||"object"==typeof r)&&t&&Object.defineProperty(r,Me,{value:t,configurable:!0}),{flags:i,token:r,tokenKey:Xn(r)}}))}function pr(e,t,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===Ge.Native?Wn(e,n.renderParent.nodeIndex).renderElement:void 0:t}var vr=new WeakMap;function gr(e){var t=vr.get(e);return t||((t=e((function(){return Kn}))).factory=e,vr.set(e,t)),t}function yr(e,t,n,r,i){3===t&&(n=e.renderer.parentNode(lr(e,e.def.lastRenderRootNode))),mr(e,t,0,e.def.nodes.length-1,n,r,i)}function mr(e,t,n,r,i,o,a){for(var s=n;s<=r;s++){var u=e.def.nodes[s];11&u.flags&&br(e,u,t,i,o,a),s+=u.childCount}}function _r(e,t,n,r,i,o){for(var a=e;a&&!cr(a);)a=a.parent;for(var s=a.parent,u=ur(a),l=u.nodeIndex+u.childCount,c=u.nodeIndex+1;c<=l;c++){var h=s.def.nodes[c];h.ngContentIndex===t&&br(s,h,n,r,i,o),c+=h.childCount}if(!s.parent){var f=e.root.projectableNodes[t];if(f)for(var d=0;d<f.length;d++)wr(e,f[d],n,r,i,o)}}function br(e,t,n,r,i,o){if(8&t.flags)_r(e,t.ngContent.index,n,r,i,o);else{var a=lr(e,t);if(3===n&&33554432&t.flags&&48&t.bindingFlags?(16&t.bindingFlags&&wr(e,a,n,r,i,o),32&t.bindingFlags&&wr(Wn(e,t.nodeIndex).componentView,a,n,r,i,o)):wr(e,a,n,r,i,o),16777216&t.flags)for(var s=Wn(e,t.nodeIndex).viewContainer._embeddedViews,u=0;u<s.length;u++)yr(s[u],n,r,i,o);1&t.flags&&!t.element.name&&mr(e,n,t.nodeIndex+1,t.nodeIndex+t.childCount,r,i,o)}}function wr(e,t,n,r,i,o){var a=e.renderer;switch(n){case 1:a.appendChild(r,t);break;case 2:a.insertBefore(r,t,i);break;case 3:a.removeChild(r,t);break;case 0:o.push(t)}}var Cr=/^:([^:]+):(.+)$/;function kr(e){if(":"===e[0]){var t=e.match(Cr);return[t[1],t[2]]}return["",e]}function Er(e){for(var t=0,n=0;n<e.length;n++)t|=e[n].flags;return t}function Sr(e,t,n,r,i,o,a,s,u,l,c,h,f,d,p,v,g,y,m,_){switch(e){case 1:return t+Tr(n)+r;case 2:return t+Tr(n)+r+Tr(i)+o;case 3:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s;case 4:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l;case 5:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l+Tr(c)+h;case 6:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l+Tr(c)+h+Tr(f)+d;case 7:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l+Tr(c)+h+Tr(f)+d+Tr(p)+v;case 8:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l+Tr(c)+h+Tr(f)+d+Tr(p)+v+Tr(g)+y;case 9:return t+Tr(n)+r+Tr(i)+o+Tr(a)+s+Tr(u)+l+Tr(c)+h+Tr(f)+d+Tr(p)+v+Tr(g)+y+Tr(m)+_;default:throw new Error("Does not support more than 9 expressions")}}function Tr(e){return null!=e?e.toString():""}var Ir=new Object,Ar=Xn(Lt),Nr=Xn(xe),Dr=Xn(We);function xr(e,t,n,r){return n=ke(n),{index:-1,deps:dr(r,be(t)),flags:e,token:t,value:n}}function Rr(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lt.THROW_IF_NOT_FOUND,o=Ve(e);try{if(8&t.flags)return t.token;if(2&t.flags&&(i=null),1&t.flags)return e._parent.get(t.token,i);var a=t.tokenKey;switch(a){case Ar:case Nr:case Dr:return e}var s,u=e._def.providersByKey[a];if(u){var l=e._providers[u.index];return void 0===l&&(l=e._providers[u.index]=Or(e,u)),l===Ir?void 0:l}if((s=me(t.token))&&(n=e,null!=(r=s).providedIn&&(function(e,t){return e._def.modules.indexOf(t)>-1}(n,r.providedIn)||"root"===r.providedIn&&n._def.isRoot))){var c=e._providers.length;return e._def.providers[c]=e._def.providersByKey[t.tokenKey]={flags:5120,value:s.factory,deps:[],index:c,token:t.token},e._providers[c]=Ir,e._providers[c]=Or(e,e._def.providersByKey[t.tokenKey])}return 4&t.flags?i:e._parent.get(t.token,i)}finally{Ve(o)}}function Or(e,t){var n;switch(201347067&t.flags){case 512:n=function(e,t,n){var r=n.length;switch(r){case 0:return new t;case 1:return new t(Rr(e,n[0]));case 2:return new t(Rr(e,n[0]),Rr(e,n[1]));case 3:return new t(Rr(e,n[0]),Rr(e,n[1]),Rr(e,n[2]));default:for(var i=new Array(r),o=0;o<r;o++)i[o]=Rr(e,n[o]);return _construct(t,i)}}(e,t.value,t.deps);break;case 1024:n=function(e,t,n){var r=n.length;switch(r){case 0:return t();case 1:return t(Rr(e,n[0]));case 2:return t(Rr(e,n[0]),Rr(e,n[1]));case 3:return t(Rr(e,n[0]),Rr(e,n[1]),Rr(e,n[2]));default:for(var i=Array(r),o=0;o<r;o++)i[o]=Rr(e,n[o]);return t.apply(void 0,i)}}(e,t.value,t.deps);break;case 2048:n=Rr(e,t.deps[0]);break;case 256:n=t.value}return n===Ir||null===n||"object"!=typeof n||131072&t.flags||"function"!=typeof n.ngOnDestroy||(t.flags|=131072),void 0===n?Ir:n}function Pr(e,t){var n=e.viewContainer._embeddedViews;if((null==t||t>=n.length)&&(t=n.length-1),t<0)return null;var r=n[t];return r.viewContainerParent=null,Qe(n,t),Gn.dirtyParentQueries(r),Lr(r),r}function Mr(e,t,n){var r=t?lr(t,t.def.lastRenderRootNode):e.renderElement,i=n.renderer.parentNode(r),o=n.renderer.nextSibling(r);yr(n,2,i,o,void 0)}function Lr(e){yr(e,3,null,null,void 0)}var Fr=new Object;function Vr(e,t,n,r,i,o){return new Ur(e,t,n,r,i,o)}var Ur=function(e){function t(e,n,r,i,o,a){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).selector=e,s.componentType=n,s._inputs=i,s._outputs=o,s.ngContentSelectors=a,s.viewDefFactory=r,s}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e,t,n,r){if(!r)throw new Error("ngModule should be provided");var i=gr(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,a=Gn.createRootView(e,t||[],n,i,r,Fr),s=Hn(a,o).instance;return n&&a.renderer.setAttribute(Wn(a,0).renderElement,"ng-version",yn.full),new qr(a,new Hr(a),s)}},{key:"inputs",get:function(){var e=[],t=this._inputs;for(var n in t)e.push({propName:n,templateName:t[n]});return e}},{key:"outputs",get:function(){var e=[];for(var t in this._outputs)e.push({propName:t,templateName:this._outputs[t]});return e}}]),t}(nn),qr=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._view=e,i._viewRef=n,i._component=r,i._elDef=i._view.def.nodes[0],i.hostView=n,i.changeDetectorRef=n,i.instance=r,i}return _inherits(t,e),_createClass(t,[{key:"destroy",value:function(){this._viewRef.destroy()}},{key:"onDestroy",value:function(e){this._viewRef.onDestroy(e)}},{key:"location",get:function(){return new hn(Wn(this._view,this._elDef.nodeIndex).renderElement)}},{key:"injector",get:function(){return new Kr(this._view,this._elDef)}},{key:"componentType",get:function(){return this._component.constructor}}]),t}(tn);function Br(e,t,n){return new jr(e,t,n)}var jr=function(){function e(t,n,r){_classCallCheck(this,e),this._view=t,this._elDef=n,this._data=r,this._embeddedViews=[]}return _createClass(e,[{key:"clear",value:function(){for(var e=this._embeddedViews.length-1;e>=0;e--){var t=Pr(this._data,e);Gn.destroyView(t)}}},{key:"get",value:function(e){var t=this._embeddedViews[e];if(t){var n=new Hr(t);return n.attachToViewContainerRef(this),n}return null}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var o=n||this.parentInjector;i||e instanceof ln||(i=o.get(We));var a=e.create(o,r,void 0,i);return this.insert(a.hostView,t),a}},{key:"insert",value:function(e,t){if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n,r,i,o,a,s=e;return n=this._view,r=this._data,i=t,o=s._view,a=r.viewContainer._embeddedViews,null==i&&(i=a.length),o.viewContainerParent=n,ze(a,i,o),function(e,t){var n=sr(t);if(n&&n!==e&&!(16&t.state)){t.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(t),function(e,t){if(!(4&t.flags)){e.nodeFlags|=4,t.flags|=4;for(var n=t.parent;n;)n.childFlags|=4,n=n.parent}}(t.parent.def,t.parentNodeDef)}}(r,o),Gn.dirtyParentQueries(o),Mr(r,i>0?a[i-1]:null,o),s.attachToViewContainerRef(this),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n,r,i,o,a,s=this._embeddedViews.indexOf(e._view);return n=this._data,r=s,i=t,o=n.viewContainer._embeddedViews,a=o[r],Qe(o,r),null==i&&(i=o.length),ze(o,i,a),Gn.dirtyParentQueries(a),Lr(a),Mr(n,i>0?o[i-1]:null,a),e}},{key:"indexOf",value:function(e){return this._embeddedViews.indexOf(e._view)}},{key:"remove",value:function(e){var t=Pr(this._data,e);t&&Gn.destroyView(t)}},{key:"detach",value:function(e){var t=Pr(this._data,e);return t?new Hr(t):null}},{key:"element",get:function(){return new hn(this._data.renderElement)}},{key:"injector",get:function(){return new Kr(this._view,this._elDef)}},{key:"parentInjector",get:function(){for(var e=this._view,t=this._elDef.parent;!t&&e;)t=ur(e),e=e.parent;return e?new Kr(e,t):new Kr(this._view,null)}},{key:"length",get:function(){return this._embeddedViews.length}}]),e}();function Wr(e){return new Hr(e)}var Hr=function(){function e(t){_classCallCheck(this,e),this._view=t,this._viewContainerRef=null,this._appRef=null}return _createClass(e,[{key:"markForCheck",value:function(){ir(this._view)}},{key:"detach",value:function(){this._view.state&=-5}},{key:"detectChanges",value:function(){var e=this._view.root.rendererFactory;e.begin&&e.begin();try{Gn.checkAndUpdateView(this._view)}finally{e.end&&e.end()}}},{key:"checkNoChanges",value:function(){Gn.checkNoChangesView(this._view)}},{key:"reattach",value:function(){this._view.state|=4}},{key:"onDestroy",value:function(e){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(e)}},{key:"destroy",value:function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Gn.destroyView(this._view)}},{key:"detachFromAppRef",value:function(){this._appRef=null,Lr(this._view),Gn.dirtyParentQueries(this._view)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"rootNodes",get:function(){return yr(this._view,0,void 0,void 0,e=[]),e;var e}},{key:"context",get:function(){return this._view.context}},{key:"destroyed",get:function(){return 0!=(128&this._view.state)}}]),e}();function zr(e,t){return new Qr(e,t)}var Qr=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parentView=e,r._def=n,r}return _inherits(t,e),_createClass(t,[{key:"createEmbeddedView",value:function(e){return new Hr(Gn.createEmbeddedView(this._parentView,this._def,this._def.element.template,e))}},{key:"elementRef",get:function(){return new hn(Wn(this._parentView,this._def.nodeIndex).renderElement)}}]),t}(On);function Gr(e,t){return new Kr(e,t)}var Kr=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.elDef=n}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lt.THROW_IF_NOT_FOUND;return Gn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:e,tokenKey:Xn(e)},t)}}]),e}();function Yr(e,t){var n=e.def.nodes[t];if(1&n.flags){var r=Wn(e,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return jn(e,n.nodeIndex).renderText;if(20240&n.flags)return Hn(e,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index ".concat(t))}function Xr(e){return new Jr(e.renderer)}var Jr=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"selectRootElement",value:function(e){return this.delegate.selectRootElement(e)}},{key:"createElement",value:function(e,t){var n=_slicedToArray(kr(t),2),r=n[0],i=n[1],o=this.delegate.createElement(i,r);return e&&this.delegate.appendChild(e,o),o}},{key:"createViewRoot",value:function(e){return e}},{key:"createTemplateAnchor",value:function(e){var t=this.delegate.createComment("");return e&&this.delegate.appendChild(e,t),t}},{key:"createText",value:function(e,t){var n=this.delegate.createText(t);return e&&this.delegate.appendChild(e,n),n}},{key:"projectNodes",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.appendChild(e,t[n])}},{key:"attachViewAfter",value:function(e,t){for(var n=this.delegate.parentNode(e),r=this.delegate.nextSibling(e),i=0;i<t.length;i++)this.delegate.insertBefore(n,t[i],r)}},{key:"detachView",value:function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}},{key:"destroyView",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.destroyNode(t[n])}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"listenGlobal",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"setElementProperty",value:function(e,t,n){this.delegate.setProperty(e,t,n)}},{key:"setElementAttribute",value:function(e,t,n){var r=_slicedToArray(kr(t),2),i=r[0],o=r[1];null!=n?this.delegate.setAttribute(e,o,n,i):this.delegate.removeAttribute(e,o,i)}},{key:"setBindingDebugInfo",value:function(e,t,n){}},{key:"setElementClass",value:function(e,t,n){n?this.delegate.addClass(e,t):this.delegate.removeClass(e,t)}},{key:"setElementStyle",value:function(e,t,n){null!=n?this.delegate.setStyle(e,t,n):this.delegate.removeStyle(e,t)}},{key:"invokeElementMethod",value:function(e,t,n){e[t].apply(e,n)}},{key:"setText",value:function(e,t){this.delegate.setValue(e,t)}},{key:"animate",value:function(){throw new Error("Renderer.animate is no longer supported!")}}]),e}();function $r(e,t,n,r){return new Zr(e,t,n,r)}var Zr=function(){function e(t,n,r,i){_classCallCheck(this,e),this._moduleType=t,this._parent=n,this._bootstrapComponents=r,this._def=i,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(e){for(var t=e._def,n=e._providers=new Array(t.providers.length),r=0;r<t.providers.length;r++){var i=t.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=Or(e,i))}}(this)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lt.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ve.Default,r=0;return n&ve.SkipSelf?r|=1:n&ve.Self&&(r|=4),Rr(this,{token:e,tokenKey:Xn(e),flags:r},t)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The ng module ".concat(be(this.instance.constructor)," has already been destroyed."));this._destroyed=!0,function(e,t){for(var n=e._def,r=new Set,i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){var o=e._providers[i];if(o&&o!==Ir){var a=o.ngOnDestroy;"function"!=typeof a||r.has(o)||(a.apply(o),r.add(o))}}}(this),this._destroyListeners.forEach((function(e){return e()}))}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"instance",get:function(){return this.get(this._moduleType)}},{key:"componentFactoryResolver",get:function(){return this.get(sn)}}]),e}(),ei=Xn((function e(){_classCallCheck(this,e)})),ti=Xn(vn),ni=Xn(hn),ri=Xn(Mn),ii=Xn(On),oi=Xn(Rt),ai=Xn(Lt),si=Xn(xe);function ui(e,t,n,r,i,o,a,s){var u=[];if(a)for(var l in a){var c=_slicedToArray(a[l],2),h=c[0],f=c[1];u[h]={flags:8,name:l,nonMinifiedName:f,ns:null,securityContext:null,suffix:null}}var d=[];if(s)for(var p in s)d.push({type:1,propName:p,target:null,eventName:s[p]});return ci(e,t|=16384,n,r,i,i,o,u,d)}function li(e,t,n,r,i){return ci(-1,e,t,0,n,r,i)}function ci(e,t,n,r,i,o,a,s,u){var l=fr(n),c=l.matchedQueries,h=l.references,f=l.matchedQueryIds;u||(u=[]),s||(s=[]),o=ke(o);var d=dr(a,be(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:c,matchedQueryIds:f,references:h,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Er(s),outputs:u,element:null,provider:{token:i,value:o,deps:d},text:null,query:null,ngContent:null}}function hi(e,t){return vi(e,t)}function fi(e,t){for(var n=e;n.parent&&!cr(n);)n=n.parent;return gi(n.parent,ur(n),!0,t.provider.value,t.provider.deps)}function di(e,t){var n=gi(e,t.parent,(32768&t.flags)>0,t.provider.value,t.provider.deps);if(t.outputs.length)for(var r=0;r<t.outputs.length;r++){var i=t.outputs[r],o=n[i.propName];if(!Zt(o))throw new Error("@Output ".concat(i.propName," not initialized in '").concat(n.constructor.name,"'."));var a=o.subscribe(pi(e,t.parent.nodeIndex,i.eventName));e.disposables[t.outputIndex+r]=a.unsubscribe.bind(a)}return n}function pi(e,t,n){return function(r){return ar(e,t,n,r)}}function vi(e,t){var n=(8192&t.flags)>0,r=t.provider;switch(201347067&t.flags){case 512:return gi(e,t.parent,n,r.value,r.deps);case 1024:return function(e,t,n,r,i){var o=i.length;switch(o){case 0:return r();case 1:return r(mi(e,t,n,i[0]));case 2:return r(mi(e,t,n,i[0]),mi(e,t,n,i[1]));case 3:return r(mi(e,t,n,i[0]),mi(e,t,n,i[1]),mi(e,t,n,i[2]));default:for(var a=Array(o),s=0;s<o;s++)a[s]=mi(e,t,n,i[s]);return r.apply(void 0,a)}}(e,t.parent,n,r.value,r.deps);case 2048:return mi(e,t.parent,n,r.deps[0]);case 256:return r.value}}function gi(e,t,n,r,i){var o=i.length;switch(o){case 0:return new r;case 1:return new r(mi(e,t,n,i[0]));case 2:return new r(mi(e,t,n,i[0]),mi(e,t,n,i[1]));case 3:return new r(mi(e,t,n,i[0]),mi(e,t,n,i[1]),mi(e,t,n,i[2]));default:for(var a=new Array(o),s=0;s<o;s++)a[s]=mi(e,t,n,i[s]);return _construct(r,a)}}var yi={};function mi(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Lt.THROW_IF_NOT_FOUND;if(8&r.flags)return r.token;var o=e;2&r.flags&&(i=null);var a=r.tokenKey;a===oi&&(n=!(!t||!t.element.componentView)),t&&1&r.flags&&(n=!1,t=t.parent);for(var s=e;s;){if(t)switch(a){case ei:return Xr(_i(s,t,n));case ti:return _i(s,t,n).renderer;case ni:return new hn(Wn(s,t.nodeIndex).renderElement);case ri:return Wn(s,t.nodeIndex).viewContainer;case ii:if(t.element.template)return Wn(s,t.nodeIndex).template;break;case oi:return Wr(_i(s,t,n));case ai:case si:return Gr(s,t);default:var u=(n?t.element.allProviders:t.element.publicProviders)[a];if(u){var l=Hn(s,u.nodeIndex);return l||(l={instance:vi(s,u)},s.nodes[u.nodeIndex]=l),l.instance}}n=cr(s),t=ur(s),s=s.parent,4&r.flags&&(s=null)}var c=o.root.injector.get(r.token,yi);return c!==yi||i===yi?c:o.root.ngModule.injector.get(r.token,i)}function _i(e,t,n){var r;if(n)r=Wn(e,t.nodeIndex).componentView;else for(r=e;r.parent&&!cr(r);)r=r.parent;return r}function bi(e,t,n,r,i,o){if(32768&n.flags){var a=Wn(e,n.parent.nodeIndex).componentView;2&a.def.flags&&(a.state|=8)}if(t.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};var s=Yt.unwrap(e.oldValues[n.bindingIndex+r]);o[n.bindings[r].nonMinifiedName]=new en(s,i,0!=(2&e.state))}return e.oldValues[n.bindingIndex+r]=i,o}function wi(e,t){if(e.def.nodeFlags&t)for(var n=e.def.nodes,r=0,i=0;i<n.length;i++){var o=n[i],a=o.parent;for(!a&&o.flags&t&&ki(e,i,o.flags&t,r++),0==(o.childFlags&t)&&(i+=o.childCount);a&&1&a.flags&&i===a.nodeIndex+a.childCount;)a.directChildFlags&t&&(r=Ci(e,a,t,r)),a=a.parent}}function Ci(e,t,n,r){for(var i=t.nodeIndex+1;i<=t.nodeIndex+t.childCount;i++){var o=e.def.nodes[i];o.flags&n&&ki(e,i,o.flags&n,r++),i+=o.childCount}return r}function ki(e,t,n,r){var i=Hn(e,t);if(i){var o=i.instance;o&&(Gn.setCurrentNode(e,t),1048576&n&&Bn(e,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&Bn(e,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}}var Ei=new De("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Ke}}),Si={},Ti=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}(),Ii=void 0,Ai=["en",[["a","p"],["AM","PM"],Ii],[["AM","PM"],Ii,Ii],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ii,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ii,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ii,"{1} 'at' {0}",Ii],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Ni="en-US";function Di(e){null==e&&function(e){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined"))}(),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var xi=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).__isAsync=n,e}return _inherits(t,e),_createClass(t,[{key:"emit",value:function(e){_get(_getPrototypeOf(t.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,n,r){var i,o=function(e){return null},a=function(){return null};e&&"object"==typeof e?(i=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(o=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(a=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(i=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},n&&(o=this.__isAsync?function(e){setTimeout((function(){return n(e)}))}:function(e){n(e)}),r&&(a=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(t.prototype),"subscribe",this).call(this,i,o,a);return e instanceof d&&e.add(s),s}}]),t}(D);function Ri(){return this._results[Qt()]()}var Oi=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new xi,this.length=0;var t=Qt(),n=e.prototype;n[t]||(n[t]=Ri)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,n){void 0===n&&(n=t);for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?(n===t&&(n=t.slice(0,r)),e(i,n)):n!==t&&n.push(i)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),Pi=new De("Application Initializer"),Mi=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();$t(i)&&t.push(i)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}(),Li=new De("AppId");function Fi(){return"".concat(Vi()).concat(Vi()).concat(Vi())}function Vi(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Ui=new De("Platform Initializer"),qi=new De("Platform ID"),Bi=new De("appBootstrapListener"),ji=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}(),Wi=new De("LocaleId"),Hi=!1;function zi(){throw new Error("Runtime compiler is not loaded")}var Qi,Gi,Ki=zi,Yi=zi,Xi=zi,Ji=zi,$i=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Ki,this.compileModuleAsync=Yi,this.compileModuleAndAllComponentsSync=Xi,this.compileModuleAndAllComponentsAsync=Ji}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}(),Zi=function e(){_classCallCheck(this,e)};var eo,to=!(!(eo=Ne.wtf)||!(Qi=eo.trace)||(Gi=Qi.events,0));function no(e,t){return null}var ro=to?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Gi.createScope(e,t)}:function(e,t){return no},io=to?function(e,t){return Qi.leaveScope(e,t),t}:function(e,t){return t},oo=Promise.resolve(0);function ao(e){"undefined"==typeof Zone?oo.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var so=function(){function e(t){var n,r=t.enableLongStackTrace,i=void 0!==r&&r;if(_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xi(!1),this.onMicrotaskEmpty=new xi(!1),this.onStable=new xi(!1),this.onError=new xi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,t,r,i,o,a){try{return ho(n),e.invokeTask(r,i,o,a)}finally{fo(n)}},onInvoke:function(e,t,r,i,o,a,s){try{return ho(n),e.invoke(r,i,o,a,s)}finally{fo(n)}},onHasTask:function(e,t,r,i){e.hasTask(r,i),t===r&&("microTask"==i.change?(n.hasPendingMicrotasks=i.microTask,co(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,t,r,i){return e.handleError(r,i),n.runOutsideAngular((function(){return n.onError.emit(i)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,lo,uo,uo);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function uo(){}var lo={};function co(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function ho(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function fo(e){e._nesting--,co(e)}var po,vo=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xi,this.onMicrotaskEmpty=new xi,this.onStable=new xi,this.onError=new xi}return _createClass(e,[{key:"run",value:function(e){return e()}},{key:"runGuarded",value:function(e){return e()}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e){return e()}}]),e}(),go=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){so.assertNotInAngularZone(),ao((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())ao((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout((function(){r._callbacks=r._callbacks.filter((function(e){return e.timeoutId!==i})),e(r._didWork,r.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}(),yo=function(){function e(){_classCallCheck(this,e),this._applications=new Map,mo.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return mo.findTestabilityInTree(this,e,t)}}]),e}(),mo=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),_o=function(e,t,n){return e.get(Zi).createCompiler([t]).compileModuleAsync(n)},bo=new De("AllowMultipleToken"),wo=function e(t,n){_classCallCheck(this,e),this.name=t,this.token=n};function Co(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new De(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=ko();if(!o||o.injector.get(bo,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var a=n.concat(t).concat({provide:i,useValue:!0});!function(e){if(po&&!po.destroyed&&!po.injector.get(bo,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");po=e.get(Eo);var t=e.get(Ui,null);t&&t.forEach((function(e){return e()}))}(Lt.create({providers:a,name:r}))}return function(e){var t=ko();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function ko(){return po&&!po.destroyed?po:null}var Eo=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r=this,i="noop"===(n=t?t.ngZone:void 0)?new vo:("zone.js"===n?void 0:n)||new so({enableLongStackTrace:it()}),o=[{provide:so,useValue:i}];return i.run((function(){var t=Lt.create({providers:o,parent:r.injector,name:e.moduleType.name}),n=e.create(t),a=n.injector.get(tt,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return Hi&&Di(n.injector.get(Wi,Ni)||Ni),n.onDestroy((function(){return Ao(r._modules,n)})),i.runOutsideAngular((function(){return i.onError.subscribe({next:function(e){a.handleError(e)}})})),function(e,t,i){try{var o=((a=n.injector.get(Mi)).runInitializers(),a.donePromise.then((function(){return r._moduleDoBootstrap(n),n})));return $t(o)?o.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):o}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var a}(a,i)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=So({},n);return _o(this.injector,r,e).then((function(e){return t.bootstrapModuleFactory(e,r)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Io);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(be(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function So(e,t){return Array.isArray(t)?t.reduce(So,e):Object.assign({},e,t)}var To,Io=((To=function(){function e(t,n,r,i,o,a){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=it(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new k((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),l=new k((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){so.assertNotInAngularZone(),ao((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){so.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=ee(u,l.pipe(ue()))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof nn?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=n instanceof ln?null:this._injector.get(We),o=n.create(Lt.NULL,[],t||n.selector,i);o.onDestroy((function(){r._unloadComponent(o)}));var a=o.injector.get(go,null);return a&&o.injector.get(yo).registerApplication(o.location.nativeElement,a),this._loadComponent(o),it()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}},{key:"tick",value:function(){var t=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=e._tickScope();try{this._runningTick=!0;var r=!0,i=!1,o=void 0;try{for(var a,s=this._views[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.detectChanges()}catch(d){i=!0,o=d}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}if(this._enforceNoNewChanges){var u=!0,l=!1,c=void 0;try{for(var h,f=this._views[Symbol.iterator]();!(u=(h=f.next()).done);u=!0)h.value.checkNoChanges()}catch(d){l=!0,c=d}finally{try{u||null==f.return||f.return()}finally{if(l)throw c}}}}catch(p){this._zone.runOutsideAngular((function(){return t._exceptionHandler.handleError(p)}))}finally{this._runningTick=!1,io(n)}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;Ao(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Bi,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),Ao(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}())._tickScope=ro("ApplicationRef#tick()"),To);function Ao(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var No=function e(){_classCallCheck(this,e)},Do=function e(){_classCallCheck(this,e)},xo={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Ro=function(){function e(t,n){_classCallCheck(this,e),this._compiler=t,this._config=n||xo}return _createClass(e,[{key:"load",value:function(e){return!Hi&&this._compiler instanceof $i?this.loadFactory(e):this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,r=_slicedToArray(e.split("#"),2),i=r[0],o=r[1];return void 0===o&&(o="default"),n("zn8P")(i).then((function(e){return e[o]})).then((function(e){return Oo(e,i,o)})).then((function(e){return t._compiler.compileModuleAsync(e)}))}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],i=t[1],o="NgFactory";return void 0===i&&(i="default",o=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then((function(e){return e[i+o]})).then((function(e){return Oo(e,r,i)}))}}]),e}();function Oo(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var Po=function e(t,n){_classCallCheck(this,e),this.name=t,this.callback=n},Mo=function(){function e(t,n,r){_classCallCheck(this,e),this.listeners=[],this.parent=null,this._debugContext=r,this.nativeNode=t,n&&n instanceof Lo&&n.addChild(this)}return _createClass(e,[{key:"injector",get:function(){return this._debugContext.injector}},{key:"componentInstance",get:function(){return this._debugContext.component}},{key:"context",get:function(){return this._debugContext.context}},{key:"references",get:function(){return this._debugContext.references}},{key:"providerTokens",get:function(){return this._debugContext.providerTokens}}]),e}(),Lo=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n,r))).properties={},i.attributes={},i.classes={},i.styles={},i.childNodes=[],i.nativeElement=e,i}return _inherits(t,e),_createClass(t,[{key:"addChild",value:function(e){e&&(this.childNodes.push(e),e.parent=this)}},{key:"removeChild",value:function(e){var t=this.childNodes.indexOf(e);-1!==t&&(e.parent=null,this.childNodes.splice(t,1))}},{key:"insertChildrenAfter",value:function(e,t){var n,r=this,i=this.childNodes.indexOf(e);-1!==i&&((n=this.childNodes).splice.apply(n,[i+1,0].concat(_toConsumableArray(t))),t.forEach((function(t){t.parent&&t.parent.removeChild(t),e.parent=r})))}},{key:"insertBefore",value:function(e,t){var n=this.childNodes.indexOf(e);-1===n?this.addChild(t):(t.parent&&t.parent.removeChild(t),t.parent=this,this.childNodes.splice(n,0,t))}},{key:"query",value:function(e){return this.queryAll(e)[0]||null}},{key:"queryAll",value:function(e){var n=[];return function e(n,r,i){n.childNodes.forEach((function(n){n instanceof t&&(r(n)&&i.push(n),e(n,r,i))}))}(this,e,n),n}},{key:"queryAllNodes",value:function(e){var n=[];return function e(n,r,i){n instanceof t&&n.childNodes.forEach((function(n){r(n)&&i.push(n),n instanceof t&&e(n,r,i)}))}(this,e,n),n}},{key:"triggerEventHandler",value:function(e,t){this.listeners.forEach((function(n){n.name==e&&n.callback(t)}))}},{key:"children",get:function(){return this.childNodes.filter((function(e){return e instanceof t}))}}]),t}(Mo),Fo=new Map,Vo=function(e){return Fo.get(e)||null};function Uo(e){Fo.set(e.nativeNode,e)}var qo=Co(null,"core",[{provide:qi,useValue:"unknown"},{provide:Eo,deps:[Lt]},{provide:yo,deps:[]},{provide:ji,deps:[]}]);function Bo(){return xn}function jo(){return Rn}function Wo(e){return e?(Hi&&Di(e),e):Ni}function Ho(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}var zo=function e(t){_classCallCheck(this,e)};function Qo(e,t,n,r,i,o){e|=1;var a=fr(t),s=a.matchedQueries,u=a.references;return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:e,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:a.matchedQueryIds,references:u,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?gr(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||Kn},provider:null,text:null,query:null,ngContent:null}}function Go(e,t,n,r,i,o){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0;c||(c=Kn);var d=fr(n),p=d.matchedQueries,v=d.references,g=d.matchedQueryIds,y=null,m=null;o&&(y=(a=_slicedToArray(kr(o),2))[0],m=a[1]),u=u||[];for(var _=new Array(u.length),b=0;b<u.length;b++){var w=_slicedToArray(u[b],3),C=w[0],k=w[1],E=w[2],S=_slicedToArray(kr(k),2),T=S[0],I=S[1],A=void 0,N=void 0;switch(15&C){case 4:N=E;break;case 1:case 8:A=E}_[b]={flags:C,ns:T,name:I,nonMinifiedName:I,securityContext:A,suffix:N}}l=l||[];for(var D=new Array(l.length),x=0;x<l.length;x++){var R=_slicedToArray(l[x],2),O=R[0],P=R[1];D[x]={type:0,target:O,eventName:P,propName:null}}var M=(s=s||[]).map((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],i=_slicedToArray(kr(n),2);return[i[0],i[1],r]}));return f=function(e){if(e&&e.id===Jn){var t=null!=e.encapsulation&&e.encapsulation!==Ge.None||e.styles.length||Object.keys(e.data).length;e.id=t?"c".concat(er++):$n}return e&&e.id===$n&&(e=null),e||null}(f),h&&(t|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:g,references:v,ngContentIndex:r,childCount:i,bindings:_,bindingFlags:Er(_),outputs:D,element:{ns:y,name:m,attrs:M,template:null,componentProvider:null,componentView:h||null,componentRendererType:f,publicProviders:null,allProviders:null,handleEvent:c||Kn},provider:null,text:null,query:null,ngContent:null}}function Ko(e,t,n){var r,i=n.element,o=e.root.selectorOrNode,a=e.renderer;if(e.parent||!o){r=i.name?a.createElement(i.name,i.ns):a.createComment("");var s=pr(e,t,n);s&&a.appendChild(s,r)}else r=a.selectRootElement(o,!!i.componentRendererType&&i.componentRendererType.encapsulation===Ge.ShadowDom);if(i.attrs)for(var u=0;u<i.attrs.length;u++){var l=_slicedToArray(i.attrs[u],3),c=l[0],h=l[1],f=l[2];a.setAttribute(r,h,f,c)}return r}function Yo(e,t,n,r){for(var i=0;i<n.outputs.length;i++){var o=n.outputs[i],a=Xo(e,n.nodeIndex,(h=o.eventName,(c=o.target)?"".concat(c,":").concat(h):h)),s=o.target,u=e;"component"===o.target&&(s=null,u=t);var l=u.renderer.listen(s||r,o.eventName,a);e.disposables[n.outputIndex+i]=l}var c,h}function Xo(e,t,n){return function(r){return ar(e,t,n,r)}}function Jo(e,t,n,r){if(!nr(e,t,n,r))return!1;var i=t.bindings[n],o=Wn(e,t.nodeIndex),a=o.renderElement,s=i.name;switch(15&i.flags){case 1:!function(e,t,n,r,i,o){var a=t.securityContext,s=a?e.root.sanitizer.sanitize(a,o):o;s=null!=s?s.toString():null;var u=e.renderer;null!=o?u.setAttribute(n,i,s,r):u.removeAttribute(n,i,r)}(e,i,a,i.ns,s,r);break;case 2:!function(e,t,n,r){var i=e.renderer;r?i.addClass(t,n):i.removeClass(t,n)}(e,a,s,r);break;case 4:!function(e,t,n,r,i){var o=e.root.sanitizer.sanitize(Tt.STYLE,i);if(null!=o){o=o.toString();var a=t.suffix;null!=a&&(o+=a)}else o=null;var s=e.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(e,i,a,s,r);break;case 8:!function(e,t,n,r,i){var o=t.securityContext,a=o?e.root.sanitizer.sanitize(o,i):i;e.renderer.setProperty(n,r,a)}(33554432&t.flags&&32&i.flags?o.componentView:e,i,a,s,r)}return!0}function $o(e){for(var t=e.def.nodeMatchedQueries;e.parent&&hr(e);){var n=e.parentNodeDef;e=e.parent;for(var r=n.nodeIndex+n.childCount,i=0;i<=r;i++){var o=e.def.nodes[i];67108864&o.flags&&536870912&o.flags&&(o.query.filterId&t)===o.query.filterId&&Qn(e,i).setDirty(),!(1&o.flags&&i+o.childCount<n.nodeIndex)&&67108864&o.childFlags&&536870912&o.childFlags||(i+=o.childCount)}}if(134217728&e.def.nodeFlags)for(var a=0;a<e.def.nodes.length;a++){var s=e.def.nodes[a];134217728&s.flags&&536870912&s.flags&&Qn(e,a).setDirty(),a+=s.childCount}}function Zo(e,t){var n=Qn(e,t.nodeIndex);if(n.dirty){var r,i=void 0;if(67108864&t.flags){var o=t.parent.parent;i=ea(e,o.nodeIndex,o.nodeIndex+o.childCount,t.query,[]),r=Hn(e,t.parent.nodeIndex).instance}else 134217728&t.flags&&(i=ea(e,0,e.def.nodes.length-1,t.query,[]),r=e.component);n.reset(i);for(var a=t.query.bindings,s=!1,u=0;u<a.length;u++){var l=a[u],c=void 0;switch(l.bindingType){case 0:c=n.first;break;case 1:c=n,s=!0}r[l.propName]=c}s&&n.notifyOnChanges()}}function ea(e,t,n,r,i){for(var o=t;o<=n;o++){var a=e.def.nodes[o],s=a.matchedQueries[r.id];if(null!=s&&i.push(ta(e,a,s)),1&a.flags&&a.element.template&&(a.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var u=Wn(e,o);if((a.childMatchedQueries&r.filterId)===r.filterId&&(ea(e,o+1,o+a.childCount,r,i),o+=a.childCount),16777216&a.flags)for(var l=u.viewContainer._embeddedViews,c=0;c<l.length;c++){var h=l[c],f=sr(h);f&&f===u&&ea(h,0,h.def.nodes.length-1,r,i)}var d=u.template._projectedViews;if(d)for(var p=0;p<d.length;p++){var v=d[p];ea(v,0,v.def.nodes.length-1,r,i)}}(a.childMatchedQueries&r.filterId)!==r.filterId&&(o+=a.childCount)}return i}function ta(e,t,n){if(null!=n)switch(n){case 1:return Wn(e,t.nodeIndex).renderElement;case 0:return new hn(Wn(e,t.nodeIndex).renderElement);case 2:return Wn(e,t.nodeIndex).template;case 3:return Wn(e,t.nodeIndex).viewContainer;case 4:return Hn(e,t.nodeIndex).instance}}function na(e,t,n){var r=pr(e,t,n);r&&_r(e,n.ngContent.index,1,r,null,void 0)}function ra(e,t){for(var n=Object.keys(t),r=n.length,i=new Array(r),o=0;o<r;o++){var a=n[o];i[t[a]]=a}return function(e,t,n){for(var r=new Array(n.length),i=0;i<n.length;i++){var o=n[i];r[i]={flags:8,name:o,ns:null,nonMinifiedName:o,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:64,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:Er(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}(0,e,i)}function ia(e,t,n){for(var r=new Array(n.length-1),i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function oa(e,t,n){var r,i=e.renderer;r=i.createText(n.text.prefix);var o=pr(e,t,n);return o&&i.appendChild(o,r),{renderText:r}}function aa(e,t){return(null!=e?e.toString():"")+t.suffix}function sa(e,t,n,r){for(var i=0,o=0,a=0,s=0,u=0,l=null,c=null,h=!1,f=!1,d=null,p=0;p<t.length;p++){var v=t[p];if(v.nodeIndex=p,v.parent=l,v.bindingIndex=i,v.outputIndex=o,v.renderParent=c,a|=v.flags,u|=v.matchedQueryIds,v.element){var g=v.element;g.publicProviders=l?l.element.publicProviders:Object.create(null),g.allProviders=g.publicProviders,h=!1,f=!1,v.element.template&&(u|=v.element.template.nodeMatchedQueries)}if(la(l,v,t.length),i+=v.bindings.length,o+=v.outputs.length,!c&&3&v.flags&&(d=v),20224&v.flags){h||(h=!0,l.element.publicProviders=Object.create(l.element.publicProviders),l.element.allProviders=l.element.publicProviders);var y=0!=(32768&v.flags);0==(8192&v.flags)||y?l.element.publicProviders[Xn(v.provider.token)]=v:(f||(f=!0,l.element.allProviders=Object.create(l.element.publicProviders)),l.element.allProviders[Xn(v.provider.token)]=v),y&&(l.element.componentProvider=v)}if(l?(l.childFlags|=v.flags,l.directChildFlags|=v.flags,l.childMatchedQueries|=v.matchedQueryIds,v.element&&v.element.template&&(l.childMatchedQueries|=v.element.template.nodeMatchedQueries)):s|=v.flags,v.childCount>0)l=v,ua(v)||(c=v);else for(;l&&p===l.nodeIndex+l.childCount;){var m=l.parent;m&&(m.childFlags|=l.childFlags,m.childMatchedQueries|=l.childMatchedQueries),c=(l=m)&&ua(l)?l.renderParent:l}}return{factory:null,nodeFlags:a,rootNodeFlags:s,nodeMatchedQueries:u,flags:e,nodes:t,updateDirectives:n||Kn,updateRenderer:r||Kn,handleEvent:function(e,n,r,i){return t[n].element.handleEvent(e,r,i)},bindingCount:i,outputCount:o,lastRenderRootNode:d}}function ua(e){return 0!=(1&e.flags)&&null===e.element.name}function la(e,t,n){var r=t.element&&t.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index ".concat(t.nodeIndex,"!"))}if(20224&t.flags&&0==(1&(e?e.flags:0)))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ".concat(t.nodeIndex,"!"));if(t.query){if(67108864&t.flags&&(!e||0==(16384&e.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index ".concat(t.nodeIndex,"!"));if(134217728&t.flags&&e)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index ".concat(t.nodeIndex,"!"))}if(t.childCount){var i=e?e.nodeIndex+e.childCount:n-1;if(t.nodeIndex<=i&&t.nodeIndex+t.childCount>i)throw new Error("Illegal State: childCount of node leads outside of parent, at index ".concat(t.nodeIndex,"!"))}}function ca(e,t,n,r){var i=da(e.root,e.renderer,e,t,n);return pa(i,e.component,r),va(i),i}function ha(e,t,n){var r=da(e,e.renderer,null,null,t);return pa(r,n,n),va(r),r}function fa(e,t,n,r){var i,o=t.element.componentRendererType;return i=o?e.root.rendererFactory.createRenderer(r,o):e.root.renderer,da(e.root,i,e,t.element.componentProvider,n)}function da(e,t,n,r,i){var o=new Array(i.nodes.length),a=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:e,renderer:t,oldValues:new Array(i.bindingCount),disposables:a,initIndex:-1}}function pa(e,t,n){e.component=t,e.context=n}function va(e){var t;cr(e)&&(t=Wn(e.parent,e.parentNodeDef.parent.nodeIndex).renderElement);for(var n=e.def,r=e.nodes,i=0;i<n.nodes.length;i++){var o=n.nodes[i],a=void 0;switch(Gn.setCurrentNode(e,i),201347067&o.flags){case 1:var s=Ko(e,t,o),u=void 0;if(33554432&o.flags){var l=gr(o.element.componentView);u=Gn.createComponentView(e,o,l,s)}Yo(e,u,o,s),a={renderElement:s,componentView:u,viewContainer:null,template:o.element.template?zr(e,o):void 0},16777216&o.flags&&(a.viewContainer=Br(e,o,a));break;case 2:a=oa(e,t,o);break;case 512:case 1024:case 2048:case 256:(a=r[i])||4096&o.flags||(a={instance:hi(e,o)});break;case 16:a={instance:fi(e,o)};break;case 16384:(a=r[i])||(a={instance:di(e,o)}),32768&o.flags&&pa(Wn(e,o.parent.nodeIndex).componentView,a.instance,a.instance);break;case 32:case 64:case 128:a={value:void 0};break;case 67108864:case 134217728:a=new Oi;break;case 8:na(e,t,o),a=void 0}r[i]=a}Ea(e,ka.CreateViewNodes),Aa(e,201326592,268435456,0)}function ga(e){_a(e),Gn.updateDirectives(e,1),Sa(e,ka.CheckNoChanges),Gn.updateRenderer(e,1),Ea(e,ka.CheckNoChanges),e.state&=-97}function ya(e){1&e.state?(e.state&=-2,e.state|=2):e.state&=-3,qn(e,0,256),_a(e),Gn.updateDirectives(e,0),Sa(e,ka.CheckAndUpdate),Aa(e,67108864,536870912,0);var t=qn(e,256,512);wi(e,2097152|(t?1048576:0)),Gn.updateRenderer(e,0),Ea(e,ka.CheckAndUpdate),Aa(e,134217728,536870912,0),wi(e,8388608|((t=qn(e,512,768))?4194304:0)),2&e.def.flags&&(e.state&=-9),e.state&=-97,qn(e,768,1024)}function ma(e,t,n,r,i,o,a,s,u,l,c,h,f){return 0===n?function(e,t,n,r,i,o,a,s,u,l,c,h){switch(201347067&t.flags){case 1:return function(e,t,n,r,i,o,a,s,u,l,c,h){var f=t.bindings.length,d=!1;return f>0&&Jo(e,t,0,n)&&(d=!0),f>1&&Jo(e,t,1,r)&&(d=!0),f>2&&Jo(e,t,2,i)&&(d=!0),f>3&&Jo(e,t,3,o)&&(d=!0),f>4&&Jo(e,t,4,a)&&(d=!0),f>5&&Jo(e,t,5,s)&&(d=!0),f>6&&Jo(e,t,6,u)&&(d=!0),f>7&&Jo(e,t,7,l)&&(d=!0),f>8&&Jo(e,t,8,c)&&(d=!0),f>9&&Jo(e,t,9,h)&&(d=!0),d}(e,t,n,r,i,o,a,s,u,l,c,h);case 2:return function(e,t,n,r,i,o,a,s,u,l,c,h){var f=!1,d=t.bindings,p=d.length;if(p>0&&nr(e,t,0,n)&&(f=!0),p>1&&nr(e,t,1,r)&&(f=!0),p>2&&nr(e,t,2,i)&&(f=!0),p>3&&nr(e,t,3,o)&&(f=!0),p>4&&nr(e,t,4,a)&&(f=!0),p>5&&nr(e,t,5,s)&&(f=!0),p>6&&nr(e,t,6,u)&&(f=!0),p>7&&nr(e,t,7,l)&&(f=!0),p>8&&nr(e,t,8,c)&&(f=!0),p>9&&nr(e,t,9,h)&&(f=!0),f){var v=t.text.prefix;p>0&&(v+=aa(n,d[0])),p>1&&(v+=aa(r,d[1])),p>2&&(v+=aa(i,d[2])),p>3&&(v+=aa(o,d[3])),p>4&&(v+=aa(a,d[4])),p>5&&(v+=aa(s,d[5])),p>6&&(v+=aa(u,d[6])),p>7&&(v+=aa(l,d[7])),p>8&&(v+=aa(c,d[8])),p>9&&(v+=aa(h,d[9]));var g=jn(e,t.nodeIndex).renderText;e.renderer.setValue(g,v)}return f}(e,t,n,r,i,o,a,s,u,l,c,h);case 16384:return function(e,t,n,r,i,o,a,s,u,l,c,h){var f=Hn(e,t.nodeIndex),d=f.instance,p=!1,v=void 0,g=t.bindings.length;return g>0&&tr(e,t,0,n)&&(p=!0,v=bi(e,f,t,0,n,v)),g>1&&tr(e,t,1,r)&&(p=!0,v=bi(e,f,t,1,r,v)),g>2&&tr(e,t,2,i)&&(p=!0,v=bi(e,f,t,2,i,v)),g>3&&tr(e,t,3,o)&&(p=!0,v=bi(e,f,t,3,o,v)),g>4&&tr(e,t,4,a)&&(p=!0,v=bi(e,f,t,4,a,v)),g>5&&tr(e,t,5,s)&&(p=!0,v=bi(e,f,t,5,s,v)),g>6&&tr(e,t,6,u)&&(p=!0,v=bi(e,f,t,6,u,v)),g>7&&tr(e,t,7,l)&&(p=!0,v=bi(e,f,t,7,l,v)),g>8&&tr(e,t,8,c)&&(p=!0,v=bi(e,f,t,8,c,v)),g>9&&tr(e,t,9,h)&&(p=!0,v=bi(e,f,t,9,h,v)),v&&d.ngOnChanges(v),65536&t.flags&&Bn(e,256,t.nodeIndex)&&d.ngOnInit(),262144&t.flags&&d.ngDoCheck(),p}(e,t,n,r,i,o,a,s,u,l,c,h);case 32:case 64:case 128:return function(e,t,n,r,i,o,a,s,u,l,c,h){var f=t.bindings,d=!1,p=f.length;if(p>0&&nr(e,t,0,n)&&(d=!0),p>1&&nr(e,t,1,r)&&(d=!0),p>2&&nr(e,t,2,i)&&(d=!0),p>3&&nr(e,t,3,o)&&(d=!0),p>4&&nr(e,t,4,a)&&(d=!0),p>5&&nr(e,t,5,s)&&(d=!0),p>6&&nr(e,t,6,u)&&(d=!0),p>7&&nr(e,t,7,l)&&(d=!0),p>8&&nr(e,t,8,c)&&(d=!0),p>9&&nr(e,t,9,h)&&(d=!0),d){var v,g=zn(e,t.nodeIndex);switch(201347067&t.flags){case 32:v=new Array(f.length),p>0&&(v[0]=n),p>1&&(v[1]=r),p>2&&(v[2]=i),p>3&&(v[3]=o),p>4&&(v[4]=a),p>5&&(v[5]=s),p>6&&(v[6]=u),p>7&&(v[7]=l),p>8&&(v[8]=c),p>9&&(v[9]=h);break;case 64:v={},p>0&&(v[f[0].name]=n),p>1&&(v[f[1].name]=r),p>2&&(v[f[2].name]=i),p>3&&(v[f[3].name]=o),p>4&&(v[f[4].name]=a),p>5&&(v[f[5].name]=s),p>6&&(v[f[6].name]=u),p>7&&(v[f[7].name]=l),p>8&&(v[f[8].name]=c),p>9&&(v[f[9].name]=h);break;case 128:var y=n;switch(p){case 1:v=y.transform(n);break;case 2:v=y.transform(r);break;case 3:v=y.transform(r,i);break;case 4:v=y.transform(r,i,o);break;case 5:v=y.transform(r,i,o,a);break;case 6:v=y.transform(r,i,o,a,s);break;case 7:v=y.transform(r,i,o,a,s,u);break;case 8:v=y.transform(r,i,o,a,s,u,l);break;case 9:v=y.transform(r,i,o,a,s,u,l,c);break;case 10:v=y.transform(r,i,o,a,s,u,l,c,h)}}g.value=v}return d}(e,t,n,r,i,o,a,s,u,l,c,h);default:throw"unreachable"}}(e,t,r,i,o,a,s,u,l,c,h,f):function(e,t,n){switch(201347067&t.flags){case 1:return function(e,t,n){for(var r=!1,i=0;i<n.length;i++)Jo(e,t,i,n[i])&&(r=!0);return r}(e,t,n);case 2:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)nr(e,t,o,n[o])&&(i=!0);if(i){for(var a="",s=0;s<n.length;s++)a+=aa(n[s],r[s]);a=t.text.prefix+a;var u=jn(e,t.nodeIndex).renderText;e.renderer.setValue(u,a)}return i}(e,t,n);case 16384:return function(e,t,n){for(var r=Hn(e,t.nodeIndex),i=r.instance,o=!1,a=void 0,s=0;s<n.length;s++)tr(e,t,s,n[s])&&(o=!0,a=bi(e,r,t,s,n[s],a));return a&&i.ngOnChanges(a),65536&t.flags&&Bn(e,256,t.nodeIndex)&&i.ngOnInit(),262144&t.flags&&i.ngDoCheck(),o}(e,t,n);case 32:case 64:case 128:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)nr(e,t,o,n[o])&&(i=!0);if(i){var a,s=zn(e,t.nodeIndex);switch(201347067&t.flags){case 32:a=n;break;case 64:a={};for(var u=0;u<n.length;u++)a[r[u].name]=n[u];break;case 128:var l=n[0],c=n.slice(1);a=l.transform.apply(l,_toConsumableArray(c))}s.value=a}return i}(e,t,n);default:throw"unreachable"}}(e,t,r)}function _a(e){var t=e.def;if(4&t.nodeFlags)for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];if(4&r.flags){var i=Wn(e,n).template._projectedViews;if(i)for(var o=0;o<i.length;o++){var a=i[o];a.state|=32,or(a,e)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function ba(e,t,n,r,i,o,a,s,u,l,c,h,f){return 0===n?function(e,t,n,r,i,o,a,s,u,l,c,h){var f=t.bindings.length;f>0&&rr(e,t,0,n),f>1&&rr(e,t,1,r),f>2&&rr(e,t,2,i),f>3&&rr(e,t,3,o),f>4&&rr(e,t,4,a),f>5&&rr(e,t,5,s),f>6&&rr(e,t,6,u),f>7&&rr(e,t,7,l),f>8&&rr(e,t,8,c),f>9&&rr(e,t,9,h)}(e,t,r,i,o,a,s,u,l,c,h,f):function(e,t,n){for(var r=0;r<n.length;r++)rr(e,t,r,n[r])}(e,t,r),!1}function wa(e,t){if(Qn(e,t.nodeIndex).dirty)throw Fn(Gn.createDebugContext(e,t.nodeIndex),"Query ".concat(t.query.id," not dirty"),"Query ".concat(t.query.id," dirty"),0!=(1&e.state))}function Ca(e){if(!(128&e.state)){if(Sa(e,ka.Destroy),Ea(e,ka.Destroy),wi(e,131072),e.disposables)for(var t=0;t<e.disposables.length;t++)e.disposables[t]();!function(e){if(16&e.state){var t=sr(e);if(t){var n=t.template._projectedViews;n&&(Qe(n,n.indexOf(e)),Gn.dirtyParentQueries(e))}}}(e),e.renderer.destroyNode&&function(e){for(var t=e.def.nodes.length,n=0;n<t;n++){var r=e.def.nodes[n];1&r.flags?e.renderer.destroyNode(Wn(e,n).renderElement):2&r.flags?e.renderer.destroyNode(jn(e,n).renderText):(67108864&r.flags||134217728&r.flags)&&Qn(e,n).destroy()}}(e),cr(e)&&e.renderer.destroy(),e.state|=128}}var ka=function(){var e={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return e[e.CreateViewNodes]="CreateViewNodes",e[e.CheckNoChanges]="CheckNoChanges",e[e.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",e[e.CheckAndUpdate]="CheckAndUpdate",e[e.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",e[e.Destroy]="Destroy",e}();function Ea(e,t){var n=e.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];33554432&i.flags?Ta(Wn(e,r).componentView,t):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function Sa(e,t){var n=e.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];if(16777216&i.flags)for(var o=Wn(e,r).viewContainer._embeddedViews,a=0;a<o.length;a++)Ta(o[a],t);else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function Ta(e,t){var n=e.state;switch(t){case ka.CheckNoChanges:0==(128&n)&&(12==(12&n)?ga(e):64&n&&Ia(e,ka.CheckNoChangesProjectedViews));break;case ka.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ga(e):64&n&&Ia(e,t));break;case ka.CheckAndUpdate:0==(128&n)&&(12==(12&n)?ya(e):64&n&&Ia(e,ka.CheckAndUpdateProjectedViews));break;case ka.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?ya(e):64&n&&Ia(e,t));break;case ka.Destroy:Ca(e);break;case ka.CreateViewNodes:va(e)}}function Ia(e,t){Sa(e,t),Ea(e,t)}function Aa(e,t,n,r){if(e.def.nodeFlags&t&&e.def.nodeFlags&n)for(var i=e.def.nodes.length,o=0;o<i;o++){var a=e.def.nodes[o];if(a.flags&t&&a.flags&n)switch(Gn.setCurrentNode(e,a.nodeIndex),r){case 0:Zo(e,a);break;case 1:wa(e,a)}a.childFlags&t&&a.childFlags&n||(o+=a.childCount)}}var Na=!1;function Da(e,t,n,r,i,o){var a=i.injector.get(dn);return ha(Ra(e,i,a,t,n),r,o)}function xa(e,t,n,r,i,o){var a=i.injector.get(dn),s=Ra(e,i,new cs(a),t,n),u=ja(r);return us(Ja.create,ha,null,[s,u,o])}function Ra(e,t,n,r,i){var o=t.injector.get(It),a=t.injector.get(tt),s=n.createRenderer(null,null);return{ngModule:t,injector:e,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:s,errorHandler:a}}function Oa(e,t,n,r){var i=ja(n);return us(Ja.create,ca,null,[e,t,i,r])}function Pa(e,t,n,r){return n=Va.get(t.element.componentProvider.provider.token)||ja(n),us(Ja.create,fa,null,[e,t,n,r])}function Ma(e,t,n,r){return $r(e,t,n,function(e){var t=function(e){var t=!1,n=!1;return 0===La.size?{hasOverrides:t,hasDeprecatedOverrides:n}:(e.providers.forEach((function(e){var r=La.get(e.token);3840&e.flags&&r&&(t=!0,n=n||r.deprecatedBehavior)})),e.modules.forEach((function(e){Fa.forEach((function(r,i){me(i).providedIn===e&&(t=!0,n=n||r.deprecatedBehavior)}))})),{hasOverrides:t,hasDeprecatedOverrides:n})}(e),n=t.hasOverrides,r=t.hasDeprecatedOverrides;return n?(function(e){for(var t=0;t<e.providers.length;t++){var n=e.providers[t];r&&(n.flags|=4096);var i=La.get(n.token);i&&(n.flags=-3841&n.flags|i.flags,n.deps=dr(i.deps),n.value=i.value)}if(Fa.size>0){var o=new Set(e.modules);Fa.forEach((function(t,n){if(o.has(me(n).providedIn)){var i={token:n,flags:t.flags|(r?4096:0),deps:dr(t.deps),value:t.value,index:e.providers.length};e.providers.push(i),e.providersByKey[Xn(n)]=i}}))}}(e=e.factory((function(){return Kn}))),e):e}(r))}var La=new Map,Fa=new Map,Va=new Map;function Ua(e){var t;La.set(e.token,e),"function"==typeof e.token&&(t=me(e.token))&&"function"==typeof t.providedIn&&Fa.set(e.token,e)}function qa(e,t){var n=gr(t.viewDefFactory),r=gr(n.nodes[0].element.componentView);Va.set(e,r)}function Ba(){La.clear(),Fa.clear(),Va.clear()}function ja(e){if(0===La.size)return e;var t=function(e){for(var t=[],n=null,r=0;r<e.nodes.length;r++){var i=e.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&La.has(i.provider.token)&&(t.push(n.nodeIndex),n=null)}return t}(e);if(0===t.length)return e;e=e.factory((function(){return Kn}));for(var n=0;n<t.length;n++)r(e,t[n]);return e;function r(e,t){for(var n=t+1;n<e.nodes.length;n++){var r=e.nodes[n];if(1&r.flags)return;if(3840&r.flags){var i=r.provider,o=La.get(i.token);o&&(r.flags=-3841&r.flags|o.flags,i.deps=dr(o.deps),i.value=o.value)}}}}function Wa(e,t,n,r,i,o,a,s,u,l,c,h,f){var d=e.def.nodes[t];return ma(e,d,n,r,i,o,a,s,u,l,c,h,f),224&d.flags?zn(e,t).value:void 0}function Ha(e,t,n,r,i,o,a,s,u,l,c,h,f){var d=e.def.nodes[t];return ba(e,d,n,r,i,o,a,s,u,l,c,h,f),224&d.flags?zn(e,t).value:void 0}function za(e){return us(Ja.detectChanges,ya,null,[e])}function Qa(e){return us(Ja.checkNoChanges,ga,null,[e])}function Ga(e){return us(Ja.destroy,Ca,null,[e])}var Ka,Ya,Xa,Ja=function(){var e={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return e[e.create]="create",e[e.detectChanges]="detectChanges",e[e.checkNoChanges]="checkNoChanges",e[e.destroy]="destroy",e[e.handleEvent]="handleEvent",e}();function $a(e,t){Ya=e,Xa=t}function Za(e,t,n,r){return $a(e,t),us(Ja.handleEvent,e.def.handleEvent,null,[e,t,n,r])}function es(e,t){if(128&e.state)throw Un(Ja[Ka]);return $a(e,is(e,0)),e.def.updateDirectives((function(e,n,r){for(var i=e.def.nodes[n],o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return 0===t?ns(e,i,r,a):rs(e,i,r,a),16384&i.flags&&$a(e,is(e,n)),224&i.flags?zn(e,i.nodeIndex).value:void 0}),e)}function ts(e,t){if(128&e.state)throw Un(Ja[Ka]);return $a(e,os(e,0)),e.def.updateRenderer((function(e,n,r){for(var i=e.def.nodes[n],o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return 0===t?ns(e,i,r,a):rs(e,i,r,a),3&i.flags&&$a(e,os(e,n)),224&i.flags?zn(e,i.nodeIndex).value:void 0}),e)}function ns(e,t,n,r){if(ma.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))){var i=1===n?r[0]:r;if(16384&t.flags){for(var o={},a=0;a<t.bindings.length;a++){var s=t.bindings[a],u=i[a];8&s.flags&&(o[(d=s.nonMinifiedName,p=void 0,p=d.replace(/[$@]/g,"_"),"ng-reflect-".concat(d=p.replace(Dt,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"-"+t[1].toLowerCase()}))))]=xt(u))}var l=t.parent,c=Wn(e,l.nodeIndex).renderElement;if(l.element.name)for(var h in o){var f=o[h];null!=f?e.renderer.setAttribute(c,h,f):e.renderer.removeAttribute(c,h)}else e.renderer.setValue(c,"bindings=".concat(JSON.stringify(o,null,2)))}}var d,p}function rs(e,t,n,r){ba.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))}function is(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function os(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}var as=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.nodeIndex=n,null==n&&(this.nodeIndex=n=0),this.nodeDef=t.def.nodes[n];for(var r=this.nodeDef,i=t;r&&0==(1&r.flags);)r=r.parent;if(!r)for(;!r&&i;)r=ur(i),i=i.parent;this.elDef=r,this.elView=i}return _createClass(e,[{key:"logError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o;2&this.nodeDef.flags?(i=this.view.def,o=this.nodeDef.nodeIndex):(i=this.elView.def,o=this.elDef.nodeIndex);var a=function(e,t){for(var n=-1,r=0;r<=t;r++)3&e.nodes[r].flags&&n++;return n}(i,o),s=-1;i.factory((function(){var t;return++s===a?(t=e.error).bind.apply(t,[e].concat(n)):Kn})),s<a&&(e.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),e.error.apply(e,n))}},{key:"elOrCompView",get:function(){return Wn(this.elView,this.elDef.nodeIndex).componentView||this.view}},{key:"injector",get:function(){return Gr(this.elView,this.elDef)}},{key:"component",get:function(){return this.elOrCompView.component}},{key:"context",get:function(){return this.elOrCompView.context}},{key:"providerTokens",get:function(){var e=[];if(this.elDef)for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&e.push(n.provider.token),t+=n.childCount}return e}},{key:"references",get:function(){var e={};if(this.elDef){ss(this.elView,this.elDef,e);for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&ss(this.elView,n,e),t+=n.childCount}}return e}},{key:"componentRenderElement",get:function(){var e=function(e){for(;e&&!cr(e);)e=e.parent;return e.parent?Wn(e.parent,ur(e).nodeIndex):null}(this.elOrCompView);return e?e.renderElement:void 0}},{key:"renderNode",get:function(){return 2&this.nodeDef.flags?lr(this.view,this.nodeDef):lr(this.elView,this.elDef)}}]),e}();function ss(e,t,n){for(var r in t.references)n[r]=ta(e,t,t.references[r])}function us(e,t,n,r){var i,o,a=Ka,s=Ya,u=Xa;try{Ka=e;var l=t.apply(n,r);return Ya=s,Xa=u,Ka=a,l}catch(c){if($e(c)||!Ya)throw c;throw i=c,o=ls(),i instanceof Error||(i=new Error(i.toString())),Vn(i,o),i}}function ls(){return Ya?new as(Ya,Xa):null}var cs=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"createRenderer",value:function(e,t){return new hs(this.delegate.createRenderer(e,t))}},{key:"begin",value:function(){this.delegate.begin&&this.delegate.begin()}},{key:"end",value:function(){this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}]),e}(),hs=function(){function e(t){_classCallCheck(this,e),this.delegate=t,this.debugContextFactory=ls,this.data=this.delegate.data}return _createClass(e,[{key:"createDebugContext",value:function(e){return this.debugContextFactory(e)}},{key:"destroyNode",value:function(e){var t=Vo(e);!function(e){Fo.delete(e.nativeNode)}(t),t instanceof Mo&&(t.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(e)}},{key:"destroy",value:function(){this.delegate.destroy()}},{key:"createElement",value:function(e,t){var n=this.delegate.createElement(e,t),r=this.createDebugContext(n);if(r){var i=new Lo(n,null,r);i.name=e,Uo(i)}return n}},{key:"createComment",value:function(e){var t=this.delegate.createComment(e),n=this.createDebugContext(t);return n&&Uo(new Mo(t,null,n)),t}},{key:"createText",value:function(e){var t=this.delegate.createText(e),n=this.createDebugContext(t);return n&&Uo(new Mo(t,null,n)),t}},{key:"appendChild",value:function(e,t){var n=Vo(e),r=Vo(t);n&&r&&n instanceof Lo&&n.addChild(r),this.delegate.appendChild(e,t)}},{key:"insertBefore",value:function(e,t,n){var r=Vo(e),i=Vo(t),o=Vo(n);r&&i&&r instanceof Lo&&r.insertBefore(o,i),this.delegate.insertBefore(e,t,n)}},{key:"removeChild",value:function(e,t){var n=Vo(e),r=Vo(t);n&&r&&n instanceof Lo&&n.removeChild(r),this.delegate.removeChild(e,t)}},{key:"selectRootElement",value:function(e,t){var n=this.delegate.selectRootElement(e,t),r=ls();return r&&Uo(new Lo(n,null,r)),n}},{key:"setAttribute",value:function(e,t,n,r){var i=Vo(e);i&&i instanceof Lo&&(i.attributes[r?r+":"+t:t]=n),this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){var r=Vo(e);r&&r instanceof Lo&&(r.attributes[n?n+":"+t:t]=null),this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){var n=Vo(e);n&&n instanceof Lo&&(n.classes[t]=!0),this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){var n=Vo(e);n&&n instanceof Lo&&(n.classes[t]=!1),this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){var i=Vo(e);i&&i instanceof Lo&&(i.styles[t]=n),this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){var r=Vo(e);r&&r instanceof Lo&&(r.styles[t]=null),this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){var r=Vo(e);r&&r instanceof Lo&&(r.properties[t]=n),this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){if("string"!=typeof e){var r=Vo(e);r&&r.listeners.push(new Po(t,n))}return this.delegate.listen(e,t,n)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setValue",value:function(e,t){return this.delegate.setValue(e,t)}}]),e}();var fs=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).moduleType=e,i._bootstrapComponents=n,i._ngModuleDefFactory=r,i}return _inherits(t,e),_createClass(t,[{key:"create",value:function(e){!function(){if(!Na){Na=!0;var e=it()?{setCurrentNode:$a,createRootView:xa,createEmbeddedView:Oa,createComponentView:Pa,createNgModuleRef:Ma,overrideProvider:Ua,overrideComponentView:qa,clearOverrides:Ba,checkAndUpdateView:za,checkNoChangesView:Qa,destroyView:Ga,createDebugContext:function(e,t){return new as(e,t)},handleEvent:Za,updateDirectives:es,updateRenderer:ts}:{setCurrentNode:function(){},createRootView:Da,createEmbeddedView:ca,createComponentView:fa,createNgModuleRef:$r,overrideProvider:Kn,overrideComponentView:Kn,clearOverrides:Kn,checkAndUpdateView:ya,checkNoChangesView:ga,destroyView:Ca,createDebugContext:function(e,t){return new as(e,t)},handleEvent:function(e,t,n,r){return e.def.handleEvent(e,t,n,r)},updateDirectives:function(e,t){return e.def.updateDirectives(0===t?Wa:Ha,e)},updateRenderer:function(e,t){return e.def.updateRenderer(0===t?Wa:Ha,e)}};Gn.setCurrentNode=e.setCurrentNode,Gn.createRootView=e.createRootView,Gn.createEmbeddedView=e.createEmbeddedView,Gn.createComponentView=e.createComponentView,Gn.createNgModuleRef=e.createNgModuleRef,Gn.overrideProvider=e.overrideProvider,Gn.overrideComponentView=e.overrideComponentView,Gn.clearOverrides=e.clearOverrides,Gn.checkAndUpdateView=e.checkAndUpdateView,Gn.checkNoChangesView=e.checkNoChangesView,Gn.destroyView=e.destroyView,Gn.resolveDep=mi,Gn.createDebugContext=e.createDebugContext,Gn.handleEvent=e.handleEvent,Gn.updateDirectives=e.updateDirectives,Gn.updateRenderer=e.updateRenderer,Gn.dirtyParentQueries=$o}}();var t=function(e){var t=Array.from(e.providers),n=Array.from(e.modules),r={};for(var i in e.providersByKey)r[i]=e.providersByKey[i];return{factory:e.factory,isRoot:e.isRoot,providers:t,modules:n,providersByKey:r}}(gr(this._ngModuleDefFactory));return Gn.createNgModuleRef(this.moduleType,e||Lt.NULL,this._bootstrapComponents,t)}}]),t}(He),ds=function e(){_classCallCheck(this,e)},ps=function e(){_classCallCheck(this,e),this.title="PitrusApp"},vs=function e(){_classCallCheck(this,e)},gs=new De("Location Initialized"),ys=function e(){_classCallCheck(this,e)},ms=new De("appBaseHref"),_s=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._subject=new xi,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=e.stripTrailingSlash(bs(i)),this._platformStrategy.onPopState((function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})}))}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(t+e.normalizeQueryParams(n))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,bs(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"replaceState",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe((function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(e,t)}))}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}],[{key:"normalizeQueryParams",value:function(e){return e&&"?"!==e[0]?"?"+e:e}},{key:"joinWithSlash",value:function(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}},{key:"stripTrailingSlash",value:function(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}}]),e}();function bs(e){return e.replace(/\/index.html$/,"")}var ws=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._platformLocation=e,r._baseHref="",null!=n&&(r._baseHref=n),r}return _inherits(t,e),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=_s.joinWithSlash(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+_s.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+_s.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(ys),Cs=function(e){function t(e,n){var r;if(_classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._platformLocation=e,null==n&&(n=r._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return r._baseHref=n,_possibleConstructorReturn(r)}return _inherits(t,e),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return _s.joinWithSlash(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+_s.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+_s.normalizeQueryParams(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+_s.normalizeQueryParams(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(ys),ks=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),Es=new De("UseV4Plurals"),Ss=function e(){_classCallCheck(this,e)},Ts=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).locale=e,r.deprecatedPluralFn=n,r}return _inherits(t,e),_createClass(t,[{key:"getPluralCategory",value:function(e,t){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(t||this.locale,e):function(e){return function(e){var t=e.toLowerCase().replace(/_/g,"-"),n=Si[t];if(n)return n;var r=t.split("-")[0];if(n=Si[r])return n;if("en"===r)return Ai;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[Ti.PluralCase]}(t||this.locale)(e)){case ks.Zero:return"zero";case ks.One:return"one";case ks.Two:return"two";case ks.Few:return"few";case ks.Many:return"many";default:return"other"}}}]),t}(Ss);function Is(e,t){t=encodeURIComponent(t);var n=!0,r=!1,i=void 0;try{for(var o,a=e.split(";")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.indexOf("="),l=_slicedToArray(-1==u?[s,""]:[s.slice(0,u),s.slice(u+1)],2),c=l[0],h=l[1];if(c.trim()===t)return decodeURIComponent(h)}}catch(f){r=!0,i=f}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}var As=function e(){_classCallCheck(this,e)},Ns=function(){function e(t,n,r,i){_classCallCheck(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._initialClasses=[]}return _createClass(e,[{key:"getValue",value:function(){return null}},{key:"setClass",value:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"setNgClass",value:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Xt(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"applyChanges",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachRemovedItem((function(e){e.previousValue&&t._toggleClass(e.key,!1)}))}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(be(e.item)));t._toggleClass(e.item,!0)})),e.forEachRemovedItem((function(e){return t._toggleClass(e.item,!1)}))}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!0)})):Object.keys(e).forEach((function(n){return t._toggleClass(n,!!e[n])})))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!1)})):Object.keys(e).forEach((function(e){return t._toggleClass(e,!1)})))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach((function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)}))}}]),e}(),Ds=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"ngDoCheck",value:function(){this._delegate.applyChanges()}},{key:"klass",set:function(e){this._delegate.setClass(e)}},{key:"ngClass",set:function(e){this._delegate.setNgClass(e)}}]),t}(function(){var e=function(){function e(t){_classCallCheck(this,e),this._delegate=t}return _createClass(e,[{key:"getValue",value:function(){return this._delegate.getValue()}}]),e}();return e.ngDirectiveDef=void 0,e}()),xs=function(){function e(t,n,r,i){_classCallCheck(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return _createClass(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),Rs=function(){function e(t,n,r){_classCallCheck(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOfDirty=!0,this._differ=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation((function(e,r,i){if(null==e.previousIndex){var o=t._viewContainer.createEmbeddedView(t._template,new xs(null,t._ngForOf,-1,-1),null===i?void 0:i),a=new Os(e,o);n.push(a)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new Os(e,s);n.push(u)}}));for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,o=this._viewContainer.length;i<o;i++){var a=this._viewContainer.get(i);a.context.index=i,a.context.count=o,a.context.ngForOf=this._ngForOf}e.forEachIdentityChange((function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item}))}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}},{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(e){it()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(e),". ")+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=e},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}(),Os=function e(t,n){_classCallCheck(this,e),this.record=t,this.view=n},Ps=function(){function e(t,n){_classCallCheck(this,e),this._viewContainer=t,this._context=new Ms,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(e,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Ls("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Ls("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}}]),e}(),Ms=function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null};function Ls(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(be(t),"'."))}var Fs=function(){function e(t,n){_classCallCheck(this,e),this._viewContainerRef=t,this._templateRef=n,this._created=!1}return _createClass(e,[{key:"create",value:function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}},{key:"destroy",value:function(){this._created=!1,this._viewContainerRef.clear()}},{key:"enforceState",value:function(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}]),e}(),Vs=function(){function e(){_classCallCheck(this,e),this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return _createClass(e,[{key:"_addCase",value:function(){return this._caseCount++}},{key:"_addDefault",value:function(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}},{key:"_matchCase",value:function(e){var t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}},{key:"_updateDefaultCases",value:function(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(var t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}},{key:"ngSwitch",set:function(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}}]),e}(),Us=function(){function e(t,n,r){_classCallCheck(this,e),this.ngSwitch=r,r._addCase(),this._view=new Fs(t,n)}return _createClass(e,[{key:"ngDoCheck",value:function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}]),e}(),qs=function e(t,n,r){_classCallCheck(this,e),r._addDefault(new Fs(t,n))},Bs=function e(){_classCallCheck(this,e)},js=new De("DocumentToken"),Ws="server";function Hs(e){return e===Ws}var zs,Qs=((zs=function e(){_classCallCheck(this,e)}).ngInjectableDef=ye({token:zs,providedIn:"root",factory:function(){return new Gs(qe(js),window,qe(tt))}}),zs),Gs=function(){function e(t,n,r){_classCallCheck(this,e),this.document=t,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#".concat(e));if(t)return void this.scrollToElement(t);var n=this.document.querySelector("[name='".concat(e,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),Ks=new k((function(e){return e.complete()}));function Ys(e){return e?function(e){return new k((function(t){return e.schedule((function(){return t.complete()}))}))}(e):Ks}function Xs(e){var t=new k((function(t){t.next(e),t.complete()}));return t._isScalar=!0,t.value=e,t}function Js(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];switch(R(r)?t.pop():r=void 0,t.length){case 0:return Ys(r);case 1:return r?G(t,r):Xs(t[0]);default:return G(t,r)}}var $s=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._value=e,n}return _inherits(t,e),_createClass(t,[{key:"_subscribe",value:function(e){var n=_get(_getPrototypeOf(t.prototype),"_subscribe",this).call(this,e);return n&&!n.closed&&e.next(this._value),n}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new I;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf(t.prototype),"next",this).call(this,this._value=e)}},{key:"value",get:function(){return this.getValue()}}]),t}(D);function Zs(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Zs.prototype=Object.create(Error.prototype);var eu=Zs,tu={},nu=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ru(e,this.resultSelector))}}]),e}(),ru=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.values.push(tu),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(j(this,r,r,n))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n,r,i){var o=this.values,a=this.toRespond?o[n]===tu?--this.toRespond:this.toRespond:0;o[n]=t,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(W);function iu(e){return new k((function(t){var n;try{n=e()}catch(r){return void t.error(r)}return(n?K(n):Ys()).subscribe(t)}))}function ou(){return Z(1)}function au(e,t){return function(n){return n.lift(new su(e,t))}}var su=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new uu(e,this.predicate,this.thisArg))}}]),e}(),uu=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,i.thisArg=r,i.count=0,i}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),t}(g);function lu(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}lu.prototype=Object.create(Error.prototype);var cu=lu;function hu(e){return function(t){return 0===e?Ys():t.lift(new fu(e))}}var fu=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new cu}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new du(e,this.total))}}]),e}(),du=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).total=n,r.ring=new Array,r.count=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()}}]),t}(g);function pu(e,t,n){return function(r){return r.lift(new vu(e,t,n))}}var vu=function(){function e(t,n,r){_classCallCheck(this,e),this.nextOrObserver=t,this.error=n,this.complete=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new gu(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),gu=function(e){function t(e,n,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)))._tapNext=_,a._tapError=_,a._tapComplete=_,a._tapError=i||_,a._tapComplete=o||_,r(n)?(a._context=_assertThisInitialized(a),a._tapNext=n):n&&(a._context=n,a._tapNext=n.next||_,a._tapError=n.error||_,a._tapComplete=n.complete||_),a}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),t}(g),yu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mu;return pu({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw e()}})};function mu(){return new eu}function _u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new bu(e))}}var bu=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new wu(e,this.defaultValue))}}]),e}(),wu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).defaultValue=n,r.isEmpty=!0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),t}(g);function Cu(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?au((function(t,n){return e(t,n,r)})):$,hu(1),n?_u(t):yu((function(){return new eu})))}}function ku(e){return function(t){var n=new Eu(e),r=t.lift(n);return n.caught=r}}var Eu=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Su(e,this.selector,this.caught))}}]),e}(),Su=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).selector=n,i.caught=r,i}return _inherits(t,e),_createClass(t,[{key:"error",value:function(e){if(!this.isStopped){var n;try{n=this.selector(e,this.caught)}catch(i){return void _get(_getPrototypeOf(t.prototype),"error",this).call(this,i)}this._unsubscribeAndRecycle();var r=new O(this,void 0,void 0);this.add(r),j(this,n,void 0,void 0,r)}}}]),t}(W);function Tu(e){return function(t){return 0===e?Ys():t.lift(new Iu(e))}}var Iu=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new cu}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Au(e,this.total))}}]),e}(),Au=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).total=n,r.count=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),t}(g);function Nu(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?au((function(t,n){return e(t,n,r)})):$,Tu(1),n?_u(t):yu((function(){return new eu})))}}var Du=function(){function e(t,n,r){_classCallCheck(this,e),this.predicate=t,this.thisArg=n,this.source=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new xu(e,this.predicate,this.thisArg,this.source))}}]),e}(),xu=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||_assertThisInitialized(o),o}return _inherits(t,e),_createClass(t,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(n){return void this.destination.error(n)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),t}(g);function Ru(e,t){return"function"==typeof t?function(n){return n.pipe(Ru((function(n,r){return K(e(n,r)).pipe(H((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new Ou(e))}}var Ou=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Pu(e,this.project))}}]),e}(),Pu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,r.index=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new O(this,void 0,void 0);this.destination.add(i),this.innerSubscription=j(this,e,t,n,i)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf(t.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}}]),t}(W);function Mu(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Lu(e,t,n))}}var Lu=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Fu(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),Fu=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}},{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}}]),t}(g);function Vu(e,t){return Y(e,t,1)}var Uu=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new qu(e,this.callback))}}]),e}(),qu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).add(new d(n)),r}return _inherits(t,e),t}(g),Bu=null;function ju(){return Bu}var Wu,Hu=function(e){function t(){var e;_classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._animationPrefix=null,e._transitionEnd=null;try{var n=e.createElement("div",document);if(null!=e.getStyle(n,"animationName"))e._animationPrefix="";else for(var r=["Webkit","Moz","O","ms"],i=0;i<r.length;i++)if(null!=e.getStyle(n,r[i]+"AnimationName")){e._animationPrefix="-"+r[i].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach((function(t){null!=e.getStyle(n,t)&&(e._transitionEnd=o[t])}))}catch(a){e._animationPrefix=null,e._transitionEnd=null}return e}return _inherits(t,e),_createClass(t,[{key:"getDistributedNodes",value:function(e){return e.getDistributedNodes()}},{key:"resolveAndSetHref",value:function(e,t,n){e.href=null==n?t:t+"/../"+n}},{key:"supportsDOMEvents",value:function(){return!0}},{key:"supportsNativeShadowDOM",value:function(){return"function"==typeof document.body.createShadowRoot}},{key:"getAnimationPrefix",value:function(){return this._animationPrefix?this._animationPrefix:""}},{key:"getTransitionEnd",value:function(){return this._transitionEnd?this._transitionEnd:""}},{key:"supportsAnimation",value:function(){return null!=this._animationPrefix&&null!=this._transitionEnd}}]),t}(function(){function e(){_classCallCheck(this,e),this.resourceLoaderType=null}return _createClass(e,[{key:"attrToPropMap",get:function(){return this._attrToPropMap},set:function(e){this._attrToPropMap=e}}]),e}()),zu={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},Qu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gu={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ku=function(){if(Ne.Node)return Ne.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))}}(),Yu=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"parse",value:function(e){throw new Error("parse not implemented")}},{key:"hasProperty",value:function(e,t){return t in e}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"getProperty",value:function(e,t){return e[t]}},{key:"invoke",value:function(e,t,n){e[t].apply(e,_toConsumableArray(n))}},{key:"logError",value:function(e){window.console&&(console.error?console.error(e):console.log(e))}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"contains",value:function(e,t){return Ku.call(e,t)}},{key:"querySelector",value:function(e,t){return e.querySelector(t)}},{key:"querySelectorAll",value:function(e,t){return e.querySelectorAll(t)}},{key:"on",value:function(e,t,n){e.addEventListener(t,n,!1)}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"createMouseEvent",value:function(e){var t=this.getDefaultDocument().createEvent("MouseEvent");return t.initEvent(e,!0,!0),t}},{key:"createEvent",value:function(e){var t=this.getDefaultDocument().createEvent("Event");return t.initEvent(e,!0,!0),t}},{key:"preventDefault",value:function(e){e.preventDefault(),e.returnValue=!1}},{key:"isPrevented",value:function(e){return e.defaultPrevented||null!=e.returnValue&&!e.returnValue}},{key:"getInnerHTML",value:function(e){return e.innerHTML}},{key:"getTemplateContent",value:function(e){return"content"in e&&this.isTemplateElement(e)?e.content:null}},{key:"getOuterHTML",value:function(e){return e.outerHTML}},{key:"nodeName",value:function(e){return e.nodeName}},{key:"nodeValue",value:function(e){return e.nodeValue}},{key:"type",value:function(e){return e.type}},{key:"content",value:function(e){return this.hasProperty(e,"content")?e.content:e}},{key:"firstChild",value:function(e){return e.firstChild}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"parentElement",value:function(e){return e.parentNode}},{key:"childNodes",value:function(e){return e.childNodes}},{key:"childNodesAsList",value:function(e){for(var t=e.childNodes,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}},{key:"clearNodes",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"removeChild",value:function(e,t){e.removeChild(t)}},{key:"replaceChild",value:function(e,t,n){e.replaceChild(t,n)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"insertBefore",value:function(e,t,n){e.insertBefore(n,t)}},{key:"insertAllBefore",value:function(e,t,n){n.forEach((function(n){return e.insertBefore(n,t)}))}},{key:"insertAfter",value:function(e,t,n){e.insertBefore(n,t.nextSibling)}},{key:"setInnerHTML",value:function(e,t){e.innerHTML=t}},{key:"getText",value:function(e){return e.textContent}},{key:"setText",value:function(e,t){e.textContent=t}},{key:"getValue",value:function(e){return e.value}},{key:"setValue",value:function(e,t){e.value=t}},{key:"getChecked",value:function(e){return e.checked}},{key:"setChecked",value:function(e,t){e.checked=t}},{key:"createComment",value:function(e){return this.getDefaultDocument().createComment(e)}},{key:"createTemplate",value:function(e){var t=this.getDefaultDocument().createElement("template");return t.innerHTML=e,t}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createElementNS",value:function(e,t,n){return(n=n||this.getDefaultDocument()).createElementNS(e,t)}},{key:"createTextNode",value:function(e,t){return(t=t||this.getDefaultDocument()).createTextNode(e)}},{key:"createScriptTag",value:function(e,t,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(e,t),r}},{key:"createStyleElement",value:function(e,t){var n=(t=t||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(e,t)),n}},{key:"createShadowRoot",value:function(e){return e.createShadowRoot()}},{key:"getShadowRoot",value:function(e){return e.shadowRoot}},{key:"getHost",value:function(e){return e.host}},{key:"clone",value:function(e){return e.cloneNode(!0)}},{key:"getElementsByClassName",value:function(e,t){return e.getElementsByClassName(t)}},{key:"getElementsByTagName",value:function(e,t){return e.getElementsByTagName(t)}},{key:"classList",value:function(e){return Array.prototype.slice.call(e.classList,0)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"hasClass",value:function(e,t){return e.classList.contains(t)}},{key:"setStyle",value:function(e,t,n){e.style[t]=n}},{key:"removeStyle",value:function(e,t){e.style[t]=""}},{key:"getStyle",value:function(e,t){return e.style[t]}},{key:"hasStyle",value:function(e,t,n){var r=this.getStyle(e,t)||"";return n?r==n:r.length>0}},{key:"tagName",value:function(e){return e.tagName}},{key:"attributeMap",value:function(e){for(var t=new Map,n=e.attributes,r=0;r<n.length;r++){var i=n.item(r);t.set(i.name,i.value)}return t}},{key:"hasAttribute",value:function(e,t){return e.hasAttribute(t)}},{key:"hasAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"getAttributeNS",value:function(e,t,n){return e.getAttributeNS(t,n)}},{key:"setAttribute",value:function(e,t,n){e.setAttribute(t,n)}},{key:"setAttributeNS",value:function(e,t,n,r){e.setAttributeNS(t,n,r)}},{key:"removeAttribute",value:function(e,t){e.removeAttribute(t)}},{key:"removeAttributeNS",value:function(e,t,n){e.removeAttributeNS(t,n)}},{key:"templateAwareRoot",value:function(e){return this.isTemplateElement(e)?this.content(e):e}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"getBoundingClientRect",value:function(e){try{return e.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}},{key:"getTitle",value:function(e){return e.title}},{key:"setTitle",value:function(e,t){e.title=t||""}},{key:"elementMatches",value:function(e,t){return!!this.isElementNode(e)&&(e.matches&&e.matches(t)||e.msMatchesSelector&&e.msMatchesSelector(t)||e.webkitMatchesSelector&&e.webkitMatchesSelector(t))}},{key:"isTemplateElement",value:function(e){return this.isElementNode(e)&&"TEMPLATE"===e.nodeName}},{key:"isTextNode",value:function(e){return e.nodeType===Node.TEXT_NODE}},{key:"isCommentNode",value:function(e){return e.nodeType===Node.COMMENT_NODE}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"hasShadowRoot",value:function(e){return null!=e.shadowRoot&&e instanceof HTMLElement}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"importIntoDoc",value:function(e){return document.importNode(this.templateAwareRoot(e),!0)}},{key:"adoptNode",value:function(e){return document.adoptNode(e)}},{key:"getHref",value:function(e){return e.getAttribute("href")}},{key:"getEventKey",value:function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Gu.hasOwnProperty(t)&&(t=Gu[t]))}return Qu[t]||t}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Xu||(Xu=document.querySelector("base"))?Xu.getAttribute("href"):null;return null==n?null:(t=n,Wu||(Wu=document.createElement("a")),Wu.setAttribute("href",t),"/"===Wu.pathname.charAt(0)?Wu.pathname:"/"+Wu.pathname)}},{key:"resetBaseElement",value:function(){Xu=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"setData",value:function(e,t,n){this.setAttribute(e,"data-"+t,n)}},{key:"getData",value:function(e,t){return this.getAttribute(e,"data-"+t)}},{key:"getComputedStyle",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return getComputedStyle(e)}))},{key:"supportsWebAnimation",value:function(){return"function"==typeof Element.prototype.animate}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return Is(document.cookie,e)}},{key:"setCookie",value:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)}},{key:"attrToPropMap",get:function(){return zu}}],[{key:"makeCurrent",value:function(){var e;e=new t,Bu||(Bu=e)}}]),t}(Hu),Xu=null;function Ju(){return!!window.history.pushState}var $u=new De("TRANSITION_ID"),Zu=[{provide:Pi,useFactory:function(e,t,n){return function(){n.get(Mi).donePromise.then((function(){var n=ju();Array.prototype.slice.apply(n.querySelectorAll(t,"style[ng-transition]")).filter((function(t){return n.getAttribute(t,"ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[$u,js,Lt],multi:!0}],el=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){Ne.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Ne.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Ne.getAllAngularRootElements=function(){return e.getAllRootElements()},Ne.frameworkStabilizers||(Ne.frameworkStabilizers=[]),Ne.frameworkStabilizers.push((function(e){var t=Ne.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(i)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?ju().isShadowRoot(t)?this.findTestabilityInTree(e,ju().getHost(t),!0):this.findTestabilityInTree(e,ju().parentElement(t),!0):null}}],[{key:"init",value:function(){var t;t=new e,mo=t}}]),e}();function tl(e,t){"undefined"!=typeof COMPILED&&COMPILED||((Ne.ng=Ne.ng||{})[e]=t)}var nl={ApplicationRef:Io,NgZone:so};function rl(e){return Vo(e)}var il=new De("EventManagerPlugins"),ol=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=r})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}(),al=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=ju().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),sl=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}(),ul=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return _inherits(t,e),_createClass(t,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return ju().remove(e)}))}}]),t}(sl),ll={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},cl=/%COMP%/g,hl="_nghost-%COMP%",fl="_ngcontent-%COMP%";function dl(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?dl(e,i,n):(i=i.replace(cl,e),n.push(i))}return n}function pl(e){return function(t){!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var vl=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new gl(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ge.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new _l(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case Ge.Native:case Ge.ShadowDom:return new bl(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=dl(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}(),gl=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(ll[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=ll[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=ll[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&pn.DashCase?e.style.setProperty(t,n,r&pn.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&pn.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){ml(t,"property"),e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return ml(t,"listener"),"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,pl(n)):this.eventManager.addEventListener(e,t,pl(n))}}]),e}(),yl="@".charCodeAt(0);function ml(e,t){if(e.charCodeAt(0)===yl)throw new Error("Found the synthetic ".concat(t," ").concat(e,'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.'))}var _l=function(e){function t(e,n,r,i){var o;_classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).component=r;var a=dl(i+"-"+r.id,r.styles,[]);return n.addStyles(a),o.contentAttr=fl.replace(cl,i+"-"+r.id),o.hostAttr=hl.replace(cl,i+"-"+r.id),o}return _inherits(t,e),_createClass(t,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,n){var r=_get(_getPrototypeOf(t.prototype),"createElement",this).call(this,e,n);return _get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),t}(gl),bl=function(e){function t(e,n,r,i){var o;_classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).sharedStylesHost=n,o.hostEl=r,o.component=i,o.shadowRoot=i.encapsulation===Ge.ShadowDom?r.attachShadow({mode:"open"}):r.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var a=dl(i.id,i.styles,[]),s=0;s<a.length;s++){var u=document.createElement("style");u.textContent=a[s],o.shadowRoot.appendChild(u)}return o}return _inherits(t,e),_createClass(t,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"insertBefore",value:function(e,n,r){return _get(_getPrototypeOf(t.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),n,r)}},{key:"removeChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(t.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),t}(gl),wl="undefined"!=typeof Zone&&Zone.__symbol__||function(e){return"__zone_symbol__"+e},Cl=wl("addEventListener"),kl=wl("removeEventListener"),El={},Sl="__zone_symbol__propagationStopped",Tl=function(){var e="undefined"!=typeof Zone&&Zone[wl("BLACK_LISTED_EVENTS")];if(e){var t={};return e.forEach((function(e){t[e]=e})),t}}(),Il=function(e){return!!Tl&&Tl.hasOwnProperty(e)},Al=function(e){var t=El[e.type];if(t){var n=this[t];if(n){var r=[e];if(1===n.length){var i=n[0];return i.zone!==Zone.current?i.zone.run(i.handler,this,r):i.handler.apply(this,r)}for(var o=n.slice(),a=0;a<o.length&&!0!==e[Sl];a++){var s=o[a];s.zone!==Zone.current?s.zone.run(s.handler,this,r):s.handler.apply(this,r)}}}},Nl=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).ngZone=n,r&&Hs(r)||i.patchEvent(),i}return _inherits(t,e),_createClass(t,[{key:"patchEvent",value:function(){if("undefined"!=typeof Event&&Event&&Event.prototype&&!Event.prototype.__zone_symbol__stopImmediatePropagation){var e=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Sl]=!0),e&&e.apply(this,arguments)}}}},{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this,i=n;if(!e[Cl]||so.isInAngularZone()&&!Il(t))e.addEventListener(t,i,!1);else{var o=El[t];o||(o=El[t]=wl("ANGULAR"+t+"FALSE"));var a=e[o],s=a&&a.length>0;a||(a=e[o]=[]);var u=Il(t)?Zone.root:Zone.current;if(0===a.length)a.push({zone:u,handler:i});else{for(var l=!1,c=0;c<a.length;c++)if(a[c].handler===i){l=!0;break}l||a.push({zone:u,handler:i})}s||e[Cl](t,Al,!1)}return function(){return r.removeEventListener(e,t,i)}}},{key:"removeEventListener",value:function(e,t,n){var r=e[kl];if(!r)return e.removeEventListener.apply(e,[t,n,!1]);var i=El[t],o=i&&e[i];if(!o)return e.removeEventListener.apply(e,[t,n,!1]);for(var a=!1,s=0;s<o.length;s++)if(o[s].handler===n){a=!0,o.splice(s,1);break}a?0===o.length&&r.apply(e,[t,Al,!1]):e.removeEventListener.apply(e,[t,n,!1])}}]),t}(al),Dl={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},xl=new De("HammerGestureConfig"),Rl=new De("HammerLoader"),Ol=function(){function e(){_classCallCheck(this,e),this.events=[],this.overrides={}}return _createClass(e,[{key:"buildHammer",value:function(e){var t=new Hammer(e,this.options);for(var n in t.get("pinch").set({enable:!0}),t.get("rotate").set({enable:!0}),this.overrides)t.get(n).set(this.overrides[n]);return t}}]),e}(),Pl=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)))._config=n,o.console=r,o.loader=i,o}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return!(!Dl.hasOwnProperty(e.toLowerCase())&&!this.isCustomEvent(e)||!window.Hammer&&!this.loader&&(this.console.warn('The "'.concat(e,'" event cannot be bound because Hammer.JS is not ')+"loaded and no custom loader has been specified."),1))}},{key:"addEventListener",value:function(e,t,n){var r=this,i=this.manager.getZone();if(t=t.toLowerCase(),!window.Hammer&&this.loader){var o=!1,a=function(){o=!0};return this.loader().then((function(){if(!window.Hammer)return r.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(a=function(){});o||(a=r.addEventListener(e,t,n))})).catch((function(){r.console.warn('The "'.concat(t,'" event cannot be bound because the custom ')+"Hammer.JS loader failed."),a=function(){}})),function(){a()}}return i.runOutsideAngular((function(){var o=r._config.buildHammer(e),a=function(e){i.runGuarded((function(){n(e)}))};return o.on(t,a),function(){o.off(t,a),"function"==typeof o.destroy&&o.destroy()}}))}},{key:"isCustomEvent",value:function(e){return this._config.events.indexOf(e)>-1}}]),t}(al),Ml=["alt","control","meta","shift"],Ll={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},Fl=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"supports",value:function(e){return null!=t.parseEventName(e)}},{key:"addEventListener",value:function(e,n,r){var i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return ju().onAndCancel(e,i.domEventName,o)}))}}],[{key:"parseEventName",value:function(e){var n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;var i=t._normalizeKey(n.pop()),o="";if(Ml.forEach((function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),o+=e+".")})),o+=i,0!=n.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a}},{key:"getEventFullKey",value:function(e){var t="",n=ju().getEventKey(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Ml.forEach((function(r){r!=n&&(0,Ll[r])(e)&&(t+=r+".")})),t+=n}},{key:"eventCallback",value:function(e,n,r){return function(i){t.getEventFullKey(i)===e&&r.runGuarded((function(){return n(i)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),t}(al),Vl=function e(){_classCallCheck(this,e)},Ul=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n}return _inherits(t,e),_createClass(t,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case Tt.NONE:return t;case Tt.HTML:return t instanceof Bl?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"HTML"),function(e,t){var n=null;try{ht=ht||new ot(e);var r=t?String(t):"";n=ht.getInertBodyElement(r);var i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=ht.getInertBodyElement(r)}while(r!==o);var a=new wt,s=a.sanitizeChildren(St(n)||n);return it()&&a.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var u=St(n)||n;u.firstChild;)u.removeChild(u.firstChild)}}(this._doc,String(t)));case Tt.STYLE:return t instanceof jl?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"Style"),function(e){if(!(e=String(e).trim()))return"";var t=e.match(Nt);return t&&ut(t[1])===t[1]||e.match(At)&&function(e){for(var t=!0,n=!0,r=0;r<e.length;r++){var i=e.charAt(r);"'"===i&&n?t=!t:'"'===i&&t&&(n=!n)}return t&&n}(e)?e:(it()&&console.warn("WARNING: sanitizing unsafe style value ".concat(e," (see http://g.co/ng/security#xss).")),"unsafe")}(t));case Tt.SCRIPT:if(t instanceof Wl)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"Script"),new Error("unsafe value used in a script context");case Tt.URL:return t instanceof zl||t instanceof Hl?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"URL"),ut(String(t)));case Tt.RESOURCE_URL:if(t instanceof zl)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see http://g.co/ng/security#xss)"))}}},{key:"checkNotSafeValue",value:function(e,t){if(e instanceof ql)throw new Error("Required a safe ".concat(t,", got a ").concat(e.getTypeName()," ")+"(see http://g.co/ng/security#xss)")}},{key:"bypassSecurityTrustHtml",value:function(e){return new Bl(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new jl(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new Wl(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new Hl(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new zl(e)}}]),t}(Vl),ql=function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),e}(),Bl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"HTML"}}]),t}(ql),jl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"Style"}}]),t}(ql),Wl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"Script"}}]),t}(ql),Hl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"URL"}}]),t}(ql),zl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),t}(ql),Ql=Co(qo,"browser",[{provide:qi,useValue:"browser"},{provide:Ui,useValue:function(){Yu.makeCurrent(),el.init()},multi:!0},{provide:vs,useClass:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n._init(),n}return _inherits(t,e),_createClass(t,[{key:"_init",value:function(){this.location=ju().getLocation(),this._history=ju().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return ju().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){ju().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){ju().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"pushState",value:function(e,t,n){Ju()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){Ju()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),t}(vs),deps:[js]},{provide:js,useFactory:function(){return document},deps:[]}]);function Gl(){return new tt}var Kl=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Li,useValue:t.appId},{provide:$u,useExisting:Li},Zu]}}}]),e}();"undefined"!=typeof window&&window;var Yl=function e(t,n){_classCallCheck(this,e),this.id=t,this.url=n},Xl=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).navigationTrigger=i,r.restoredState=o,r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(Yl),Jl=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),t}(Yl),$l=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).reason=r,i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(Yl),Zl=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).error=r,i}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),t}(Yl),ec=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(Yl),tc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(Yl),nc=function(e){function t(e,n,r,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,a.state=i,a.shouldActivate=o,a}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),t}(Yl),rc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(Yl),ic=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(Yl),oc=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),ac=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),sc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),uc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),lc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),cc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),hc=function(){function e(t,n,r){_classCallCheck(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),fc=function e(){_classCallCheck(this,e)},dc="primary",pc=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function vc(e){return new pc(e)}var gc="ngNavigationCancelingError";function yc(e){var t=Error("NavigationCancelingError: "+e);return t[gc]=!0,t}function mc(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},o=0;o<r.length;o++){var a=r[o],s=e[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}var _c=function e(t,n){_classCallCheck(this,e),this.routes=t,this.module=n};function bc(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];wc(r,Cc(t,r))}}function wc(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&e.outlet!==dc)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&bc(e.children,t)}function Cc(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function kc(e){var t=e.children&&e.children.map(kc),n=t?Object.assign({},e,{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==dc&&(n.component=fc),n}function Ec(e,t){var n,r=Object.keys(e),i=Object.keys(t);if(!r||!i||r.length!=i.length)return!1;for(var o=0;o<r.length;o++)if(e[n=r[o]]!==t[n])return!1;return!0}function Sc(e){return Array.prototype.concat.apply([],e)}function Tc(e){return e.length>0?e[e.length-1]:null}function Ic(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Ac(e){return Zt(e)?e:$t(e)?K(Promise.resolve(e)):Js(e)}function Nc(e,t,n){return n?function(e,t){return Ec(e,t)}(e.queryParams,t.queryParams)&&function e(t,n){if(!Oc(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!t.children[r])return!1;if(!e(t.children[r],n.children[r]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every((function(n){return t[n]===e[n]}))}(e.queryParams,t.queryParams)&&function e(t,n){return function t(n,r,i){if(n.segments.length>i.length)return!!Oc(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Oc(n.segments,i))return!1;for(var o in r.children){if(!n.children[o])return!1;if(!e(n.children[o],r.children[o]))return!1}return!0}var a=i.slice(0,n.segments.length),s=i.slice(n.segments.length);return!!Oc(n.segments,a)&&!!n.children[dc]&&t(n.children[dc],r,s)}(t,n,n.segments)}(e.root,t.root)}var Dc=function(){function e(t,n,r){_classCallCheck(this,e),this.root=t,this.queryParams=n,this.fragment=r}return _createClass(e,[{key:"toString",value:function(){return Fc.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=vc(this.queryParams)),this._queryParamMap}}]),e}(),xc=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.segments=t,this.children=n,this.parent=null,Ic(n,(function(e,t){return e.parent=r}))}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return Vc(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),e}(),Rc=function(){function e(t,n){_classCallCheck(this,e),this.path=t,this.parameters=n}return _createClass(e,[{key:"toString",value:function(){return Hc(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=vc(this.parameters)),this._parameterMap}}]),e}();function Oc(e,t){return e.length===t.length&&e.every((function(e,n){return e.path===t[n].path}))}function Pc(e,t){var n=[];return Ic(e.children,(function(e,r){r===dc&&(n=n.concat(t(e,r)))})),Ic(e.children,(function(e,r){r!==dc&&(n=n.concat(t(e,r)))})),n}var Mc=function e(){_classCallCheck(this,e)},Lc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new Yc(e);return new Dc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n,r;return"".concat("/".concat(function e(t,n){if(!t.hasChildren())return Vc(t);if(n){var r=t.children[dc]?e(t.children[dc],!1):"",i=[];return Ic(t.children,(function(t,n){n!==dc&&i.push("".concat(n,":").concat(e(t,!1)))})),i.length>0?"".concat(r,"(").concat(i.join("//"),")"):r}var o=Pc(t,(function(n,r){return r===dc?[e(t.children[dc],!1)]:["".concat(r,":").concat(e(n,!1))]}));return"".concat(Vc(t),"/(").concat(o.join("//"),")")}(e.root,!0)),(n=e.queryParams,r=Object.keys(n).map((function(e){var t=n[e];return Array.isArray(t)?t.map((function(t){return"".concat(qc(e),"=").concat(qc(t))})).join("&"):"".concat(qc(e),"=").concat(qc(t))})),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),Fc=new Lc;function Vc(e){return e.segments.map((function(e){return Hc(e)})).join("/")}function Uc(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qc(e){return Uc(e).replace(/%3B/gi,";")}function Bc(e){return Uc(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jc(e){return decodeURIComponent(e)}function Wc(e){return jc(e.replace(/\+/g,"%20"))}function Hc(e){return"".concat(Bc(e.path)).concat((t=e.parameters,Object.keys(t).map((function(e){return";".concat(Bc(e),"=").concat(Bc(t[e]))})).join("")));var t}var zc=/^[^\/()?;=#]+/;function Qc(e){var t=e.match(zc);return t?t[0]:""}var Gc=/^[^=?&#]+/,Kc=/^[^?&#]+/,Yc=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xc([],{}):new xc([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[dc]=new xc(e,t)),n}},{key:"parseSegment",value:function(){var e=Qc(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new Rc(jc(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=Qc(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=Qc(this.remaining);r&&this.capture(n=r)}e[jc(t)]=jc(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(Gc);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(Kc);return t?t[0]:""}(this.remaining);r&&this.capture(n=r)}var i=Wc(t),o=Wc(n);if(e.hasOwnProperty(i)){var a=e[i];Array.isArray(a)||(e[i]=a=[a]),a.push(o)}else e[i]=o}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=Qc(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=dc);var o=this.parseChildren();t[i]=1===Object.keys(o).length?o[dc]:new xc([],o),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),Xc=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=Jc(e,this._root);return t?t.children.map((function(e){return e.value})):[]}},{key:"firstChild",value:function(e){var t=Jc(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=$c(e,this._root);return t.length<2?[]:t[t.length-2].children.map((function(e){return e.value})).filter((function(t){return t!==e}))}},{key:"pathFromRoot",value:function(e){return $c(e,this._root).map((function(e){return e.value}))}},{key:"root",get:function(){return this._root.value}}]),e}();function Jc(e,t){if(e===t.value)return t;var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=Jc(e,o.value);if(s)return s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}function $c(e,t){if(e===t.value)return[t];var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=$c(e,o.value);if(s.length)return s.unshift(t),s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return[]}var Zc=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.children=n}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function eh(e){var t={};return e&&e.children.forEach((function(e){return t[e.value.outlet]=e})),t}var th=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).snapshot=n,sh(_assertThisInitialized(r),e),r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return this.snapshot.toString()}}]),t}(Xc);function nh(e,t){var n=function(e,t){var n=new oh([],{},{},"",{},dc,t,null,e.root,-1,{});return new ah("",new Zc(n,[]))}(e,t),r=new $s([new Rc("",{})]),i=new $s({}),o=new $s({}),a=new $s({}),s=new $s(""),u=new rh(r,i,a,s,o,dc,t,n.root);return u.snapshot=n.root,new th(new Zc(u,[]),n)}var rh=function(){function e(t,n,r,i,o,a,s,u){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this._futureSnapshot=u}return _createClass(e,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(H((function(e){return vc(e)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(H((function(e){return vc(e)})))),this._queryParamMap}}]),e}();function ih(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(e){return e.reduce((function(e,t){return{params:Object.assign({},e.params,t.params),data:Object.assign({},e.data,t.data),resolve:Object.assign({},e.resolve,t._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(r))}var oh=function(){function e(t,n,r,i,o,a,s,u,l,c,h){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.routeConfig=u,this._urlSegment=l,this._lastPathIndex=c,this._resolve=h}return _createClass(e,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(e){return e.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=vc(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=vc(this.queryParams)),this._queryParamMap}}]),e}(),ah=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).url=e,sh(_assertThisInitialized(r),n),r}return _inherits(t,e),_createClass(t,[{key:"toString",value:function(){return uh(this._root)}}]),t}(Xc);function sh(e,t){t.value._routerState=e,t.children.forEach((function(t){return sh(e,t)}))}function uh(e){var t=e.children.length>0?" { ".concat(e.children.map(uh).join(", ")," } "):"";return"".concat(e.value).concat(t)}function lh(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Ec(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),Ec(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!Ec(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),Ec(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function ch(e,t){var n,r;return Ec(e.params,t.params)&&Oc(n=e.url,r=t.url)&&n.every((function(e,t){return Ec(e.parameters,r[t].parameters)}))&&!(!e.parent!=!t.parent)&&(!e.parent||ch(e.parent,t.parent))}function hh(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function fh(e,t,n,r,i){var o={};return r&&Ic(r,(function(e,t){o[t]=Array.isArray(e)?e.map((function(e){return"".concat(e)})):"".concat(e)})),new Dc(n.root===e?t:function e(t,n,r){var i={};return Ic(t.children,(function(t,o){i[o]=t===n?r:e(t,n,r)})),new xc(t.segments,i)}(n.root,e,t),o,i)}var dh=function(){function e(t,n,r){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&hh(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find((function(e){return"object"==typeof e&&null!=e&&e.outlets}));if(i&&i!==Tc(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),ph=function e(t,n,r){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r};function vh(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets[dc]:"".concat(e)}function gh(e,t,n){if(e||(e=new xc([],{})),0===e.segments.length&&e.hasChildren())return yh(e,t,n);var r=function(e,t,n){for(var r=0,i=t,o={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return o;var a=e.segments[i],s=vh(n[r]),u=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!wh(s,u,a))return o;r+=2}else{if(!wh(s,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var o=new xc(e.segments.slice(0,r.pathIndex),{});return o.children[dc]=new xc(e.segments.slice(r.pathIndex),e.children),yh(o,0,i)}return r.match&&0===i.length?new xc(e.segments,{}):r.match&&!e.hasChildren()?mh(e,t,n):r.match?yh(e,0,i):mh(e,t,n)}function yh(e,t,n){if(0===n.length)return new xc(e.segments,{});var r=function(e){return"object"!=typeof e[0]?_defineProperty({},dc,e):void 0===e[0].outlets?_defineProperty({},dc,e):e[0].outlets}(n),i={};return Ic(r,(function(n,r){null!==n&&(i[r]=gh(e.children[r],t,n))})),Ic(e.children,(function(e,t){void 0===r[t]&&(i[t]=e)})),new xc(e.segments,i)}function mh(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){var o=_h(n[i].outlets);return new xc(r,o)}if(0===i&&hh(n[0]))r.push(new Rc(e.segments[t].path,n[0])),i++;else{var a=vh(n[i]),s=i<n.length-1?n[i+1]:null;a&&s&&hh(s)?(r.push(new Rc(a,bh(s))),i+=2):(r.push(new Rc(a,{})),i++)}}return new xc(r,{})}function _h(e){var t={};return Ic(e,(function(e,n){null!==e&&(t[n]=mh(new xc([],{}),0,e))})),t}function bh(e){var t={};return Ic(e,(function(e,n){return t[n]="".concat(e)})),t}function wh(e,t,n){return e==n.path&&Ec(t,n.parameters)}var Ch=function(){function e(t,n,r,i){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),lh(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=eh(t);e.children.forEach((function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]})),Ic(i,(function(e,t){r.deactivateRouteAndItsChildren(e,n)}))}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var n=this,r=t.getContext(e.value.outlet);if(r){var i=eh(e),o=e.value.component?r.children:t;Ic(i,(function(e,t){return n.deactivateRouteAndItsChildren(e,o)})),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=eh(t);e.children.forEach((function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new cc(e.value.snapshot))})),e.children.length&&this.forwardEvent(new uc(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(lh(r),r===i)if(r.component){var o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),kh(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),l=u?u.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=l,a.outlet&&a.outlet.activateWith(r,l),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function kh(e){lh(e.value),e.children.forEach(kh)}function Eh(e){return"function"==typeof e}function Sh(e){return e instanceof Dc}var Th=function e(t){_classCallCheck(this,e),this.segmentGroup=t||null},Ih=function e(t){_classCallCheck(this,e),this.urlTree=t};function Ah(e){return new k((function(t){return t.error(new Th(e))}))}function Nh(e){return new k((function(t){return t.error(new Ih(e))}))}function Dh(e){return new k((function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))}))}var xh=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=t.get(We)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,dc).pipe(H((function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)}))).pipe(ku((function(t){if(t instanceof Ih)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof Th)throw e.noMatchError(t);throw t})))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,dc).pipe(H((function(n){return t.createUrlTree(n,e.queryParams,e.fragment)}))).pipe(ku((function(e){if(e instanceof Th)throw t.noMatchError(e);throw e})))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new xc([],_defineProperty({},dc,e)):e;return new Dc(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(H((function(e){return new xc([],e)}))):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){var r=this;return function(n,i){if(0===Object.keys(n).length)return Js({});var o=[],a=[],s={};return Ic(n,(function(n,i){var u,l,c=(u=i,l=n,r.expandSegmentGroup(e,t,l,u)).pipe(H((function(e){return s[i]=e})));i===dc?o.push(c):a.push(c)})),Js.apply(null,o.concat(a)).pipe(ou(),Cu(),H((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(e,t,n,r,i,o){var a=this;return Js.apply(void 0,_toConsumableArray(n)).pipe(H((function(s){return a.expandSegmentAgainstRoute(e,t,n,s,r,i,o).pipe(ku((function(e){if(e instanceof Th)return Js(null);throw e})))})),ou(),Nu((function(e){return!!e})),ku((function(e,n){if(e instanceof eu||"EmptyError"===e.name){if(a.noLeftoversInUrl(t,r,i))return Js(new xc([],{}));throw new Th(t)}throw e})))}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,o,a){return Mh(r)!==o?Ah(t):void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o):Ah(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Nh(o):this.lineralizeSegments(n,o).pipe(Y((function(n){var o=new xc(n,{});return i.expandSegment(e,o,t,n,r,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){var a=this,s=Rh(t,r,i),u=s.matched,l=s.consumedSegments,c=s.lastChild,h=s.positionalParamSegments;if(!u)return Ah(t);var f=this.applyRedirectCommands(l,r.redirectTo,h);return r.redirectTo.startsWith("/")?Nh(f):this.lineralizeSegments(r,f).pipe(Y((function(r){return a.expandSegment(e,t,n,r.concat(i.slice(c)),o,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r){var i=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(e.injector,n).pipe(H((function(e){return n._loadedConfig=e,new xc(r,{})}))):Js(new xc(r,{}));var o=Rh(t,n,r),a=o.matched,s=o.consumedSegments,u=o.lastChild;if(!a)return Ah(t);var l=r.slice(u);return this.getChildConfig(e,n,r).pipe(Y((function(e){var n=e.module,r=e.routes,o=function(e,t,n,r){return n.length>0&&function(e,t,n){return n.some((function(n){return Ph(e,t,n)&&Mh(n)!==dc}))}(e,n,r)?{segmentGroup:Oh(new xc(t,function(e,t){var n={};n[dc]=t;var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;""===u.path&&Mh(u)!==dc&&(n[Mh(u)]=new xc([],{}))}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(r,new xc(n,e.children)))),slicedSegments:[]}:0===n.length&&function(e,t,n){return n.some((function(n){return Ph(e,t,n)}))}(e,n,r)?{segmentGroup:Oh(new xc(e.segments,function(e,t,n,r){var i={},o=!0,a=!1,s=void 0;try{for(var u,l=n[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;Ph(e,t,c)&&!r[Mh(c)]&&(i[Mh(c)]=new xc([],{}))}}catch(h){a=!0,s=h}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return Object.assign({},r,i)}(e,n,r,e.children))),slicedSegments:n}:{segmentGroup:e,slicedSegments:n}}(t,s,l,r),a=o.segmentGroup,u=o.slicedSegments;return 0===u.length&&a.hasChildren()?i.expandChildren(n,r,a).pipe(H((function(e){return new xc(s,e)}))):0===r.length&&0===u.length?Js(new xc(s,{})):i.expandSegment(n,a,r,u,dc,!0).pipe(H((function(e){return new xc(s.concat(e.segments),e.children)})))})))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?Js(new _c(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Js(t._loadedConfig):function(e,t,n){var r,i=t.canLoad;return i&&0!==i.length?K(i).pipe(H((function(r){var i,o=e.get(r);if(function(e){return e&&Eh(e.canLoad)}(o))i=o.canLoad(t,n);else{if(!Eh(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return Ac(i)}))).pipe(ou(),(r=function(e){return!0===e},function(e){return e.lift(new Du(r,void 0,e))})):Js(!0)}(e.injector,t,n).pipe(Y((function(n){return n?r.configLoader.load(e.injector,t).pipe(H((function(e){return t._loadedConfig=e,e}))):function(e){return new k((function(t){return t.error(yc("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))}))}(t)}))):Js(new _c([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Js(n);if(r.numberOfChildren>1||!r.children[dc])return Dh(e.redirectTo);r=r.children[dc]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new Dc(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return Ic(e,(function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e})),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,o=this.createSegments(e,t.segments,n,r),a={};return Ic(t.children,(function(t,o){a[o]=i.createSegmentGroup(e,t,n,r)})),new xc(o,a)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map((function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)}))}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n=0,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.path===e.path)return t.splice(n),u;n++}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}}]),e}();function Rh(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(t.matcher||mc)(n,e,t);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Oh(e){if(1===e.numberOfChildren&&e.children[dc]){var t=e.children[dc];return new xc(e.segments.concat(t.segments),t.children)}return e}function Ph(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Mh(e){return e.outlet||dc}var Lh=function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]},Fh=function e(t,n){_classCallCheck(this,e),this.component=t,this.route=n};function Vh(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Uh(e,t,n){var r=eh(e),i=e.value;Ic(r,(function(e,r){Uh(e,i.component?t?t.children.getContext(r):null:t,n)})),n.canDeactivateChecks.push(new Fh(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var qh=Symbol("INITIAL_VALUE");function Bh(){return Ru((function(e){return(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=null,i=null;return R(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&u(t[0])&&(t=t[0]),G(t,i).lift(new nu(r))}).apply(void 0,_toConsumableArray(e.map((function(e){return e.pipe(Tu(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=t[t.length-1];R(n)?t.pop():n=null;var r=t.length;return function(){return ou()(Js.apply(void 0,arguments))}(1!==r||n?r>0?G(t,n):Ys(n):Xs(t[0]),e)}}(qh))})))).pipe(Mu((function(e,t){var n=!1;return t.reduce((function(e,r,i){if(e!==qh)return e;if(r===qh&&(n=!0),!n){if(!1===r)return r;if(i===t.length-1||Sh(r))return r}return e}),e)}),qh),au((function(e){return e!==qh})),H((function(e){return Sh(e)?e:!0===e})),Tu(1))}))}function jh(e,t){return null!==e&&t&&t(new lc(e)),Js(!0)}function Wh(e,t){return null!==e&&t&&t(new sc(e)),Js(!0)}function Hh(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?Js(r.map((function(r){return iu((function(){var i,o=Vh(r,t,n);if(function(e){return e&&Eh(e.canActivate)}(o))i=Ac(o.canActivate(t,e));else{if(!Eh(o))throw new Error("Invalid CanActivate guard");i=Ac(o(t,e))}return i.pipe(Nu())}))}))).pipe(Bh()):Js(!0)}function zh(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map((function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)})).filter((function(e){return null!==e})).map((function(t){return iu((function(){return Js(t.guards.map((function(i){var o,a=Vh(i,t.node,n);if(function(e){return e&&Eh(e.canActivateChild)}(a))o=Ac(a.canActivateChild(r,e));else{if(!Eh(a))throw new Error("Invalid CanActivateChild guard");o=Ac(a(r,e))}return o.pipe(Nu())}))).pipe(Bh())}))}));return Js(i).pipe(Bh())}var Qh=function e(){_classCallCheck(this,e)},Gh=function(){function e(t,n,r,i,o,a){_classCallCheck(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=a}return _createClass(e,[{key:"recognize",value:function(){try{var e=Xh(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,dc),n=new oh([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},dc,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Zc(n,t),i=new ah(this.url,r);return this.inheritParamsAndData(i._root),Js(i)}catch(o){return new k((function(e){return e.error(o)}))}}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=ih(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach((function(e){return t.inheritParamsAndData(e)}))}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){var n,r=this,i=Pc(t,(function(t,n){return r.processSegmentGroup(e,t,n)}));return n={},i.forEach((function(e){var t=n[e.value.outlet];if(t){var r=t.url.map((function(e){return e.toString()})).join("/"),i=e.value.url.map((function(e){return e.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(i,"'."))}n[e.value.outlet]=e.value})),i.sort((function(e,t){return e.value.outlet===dc?-1:t.value.outlet===dc?1:e.value.outlet.localeCompare(t.value.outlet)})),i}},{key:"processSegment",value:function(e,t,n,r){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;try{return this.processSegmentAgainstRoute(l,t,n,r)}catch(c){if(!(c instanceof Qh))throw c}}}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}if(this.noLeftoversInUrl(t,n,r))return[];throw new Qh}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo)throw new Qh;if((e.outlet||dc)!==r)throw new Qh;var i,o=[],a=[];if("**"===e.path){var s=n.length>0?Tc(n).parameters:{};i=new oh(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Zh(e),r,e.component,e,Kh(t),Yh(t)+n.length,ef(e))}else{var u=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new Qh;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(t.matcher||mc)(n,e,t);if(!r)throw new Qh;var i={};Ic(r.posParams,(function(e,t){i[t]=e.path}));var o=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(t,e,n);o=u.consumedSegments,a=n.slice(u.lastChild),i=new oh(o,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Zh(e),r,e.component,e,Kh(t),Yh(t)+o.length,ef(e))}var l=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),c=Xh(t,o,a,l,this.relativeLinkResolution),h=c.segmentGroup,f=c.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(l,h);return[new Zc(i,d)]}if(0===l.length&&0===f.length)return[new Zc(i,[])];var p=this.processSegment(l,h,f,dc);return[new Zc(i,p)]}}]),e}();function Kh(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function Yh(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function Xh(e,t,n,r,i){if(n.length>0&&function(e,t,n){return n.some((function(n){return Jh(e,t,n)&&$h(n)!==dc}))}(e,n,r)){var o=new xc(t,function(e,t,n,r){var i={};i[dc]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var o=!0,a=!1,s=void 0;try{for(var u,l=n[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(""===c.path&&$h(c)!==dc){var h=new xc([],{});h._sourceSegment=e,h._segmentIndexShift=t.length,i[$h(c)]=h}}}catch(f){a=!0,s=f}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return i}(e,t,r,new xc(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some((function(n){return Jh(e,t,n)}))}(e,n,r)){var a=new xc(e.segments,function(e,t,n,r,i,o){var a={},s=!0,u=!1,l=void 0;try{for(var c,h=r[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var f=c.value;if(Jh(e,n,f)&&!i[$h(f)]){var d=new xc([],{});d._sourceSegment=e,d._segmentIndexShift="legacy"===o?e.segments.length:t.length,a[$h(f)]=d}}}catch(p){u=!0,l=p}finally{try{s||null==h.return||h.return()}finally{if(u)throw l}}return Object.assign({},i,a)}(e,t,n,r,e.children,i));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:n}}var s=new xc(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Jh(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function $h(e){return e.outlet||dc}function Zh(e){return e.data||{}}function ef(e){return e.resolve||{}}function tf(e,t,n,r){var i=Vh(e,t,r);return Ac(i.resolve?i.resolve(t,n):i(t,n))}function nf(e){return function(t){return t.pipe(Ru((function(t){var n=e(t);return n?K(n).pipe(H((function(){return t}))):K([t])})))}}var rf=function e(){_classCallCheck(this,e)},of=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),af=new De("ROUTES"),sf=function(){function e(t,n,r,i){_classCallCheck(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return _createClass(e,[{key:"load",value:function(e,t){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(H((function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new _c(Sc(i.injector.get(af)).map(kc),i)})))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?K(this.loader.load(e)):Ac(e()).pipe(Y((function(e){return e instanceof He?Js(e):K(t.compiler.compileModuleAsync(e))})))}}]),e}(),uf=function e(){_classCallCheck(this,e)},lf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function cf(e){throw e}function hf(e,t,n){return t.parse("/")}function ff(e,t){return Js(null)}var df=function(){function e(t,n,r,i,o,a,s,u){var l=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new D,this.errorHandler=cf,this.malformedUriErrorHandler=hf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:ff,afterPreactivation:ff},this.urlHandlingStrategy=new lf,this.routeReuseStrategy=new of,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=o.get(We),this.console=o.get(ji);var c=o.get(so);this.isNgZoneEnabled=c instanceof so,this.resetConfig(u),this.currentUrlTree=new Dc(new xc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new sf(a,s,(function(e){return l.triggerEvent(new oc(e))}),(function(e){return l.triggerEvent(new ac(e))})),this.routerState=nh(this.currentUrlTree,this.rootComponentType),this.transitions=new $s({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(au((function(e){return 0!==e.id})),H((function(e){return Object.assign({},e,{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})})),Ru((function(e){var r,i,o,a=!1,s=!1;return Js(e).pipe(pu((function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign({},t.lastSuccessfulNavigation,{previousNavigation:null}):null}})),Ru((function(e){var r,i,o,a,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Js(e).pipe(Ru((function(e){var r=t.transitions.getValue();return n.next(new Xl(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?Ks:[e]})),Ru((function(e){return Promise.resolve(e)})),(r=t.ngModule.injector,i=t.configLoader,o=t.urlSerializer,a=t.config,function(e){return e.pipe(Ru((function(e){return function(e,t,n,r,i){return new xh(e,t,n,r,i).apply()}(r,i,o,e.extractedUrl,a).pipe(H((function(t){return Object.assign({},e,{urlAfterRedirects:t})})))})))}),pu((function(e){t.currentNavigation=Object.assign({},t.currentNavigation,{finalUrl:e.urlAfterRedirects})})),function(e,n,r,i,o){return function(r){return r.pipe(Y((function(r){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new Gh(e,t,n,r,i,o).recognize()}(e,n,r.urlAfterRedirects,(a=r.urlAfterRedirects,t.serializeUrl(a)),i,o).pipe(H((function(e){return Object.assign({},r,{targetSnapshot:e})})));var a})))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),pu((function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),pu((function(e){var r=new ec(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)})));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var u=e.id,l=e.extractedUrl,c=e.source,h=e.restoredState,f=e.extras,d=new Xl(u,t.serializeUrl(l),c,h);n.next(d);var p=nh(l,t.rootComponentType).snapshot;return Js(Object.assign({},e,{targetSnapshot:p,urlAfterRedirects:l,extras:Object.assign({},f,{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Ks})),nf((function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})})),pu((function(e){var n=new tc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),H((function(e){return Object.assign({},e,{guards:(n=e.targetSnapshot,r=e.currentSnapshot,i=t.rootContexts,o=n._root,function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=eh(n);return t.children.forEach((function(t){!function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=t.value,s=n?n.value:null,u=r?r.getContext(t.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){var l=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Oc(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Oc(e.url,t.url)||!Ec(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ch(e,t)||!Ec(e.queryParams,t.queryParams);case"paramsChange":default:return!ch(e,t)}}(s,a,a.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new Lh(i)):(a.data=s.data,a._resolvedData=s._resolvedData),e(t,n,a.component?u?u.children:null:r,i,o),l&&o.canDeactivateChecks.push(new Fh(u&&u.outlet&&u.outlet.component||null,s))}else s&&Uh(n,u,o),o.canActivateChecks.push(new Lh(i)),e(t,null,a.component?u?u.children:null:r,i,o)}(t,a[t.value.outlet],r,i.concat([t.value]),o),delete a[t.value.outlet]})),Ic(a,(function(e,t){return Uh(e,r.getContext(t),o)})),o}(o,r?r._root:null,i,[o.value]))});var n,r,i,o})),(i=t.ngModule.injector,o=function(e){return t.triggerEvent(e)},function(e){return e.pipe(Y((function(e){var t=e.targetSnapshot,n=e.currentSnapshot,r=e.guards,a=r.canActivateChecks,s=r.canDeactivateChecks;return 0===s.length&&0===a.length?Js(Object.assign({},e,{guardsResult:!0})):function(e,t,n,r){return K(e).pipe(Y((function(e){return function(e,t,n,r,i){var o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Js(o.map((function(o){var a,s=Vh(o,t,i);if(function(e){return e&&Eh(e.canDeactivate)}(s))a=Ac(s.canDeactivate(e,t,n,r));else{if(!Eh(s))throw new Error("Invalid CanDeactivate guard");a=Ac(s(e,t,n,r))}return a.pipe(Nu())}))).pipe(Bh()):Js(!0)}(e.component,e.route,n,t,r)})),Nu((function(e){return!0!==e}),!0))}(s,t,n,i).pipe(Y((function(e){return e&&"boolean"==typeof e?function(e,t,n,r){return K(t).pipe(Vu((function(t){return K([Wh(t.route.parent,r),jh(t.route,r),zh(e,t.path,n),Hh(e,t.route,n)]).pipe(ou(),Nu((function(e){return!0!==e}),!0))})),Nu((function(e){return!0!==e}),!0))}(t,a,i,o):Js(e)})),H((function(t){return Object.assign({},e,{guardsResult:t})})))})))}),pu((function(e){if(Sh(e.guardsResult)){var n=yc('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}})),pu((function(e){var n=new nc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)})),au((function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var r=new $l(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(r),e.resolve(!1),!1}return!0})),nf((function(e){if(e.guards.canActivateChecks.length)return Js(e).pipe(pu((function(e){var n=new rc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),function(e,t){return function(n){return n.pipe(Y((function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;return i.length?K(i).pipe(Vu((function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return Js({});if(1===i.length){var o=i[0];return tf(e[o],t,n,r).pipe(H((function(e){return _defineProperty({},o,e)})))}var a={};return K(i).pipe(Y((function(i){return tf(e[i],t,n,r).pipe(H((function(e){return a[i]=e,e})))}))).pipe(Cu(),H((function(){return a})))}(e._resolve,e,t,r).pipe(H((function(t){return e._resolvedData=t,e.data=Object.assign({},e.data,ih(e,n).resolve),null})))}(n.route,r,e,t)})),function(e,t){return arguments.length>=2?function(n){return b(Mu(e,t),hu(1),_u(t))(n)}:function(t){return b(Mu((function(t,n,r){return e(t,n,r+1)})),hu(1))(t)}}((function(e,t){return e})),H((function(e){return n}))):Js(n)})))}}(t.paramsInheritanceStrategy,t.ngModule.injector),pu((function(e){var n=new ic(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})))})),nf((function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})})),H((function(e){var n,r,i,o,a=(n=t.routeReuseStrategy,r=e.targetSnapshot,i=e.currentRouterState,o=function e(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){var i=r.value;i._futureSnapshot=n.value;var o=function(t,n,r){return n.children.map((function(n){var i=!0,o=!1,a=void 0;try{for(var s,u=r.children[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(t.shouldReuseRoute(l.value.snapshot,n.value))return e(t,n,l)}}catch(c){o=!0,a=c}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return e(t,n)}))}(t,n,r);return new Zc(i,o)}var a=t.retrieve(n.value);if(a){var s=a.route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var r=0;r<t.children.length;++r)e(t.children[r],n.children[r])}(n,s),s}var u,l=new rh(new $s((u=n.value).url),new $s(u.params),new $s(u.queryParams),new $s(u.fragment),new $s(u.data),u.outlet,u.component,u),c=n.children.map((function(n){return e(t,n)}));return new Zc(l,c)}(n,r._root,i?i._root:void 0),new th(o,r));return Object.assign({},e,{targetRouterState:a})})),pu((function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),function(e,t,n){return H((function(r){return new Ch(t,r.targetRouterState,r.currentRouterState,n).activate(e),r}))}(t.rootContexts,t.routeReuseStrategy,(function(e){return t.triggerEvent(e)})),pu({next:function(){a=!0},complete:function(){a=!0}}),(r=function(){if(!a&&!s){t.resetUrlToCurrentUrlTree();var r=new $l(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(r),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new Uu(r))}),ku((function(r){if(s=!0,(u=r)&&u[gc]){var i=Sh(r.url);i||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var o=new $l(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),e.resolve(!1),i&&t.navigateByUrl(r.url)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var a=new Zl(e.id,t.serializeUrl(e.extractedUrl),r);n.next(a);try{e.resolve(t.errorHandler(r))}catch(l){e.reject(l)}}var u;return Ks})))})))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign({},this.getTransition(),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(t){var n=e.parseUrl(t.url),r="popstate"===t.type?"popstate":"hashchange",i=t.state&&t.state.navigationId?t.state:null;setTimeout((function(){e.scheduleNavigation(n,r,i,{replaceUrl:!0})}),0)})))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){bc(e),this.config=e.map(kc),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,o=t.preserveQueryParams,a=t.queryParamsHandling,s=t.preserveFragment;it()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,l=s?this.currentUrlTree.fragment:i,c=null;if(a)switch(a){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=o?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return fh(t.root,t.root,t,r,i);var o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new dh(!0,0,e);var t=0,n=!1,r=e.reduce((function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var o={};return Ic(r.outlets,(function(e,t){o[t]="string"==typeof e?e.split("/"):e})),[].concat(_toConsumableArray(e),[{outlets:o}])}if(r.segmentPath)return[].concat(_toConsumableArray(e),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(e),[r]):0===i?(r.split("/").forEach((function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))})),e):[].concat(_toConsumableArray(e),[r])}),[]);return new dh(n,t,r)}(n);if(o.toRoot())return fh(t.root,new xc([],{}),t,r,i);var a=function(e,t,n){if(e.isAbsolute)return new ph(t.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new ph(n.snapshot._urlSegment,!0,0);var r=hh(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,o=n;o>i;){if(o-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new ph(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(o,t,e),s=a.processChildren?yh(a.segmentGroup,a.index,o.commands):gh(a.segmentGroup,a.index,o.commands);return fh(a.segmentGroup,s,t,r,i)}(u,this.currentUrlTree,e,c,l)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};it()&&this.isNgZoneEnabled&&!so.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=Sh(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(Sh(e))return Nc(this.currentUrlTree,e,t);var n=this.parseUrl(e);return Nc(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return null!=r&&(t[n]=r),t}),{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe((function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new Jl(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)}),(function(t){e.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(e,t,n,r){var i=this.getTransition();if(i&&"imperative"!==t&&"imperative"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(i&&"hashchange"==t&&"popstate"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(i&&"popstate"==t&&"hashchange"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);var o=null,a=null,s=new Promise((function(e,t){o=e,a=t})),u=++this.navigationId;return this.setTransition({id:u,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:o,reject:a,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(e){return Promise.reject(e)}))}},{key:"setBrowserUrl",value:function(e,t,n,r){var i=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(i)||t?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),e}(),pf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.router=t,this.route=n,this.commands=[],null==r&&i.setAttribute(o.nativeElement,"tabindex","0")}return _createClass(e,[{key:"onClick",value:function(){var e={skipLocationChange:vf(this.skipLocationChange),replaceUrl:vf(this.replaceUrl)};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){it()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated!, use queryParamsHandling instead."),this.preserve=e}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:vf(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:vf(this.preserveFragment)})}}]),e}();function vf(e){return""===e||!!e}var gf=function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new yf,this.attachRef=null},yf=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new gf,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),mf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new xi,this.deactivateEvents=new xi,this.name=i||dc,t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new _f(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),e}(),_f=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.childContexts=n,this.parent=r}return _createClass(e,[{key:"get",value:function(e,t){return e===rh?this.route:e===yf?this.childContexts:this.parent.get(e,t)}}]),e}(),bf=function e(){_classCallCheck(this,e)},wf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe(ku((function(){return Js(null)})))}}]),e}(),Cf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return Js(null)}}]),e}(),kf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=new sf(n,r,(function(e){return t.triggerEvent(new oc(e))}),(function(e){return t.triggerEvent(new ac(e))}))}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(au((function(e){return e instanceof Jl})),Vu((function(){return e.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var e=this.injector.get(We);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.loadChildren&&!u.canLoad&&u._loadedConfig){var l=u._loadedConfig;n.push(this.processRoutes(l.module,l.routes))}else u.loadChildren&&!u.canLoad?n.push(this.preloadConfig(e,u)):u.children&&n.push(this.processRoutes(e,u.children))}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return K(n).pipe(Z(),H((function(e){})))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,(function(){return n.loader.load(e.injector,t).pipe(Y((function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)})))}))}}]),e}(),Ef=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof Xl?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Jl&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof hc&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new hc(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}(),Sf=new De("ROUTER_CONFIGURATION"),Tf=new De("ROUTER_FORROOT_GUARD"),If=[_s,{provide:Mc,useClass:Lc},{provide:df,useFactory:Pf,deps:[Io,Mc,yf,_s,Lt,No,$i,af,Sf,[uf,new fe],[rf,new fe]]},yf,{provide:rh,useFactory:Mf,deps:[df]},{provide:No,useClass:Ro},kf,Cf,wf,{provide:Sf,useValue:{enableTracing:!1}}];function Af(){return new wo("Router",df)}var Nf=function(){function e(t,n){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[If,Of(t),{provide:Tf,useFactory:Rf,deps:[[df,new fe,new pe]]},{provide:Sf,useValue:n||{}},{provide:ys,useFactory:xf,deps:[vs,[new he(ms),new fe],Sf]},{provide:Ef,useFactory:Df,deps:[df,Qs,Sf]},{provide:bf,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Cf},{provide:wo,multi:!0,useFactory:Af},[Lf,{provide:Pi,multi:!0,useFactory:Ff,deps:[Lf]},{provide:Uf,useFactory:Vf,deps:[Lf]},{provide:Bi,multi:!0,useExisting:Uf}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[Of(t)]}}}]),e}();function Df(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new Ef(e,t,n)}function xf(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).useHash?new ws(e,t):new Cs(e,t)}function Rf(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Of(e){return[{provide:Ht,multi:!0,useValue:e},{provide:af,multi:!0,useValue:e}]}function Pf(e,t,n,r,i,o,a,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},l=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,h=new df(null,t,n,r,i,o,a,Sc(s));if(l&&(h.urlHandlingStrategy=l),c&&(h.routeReuseStrategy=c),u.errorHandler&&(h.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(h.malformedUriErrorHandler=u.malformedUriErrorHandler),u.enableTracing){var f=ju();h.events.subscribe((function(e){f.logGroup("Router Event: ".concat(e.constructor.name)),f.log(e.toString()),f.log(e),f.logGroupEnd()}))}return u.onSameUrlNavigation&&(h.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.urlUpdateStrategy&&(h.urlUpdateStrategy=u.urlUpdateStrategy),u.relativeLinkResolution&&(h.relativeLinkResolution=u.relativeLinkResolution),h}function Mf(e){return e.routerState.root}var Lf=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new D}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(gs,Promise.resolve(null)).then((function(){var t=null,n=new Promise((function(e){return t=e})),r=e.injector.get(df),i=e.injector.get(Sf);if(e.isLegacyDisabled(i)||e.isLegacyEnabled(i))t(!0);else if("disabled"===i.initialNavigation)r.setUpLocationChangeListener(),t(!0);else{if("enabled"!==i.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(i.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return e.initNavigation?Js(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(Sf),n=this.injector.get(kf),r=this.injector.get(Ef),i=this.injector.get(df),o=this.injector.get(Io);e===o.components[0]&&(this.isLegacyEnabled(t)?i.initialNavigation():this.isLegacyDisabled(t)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}();function Ff(e){return e.appInitializer.bind(e)}function Vf(e){return e.bootstrapListener.bind(e)}var Uf=new De("Router Initializer"),qf=Zn({encapsulation:2,styles:[],data:{}});function Bf(e){return sa(0,[(e()(),Go(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ui(1,212992,null,0,mf,[yf,Mn,sn,[8,null],Rt],null,null)],(function(e,t){e(t,1,0)}),null)}var jf=Vr("ng-component",fc,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"ng-component",[],null,null,null,Bf,qf)),ui(1,49152,null,0,fc,[],null,null)],null,null)}),{},{},[]),Wf=function(){function e(t){var n=this;_classCallCheck(this,e),this.userService=t,this.eventDelete=new xi,this.isAdmin=!1,this.userService.afAuth.authState.subscribe((function(e){e&&n.userService.getUserData(e.email).subscribe((function(e){"admin"===e.role&&(n.isAdmin=!0)}))}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"deleteCourse",value:function(){this.eventDelete.emit(this.course.id)}}]),e}();function Hf(e){return function(e){return new k((function(t){return{unsubscribe:e.onSnapshot(t)}}))}(e).pipe(ue())}function zf(e){return Hf(e).pipe(H((function(e){return{payload:e,type:"query"}})))}function Qf(e){return zf(e).pipe(H((function(e){return e.payload.docChanges().map((function(e){return{type:e.type,payload:e}}))})))}function Gf(e,t){return zf(e).pipe(H((function(e){return e.payload.docChanges()})),Mu((function(e,n){return function(e,t,n){return t.forEach((function(t){n.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":e[t.newIndex]&&e[t.newIndex].doc.ref.isEqual(t.doc.ref)||e.splice(t.newIndex,0,t);break;case"modified":(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref))&&(t.oldIndex!==t.newIndex?(e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t)):e.splice(t.newIndex,1,t));break;case"removed":e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref)&&e.splice(t.oldIndex,1)}return e}(e,t))})),e}(e,n,t)}),[]),H((function(e){return e.map((function(e){return{type:e.type,payload:e}}))})))}n("mrSG");var Kf=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r.pending=!1,r}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),t}(function(e){function t(e,n){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),t}(d)),Yf=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n>0?_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,n){return n>0||this.closed?_get(_getPrototypeOf(t.prototype),"execute",this).call(this,e,n):this._execute(e,n)}},{key:"requestAsyncId",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,n,r):e.flush(this)}}]),t}(Kf),Xf=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Jf=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xf.now;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,(function(){return t.delegate&&t.delegate!==_assertThisInitialized(n)?t.delegate.now():r()})))).actions=[],n.active=!1,n.scheduled=void 0,n}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,r):_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),t}(Xf),$f=new(function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),t}(Jf))(Yf),Zf=new De("angularfire2.realtimeDatabaseURL"),ed=function(){function e(t,n){_classCallCheck(this,e),this.zone=t,this.platformId=n}return _createClass(e,[{key:"schedule",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.zone.runGuarded((function(){return $f.schedule.apply($f,t)}))}},{key:"keepUnstableUntilFirst",value:function(e){return Hs(this.platformId)?new k((function(t){var n=function(){},r=Zone.current.scheduleMacroTask("firebaseZoneBlock",n,{},n,n);e.subscribe((function(e){"scheduled"===r.state&&r.invoke(),t.next(e)}),(function(e){"scheduled"===r.state&&r.invoke(),t.error(e)}),(function(){"scheduled"===r.state&&r.invoke(),t.complete()}))})):e}},{key:"runOutsideAngular",value:function(e){var t=this;return new k((function(n){return t.zone.runOutsideAngular((function(){return e.subscribe((function(e){return t.zone.run((function(){return n.next(e)}))}),(function(e){return t.zone.run((function(){return n.error(e)}))}),(function(){return t.zone.run((function(){return n.complete()}))}))}))}))}}]),e}(),td=function(e){return function(t){return new k((function(n){return t.subscribe((function(t){return e.run((function(){return n.next(t)}))}),(function(t){return e.run((function(){return n.error(t)}))}),(function(){return e.run((function(){return n.complete()}))}))}))}};function nd(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}var rd,id=function(){function e(t,n,r){_classCallCheck(this,e),this.ref=t,this.query=n,this.afs=r}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Qf(this.query))).pipe(H((function(t){return t.filter((function(t){return e.indexOf(t.type)>-1}))})),au((function(e){return e.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Qf(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Mu((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[]))}},{key:"snapshotChanges",value:function(e){var t=nd(e),n=Gf(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=zf(this.query),n=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(n).pipe(H((function(t){return t.payload.docs.map((function(t){return e.idField?Object.assign({},t.data(),_defineProperty({},e.idField,t.id)):t.data()}))})))}},{key:"get",value:function(e){return K(this.query.get(e)).pipe(td(this.afs.scheduler.zone))}},{key:"add",value:function(e){return this.ref.add(e)}},{key:"doc",value:function(e){return new od(this.ref.doc(e),this.afs)}}]),e}(),od=function(){function e(t,n){_classCallCheck(this,e),this.ref=t,this.afs=n}return _createClass(e,[{key:"set",value:function(e,t){return this.ref.set(e,t)}},{key:"update",value:function(e){return this.ref.update(e)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(e,t){var n=wd(this.ref.collection(e),t),r=n.ref,i=n.query;return new id(r,i,this.afs)}},{key:"snapshotChanges",value:function(){var e=Hf(this.ref).pipe(H((function(e){return{payload:e,type:"value"}}))),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t)}},{key:"valueChanges",value:function(){return this.snapshotChanges().pipe(H((function(e){return e.payload.data()})))}},{key:"get",value:function(e){return K(this.ref.get(e)).pipe(td(this.afs.scheduler.zone))}}]),e}(),ad=function(){function e(t,n){_classCallCheck(this,e),this.query=t,this.afs=n}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Qf(this.query))).pipe(H((function(t){return t.filter((function(t){return e.indexOf(t.type)>-1}))})),au((function(e){return e.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Qf(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Mu((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[]))}},{key:"snapshotChanges",value:function(e){var t=nd(e),n=Gf(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=zf(this.query),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t).pipe(H((function(e){return e.payload.docs.map((function(e){return e.data()}))})))}},{key:"get",value:function(e){return K(this.query.get(e)).pipe(td(this.afs.scheduler.zone))}}]),e}(),sd=n("Wcq6"),ud=n.n(sd),ld=new De("angularfire2.app.options"),cd=new De("angularfire2.app.nameOrConfig"),hd=ld,fd=cd,dd=function e(){_classCallCheck(this,e)};function pd(e,t,n){var r="object"==typeof n&&n||{};return r.name=r.name||"string"==typeof n&&n||"[DEFAULT]",ud.a.apps.filter((function(e){return e&&e.name===r.name}))[0]||t.runOutsideAngular((function(){return ud.a.initializeApp(e,r)}))}var vd=rd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"initializeApp",value:function(e,t){return{ngModule:rd,providers:[{provide:hd,useValue:e},{provide:fd,useValue:t}]}}}]),e}(),gd=new De("angularfire2.enableFirestorePersistence"),yd=new De("angularfire2.firestore.persistenceSettings"),md=new De("angularfire2.firestore.settings"),_d=parseInt(ud.a.SDK_VERSION.split(".")[0]),bd=_d<5||5==_d&&parseInt(ud.a.SDK_VERSION.split(".")[1])<8?{timestampsInSnapshots:!0}:{};function wd(e){return{query:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e})(e),ref:e}}var Cd,kd,Ed=function(){function e(t,n,r,i,o,a,s){var u=this;_classCallCheck(this,e),this.scheduler=new ed(a,o),this.firestore=a.runOutsideAngular((function(){var e=pd(t,a,n).firestore();return e.settings(i||bd),e})),this.persistenceEnabled$=r&&!Hs(o)?a.runOutsideAngular((function(){try{return K(u.firestore.enablePersistence(s||void 0).then((function(){return!0}),(function(){return!1})))}catch(e){return Js(!1)}})):Js(!1)}return _createClass(e,[{key:"collection",value:function(e,t){var n=wd("string"==typeof e?this.firestore.collection(e):e,t),r=n.ref,i=n.query;return new id(r,i,this)}},{key:"collectionGroup",value:function(e,t){if(_d<6)throw"collection group queries require Firebase JS SDK >= 6.0";var n=t||function(e){return e},r=this.firestore.collectionGroup(e);return new ad(n(r),this)}},{key:"doc",value:function(e){var t;return t="string"==typeof e?this.firestore.doc(e):e,new od(t,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),e}(),Sd=((kd=function(){function e(t){_classCallCheck(this,e),this.dataBase=t,this.courses=new Array,this.getCourses()}return _createClass(e,[{key:"getCourses",value:function(){var e=this;return this.dataBase.collection("/Courses").get().pipe(H((function(t){return e.courses=[],t.docs.forEach((function(t){var n=t.data();n.id=t.id,e.courses.push(n)})),e.courses})))}},{key:"getCourse",value:function(e){return this.dataBase.doc("/Courses/".concat(e)).get().pipe(H((function(e){var t=e.data();return t.id=e.id,t})))}},{key:"addCourse",value:function(e){var t=e;return t.studentsEnrolled=0,t.ratingCount=0,t.ratingSum=0,console.log(e,t),this.dataBase.collection("/Courses").add(Object.assign({},t))}},{key:"updateCourse",value:function(e,t){return this.dataBase.doc("/Courses/".concat(e)).update(t)}},{key:"removeCourse",value:function(e){return this.dataBase.doc("/Courses/".concat(e)).delete()}},{key:"rateCourse",value:function(e,t){var n=this;this.getCourse(e).subscribe((function(r){r.ratingSum+=t,r.ratingCount+=1,n.dataBase.doc("/Courses/".concat(e)).update(Object.assign({},r))}))}},{key:"enroll",value:function(e){var t=this;this.getCourse(e).subscribe((function(n){n.studentsEnrolled+=1,t.dataBase.doc("/Courses/".concat(e)).update(Object.assign({},n))}))}}]),e}()).ngInjectableDef=ye({factory:function(){return new kd(qe(Ed))},token:kd,providedIn:"root"}),kd),Td=function e(t,n,r,i){var o=this;_classCallCheck(this,e),this.zone=i;var a=new ed(i,r);this.auth=i.runOutsideAngular((function(){return pd(t,i,n).auth()})),this.authState=a.keepUnstableUntilFirst(a.runOutsideAngular(new k((function(e){return{unsubscribe:o.auth.onAuthStateChanged(e)}})))),this.user=a.keepUnstableUntilFirst(a.runOutsideAngular(new k((function(e){return{unsubscribe:o.auth.onIdTokenChanged(e)}})))),this.idToken=this.user.pipe(Ru((function(e){return e?K(e.getIdToken()):Js(null)}))),this.idTokenResult=this.user.pipe(Ru((function(e){return e?K(e.getIdTokenResult()):Js(null)})))},Id=((Cd=function(){function e(t,n,r){_classCallCheck(this,e),this.courseService=t,this.dataBase=n,this.afAuth=r,this.user=null,this.getUser()}return _createClass(e,[{key:"getUser",value:function(){var e=this;this.afAuth.authState.subscribe((function(t){t?e.getUserData(t.email):e.user=null}))}},{key:"getUserData",value:function(e){var t=this;return this.dataBase.collection("/Users").get().pipe(H((function(n){return n.forEach((function(n){n.data().email===e&&(t.user=n.data(),t.user.id=n.id)})),t.user})))}},{key:"signInUser",value:function(e,t){var n=this;return this.afAuth.auth.signInWithEmailAndPassword(e,t).then((function(){return n.getUser()}))}},{key:"registerUser",value:function(e,t){var n={email:e,role:"user",courses:[]};return this.dataBase.collection("/Users").add(Object.assign({},n)),this.afAuth.auth.createUserWithEmailAndPassword(e,t)}},{key:"signOutUser",value:function(){return this.afAuth.auth.signOut()}},{key:"enroll",value:function(e){this.user&&(this.user.courses.push({id:e}),this.dataBase.doc("/Users/".concat(this.user.id)).update(Object.assign({},this.user)),this.courseService.enroll(e))}},{key:"isEnrolled",value:function(e){return!(!this.user||!this.user.courses.find((function(t){return t.id===e})))}},{key:"getRating",value:function(e){if(this.user)return this.user.courses.find((function(t){return t.id===e})).rate}},{key:"setRating",value:function(e,t){if(this.user){this.courseService.rateCourse(e,t);var n=this.user.courses.find((function(t){return t.id===e}));n.rate=t,console.log(n),this.dataBase.doc("/Users/".concat(this.user.id)).update(this.user)}}}]),e}()).ngInjectableDef=ye({factory:function(){return new Cd(qe(Sd),qe(Ed),qe(Td))},token:Cd,providedIn:"root"}),Cd),Ad=Zn({encapsulation:0,styles:[['#wrapper[_ngcontent-%COMP%]{background-color:rgba(1,1,1,0);width:80%;max-width:20cm;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:3px;margin-left:20px;margin-right:20px;font-family:"Arial Black"}img[_ngcontent-%COMP%]{max-height:100%;width:auto;max-width:100px;max-height:100px}.img-wrapper[_ngcontent-%COMP%]{height:100%;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:6cm;overflow:hidden}h1[_ngcontent-%COMP%]{font-size:1cm;margin:1mm 1mm 1mm 2.5mm}.splitter[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 7cm;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.main-data[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto auto;height:auto}.title-wrapper[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.more-button[_ngcontent-%COMP%]{height:.5cm;width:.9cm;background-color:rgba(211,211,211,.5);padding:.3mm}.courseButton[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:bisque;border:1px solid #1e90ff;border-radius:5px}']],data:{}});function Nd(e){return sa(0,[(e()(),Go(0,0,null,null,1,"button",[["class","courseButton"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.deleteCourse()&&r),r}),null,null)),(e()(),ia(-1,null,["Remove"]))],null,null)}function Dd(e){return sa(0,[(e()(),Go(0,0,null,null,12,"div",[["id","wrapper"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,6,"div",[["class","splitter"]],null,null,null,null,null)),(e()(),Go(2,0,null,null,1,"div",[["class","img-wrapper"]],null,null,null,null,null)),(e()(),Go(3,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(e()(),Go(4,0,null,null,3,"div",[["class","main-data"]],null,null,null,null,null)),(e()(),Go(5,0,null,null,2,"div",[["class","title-wrapper"]],null,null,null,null,null)),(e()(),Go(6,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(7,null,["",""])),(e()(),Go(8,0,null,null,2,"button",[["class","courseButton"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Yr(e,9).onClick()&&r),r}),null,null)),ui(9,16384,null,0,pf,[df,rh,[8,null],vn,hn],{routerLink:[0,"routerLink"]},null),(e()(),ia(-1,null,["View Details"])),(e()(),Qo(16777216,null,null,1,null,Nd)),ui(12,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,9,0,"/Details/"+n.course.id),e(t,12,0,n.isAdmin)}),(function(e,t){var n=t.component;e(t,3,0,Sr(1,"",n.course.image,"")),e(t,7,0,n.course.name)}))}var xd=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).sources=n,r.completed=0,r.haveValues=0;var i=n.length;r.values=new Array(i);for(var o=0;o<i;o++){var a=j(_assertThisInitialized(r),n[o],null,o);a&&r.add(a)}return r}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,i){this.values[n]=t,i._hasValue||(i._hasValue=!0,this.haveValues++)}},{key:"notifyComplete",value:function(e){var t=this.destination,n=this.haveValues,r=this.values,i=r.length;e._hasValue?(this.completed++,this.completed===i&&(n===i&&t.next(r),t.complete())):t.complete()}}]),t}(W),Rd=new De("NgValueAccessor"),Od=new De("CompositionEventMode"),Pd=function(){function e(t,n,r){var i;_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=r,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(i=ju()?ju().getUserAgent():"",!/android (\d+)/.test(i.toLowerCase())))}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}(),Md=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),e}(),Ld=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),t}(Md);function Fd(){throw new Error("unimplemented")}var Vd=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)))._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return _inherits(t,e),_createClass(t,[{key:"validator",get:function(){return Fd()}},{key:"asyncValidator",get:function(){return Fd()}}]),t}(Md),Ud=function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}(),qd=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),t}(Ud),Bd=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,e),t}(Ud);function jd(e){return null==e||0===e.length}var Wd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Hd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(jd(t.value)||jd(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(jd(t.value)||jd(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return jd(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return jd(e.value)?null:Wd.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(jd(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}},{key:"maxLength",value:function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(r="","^"!==t.charAt(0)&&(r+="^"),r+=t,"$"!==t.charAt(t.length-1)&&(r+="$"),n=new RegExp(r)):(r=t.toString(),n=t),function(e){if(jd(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:r,actualValue:t}}}):e.nullValidator;var n,r}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(zd);return 0==t.length?null:function(e){return Gd(function(e,t){return t.map((function(t){return t(e)}))}(e,t))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(zd);return 0==t.length?null:function(e){return function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i;return"function"==typeof n[n.length-1]&&(i=n.pop()),1===n.length&&u(n[0])&&(n=n[0]),0===n.length?Ks:i?e(n).pipe(H((function(e){return i.apply(void 0,_toConsumableArray(e))}))):new k((function(e){return new xd(e,n)}))}(function(e,t){return t.map((function(t){return t(e)}))}(e,t).map(Qd)).pipe(H(Gd))}}}]),e}();function zd(e){return null!=e}function Qd(e){var t=$t(e)?K(e):e;if(!Zt(t))throw new Error("Expected validator to return Promise or Observable.");return t}function Gd(e){var t=e.reduce((function(e,t){return null!=t?Object.assign({},e,t):e}),{});return 0===Object.keys(t).length?null:t}function Kd(e){return e.validate?function(t){return e.validate(t)}:e}function Yd(e){return e.validate?function(t){return e.validate(t)}:e}var Xd=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),Jd=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach((function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)}))}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}(),$d='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',Zd='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',ep='\n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });',tp='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',np='\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ',rp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"controlParentException",value:function(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat($d))}},{key:"ngModelGroupException",value:function(){throw new Error('formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        '.concat(Zd,"\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ").concat(tp))}},{key:"missingFormException",value:function(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ".concat($d))}},{key:"groupParentException",value:function(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(Zd))}},{key:"arrayParentException",value:function(){throw new Error("formArrayName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        ".concat(ep))}},{key:"disabledAttrWarning",value:function(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}},{key:"ngModelWarning",value:function(e){console.warn("\n    It looks like you're using ngModel on the same form field as ".concat(e,". \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/").concat("formControl"===e?"FormControlDirective":"FormControlName","#use-with-ngmodel\n    "))}}]),e}();function ip(e,t){return[].concat(_toConsumableArray(t.path),[e])}function op(e,t){e||lp(t,"Cannot find control with"),t.valueAccessor||lp(t,"No value accessor for form control with"),e.validator=Hd.compose([e.validator,t.validator]),e.asyncValidator=Hd.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange((function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&ap(e,t)}))}(e,t),function(e,t){e.registerOnChange((function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)}))}(e,t),function(e,t){t.valueAccessor.registerOnTouched((function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&ap(e,t),"submit"!==e.updateOn&&e.markAsTouched()}))}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange((function(e){t.valueAccessor.setDisabledState(e)})),t._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))})),t._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))}))}function ap(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function sp(e,t){null==e&&lp(t,"Cannot find control with"),e.validator=Hd.compose([e.validator,t.validator]),e.asyncValidator=Hd.composeAsync([e.asyncValidator,t.asyncValidator])}function up(e){return lp(e,"There is no FormControl instance attached to form control element with")}function lp(e,t){var n;throw n=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(n))}function cp(e){return null!=e?Hd.compose(e.map(Kd)):null}function hp(e){return null!=e?Hd.composeAsync(e.map(Yd)):null}function fp(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Gt(t,n.currentValue)}var dp=[function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),Xd,function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=Gt}return _createClass(e,[{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=function(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}(),function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=Gt}return _createClass(e,[{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map((function(e){return n._getOptionId(e)}));t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=t._getOptionValue(a.value);r.push(s)}else for(var u=n.options,l=0;l<u.length;l++){var c=u.item(l);if(c.selected){var h=t._getOptionValue(c.value);r.push(h)}}t.value=r,e(r)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}(),function(){function e(t,n,r,i){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._registry=r,this._injector=i,this.onChange=function(){},this.onTouched=function(){}}return _createClass(e,[{key:"ngOnInit",value:function(){this._control=this._injector.get(Vd),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),e}()];function pp(e,t){e._syncPendingControls(),t.forEach((function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}))}function vp(e,t){if(!t)return null;Array.isArray(t)||lp(e,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,i=void 0;return t.forEach((function(t){var o;t.constructor===Pd?n=t:(o=t,dp.some((function(e){return o.constructor===e}))?(r&&lp(e,"More than one built-in value accessor matches form control with"),r=t):(i&&lp(e,"More than one custom value accessor matches form control with"),i=t))})),i||r||n||(lp(e,"No valid value accessor for form control with"),null)}function gp(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function yp(e){var t=_p(e)?e.validators:e;return Array.isArray(t)?cp(t):t||null}function mp(e,t){var n=_p(t)?t.asyncValidators:e;return Array.isArray(n)?hp(n):n||null}function _p(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var bp=function(){function e(t,n){_classCallCheck(this,e),this.validator=t,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"setValidators",value:function(e){this.validator=yp(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=mp(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(e){return e.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(e){e.markAsUntouched({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(e){e.markAsPristine({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(t){t.disable(Object.assign({},e,{onlySelf:!0}))})),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!0)}))}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild((function(t){t.enable(Object.assign({},e,{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!1)}))}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(t){return t._updateTreeValidity(e)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var n=Qd(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return t.setErrors(n,{emitEvent:e})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){return null==t?null:(t instanceof Array||(t=t.split(".")),t instanceof Array&&0===t.length?null:t.reduce((function(e,t){return e instanceof Cp?e.controls.hasOwnProperty(t)?e.controls[t]:null:e instanceof kp&&e.at(t)||null}),e))}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new xi,this.statusChanges=new xi}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls((function(t){return t.status===e}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(e){return e.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(e){return e.touched}))}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){_p(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}}]),e}(),wp=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,yp(r),mp(i,r))))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(r),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _inherits(t,e),_createClass(t,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(e){return e(t.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),t}(bp),Cp=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,yp(n),mp(r,n)))).controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _inherits(t,e),_createClass(t,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach((function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(e,t,n){return e[n]=t instanceof wp?t.value:t.getRawValue(),e}))}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,(function(e,t){return!!t._syncPendingControls()||e}));return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,n=!1;return this._forEachChild((function(r,i){n=n||t.contains(i)&&e(r)})),n}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},(function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t}))}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild((function(e,r){n=t(n,e,r)})),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),t}(bp),kp=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,yp(n),mp(r,n)))).controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _inherits(t,e),_createClass(t,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach((function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map((function(e){return e instanceof wp?e.value:e.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(e){return e._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce((function(e,t){return!!t._syncPendingControls()||e}),!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach((function(t,n){e(t,n)}))}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter((function(t){return t.enabled||e.disabled})).map((function(e){return e.value}))}},{key:"_anyControls",value:function(e){return this.controls.some((function(t){return t.enabled&&e(t)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){return e._registerControl(t)}))}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.controls[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){if(r.value.enabled)return!1}}catch(o){t=!0,n=o}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),t}(bp),Ep=Promise.resolve(null),Sp=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).submitted=!1,r._directives=[],r.ngSubmit=new xi,r.form=new Cp({},cp(e),hp(n)),r}return _inherits(t,e),_createClass(t,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(e){var t=this;Ep.then((function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),op(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)}))}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Ep.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),gp(t._directives,e)}))}},{key:"addFormGroup",value:function(e){var t=this;Ep.then((function(){var n=t._findContainer(e.path),r=new Cp({});sp(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(e){var t=this;Ep.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)}))}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Ep.then((function(){n.form.get(e.path).setValue(t)}))}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,pp(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),t}(Ld),Tp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"modelParentException",value:function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      '.concat($d,"\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      ").concat(np))}},{key:"formGroupNameException",value:function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ".concat(Zd,"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ").concat(tp))}},{key:"missingNameException",value:function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}},{key:"modelGroupParentException",value:function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ".concat(Zd,"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ").concat(tp))}},{key:"ngFormWarning",value:function(){console.warn("\n    It looks like you're using 'ngForm'.\n\n    Support for using the 'ngForm' element selector has been deprecated in Angular v6 and will be removed\n    in Angular v9.\n\n    Use 'ng-form' instead.\n\n    Before:\n    <ngForm #myForm=\"ngForm\">\n\n    After:\n    <ng-form #myForm=\"ngForm\">\n    ")}}]),e}(),Ip=new De("NgFormSelectorWarning"),Ap=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return ip(this.name,this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return cp(this._validators)}},{key:"asyncValidator",get:function(){return hp(this._asyncValidators)}}]),t}(Ld),Np=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=e,i._validators=n,i._asyncValidators=r,i}return _inherits(t,e),_createClass(t,[{key:"_checkParentType",value:function(){this._parent instanceof t||this._parent instanceof Sp||Tp.modelGroupParentException()}}]),t}(Ap),Dp=Promise.resolve(null),xp=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).control=new wp,o._registered=!1,o.update=new xi,o._parent=e,o._rawValidators=n||[],o._rawAsyncValidators=r||[],o.valueAccessor=vp(_assertThisInitialized(o),i),o}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),fp(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){op(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){!(this._parent instanceof Np)&&this._parent instanceof Ap?Tp.formGroupNameException():this._parent instanceof Np||this._parent instanceof Sp||Tp.modelParentException()}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Tp.missingNameException()}},{key:"_updateValue",value:function(e){var t=this;Dp.then((function(){t.control.setValue(e,{emitViewToModelChange:!1})}))}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Dp.then((function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()}))}},{key:"path",get:function(){return this._parent?ip(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return cp(this._rawValidators)}},{key:"asyncValidator",get:function(){return hp(this._rawAsyncValidators)}}]),t}(Vd),Rp=function e(){_classCallCheck(this,e)},Op=new De("NgModelWithFormControlWarning"),Pp=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._validators=e,r._asyncValidators=n,r.submitted=!1,r.directives=[],r.form=null,r.ngSubmit=new xi,r}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return op(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){gp(this.directives,e)}},{key:"addFormGroup",value:function(e){var t=this.form.get(e.path);sp(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormGroup",value:function(e){}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){var t=this.form.get(e.path);sp(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormArray",value:function(e){}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,pp(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach((function(t){var n=e.form.get(t.path);t.control!==n&&(function(e,t){t.valueAccessor.registerOnChange((function(){return up(t)})),t.valueAccessor.registerOnTouched((function(){return up(t)})),t._rawValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),t._rawAsyncValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),e&&e._clearChangeFns()}(t.control,t),n&&op(n,t),t.control=n)})),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_updateRegistrations",value:function(){var e=this;this.form._registerOnCollectionChange((function(){return e._updateDomValue()})),this._oldForm&&this._oldForm._registerOnCollectionChange((function(){})),this._oldForm=this.form}},{key:"_updateValidators",value:function(){var e=cp(this._validators);this.form.validator=Hd.compose([this.form.validator,e]);var t=hp(this._asyncValidators);this.form.asyncValidator=Hd.composeAsync([this.form.asyncValidator,t])}},{key:"_checkFormPresent",value:function(){this.form||rp.missingFormException()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}}]),t}(Ld),Mp=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=e,i._validators=n,i._asyncValidators=r,i}return _inherits(t,e),_createClass(t,[{key:"_checkParentType",value:function(){Fp(this._parent)&&rp.groupParentException()}}]),t}(Ap),Lp=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=e,i._validators=n,i._asyncValidators=r,i}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormArray(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormArray(this)}},{key:"_checkParentType",value:function(){Fp(this._parent)&&rp.arrayParentException()}},{key:"control",get:function(){return this.formDirective.getFormArray(this)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"path",get:function(){return ip(this.name,this._parent)}},{key:"validator",get:function(){return cp(this._validators)}},{key:"asyncValidator",get:function(){return hp(this._asyncValidators)}}]),t}(Ld);function Fp(e){return!(e instanceof Mp||e instanceof Pp||e instanceof Lp)}var Vp,Up=((Vp=function(e){function t(e,n,r,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._ngModelWarningConfig=o,a._added=!1,a.update=new xi,a._ngModelWarningSent=!1,a._parent=e,a._rawValidators=n||[],a._rawAsyncValidators=r||[],a.valueAccessor=vp(_assertThisInitialized(a),i),a}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){var n,r;this._added||this._setUpControl(),fp(e,this.viewModel)&&(n=t,r=this._ngModelWarningConfig,it()&&"never"!==r&&((null!==r&&"once"!==r||n._ngModelWarningSentOnce)&&("always"!==r||this._ngModelWarningSent)||(rp.ngModelWarning("formControlName"),n._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_checkParentType",value:function(){!(this._parent instanceof Mp)&&this._parent instanceof Ap?rp.ngModelGroupException():this._parent instanceof Mp||this._parent instanceof Pp||this._parent instanceof Lp||rp.controlParentException()}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}},{key:"isDisabled",set:function(e){rp.disabledAttrWarning()}},{key:"path",get:function(){return ip(this.name,this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return cp(this._rawValidators)}},{key:"asyncValidator",get:function(){return hp(this._rawAsyncValidators)}}]),t}(Vd))._ngModelWarningSentOnce=!1,Vp),qp=function e(){_classCallCheck(this,e)},Bp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"group",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._reduceControls(e),r=null,i=null,o=void 0;return null!=t&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(t)?(r=null!=t.validators?t.validators:null,i=null!=t.asyncValidators?t.asyncValidators:null,o=null!=t.updateOn?t.updateOn:void 0):(r=null!=t.validator?t.validator:null,i=null!=t.asyncValidator?t.asyncValidator:null)),new Cp(n,{asyncValidators:i,updateOn:o,validators:r})}},{key:"control",value:function(e,t,n){return new wp(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map((function(e){return r._createControl(e)}));return new kp(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(r){n[r]=t._createControl(e[r])})),n}},{key:"_createControl",value:function(e){return e instanceof wp||e instanceof Cp||e instanceof kp?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}(),jp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Ip,useValue:t.warnOnDeprecatedNgFormSelector}]}}}]),e}(),Wp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Op,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}(),Hp=function e(t){_classCallCheck(this,e),this.name=null,this.starsMin=null,this.starsMax=null,this.etcsMin=null,this.etcsMax=null,this.placesMin=null,this.placesMax=null,this.semesterMin=null,this.semesterMax=null,this.form=null,this.description=null,Object.assign(this,t)},zp=function(){function e(){_classCallCheck(this,e),this.eventFilter=new xi}return _createClass(e,[{key:"ngOnInit",value:function(){this.filter=new Hp}},{key:"sendFilter",value:function(){this.eventFilter.emit(this.filter)}},{key:"clearFilter",value:function(){this.filter=new Hp,this.eventFilter.emit(new Hp)}}]),e}(),Qp=Zn({encapsulation:0,styles:[['.newCourseForm[_ngcontent-%COMP%]{font-family:"Arial Black";max-width:350px;min-width:100px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column nowrap;margin:20px}.split[_ngcontent-%COMP%]{display:grid;grid-template-columns:50% 50%}.filterField[_ngcontent-%COMP%]{text-align:center;padding:2px;margin:2px;border:1px solid #1e90ff;border-radius:10px}.filterButton[_ngcontent-%COMP%]{text-align:center;padding:2px;margin:2px;font-family:"Arial Black";background-color:bisque;border:1px solid #1e90ff;border-radius:15px}']],data:{}});function Gp(e){return sa(0,[(e()(),Go(0,0,null,null,80,"div",[["class","newCourseForm"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,5,"input",[["class","filterField"],["placeholder","Name"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,2)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,2).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,2)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,2)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.filter.name=n)&&r),r}),null,null)),ui(2,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(4,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(6,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(7,0,null,null,14,"div",[["class","split"]],null,null,null,null,null)),(e()(),Go(8,0,null,null,6,"input",[["class","filterField"],["placeholder","Min stars"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,9)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,9).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,9)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,9)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,10).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,10).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,10).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.starsMin=n)&&r),r}),null,null)),ui(9,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(10,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(12,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(14,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(15,0,null,null,6,"input",[["class","filterField"],["placeholder","Max stars"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,16)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,16).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,16)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,16)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,17).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,17).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,17).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.starsMax=n)&&r),r}),null,null)),ui(16,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(17,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(19,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(21,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(22,0,null,null,14,"div",[["class","split"]],null,null,null,null,null)),(e()(),Go(23,0,null,null,6,"input",[["class","filterField"],["placeholder","Min ECTS"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,24)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,24).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,24)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,24)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,25).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,25).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,25).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.etcsMin=n)&&r),r}),null,null)),ui(24,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(25,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(27,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(29,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(30,0,null,null,6,"input",[["class","filterField"],["placeholder","Max ECTS"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,31)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,31).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,31)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,31)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,32).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,32).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,32).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.etcsMax=n)&&r),r}),null,null)),ui(31,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(32,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(34,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(36,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(37,0,null,null,14,"div",[["class","split"]],null,null,null,null,null)),(e()(),Go(38,0,null,null,6,"input",[["class","filterField"],["placeholder","Min students limit"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,39)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,39).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,39)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,39)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,40).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,40).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,40).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.placesMin=n)&&r),r}),null,null)),ui(39,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(40,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(42,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(44,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(45,0,null,null,6,"input",[["class","filterField"],["placeholder","Max students limit"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,46)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,46).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,46)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,46)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,47).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,47).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,47).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.placesMax=n)&&r),r}),null,null)),ui(46,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(47,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(49,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(51,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(52,0,null,null,14,"div",[["class","split"]],null,null,null,null,null)),(e()(),Go(53,0,null,null,6,"input",[["class","filterField"],["placeholder","Min semester"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,54)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,54).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,54)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,54)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,55).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,55).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,55).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.semesterMin=n)&&r),r}),null,null)),ui(54,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(55,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(57,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(59,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(60,0,null,null,6,"input",[["class","filterField"],["placeholder","Max semester"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,61)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,61).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,61)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,61)._compositionEnd(n.target.value)&&r),"change"===t&&(r=!1!==Yr(e,62).onChange(n.target.value)&&r),"input"===t&&(r=!1!==Yr(e,62).onChange(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,62).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.filter.semesterMax=n)&&r),r}),null,null)),ui(61,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),ui(62,16384,null,0,Xd,[vn,hn],null,null),li(1024,null,Rd,(function(e,t){return[e,t]}),[Pd,Xd]),ui(64,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(66,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(67,0,null,null,5,"input",[["class","filterField"],["placeholder","Form"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,68)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,68).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,68)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,68)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.filter.form=n)&&r),r}),null,null)),ui(68,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(70,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(72,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(73,0,null,null,5,"input",[["class","filterField"],["placeholder","Description"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,74)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,74).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,74)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,74)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.filter.description=n)&&r),r}),null,null)),ui(74,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(76,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(78,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(79,0,null,null,0,"input",[["class","filterButton"],["type","button"],["value","Filter"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.sendFilter()&&r),r}),null,null)),(e()(),Go(80,0,null,null,0,"input",[["class","filterButton"],["type","button"],["value","Clear the filter"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.clearFilter()&&r),r}),null,null))],(function(e,t){var n=t.component;e(t,4,0,n.filter.name),e(t,12,0,n.filter.starsMin),e(t,19,0,n.filter.starsMax),e(t,27,0,n.filter.etcsMin),e(t,34,0,n.filter.etcsMax),e(t,42,0,n.filter.placesMin),e(t,49,0,n.filter.placesMax),e(t,57,0,n.filter.semesterMin),e(t,64,0,n.filter.semesterMax),e(t,70,0,n.filter.form),e(t,76,0,n.filter.description)}),(function(e,t){e(t,1,0,Yr(t,6).ngClassUntouched,Yr(t,6).ngClassTouched,Yr(t,6).ngClassPristine,Yr(t,6).ngClassDirty,Yr(t,6).ngClassValid,Yr(t,6).ngClassInvalid,Yr(t,6).ngClassPending),e(t,8,0,Yr(t,14).ngClassUntouched,Yr(t,14).ngClassTouched,Yr(t,14).ngClassPristine,Yr(t,14).ngClassDirty,Yr(t,14).ngClassValid,Yr(t,14).ngClassInvalid,Yr(t,14).ngClassPending),e(t,15,0,Yr(t,21).ngClassUntouched,Yr(t,21).ngClassTouched,Yr(t,21).ngClassPristine,Yr(t,21).ngClassDirty,Yr(t,21).ngClassValid,Yr(t,21).ngClassInvalid,Yr(t,21).ngClassPending),e(t,23,0,Yr(t,29).ngClassUntouched,Yr(t,29).ngClassTouched,Yr(t,29).ngClassPristine,Yr(t,29).ngClassDirty,Yr(t,29).ngClassValid,Yr(t,29).ngClassInvalid,Yr(t,29).ngClassPending),e(t,30,0,Yr(t,36).ngClassUntouched,Yr(t,36).ngClassTouched,Yr(t,36).ngClassPristine,Yr(t,36).ngClassDirty,Yr(t,36).ngClassValid,Yr(t,36).ngClassInvalid,Yr(t,36).ngClassPending),e(t,38,0,Yr(t,44).ngClassUntouched,Yr(t,44).ngClassTouched,Yr(t,44).ngClassPristine,Yr(t,44).ngClassDirty,Yr(t,44).ngClassValid,Yr(t,44).ngClassInvalid,Yr(t,44).ngClassPending),e(t,45,0,Yr(t,51).ngClassUntouched,Yr(t,51).ngClassTouched,Yr(t,51).ngClassPristine,Yr(t,51).ngClassDirty,Yr(t,51).ngClassValid,Yr(t,51).ngClassInvalid,Yr(t,51).ngClassPending),e(t,53,0,Yr(t,59).ngClassUntouched,Yr(t,59).ngClassTouched,Yr(t,59).ngClassPristine,Yr(t,59).ngClassDirty,Yr(t,59).ngClassValid,Yr(t,59).ngClassInvalid,Yr(t,59).ngClassPending),e(t,60,0,Yr(t,66).ngClassUntouched,Yr(t,66).ngClassTouched,Yr(t,66).ngClassPristine,Yr(t,66).ngClassDirty,Yr(t,66).ngClassValid,Yr(t,66).ngClassInvalid,Yr(t,66).ngClassPending),e(t,67,0,Yr(t,72).ngClassUntouched,Yr(t,72).ngClassTouched,Yr(t,72).ngClassPristine,Yr(t,72).ngClassDirty,Yr(t,72).ngClassValid,Yr(t,72).ngClassInvalid,Yr(t,72).ngClassPending),e(t,73,0,Yr(t,78).ngClassUntouched,Yr(t,78).ngClassTouched,Yr(t,78).ngClassPristine,Yr(t,78).ngClassDirty,Yr(t,78).ngClassValid,Yr(t,78).ngClassInvalid,Yr(t,78).ngClassPending)}))}var Kp=function(){function e(t){_classCallCheck(this,e),this.courseService=t,this.filtered=!1,this.getCourses()}return _createClass(e,[{key:"ngOnInit",value:function(){this.getCourses()}},{key:"getCourses",value:function(){var e=this;this.courseService.getCourses().subscribe((function(t){e.courses=t}))}},{key:"getCourse",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.courses[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a===e)return a}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"filterCourses",value:function(e){this.filter=e,this.filtered=!0}}]),e}(),Yp=Zn({encapsulation:0,styles:[['.body[_ngcontent-%COMP%]{max-width:800px;margin-left:auto;margin-right:auto}h1[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:#add8e6;border:solid #1e90ff;border-radius:20px;padding:10px}.oddTest[_ngcontent-%COMP%]{background:#87cefa}.evenTest[_ngcontent-%COMP%]{background:#add8e6}.courseButton[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:bisque;border:1px solid #1e90ff;border-radius:5px}.greaterCourseButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:5px}']],data:{}});function Xp(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-course-bar",[],null,null,null,Dd,Ad)),ui(1,114688,null,0,Wf,[Id],{course:[0,"course"]},null)],(function(e,t){e(t,1,0,t.parent.context.$implicit)}),null)}function Jp(e){return sa(0,[(e()(),Go(0,0,null,null,5,"div",[],null,null,null,null,null)),li(512,null,As,Ns,[An,Nn,hn,vn]),ui(2,278528,null,0,Ds,[As],{ngClass:[0,"ngClass"]},null),ra(3,{oddTest:0,evenTest:1}),(e()(),Qo(16777216,null,null,1,null,Xp)),ui(5,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,3,0,t.context.even,!t.context.even);e(t,2,0,r);var i=!n.filtered||t.context.$implicit.name.toLowerCase().includes((null!=n.filter.name?n.filter.name:"").toLowerCase())&&t.context.$implicit.form.toLowerCase().includes((null!=n.filter.form?n.filter.form:"").toLowerCase())&&t.context.$implicit.description.toLowerCase().includes((null!=n.filter.description?n.filter.description:"").toLowerCase())&&(!n.filter.semesterMin||t.context.$implicit.semester>=n.filter.semesterMin)&&(!n.filter.semesterMax&&0!=n.filter.semesterMax||t.context.$implicit.semester<=n.filter.semesterMax)&&(!n.filter.starsMin||t.context.$implicit.stars>=n.filter.starsMin)&&(!n.filter.starsMax&&0!=n.filter.starsMax||t.context.$implicit.stars<=n.filter.starsMax)&&(!n.filter.etcsMin||t.context.$implicit.etcs>=n.filter.etcsMin)&&(!n.filter.etcsMax&&0!=n.filter.etcsMax||t.context.$implicit.etcs<=n.filter.etcsMax)&&(!n.filter.placesMin||t.context.$implicit.places>=n.filter.placesMin)&&(!n.filter.placesMax&&0!=n.filter.placesMax||t.context.$implicit.places<=n.filter.placesMax);e(t,5,0,i)}),null)}function $p(e){return sa(0,[(e()(),Go(0,0,null,null,6,"div",[["class","body"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(-1,null,["Course List"])),(e()(),Go(3,0,null,null,1,"app-search-bar",[],null,[[null,"eventFilter"]],(function(e,t,n){var r=!0;return"eventFilter"===t&&(r=!1!==e.component.filterCourses(n)&&r),r}),Gp,Qp)),ui(4,114688,null,0,zp,[],null,{eventFilter:"eventFilter"}),(e()(),Qo(16777216,null,null,1,null,Jp)),ui(6,278528,null,0,Rs,[Mn,On,An],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){var n=t.component;e(t,4,0),e(t,6,0,n.courses)}),null)}var Zp=Vr("app-courses",Kp,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-courses",[],null,null,null,$p,Yp)),ui(1,114688,null,0,Kp,[Sd],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),ev=function(){function e(t,n,r){_classCallCheck(this,e),this.formBuilder=t,this.userService=n,this.router=r,this.formErrors={email:"",password:""},this.validationMessages={required:"field is required"}}return _createClass(e,[{key:"ngOnInit",value:function(){this.modelForm=this.formBuilder.group({email:["",Hd.required],password:["",Hd.required]})}},{key:"onSubmit",value:function(e){var t=this;"VALID"===e.status&&this.userService.registerUser(e.value.email,e.value.password).then((function(e){t.router.navigateByUrl("/")}))}}]),e}(),tv=Zn({encapsulation:0,styles:[['.body[_ngcontent-%COMP%]{max-width:800px;margin-left:auto;margin-right:auto}h1[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:#add8e6;border:solid #1e90ff;border-radius:20px;padding:10px}.field[_ngcontent-%COMP%]{font-family:"Arial Black";display:grid;grid-template-columns:100px 250px;margin:10px}.navButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:5px}.textField[_ngcontent-%COMP%]{padding:2px;margin:2px;border:1px solid #1e90ff;border-radius:10px}']],data:{}});function nv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"span",[["class","errors"]],null,null,null,null,null)),(e()(),ia(1,null,["",""]))],null,(function(e,t){e(t,1,0,t.component.formErrors.email)}))}function rv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"span",[["class","errors"]],null,null,null,null,null)),(e()(),ia(1,null,["",""]))],null,(function(e,t){e(t,1,0,t.component.formErrors.password)}))}function iv(e){return sa(0,[(e()(),Go(0,0,null,null,31,"div",[["class","body"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(-1,null,["Registration"])),(e()(),Go(3,0,null,null,28,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(e,t,n){var r=!0,i=e.component;return"submit"===t&&(r=!1!==Yr(e,5).onSubmit(n)&&r),"reset"===t&&(r=!1!==Yr(e,5).onReset()&&r),"ngSubmit"===t&&(r=!1!==i.onSubmit(i.modelForm)&&r),r}),null,null)),ui(4,16384,null,0,Rp,[],null,null),ui(5,540672,null,0,Pp,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),li(2048,null,Ld,null,[Pp]),ui(7,16384,null,0,Bd,[[4,Ld]],null,null),(e()(),Go(8,0,null,null,10,"div",[["class","field"]],null,null,null,null,null)),(e()(),Go(9,0,null,null,1,"label",[["for","email"]],null,null,null,null,null)),(e()(),ia(-1,null,["Email"])),(e()(),Go(11,0,null,null,5,"input",[["class","textField"],["formControlName","email"],["id","email"],["name","email"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0;return"input"===t&&(r=!1!==Yr(e,12)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,12).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,12)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,12)._compositionEnd(n.target.value)&&r),r}),null,null)),ui(12,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(14,671744,null,0,Up,[[3,Ld],[8,null],[8,null],[6,Rd],[2,Op]],{name:[0,"name"]},null),li(2048,null,Vd,null,[Up]),ui(16,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Qo(16777216,null,null,1,null,nv)),ui(18,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(19,0,null,null,10,"div",[["class","field"]],null,null,null,null,null)),(e()(),Go(20,0,null,null,1,"label",[["for","password"]],null,null,null,null,null)),(e()(),ia(-1,null,["Password"])),(e()(),Go(22,0,null,null,5,"input",[["class","textField"],["formControlName","password"],["id","password"],["name","password"],["type","password"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0;return"input"===t&&(r=!1!==Yr(e,23)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,23).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,23)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,23)._compositionEnd(n.target.value)&&r),r}),null,null)),ui(23,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(25,671744,null,0,Up,[[3,Ld],[8,null],[8,null],[6,Rd],[2,Op]],{name:[0,"name"]},null),li(2048,null,Vd,null,[Up]),ui(27,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Qo(16777216,null,null,1,null,rv)),ui(29,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(30,0,null,null,1,"button",[["class","navButton"]],null,null,null,null,null)),(e()(),ia(-1,null,["Register"]))],(function(e,t){var n=t.component;e(t,5,0,n.modelForm),e(t,14,0,"email"),e(t,18,0,n.formErrors.email),e(t,25,0,"password"),e(t,29,0,n.formErrors.password)}),(function(e,t){e(t,3,0,Yr(t,7).ngClassUntouched,Yr(t,7).ngClassTouched,Yr(t,7).ngClassPristine,Yr(t,7).ngClassDirty,Yr(t,7).ngClassValid,Yr(t,7).ngClassInvalid,Yr(t,7).ngClassPending),e(t,11,0,Yr(t,16).ngClassUntouched,Yr(t,16).ngClassTouched,Yr(t,16).ngClassPristine,Yr(t,16).ngClassDirty,Yr(t,16).ngClassValid,Yr(t,16).ngClassInvalid,Yr(t,16).ngClassPending),e(t,22,0,Yr(t,27).ngClassUntouched,Yr(t,27).ngClassTouched,Yr(t,27).ngClassPristine,Yr(t,27).ngClassDirty,Yr(t,27).ngClassValid,Yr(t,27).ngClassInvalid,Yr(t,27).ngClassPending)}))}var ov=Vr("app-registration",ev,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-registration",[],null,null,null,iv,tv)),ui(1,114688,null,0,ev,[Bp,Id,df],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),av=function(){function e(t,n,r){_classCallCheck(this,e),this.formBuilder=t,this.userService=n,this.router=r,this.formErrors={email:"",password:""},this.validationMessages={required:"field is required"}}return _createClass(e,[{key:"ngOnInit",value:function(){this.modelForm=this.formBuilder.group({email:["",Hd.required],password:["",Hd.required]})}},{key:"onSubmit",value:function(e){var t=this;"VALID"===e.status&&this.userService.signInUser(e.value.email,e.value.password).then((function(e){t.router.navigateByUrl("/")})).catch((function(e){t.formErrors.email=e.message}))}}]),e}(),sv=Zn({encapsulation:0,styles:[['.body[_ngcontent-%COMP%]{max-width:800px;margin-left:auto;margin-right:auto}h1[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:#add8e6;border:solid #1e90ff;border-radius:20px;padding:10px}.field[_ngcontent-%COMP%]{font-family:"Arial Black";display:grid;grid-template-columns:100px 250px;margin:10px}.navButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:5px}.textField[_ngcontent-%COMP%]{padding:2px;margin:2px;border:1px solid #1e90ff;border-radius:10px}']],data:{}});function uv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"span",[["class","errors"]],null,null,null,null,null)),(e()(),ia(1,null,["",""]))],null,(function(e,t){e(t,1,0,t.component.formErrors.email)}))}function lv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"span",[["class","errors"]],null,null,null,null,null)),(e()(),ia(1,null,["",""]))],null,(function(e,t){e(t,1,0,t.component.formErrors.password)}))}function cv(e){return sa(0,[(e()(),Go(0,0,null,null,31,"div",[["class","body"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(-1,null,["Logging"])),(e()(),Go(3,0,null,null,28,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(e,t,n){var r=!0,i=e.component;return"submit"===t&&(r=!1!==Yr(e,5).onSubmit(n)&&r),"reset"===t&&(r=!1!==Yr(e,5).onReset()&&r),"ngSubmit"===t&&(r=!1!==i.onSubmit(i.modelForm)&&r),r}),null,null)),ui(4,16384,null,0,Rp,[],null,null),ui(5,540672,null,0,Pp,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),li(2048,null,Ld,null,[Pp]),ui(7,16384,null,0,Bd,[[4,Ld]],null,null),(e()(),Go(8,0,null,null,10,"div",[["class","field"]],null,null,null,null,null)),(e()(),Go(9,0,null,null,1,"label",[["for","email"]],null,null,null,null,null)),(e()(),ia(-1,null,["Email"])),(e()(),Go(11,0,null,null,5,"input",[["class","textField"],["formControlName","email"],["id","email"],["name","email"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0;return"input"===t&&(r=!1!==Yr(e,12)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,12).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,12)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,12)._compositionEnd(n.target.value)&&r),r}),null,null)),ui(12,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(14,671744,null,0,Up,[[3,Ld],[8,null],[8,null],[6,Rd],[2,Op]],{name:[0,"name"]},null),li(2048,null,Vd,null,[Up]),ui(16,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Qo(16777216,null,null,1,null,uv)),ui(18,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(19,0,null,null,10,"div",[["class","field"]],null,null,null,null,null)),(e()(),Go(20,0,null,null,1,"label",[["for","password"]],null,null,null,null,null)),(e()(),ia(-1,null,["Password"])),(e()(),Go(22,0,null,null,5,"input",[["class","textField"],["formControlName","password"],["id","password"],["name","password"],["type","password"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0;return"input"===t&&(r=!1!==Yr(e,23)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,23).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,23)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,23)._compositionEnd(n.target.value)&&r),r}),null,null)),ui(23,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(25,671744,null,0,Up,[[3,Ld],[8,null],[8,null],[6,Rd],[2,Op]],{name:[0,"name"]},null),li(2048,null,Vd,null,[Up]),ui(27,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Qo(16777216,null,null,1,null,lv)),ui(29,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(30,0,null,null,1,"button",[["class","navButton"]],null,null,null,null,null)),(e()(),ia(-1,null,["Login"]))],(function(e,t){var n=t.component;e(t,5,0,n.modelForm),e(t,14,0,"email"),e(t,18,0,n.formErrors.email),e(t,25,0,"password"),e(t,29,0,n.formErrors.password)}),(function(e,t){e(t,3,0,Yr(t,7).ngClassUntouched,Yr(t,7).ngClassTouched,Yr(t,7).ngClassPristine,Yr(t,7).ngClassDirty,Yr(t,7).ngClassValid,Yr(t,7).ngClassInvalid,Yr(t,7).ngClassPending),e(t,11,0,Yr(t,16).ngClassUntouched,Yr(t,16).ngClassTouched,Yr(t,16).ngClassPristine,Yr(t,16).ngClassDirty,Yr(t,16).ngClassValid,Yr(t,16).ngClassInvalid,Yr(t,16).ngClassPending),e(t,22,0,Yr(t,27).ngClassUntouched,Yr(t,27).ngClassTouched,Yr(t,27).ngClassPristine,Yr(t,27).ngClassDirty,Yr(t,27).ngClassValid,Yr(t,27).ngClassInvalid,Yr(t,27).ngClassPending)}))}var hv=Vr("app-logging",av,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-logging",[],null,null,null,cv,sv)),ui(1,114688,null,0,av,[Bp,Id,df],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),fv=function(){function e(){_classCallCheck(this,e),this.rating=new Array(5),this.ratingEvent=new xi,this.userRating=0}return _createClass(e,[{key:"ngOnInit",value:function(){this.resetRating(0)}},{key:"resetRating",value:function(e){console.log("resetRating "+e),this.userRating=0;for(var t=this.stars,n=0;n<5;n++)this.rating[n]=t>=1?1:0,t--}},{key:"resetHoverRating",value:function(e){console.log("resetHoverRating "+e);for(var t=this.stars,n=this.userRating,r=0;r<5;r++)this.rating[r]=n>=1?2:t>=1?1:0,t--,n--}},{key:"setRating",value:function(e){console.log(this.stars),this.stars&&0!==this.stars||(this.ratingEvent.emit(e),this.userRating===e?this.resetRating(e):(this.userRating=e,this.resetHoverRating(e)))}}]),e}(),dv=Zn({encapsulation:0,styles:[[".scoreBar[_ngcontent-%COMP%]{display:grid;grid-template-columns:40px 40px 40px 40px 40px}"]],data:{}});function pv(e){return sa(0,[(e()(),Go(0,0,null,null,0,"img",[["alt","ratedStar.png"],["class","star"],["src","/assets/Images/FullStar.png"]],null,null,null,null,null))],null,null)}function vv(e){return sa(0,[(e()(),Go(0,0,null,null,0,"img",[["alt","fullStar.png"],["class","star"],["src","/assets/Images/FullStar.png"]],null,null,null,null,null))],null,null)}function gv(e){return sa(0,[(e()(),Go(0,0,null,null,0,"img",[["alt","noStar.png"],["class","star"],["src","/assets/Images/NoStar.png"]],null,null,null,null,null))],null,null)}function yv(e){return sa(0,[(e()(),Go(0,0,null,null,9,null,null,null,null,null,null,null)),(e()(),Go(1,0,null,null,8,"div",[["class","starWrapper"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.setRating(e.context.index+1)&&r),r}),null,null)),(e()(),Go(2,0,null,null,7,null,null,null,null,null,null,null)),ui(3,16384,null,0,Vs,[],{ngSwitch:[0,"ngSwitch"]},null),(e()(),Qo(16777216,null,null,1,null,pv)),ui(5,278528,null,0,Us,[Mn,On,Vs],{ngSwitchCase:[0,"ngSwitchCase"]},null),(e()(),Qo(16777216,null,null,1,null,vv)),ui(7,278528,null,0,Us,[Mn,On,Vs],{ngSwitchCase:[0,"ngSwitchCase"]},null),(e()(),Qo(16777216,null,null,1,null,gv)),ui(9,16384,null,0,qs,[Mn,On,Vs],null,null)],(function(e,t){e(t,3,0,t.context.$implicit),e(t,5,0,2),e(t,7,0,1)}),null)}function mv(e){return sa(0,[(e()(),Go(0,0,null,null,2,"div",[["class","scoreBar"]],null,null,null,null,null)),(e()(),Qo(16777216,null,null,1,null,yv)),ui(2,278528,null,0,Rs,[Mn,On,An],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){e(t,2,0,t.component.rating)}),null)}var _v=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.courseService=n,this.userService=r}return _createClass(e,[{key:"ngOnInit",value:function(){this.getCourse()}},{key:"getCourse",value:function(){var e=this,t=this.route.snapshot.paramMap.get("id");this.courseService.getCourse(t).subscribe((function(t){e.course=t,e.updateEnrollmentInfo()}))}},{key:"updateEnrollmentInfo",value:function(){var e=this;this.userService.afAuth.authState.subscribe((function(t){t&&e.userService.getUserData(t.email).subscribe((function(t){t&&(e.isAuthenticated=!0),e.isEnrolled=e.userService.isEnrolled(e.course.id),console.log(e.course.studentsEnrolled,e.course.studentsLimit),e.course.studentsEnrolled<e.course.studentsLimit?!1===e.isEnrolled?e.canEnroll=!0:(e.canEnroll=!1,e.rating=e.userService.getRating(e.course.id)):e.canEnroll=!1,console.log(e.canEnroll,e.isEnrolled,e.rating)}))}))}},{key:"enroll",value:function(){this.userService.enroll(this.course.id),this.isEnrolled=!0,this.canEnroll=!1}},{key:"setRating",value:function(e){this.rating||(this.userService.setRating(this.course.id,e),this.rating=e)}},{key:"countRating",value:function(){return Math.round(100*this.course.ratingSum/this.course.ratingCount)/100}}]),e}(),bv=Zn({encapsulation:0,styles:[['#details-container[_ngcontent-%COMP%]{max-width:800px;margin:20px auto auto}.detail-bar0[_ngcontent-%COMP%]{max-width:550px;font-family:"Arial Black";display:grid;grid-template-columns:150px auto;background-color:#87cefa;padding-left:10%;margin:2px;border:solid;border-radius:10px}.detail-bar1[_ngcontent-%COMP%]{max-width:550px;font-family:"Arial Black";display:grid;grid-template-columns:150px auto;background-color:#add8e6;padding-left:10%;margin:2px;border:solid;border-radius:10px}.courseButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:10px}img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}']],data:{}});function wv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-score-bar",[],null,[[null,"ratingEvent"]],(function(e,t,n){var r=!0;return"ratingEvent"===t&&(r=!1!==e.component.setRating(n)&&r),r}),mv,dv)),ui(1,114688,null,0,fv,[],{stars:[0,"stars"]},{ratingEvent:"ratingEvent"})],(function(e,t){e(t,1,0,t.component.rating)}),null)}function Cv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"button",[["class","courseButton"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.enroll()&&r),r}),null,null)),(e()(),ia(-1,null,["Enroll"]))],null,null)}function kv(e){return sa(0,[(e()(),Go(0,0,null,null,40,"div",[["id","details-container"]],null,null,null,null,null)),(e()(),Qo(16777216,null,null,1,null,wv)),ui(2,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(3,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(e()(),Go(4,0,null,null,4,"div",[["class","detail-bar0"]],null,null,null,null,null)),(e()(),Go(5,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Name: "])),(e()(),Go(7,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(8,null,["",""])),(e()(),Go(9,0,null,null,4,"div",[["class","detail-bar1"]],null,null,null,null,null)),(e()(),Go(10,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Rating: "])),(e()(),Go(12,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(13,null,["",""])),(e()(),Go(14,0,null,null,4,"div",[["class","detail-bar0"]],null,null,null,null,null)),(e()(),Go(15,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Semester: "])),(e()(),Go(17,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(18,null,["",""])),(e()(),Go(19,0,null,null,4,"div",[["class","detail-bar1"]],null,null,null,null,null)),(e()(),Go(20,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Form: "])),(e()(),Go(22,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(23,null,["",""])),(e()(),Go(24,0,null,null,4,"div",[["class","detail-bar0"]],null,null,null,null,null)),(e()(),Go(25,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["ECTS: "])),(e()(),Go(27,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(28,null,["",""])),(e()(),Go(29,0,null,null,4,"div",[["class","detail-bar1"]],null,null,null,null,null)),(e()(),Go(30,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Students: "])),(e()(),Go(32,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(33,null,["","/",""])),(e()(),Go(34,0,null,null,4,"div",[["class","detail-bar0"]],null,null,null,null,null)),(e()(),Go(35,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),ia(-1,null,["Description: "])),(e()(),Go(37,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),ia(38,null,["",""])),(e()(),Qo(16777216,null,null,1,null,Cv)),ui(40,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.isEnrolled),e(t,40,0,n.canEnroll)}),(function(e,t){var n=t.component;e(t,3,0,Sr(1,"",n.course.image,"")),e(t,8,0,n.course.name),e(t,13,0,n.countRating()),e(t,18,0,n.course.semester),e(t,23,0,n.course.form),e(t,28,0,n.course.ECTS),e(t,33,0,n.course.studentsEnrolled,n.course.studentsLimit),e(t,38,0,n.course.description)}))}function Ev(e){return sa(0,[(e()(),Qo(16777216,null,null,1,null,kv)),ui(1,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,1,0,t.component.course)}),null)}var Sv=Vr("app-course-detail",_v,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-course-detail",[],null,null,null,Ev,bv)),ui(1,114688,null,0,_v,[rh,Sd,Id],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Tv=function e(){_classCallCheck(this,e)},Iv=function(){function e(){_classCallCheck(this,e),this.eventSubmit=new xi,this.eventClose=new xi}return _createClass(e,[{key:"ngOnInit",value:function(){this.course=new Tv}},{key:"submitCourse",value:function(){this.eventSubmit.emit(this.course)}},{key:"hide",value:function(){this.eventClose.emit()}},{key:"stopPropagation",value:function(e){e.stopPropagation()}}]),e}(),Av=Zn({encapsulation:0,styles:[['.newCourseFormBackground[_ngcontent-%COMP%]{position:fixed;z-index:666;display:grid;place-items:center;height:100vh;width:100vw;top:0;left:0;background-color:rgba(141,141,141,.8)}.newCourseForm[_ngcontent-%COMP%]{max-width:400px;min-width:200px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column nowrap}img[_ngcontent-%COMP%]{max-height:100%;width:auto}.img-wrapper[_ngcontent-%COMP%]{height:100%;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:6cm;overflow:hidden}.creatorField[_ngcontent-%COMP%]{text-align:center;padding:2px;margin:2px;border:1px solid #1e90ff;border-radius:10px}.creatorButton[_ngcontent-%COMP%]{text-align:center;padding:2px;margin:2px;font-family:"Arial Black";background-color:bisque;border:1px solid #1e90ff;border-radius:15px}']],data:{}});function Nv(e){return sa(0,[(e()(),Go(0,0,null,null,46,"div",[["class","newCourseFormBackground"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.hide()&&r),r}),null,null)),(e()(),Go(1,0,null,null,45,"div",[["class","newCourseForm"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.stopPropagation(n)&&r),r}),null,null)),(e()(),Go(2,0,null,null,5,"input",[["class","creatorField"],["placeholder","name"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,3)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,3).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,3)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,3)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.name=n)&&r),r}),null,null)),ui(3,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(5,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(7,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(8,0,null,null,5,"input",[["class","creatorField"],["placeholder","ECTS"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,9)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,9).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,9)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,9)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.ECTS=n)&&r),r}),null,null)),ui(9,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(11,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(13,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(14,0,null,null,5,"input",[["class","creatorField"],["placeholder","Students limit"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,15)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,15).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,15)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,15)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.studentsLimit=n)&&r),r}),null,null)),ui(15,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(17,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(19,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(20,0,null,null,5,"input",[["class","creatorField"],["placeholder","semester"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,21)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,21).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,21)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,21)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.semester=n)&&r),r}),null,null)),ui(21,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(23,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(25,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(26,0,null,null,5,"input",[["class","creatorField"],["placeholder","form"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,27)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,27).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,27)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,27)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.form=n)&&r),r}),null,null)),ui(27,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(29,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(31,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(32,0,null,null,5,"input",[["class","creatorField"],["placeholder","icon path"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,33)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,33).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,33)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,33)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.image=n)&&r),r}),null,null)),ui(33,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(35,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(37,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(38,0,null,null,1,"div",[["class","img-wrapper"]],null,null,null,null,null)),(e()(),Go(39,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(e()(),Go(40,0,null,null,5,"input",[["class","creatorField"],["placeholder","description"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Yr(e,41)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Yr(e,41).onTouched()&&r),"compositionstart"===t&&(r=!1!==Yr(e,41)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Yr(e,41)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.course.description=n)&&r),r}),null,null)),ui(41,16384,null,0,Pd,[vn,hn,[2,Od]],null,null),li(1024,null,Rd,(function(e){return[e]}),[Pd]),ui(43,671744,null,0,xp,[[8,null],[8,null],[8,null],[6,Rd]],{model:[0,"model"]},{update:"ngModelChange"}),li(2048,null,Vd,null,[xp]),ui(45,16384,null,0,qd,[[4,Vd]],null,null),(e()(),Go(46,0,null,null,0,"input",[["class","creatorButton"],["value","dodaj"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.submitCourse()&&r),r}),null,null))],(function(e,t){var n=t.component;e(t,5,0,n.course.name),e(t,11,0,n.course.ECTS),e(t,17,0,n.course.studentsLimit),e(t,23,0,n.course.semester),e(t,29,0,n.course.form),e(t,35,0,n.course.image),e(t,43,0,n.course.description)}),(function(e,t){var n=t.component;e(t,2,0,Yr(t,7).ngClassUntouched,Yr(t,7).ngClassTouched,Yr(t,7).ngClassPristine,Yr(t,7).ngClassDirty,Yr(t,7).ngClassValid,Yr(t,7).ngClassInvalid,Yr(t,7).ngClassPending),e(t,8,0,Yr(t,13).ngClassUntouched,Yr(t,13).ngClassTouched,Yr(t,13).ngClassPristine,Yr(t,13).ngClassDirty,Yr(t,13).ngClassValid,Yr(t,13).ngClassInvalid,Yr(t,13).ngClassPending),e(t,14,0,Yr(t,19).ngClassUntouched,Yr(t,19).ngClassTouched,Yr(t,19).ngClassPristine,Yr(t,19).ngClassDirty,Yr(t,19).ngClassValid,Yr(t,19).ngClassInvalid,Yr(t,19).ngClassPending),e(t,20,0,Yr(t,25).ngClassUntouched,Yr(t,25).ngClassTouched,Yr(t,25).ngClassPristine,Yr(t,25).ngClassDirty,Yr(t,25).ngClassValid,Yr(t,25).ngClassInvalid,Yr(t,25).ngClassPending),e(t,26,0,Yr(t,31).ngClassUntouched,Yr(t,31).ngClassTouched,Yr(t,31).ngClassPristine,Yr(t,31).ngClassDirty,Yr(t,31).ngClassValid,Yr(t,31).ngClassInvalid,Yr(t,31).ngClassPending),e(t,32,0,Yr(t,37).ngClassUntouched,Yr(t,37).ngClassTouched,Yr(t,37).ngClassPristine,Yr(t,37).ngClassDirty,Yr(t,37).ngClassValid,Yr(t,37).ngClassInvalid,Yr(t,37).ngClassPending),e(t,39,0,Sr(1,"",n.course.image,"")),e(t,40,0,Yr(t,45).ngClassUntouched,Yr(t,45).ngClassTouched,Yr(t,45).ngClassPristine,Yr(t,45).ngClassDirty,Yr(t,45).ngClassValid,Yr(t,45).ngClassInvalid,Yr(t,45).ngClassPending)}))}var Dv=function(){function e(t){_classCallCheck(this,e),this.courseService=t,this.filtered=!1,this.showNewCourseForm=!1,this.getCourses()}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"getCourses",value:function(){var e=this;this.courseService.getCourses().subscribe((function(t){e.courses=t}))}},{key:"getCourse",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.courses[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a===e)return a}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"deleteCourse",value:function(e){var t=this;this.courseService.removeCourse(e).then((function(){t.getCourses()}))}},{key:"filterCourses",value:function(e){this.filter=e,this.filtered=!0}},{key:"addCourse",value:function(e){var t=this;this.showNewCourseForm=!1,this.courseService.addCourse(e).then((function(){t.getCourses()}))}}]),e}(),xv=Zn({encapsulation:0,styles:[['.body[_ngcontent-%COMP%]{max-width:800px;margin-left:auto;margin-right:auto}h1[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:#add8e6;border:solid #1e90ff;border-radius:20px;padding:10px}.oddTest[_ngcontent-%COMP%]{background:#87cefa}.evenTest[_ngcontent-%COMP%]{background:#add8e6}.courseButton[_ngcontent-%COMP%]{font-family:"Arial Black";background-color:bisque;border:1px solid #1e90ff;border-radius:5px}.greaterCourseButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:5px}']],data:{}});function Rv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-course-bar",[],null,[[null,"eventDelete"]],(function(e,t,n){var r=!0;return"eventDelete"===t&&(r=!1!==e.component.deleteCourse(n)&&r),r}),Dd,Ad)),ui(1,114688,null,0,Wf,[Id],{course:[0,"course"]},{eventDelete:"eventDelete"})],(function(e,t){e(t,1,0,t.parent.context.$implicit)}),null)}function Ov(e){return sa(0,[(e()(),Go(0,0,null,null,5,"div",[],null,null,null,null,null)),li(512,null,As,Ns,[An,Nn,hn,vn]),ui(2,278528,null,0,Ds,[As],{ngClass:[0,"ngClass"]},null),ra(3,{oddTest:0,evenTest:1}),(e()(),Qo(16777216,null,null,1,null,Rv)),ui(5,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component,r=e(t,3,0,t.context.even,!t.context.even);e(t,2,0,r);var i=!n.filtered||t.context.$implicit.name.toLowerCase().includes((null!=n.filter.name?n.filter.name:"").toLowerCase())&&t.context.$implicit.form.toLowerCase().includes((null!=n.filter.form?n.filter.form:"").toLowerCase())&&t.context.$implicit.description.toLowerCase().includes((null!=n.filter.description?n.filter.description:"").toLowerCase())&&(!n.filter.semesterMin||t.context.$implicit.semester>=n.filter.semesterMin)&&(!n.filter.semesterMax&&0!=n.filter.semesterMax||t.context.$implicit.semester<=n.filter.semesterMax)&&(!n.filter.starsMin||t.context.$implicit.ratingSum/t.context.$implicit.ratingCount>=n.filter.starsMin)&&(!n.filter.starsMax&&0!=n.filter.starsMax||t.context.$implicit.ratingSum/t.context.$implicit.ratingCount<=n.filter.starsMax)&&(!n.filter.etcsMin||t.context.$implicit.ECTS>=n.filter.etcsMin)&&(!n.filter.etcsMax&&0!=n.filter.etcsMax||t.context.$implicit.ECTS<=n.filter.etcsMax)&&(!n.filter.placesMin||t.context.$implicit.studentsLimit>=n.filter.placesMin)&&(!n.filter.placesMax&&0!=n.filter.placesMax||t.context.$implicit.studentsLimit<=n.filter.placesMax);e(t,5,0,i)}),null)}function Pv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-course-creator",[],null,[[null,"eventSubmit"],[null,"eventClose"]],(function(e,t,n){var r=!0,i=e.component;return"eventSubmit"===t&&(r=!1!==i.addCourse(n)&&r),"eventClose"===t&&(r=0!=(i.showNewCourseForm=!1)&&r),r}),Nv,Av)),ui(1,114688,null,0,Iv,[],null,{eventSubmit:"eventSubmit",eventClose:"eventClose"})],(function(e,t){e(t,1,0)}),null)}function Mv(e){return sa(0,[(e()(),Go(0,0,null,null,10,"div",[["class","body"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(-1,null,["Course List"])),(e()(),Go(3,0,null,null,1,"app-search-bar",[],null,[[null,"eventFilter"]],(function(e,t,n){var r=!0;return"eventFilter"===t&&(r=!1!==e.component.filterCourses(n)&&r),r}),Gp,Qp)),ui(4,114688,null,0,zp,[],null,{eventFilter:"eventFilter"}),(e()(),Qo(16777216,null,null,1,null,Ov)),ui(6,278528,null,0,Rs,[Mn,On,An],{ngForOf:[0,"ngForOf"]},null),(e()(),Go(7,0,null,null,1,"button",[["class","greaterCourseButton"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=0!=(e.component.showNewCourseForm=!0)&&r),r}),null,null)),(e()(),ia(-1,null,["Add course"])),(e()(),Qo(16777216,null,null,1,null,Pv)),ui(10,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,4,0),e(t,6,0,n.courses),e(t,10,0,n.showNewCourseForm)}),null)}var Lv=Vr("app-courses-admin",Dv,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-courses-admin",[],null,null,null,Mv,xv)),ui(1,114688,null,0,Dv,[Sd],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),Fv=function(){function e(t,n){_classCallCheck(this,e),this.userService=t,this.router=n}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.isAuthenticated=!1,this.isAdmin=!1,this.userService.afAuth.authState.subscribe((function(t){t&&e.userService.getUserData(t.email).subscribe((function(t){t&&(e.isAuthenticated=!0,e.email=t.email),"admin"===t.role&&(e.isAdmin=!0)}))}))}},{key:"logout",value:function(){var e=this;this.userService.signOutUser().then((function(){return e.router.navigateByUrl("/Logging")}))}}]),e}(),Vv=Zn({encapsulation:0,styles:[['#body[_ngcontent-%COMP%]{max-width:800px;display:block;background-color:#00bfff;padding-top:5px;padding-bottom:5px;padding-left:5px;margin:auto;border:1px solid #1e90ff;border-radius:5px}nav[_ngcontent-%COMP%]{display:block;grid-template-columns:auto auto auto auto}.navButton[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px;background-color:bisque;border:1px solid #1e90ff;border-radius:5px;margin:5px}h1[_ngcontent-%COMP%]{font-family:"Arial Black";font-size:20px}']],data:{}});function Uv(e){return sa(0,[(e()(),Go(0,0,null,null,2,"button",[["class","navButton"],["routerLink","/Registration"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Yr(e,1).onClick()&&r),r}),null,null)),ui(1,16384,null,0,pf,[df,rh,[8,null],vn,hn],{routerLink:[0,"routerLink"]},null),(e()(),ia(-1,null,["Registration"]))],(function(e,t){e(t,1,0,"/Registration")}),null)}function qv(e){return sa(0,[(e()(),Go(0,0,null,null,2,"button",[["class","navButton"],["routerLink","/Logging"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Yr(e,1).onClick()&&r),r}),null,null)),ui(1,16384,null,0,pf,[df,rh,[8,null],vn,hn],{routerLink:[0,"routerLink"]},null),(e()(),ia(-1,null,["Logging"]))],(function(e,t){e(t,1,0,"/Logging")}),null)}function Bv(e){return sa(0,[(e()(),Go(0,0,null,null,1,"button",[["class","navButton"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.logout()&&r),r}),null,null)),(e()(),ia(-1,null,["Logout"]))],null,null)}function jv(e){return sa(0,[(e()(),Go(0,0,null,null,2,"button",[["class","navButton"],["routerLink","/CoursesAdmin"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Yr(e,1).onClick()&&r),r}),null,null)),ui(1,16384,null,0,pf,[df,rh,[8,null],vn,hn],{routerLink:[0,"routerLink"]},null),(e()(),ia(-1,null,["Courses Admin"]))],(function(e,t){e(t,1,0,"/CoursesAdmin")}),null)}function Wv(e){return sa(0,[(e()(),Go(0,0,null,null,14,"div",[["id","body"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,13,"naV",[],null,null,null,null,null)),(e()(),Go(2,0,null,null,2,"button",[["class","navButton"],["routerLink","/Courses"]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Yr(e,3).onClick()&&r),r}),null,null)),ui(3,16384,null,0,pf,[df,rh,[8,null],vn,hn],{routerLink:[0,"routerLink"]},null),(e()(),ia(-1,null,["Courses"])),(e()(),Qo(16777216,null,null,1,null,Uv)),ui(6,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Qo(16777216,null,null,1,null,qv)),ui(8,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Qo(16777216,null,null,1,null,Bv)),ui(10,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Qo(16777216,null,null,1,null,jv)),ui(12,16384,null,0,Ps,[Mn,On],{ngIf:[0,"ngIf"]},null),(e()(),Go(13,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),ia(14,null,["",""]))],(function(e,t){var n=t.component;e(t,3,0,"/Courses"),e(t,6,0,!n.isAuthenticated),e(t,8,0,!n.isAuthenticated),e(t,10,0,n.isAuthenticated),e(t,12,0,n.isAuthenticated&&n.isAdmin)}),(function(e,t){e(t,14,0,t.component.email)}))}var Hv=Zn({encapsulation:0,styles:[[".container[_ngcontent-%COMP%]{background-color:#f4ebd9;height:100%}"]],data:{}});function zv(e){return sa(0,[(e()(),Go(0,0,null,null,5,"div",[["class","container"]],null,null,null,null,null)),(e()(),Go(1,0,null,null,1,"app-nav-bar",[],null,null,null,Wv,Vv)),ui(2,114688,null,0,Fv,[Id,df],null,null),(e()(),Go(3,0,null,null,2,"div",[["class","content"]],null,null,null,null,null)),(e()(),Go(4,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ui(5,212992,null,0,mf,[yf,Mn,sn,[8,null],Rt],null,null)],(function(e,t){e(t,2,0),e(t,5,0)}),null)}var Qv=Vr("app-root",ps,(function(e){return sa(0,[(e()(),Go(0,0,null,null,1,"app-root",[],null,null,null,zv,Hv)),ui(1,49152,null,0,ps,[],null,null)],null,null)}),{},{},[]),Gv=n("wj3C"),Kv=n.n(Gv);(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},n="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:r(e)}}!function(e,r){if(r){var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Promise",(function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function r(){this.a=null}function o(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;r.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c((function(){t.g()}))}this.a.push(e)};var a=n.setTimeout;r.prototype.c=function(e){a(e,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(e){this.c((function(){throw e}))},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.g)}},t.prototype.m=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.o(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.u(e):this.h(e)}},t.prototype.u=function(e){var t=void 0;try{t=e.then}catch(n){return void this.g(n)}"function"==typeof t?this.v(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new r;return t.prototype.o=function(e){var t=this.f();e.La(t.resolve,t.reject)},t.prototype.v=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(n){o(n)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.La(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.La=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=o,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=i(e),a=r.next();!a.done;a=r.next())o(a.value).La(t,n)}))},t.all=function(e){var n=i(e),r=n.next();return r.done?o([]):new t((function(e,t){function i(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,o(r.value).La(i(a.length-1),t),r=n.next()}while(!r.done)}))},t}));var o=o||{},a=this||self;function s(e){return"string"==typeof e}function u(e){return"boolean"==typeof e}var l=/^[\w+/_-]+[=]{0,2}$/,c=null;function h(){}function f(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function d(e){return null===e}function p(e){return"array"==f(e)}function v(e){var t=f(e);return"array"==t||"object"==t&&"number"==typeof e.length}function g(e){return"function"==f(e)}function y(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var m="closure_uid_"+(1e9*Math.random()>>>0),_=0;function b(e,t,n){return e.call.apply(e.bind,arguments)}function w(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function C(e,t,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:w).apply(null,arguments)}function k(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var E=Date.now||function(){return+new Date};function S(e,t){function n(){}n.prototype=t.prototype,e.qb=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.gd=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function T(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}}function I(e){if(Error.captureStackTrace)Error.captureStackTrace(this,I);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function A(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");I.call(this,n+e[r])}function N(e,t){throw new A("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function D(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function x(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function R(){this.b=this.a=null}S(I,Error),I.prototype.name="CustomError",S(A,I),A.prototype.name="AssertionError",D.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var O=new D((function(){return new M}),(function(e){e.reset()}));function P(){var e=Be,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function M(){this.next=this.b=this.a=null}function L(e,t){e:{try{var n=e&&e.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||a).Element&&r.Location){var i=r;break e}}catch(s){}i=null}if(i&&void 0!==i[t]&&(!e||!(e instanceof i[t])&&(e instanceof i.Location||e instanceof i.Element))){if(y(e))try{var o=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(s){o="<object could not be stringified>"}else o=void 0===e?"undefined":null===e?"null":typeof e;N("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,o)}}R.prototype.add=function(e,t){var n=O.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},M.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},M.prototype.reset=function(){this.next=this.b=this.a=null};var F=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(s(e))return s(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},V=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=s(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},U=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i=s(e)?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},q=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=s(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function B(e,t){return 0<=F(e,t)}function j(e,t){var n;return(n=0<=(t=F(e,t)))&&Array.prototype.splice.call(e,t,1),n}function W(e,t){!function(e,t){for(var n=s(e)?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,(function(n,r){t.call(void 0,n,r,e)&&Array.prototype.splice.call(e,r,1)}))}function H(e){return Array.prototype.concat.apply([],arguments)}function z(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Q(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function G(e){for(var t in e)return!1;return!0}function K(e){var t,n={};for(t in e)n[t]=e[t];return n}var Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<Y.length;o++)n=Y[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function J(e,t){this.a=e===ee&&t||"",this.b=Z}function $(e){return e instanceof J&&e.constructor===J&&e.b===Z?e.a:(N("expected object of type Const, got '"+e+"'"),"type_error:Const")}J.prototype.qa=!0,J.prototype.pa=function(){return this.a},J.prototype.toString=function(){return"Const{"+this.a+"}"};var Z={},ee={},te=new J(ee,"");function ne(){this.a="",this.b=se}function re(e){return e instanceof ne&&e.constructor===ne&&e.b===se?e.a:(N("expected object of type TrustedResourceUrl, got '"+e+"' of type "+f(e)),"type_error:TrustedResourceUrl")}function ie(e,t){var n=$(e);if(!ae.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return ue(e=n.replace(oe,(function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof J?$(e):encodeURIComponent(String(e))})))}ne.prototype.qa=!0,ne.prototype.pa=function(){return this.a.toString()},ne.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var oe=/%{(\w+)}/g,ae=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,se={};function ue(e){var t=new ne;return t.a=e,t}var le=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},ce=/&/g,he=/</g,fe=/>/g,de=/"/g,pe=/'/g,ve=/\x00/g,ge=/[\x00&<>"']/;function ye(e,t){return-1!=e.indexOf(t)}function me(e,t){return e<t?-1:e>t?1:0}function _e(){this.a="",this.b=Ee}function be(e){return e instanceof _e&&e.constructor===_e&&e.b===Ee?e.a:(N("expected object of type SafeUrl, got '"+e+"' of type "+f(e)),"type_error:SafeUrl")}_e.prototype.qa=!0,_e.prototype.pa=function(){return this.a.toString()},_e.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var we=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ce(e){return e instanceof _e?e:(e="object"==typeof e&&e.qa?e.pa():String(e),we.test(e)||(e="about:invalid#zClosurez"),Se(e))}var ke,Ee={};function Se(e){var t=new _e;return t.a=e,t}Se("about:blank");e:{var Te=a.navigator;if(Te){var Ie=Te.userAgent;if(Ie){ke=Ie;break e}}ke=""}function Ae(e){return ye(ke,e)}function Ne(){this.a="",this.b=xe}function De(e){return e instanceof Ne&&e.constructor===Ne&&e.b===xe?e.a:(N("expected object of type SafeHtml, got '"+e+"' of type "+f(e)),"type_error:SafeHtml")}Ne.prototype.qa=!0,Ne.prototype.pa=function(){return this.a.toString()},Ne.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var xe={};function Re(e){var t=new Ne;return t.a=e,t}Re("<!DOCTYPE html>");var Oe,Pe,Me=Re("");function Le(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Fe(e){return ge.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(ce,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(he,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(fe,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(de,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(pe,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(ve,"&#0;"))),e}function Ve(e){a.setTimeout((function(){throw e}),0)}function Ue(e,t){Pe||function(){if(a.Promise&&a.Promise.resolve){var e=a.Promise.resolve(void 0);Pe=function(){e.then(je)}}else Pe=function(){var e=je;!g(a.setImmediate)||a.Window&&a.Window.prototype&&!Ae("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(Oe||(Oe=function(){var e=a.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!Ae("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",function(e){var t=ue($(te));L(e,"HTMLIFrameElement"),e.src=re(t).toString()}(e),document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(De(Me)),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=C((function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()}),this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!Ae("Trident")&&!Ae("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).yb;n.yb=null,e()}},function(e){r.next={yb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){a.setTimeout(e,0)}}()),Oe(e)):a.setImmediate(e)}}(),qe||(Pe(),qe=!0),Be.add(e,t)}Re("<br>");var qe=!1,Be=new R;function je(){for(var e;e=P();){try{e.a.call(e.b)}catch(t){Ve(t)}x(O,e)}qe=!1}function We(e,t){if(this.a=He,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=h)try{var n=this;e.call(t,(function(e){nt(n,ze,e)}),(function(e){if(!(e instanceof lt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(t){}nt(n,Qe,e)}))}catch(r){nt(this,Qe,r)}}var He=0,ze=2,Qe=3;function Ge(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ge.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ke=new D((function(){return new Ge}),(function(e){e.reset()}));function Ye(e,t,n){var r=Ke.get();return r.g=e,r.b=t,r.f=n,r}function Xe(e){if(e instanceof We)return e;var t=new We(h);return nt(t,ze,e),t}function Je(e){return new We((function(t,n){n(e)}))}function $e(e,t,n){rt(e,t,n,null)||Ue(k(t,e))}function Ze(e){return new We((function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)$e(e[o],k(i,o,!0),k(i,o,!1));else t(r)}))}function et(e,t){e.b||e.a!=ze&&e.a!=Qe||it(e),e.f?e.f.next=t:e.b=t,e.f=t}function tt(e,t,n,r){var i=Ye(null,null,null);return i.a=new We((function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(a){o(a)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof lt?o(t):e(i)}catch(a){o(a)}}:o})),i.a.c=e,et(e,i),i.a}function nt(e,t,n){e.a==He&&(e===n&&(t=Qe,n=new TypeError("Promise cannot resolve to itself")),e.a=1,rt(n,e.Oc,e.Pc,e)||(e.i=n,e.a=t,e.c=null,it(e),t!=Qe||n instanceof lt||function(e,t){e.g=!0,Ue((function(){e.g&&ut.call(null,t)}))}(e,n)))}function rt(e,t,n,r){if(e instanceof We)return et(e,Ye(t||h,n||null,r)),!0;if(T(e))return e.then(t,n,r),!0;if(y(e))try{var i=e.then;if(g(i))return function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,(function(e){a||(a=!0,n.call(i,e))}),o)}catch(s){o(s)}}(e,i,t,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function it(e){e.h||(e.h=!0,Ue(e.Zb,e))}function ot(e){var t=null;return e.b&&(e.b=(t=e.b).next,t.next=null),e.b||(e.f=null),t}function at(e,t,n,r){if(n==Qe&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,st(t,n,r);else try{t.c?t.g.call(t.f):st(t,n,r)}catch(i){ut.call(null,i)}x(Ke,t)}function st(e,t,n){t==ze?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}We.prototype.then=function(e,t,n){return tt(this,g(e)?e:null,g(t)?t:null,n)},We.prototype.$goog_Thenable=!0,(e=We.prototype).ka=function(e,t){return(e=Ye(e,e,t)).c=!0,et(this,e),this},e.s=function(e,t){return tt(this,null,e,t)},e.cancel=function(e){this.a==He&&Ue((function(){!function e(t,n){if(t.a==He)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==t&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==He&&1==i?e(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):ot(r),at(r,o,Qe,n)))}t.c=null}else nt(t,Qe,n)}(this,new lt(e))}),this)},e.Oc=function(e){this.a=He,nt(this,ze,e)},e.Pc=function(e){this.a=He,nt(this,Qe,e)},e.Zb=function(){for(var e;e=ot(this);)at(this,e,this.a,this.i);this.h=!1};var ut=Ve;function lt(e){I.call(this,e)}function ct(){0!=ht&&(ft[this[m]||(this[m]=++_)]=this),this.va=this.va,this.la=this.la}S(lt,I),lt.prototype.name="cancel";var ht=0,ft={};function dt(e){if(!e.va&&(e.va=!0,e.za(),0!=ht)){var t=e[m]||(e[m]=++_);if(0!=ht&&e.la&&0<e.la.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ft[t]}}function pt(e){return pt[" "](e),e}ct.prototype.va=!1,ct.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},pt[" "]=h;var vt,gt,yt=Ae("Opera"),mt=Ae("Trident")||Ae("MSIE"),_t=Ae("Edge"),bt=_t||mt,wt=Ae("Gecko")&&!(ye(ke.toLowerCase(),"webkit")&&!Ae("Edge"))&&!(Ae("Trident")||Ae("MSIE"))&&!Ae("Edge"),Ct=ye(ke.toLowerCase(),"webkit")&&!Ae("Edge");function kt(){var e=a.document;return e?e.documentMode:void 0}e:{var Et="",St=(gt=ke,wt?/rv:([^\);]+)(\)|;)/.exec(gt):_t?/Edge\/([\d\.]+)/.exec(gt):mt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(gt):Ct?/WebKit\/(\S+)/.exec(gt):yt?/(?:Version)[ \/]?(\S+)/.exec(gt):void 0);if(St&&(Et=St?St[1]:""),mt){var Tt=kt();if(null!=Tt&&Tt>parseFloat(Et)){vt=String(Tt);break e}}vt=Et}var It,At={};function Nt(e){return function(e,t){var n=At;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,(function(){for(var t=0,n=le(String(vt)).split("."),r=le(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=me(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||me(0==a[2].length,0==s[2].length)||me(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}It=a.document&&mt?kt():void 0;var Dt=Object.freeze||function(e){return e},xt=!mt||9<=Number(It),Rt=mt&&!Nt("9"),Ot=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",h,t),a.removeEventListener("test",h,t)}catch(n){}return e}();function Pt(e,t){this.type=e,this.b=this.target=t,this.Mb=!0}function Mt(e,t){if(Pt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(wt){e:{try{pt(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=s(e.pointerType)?e.pointerType:Lt[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}Pt.prototype.preventDefault=function(){this.Mb=!1},S(Mt,Pt);var Lt=Dt({2:"touch",3:"pen",4:"mouse"});Mt.prototype.preventDefault=function(){Mt.qb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Rt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}},Mt.prototype.f=function(){return this.a};var Ft="closure_listenable_"+(1e6*Math.random()|0),Vt=0;function Ut(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Pa=i,this.key=++Vt,this.ta=this.Ka=!1}function qt(e){e.ta=!0,e.listener=null,e.proxy=null,e.src=null,e.Pa=null}function Bt(e){this.src=e,this.a={},this.b=0}function jt(e,t){var n=t.type;n in e.a&&j(e.a[n],t)&&(qt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function Wt(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ta&&o.listener==t&&o.capture==!!n&&o.Pa==r)return i}return-1}Bt.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Wt(e,t,r,i);return-1<a?(t=e[a],n||(t.Ka=!1)):((t=new Ut(t,this.src,o,!!r,i)).Ka=n,e.push(t)),t};var Ht="closure_lm_"+(1e6*Math.random()|0),zt={};function Qt(e,t,n,r,i){if(r&&r.once)Kt(e,t,n,r,i);else if(p(t))for(var o=0;o<t.length;o++)Qt(e,t[o],n,r,i);else n=rn(n),e&&e[Ft]?an(e,t,n,y(r)?!!r.capture:!!r,i):Gt(e,t,n,!1,r,i)}function Gt(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=y(i)?!!i.capture:!!i,s=tn(e);if(s||(e[Ht]=s=new Bt(e)),!(n=s.add(t,n,r,a,o)).proxy)if(r=function(){var e=en,t=xt?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Ot||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Jt(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function Kt(e,t,n,r,i){if(p(t))for(var o=0;o<t.length;o++)Kt(e,t[o],n,r,i);else n=rn(n),e&&e[Ft]?sn(e,t,n,y(r)?!!r.capture:!!r,i):Gt(e,t,n,!0,r,i)}function Yt(e,t,n,r,i){if(p(t))for(var o=0;o<t.length;o++)Yt(e,t[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=rn(n),e&&e[Ft]?(e=e.u,(t=String(t).toString())in e.a&&-1<(n=Wt(o=e.a[t],n,r,i))&&(qt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=tn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Wt(t,n,r,i)),(n=-1<e?t[e]:null)&&Xt(n))}function Xt(e){if("number"!=typeof e&&e&&!e.ta){var t=e.src;if(t&&t[Ft])jt(t.u,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Jt(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=tn(t))?(jt(n,e),0==n.b&&(n.src=null,t[Ht]=null)):qt(e)}}}function Jt(e){return e in zt?zt[e]:zt[e]="on"+e}function $t(e,t,n,r){var i=!0;if((e=tn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.ta&&(o=Zt(o,r),i=i&&!1!==o)}return i}function Zt(e,t){var n=e.listener,r=e.Pa||e.src;return e.Ka&&Xt(e),n.call(r,t)}function en(e,t){if(e.ta)return!0;if(!xt){if(!t)e:{t=["window","event"];for(var n=a,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Mt(r=t,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(s){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=$t(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=$t(r[i],e,!1,t),n=n&&o}return n}return Zt(e,new Mt(t,this))}function tn(e){return(e=e[Ht])instanceof Bt?e:null}var nn="__closure_events_fn_"+(1e9*Math.random()>>>0);function rn(e){return g(e)?e:(e[nn]||(e[nn]=function(t){return e.handleEvent(t)}),e[nn])}function on(){ct.call(this),this.u=new Bt(this),this.Sb=this,this.Xa=null}function an(e,t,n,r,i){e.u.add(String(t),n,!1,r,i)}function sn(e,t,n,r,i){e.u.add(String(t),n,!0,r,i)}function un(e,t,n,r){if(!(t=e.u.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&jt(e.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Mb}function ln(e,t,n){if(g(e))n&&(e=C(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=C(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function cn(e){var t=null;return new We((function(n,r){-1==(t=ln((function(){n(void 0)}),e))&&r(Error("Failed to schedule timer."))})).s((function(e){throw a.clearTimeout(t),e}))}function hn(e){if(e.U&&"function"==typeof e.U)return e.U();if(s(e))return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function fn(e){if(e.X&&"function"==typeof e.X)return e.X();if(!e.U||"function"!=typeof e.U){if(v(e)||s(e)){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function dn(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof dn)for(n=e.X(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function pn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];vn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)vn(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function vn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}S(on,ct),on.prototype[Ft]=!0,on.prototype.addEventListener=function(e,t,n,r){Qt(this,e,t,n,r)},on.prototype.removeEventListener=function(e,t,n,r){Yt(this,e,t,n,r)},on.prototype.dispatchEvent=function(e){var t,n=this.Xa;if(n)for(t=[];n;n=n.Xa)t.push(n);n=this.Sb;var r=e.type||e;if(s(e))e=new Pt(e,n);else if(e instanceof Pt)e.target=e.target||n;else{var i=e;X(e=new Pt(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.b=t[o];i=un(a,r,!0,e)&&i}if(i=un(a=e.b=n,r,!0,e)&&i,i=un(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=un(a=e.b=t[o],r,!1,e)&&i;return i},on.prototype.za=function(){if(on.qb.za.call(this),this.u){var e,t=this.u;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)qt(n[r]);delete t.a[e],t.b--}}this.Xa=null},(e=dn.prototype).U=function(){pn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.X=function(){return pn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return vn(this.b,e)?this.b[e]:t},e.set=function(e,t){vn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var gn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function yn(e,t){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,e instanceof yn?(this.h=void 0!==t?t:e.h,mn(this,e.f),this.i=e.i,this.b=e.b,_n(this,e.l),this.c=e.c,bn(this,Un(e.a)),this.g=e.g):e&&(n=String(e).match(gn))?(this.h=!!t,mn(this,n[1]||"",!0),this.i=Sn(n[2]||""),this.b=Sn(n[3]||"",!0),_n(this,n[4]),this.c=Sn(n[5]||"",!0),bn(this,n[6]||"",!0),this.g=Sn(n[7]||"")):(this.h=!!t,this.a=new On(null,this.h))}function mn(e,t,n){e.f=n?Sn(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function _n(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.l=t}else e.l=null}function bn(e,t,n){t instanceof On?(e.a=t,function(e,t){t&&!e.f&&(Pn(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ln(this,t),Vn(this,n,e))}),e)),e.f=t}(e.a,e.h)):(n||(t=Tn(t,xn)),e.a=new On(t,e.h))}function wn(e,t,n){e.a.set(t,n)}function Cn(e,t){return e.a.get(t)}function kn(e){return e instanceof yn?new yn(e):new yn(e,void 0)}function En(e,t){var n=new yn(null,void 0);return mn(n,"https"),e&&(n.b=e),t&&(n.c=t),n}function Sn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Tn(e,t,n){return s(e)?(e=encodeURI(e).replace(t,In),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function In(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}yn.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Tn(t,An,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.i)&&e.push(Tn(t,An,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&e.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(Tn(n,"/"==n.charAt(0)?Dn:Nn,!0))),(n=this.a.toString())&&e.push("?",n),(n=this.g)&&e.push("#",Tn(n,Rn)),e.join("")},yn.prototype.resolve=function(e){var t=new yn(this),n=!!e.f;n?mn(t,e.f):n=!!e.i,n?t.i=e.i:n=!!e.b,n?t.b=e.b:n=null!=e.l;var r=e.c;if(n)_n(t,e.l);else if(n=!!e.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=t.c.lastIndexOf("/");-1!=i&&(r=t.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ye(i,"./")||ye(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.c=r:n=""!==e.a.toString(),n?bn(t,Un(e.a)):n=!!e.g,n&&(t.g=e.g),t};var An=/[#\/\?@]/g,Nn=/[#\?:]/g,Dn=/[#\?]/g,xn=/[#\?@]/g,Rn=/#/g;function On(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Pn(e){e.a||(e.a=new dn,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Mn(e){var t=fn(e);if(void 0===t)throw Error("Keys are undefined");var n=new On(null,void 0);e=hn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];p(o)?Vn(n,i,o):n.add(i,o)}return n}function Ln(e,t){Pn(e),t=qn(e,t),vn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,vn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&pn(e)))}function Fn(e,t){return Pn(e),t=qn(e,t),vn(e.a.b,t)}function Vn(e,t,n){Ln(e,t),0<n.length&&(e.c=null,e.a.set(qn(e,t),z(n)),e.b+=n.length)}function Un(e){var t=new On;return t.c=e.c,e.a&&(t.a=new dn(e.a),t.b=e.b),t}function qn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(e=On.prototype).add=function(e,t){Pn(this),this.c=null,e=qn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(e,t){Pn(this),this.a.forEach((function(n,r){V(n,(function(n){e.call(t,n,r,this)}),this)}),this)},e.X=function(){Pn(this);for(var e=this.a.U(),t=this.a.X(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.U=function(e){Pn(this);var t=[];if(s(e))Fn(this,e)&&(t=H(t,this.a.get(qn(this,e))));else{e=this.a.U();for(var n=0;n<e.length;n++)t=H(t,e[n])}return t},e.set=function(e,t){return Pn(this),this.c=null,Fn(this,e=qn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.U(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.X(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var Bn=!mt||9<=Number(It);function jn(e){var t=document;return s(e)?t.getElementById(e):e}function Wn(e,t){Q(t,(function(t,n){t&&"object"==typeof t&&t.qa&&(t=t.pa()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:Hn.hasOwnProperty(n)?e.setAttribute(Hn[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t}))}var Hn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function zn(e){if(e&&"number"==typeof e.length){if(y(e))return"function"==typeof e.item||"string"==typeof e.item;if(g(e))return"function"==typeof e.item}return!1}function Qn(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(p(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),e(t,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Xn(i,r),r.push(":"),e(t,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Xn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Gn,e,t),t.join("")}function Gn(){}var Kn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Yn=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Xn(e,t){t.push('"',e.replace(Yn,(function(e){var t=Kn[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Kn[e]=t),t})),'"')}function Jn(){var e=gr();return mt&&!!It&&11==It||/Edge\/\d+/.test(e)}function $n(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function Zn(e,t){t=t||a.window;var n="about:blank";e&&(n=be(Ce(e)).toString()),t.location.href=n}function er(e){return!!((e=(e||gr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function tr(e){e=e||a.window;try{e.close()}catch(t){}}function nr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=gr().toLowerCase(),r&&(t.target=r,ye(n,"crios/")&&(t.target="_blank")),dr(gr())==hr&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof _e?n:Ce(void 0!==n.href?n.href:String(n)),n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((Ae("iPhone")&&!Ae("iPod")&&!Ae("iPad")||Ae("iPad")||Ae("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(L(a=r.document.createElement("A"),"HTMLAnchorElement"),t instanceof _e||t instanceof _e||(t="object"==typeof t&&t.qa?t.pa():String(t),we.test(t)||(t="about:invalid#zClosurez"),t=Se(t)),a.href=be(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=r.open("",n,a),e=be(t).toString(),a&&(bt&&ye(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e=Re('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Fe(e)+'">'),a.document.write(De(e)),a.document.close())):(a=r.open(be(t).toString(),n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var rr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ir=/^[^@]+@[^@]+$/;function or(){var e=null;return new We((function(t){"complete"==a.document.readyState?t():(e=function(){t()},Kt(window,"load",e))})).s((function(t){throw Yt(window,"load",e),t}))}function ar(e){return e=e||gr(),!("file:"!==wr()&&"ionic:"!==wr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function sr(){var e=a.window;try{return!(!e||e==e.top)}catch(t){return!1}}function ur(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function lr(){return Kv.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Kv.a.INTERNAL.hasOwnProperty("node")?"Node":ur()?"Worker":"Browser"}function cr(){var e=lr();return"ReactNative"===e||"Node"===e}var hr="Firefox",fr="Chrome";function dr(e){var t=e.toLowerCase();return ye(t,"opera/")||ye(t,"opr/")||ye(t,"opios/")?"Opera":ye(t,"iemobile")?"IEMobile":ye(t,"msie")||ye(t,"trident/")?"IE":ye(t,"edge/")?"Edge":ye(t,"firefox/")?hr:ye(t,"silk/")?"Silk":ye(t,"blackberry")?"Blackberry":ye(t,"webos")?"Webos":!ye(t,"safari/")||ye(t,"chrome/")||ye(t,"crios/")||ye(t,"android")?!ye(t,"chrome/")&&!ye(t,"crios/")||ye(t,"edge/")?ye(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":fr:"Safari"}var pr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function vr(e,t){t=t||[];var n,r=[],i={};for(n in pr)i[pr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=lr())?r=dr(i=gr()):"Worker"===r&&(r=dr(i=gr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function gr(){return a.navigator&&a.navigator.userAgent||""}function yr(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function mr(){try{var e=a.localStorage,t=Tr();if(e)return e.setItem(t,"1"),e.removeItem(t),!Jn()||!!a.indexedDB}catch(n){return ur()&&!!a.indexedDB}return!1}function _r(){return(br()||"chrome-extension:"===wr()||ar())&&!cr()&&mr()&&!ur()}function br(){return"http:"===wr()||"https:"===wr()}function wr(){return a.location&&a.location.protocol||null}function Cr(e){return!er(e=e||gr())&&dr(e)!=hr}function kr(e){return void 0===e?null:Qn(e)}function Er(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!=e[t]&&(n[t]=e[t]);return n}function Sr(e){if(null!==e)return JSON.parse(e)}function Tr(e){return e||Math.floor(1e9*Math.random()).toString()}function Ir(e){return"Safari"!=dr(e=e||gr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Ar(){var e=a.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Nr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=gr(),t=lr(),this.b=er(e)||"ReactNative"===t}function Dr(){var e=a.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function xr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(n){}return null}function Rr(){return!(!yr("fireauth.oauthhelper",a)&&!yr("fireauth.iframe",a))}Nr.prototype.get=function(){var e=a.navigator;return!e||"boolean"!=typeof e.onLine||!br()&&"chrome-extension:"!==wr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Or,Pr={};function Mr(e){Pr[e]||(Pr[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Lr={};Object.defineProperty(Lr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Lr,"abcd",{configurable:!0,enumerable:!0,value:2}),Or=2==Lr.abcd}catch(gt){Or=!1}function Fr(e,t,n){Or?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Vr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Fr(e,n,t[n])}function Ur(e){var t={};return Vr(t,e),t}function qr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Fr(t,n,qr(e[n]));return t}function Br(e){var t={},n=e[Wr],r=e[Hr];if(!(e=e[zr])||e!=jr&&!n)throw Error("Invalid provider user info!");t[Gr]=r||null,t[Qr]=n||null,Fr(this,Yr,e),Fr(this,Kr,qr(t))}var jr="EMAIL_SIGNIN",Wr="email",Hr="newEmail",zr="requestType",Qr="email",Gr="fromEmail",Kr="data",Yr="operation";function Xr(e,t){this.code=$r+e,this.message=t||Zr[e]||""}function Jr(e){var t=e&&e.code;return t?new Xr(t.substring($r.length),e.message):null}S(Xr,Error),Xr.prototype.A=function(){return{code:this.code,message:this.message}},Xr.prototype.toJSON=function(){return this.A()};var $r="auth/",Zr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function ei(e){var t=Cn(e=kn(e),ti)||null,n=Cn(e,ni)||null,r=Cn(e,oi)||null;if(r=r&&si[r]||null,!t||!n||!r)throw new Xr("argument-error",ti+", "+ni+"and "+oi+" are required in a valid action code URL.");Vr(this,{apiKey:t,operation:r,code:n,continueUrl:Cn(e,ri)||null,languageCode:Cn(e,ii)||null,tenantId:Cn(e,ai)||null})}var ti="apiKey",ni="oobCode",ri="continueUrl",ii="languageCode",oi="mode",ai="tenantId",si={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:jr,verifyEmail:"VERIFY_EMAIL"};function ui(e){try{return new ei(e)}catch(t){return null}}function li(e){var t=e[pi];if(void 0===t)throw new Xr("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new Xr("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[ci];if(n&&"object"==typeof n){t=n[yi];var r=n[vi];if(n=n[gi],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new Xr("argument-error",vi+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Xr("argument-error",gi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new Xr("argument-error",yi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Xr("missing-android-pkg-name")}}else if(void 0!==n)throw new Xr("argument-error",ci+" property must be a non null object when specified.");if(this.f=null,(t=e[di])&&"object"==typeof t){if("string"==typeof(t=t[mi])&&t.length)this.f=t;else if(void 0!==t)throw new Xr("argument-error",mi+" property must be a non empty string when specified.")}else if(void 0!==t)throw new Xr("argument-error",di+" property must be a non null object when specified.");if(void 0!==(t=e[fi])&&"boolean"!=typeof t)throw new Xr("argument-error",fi+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[hi])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new Xr("argument-error",hi+" property must be a non empty string when specified.");this.i=e||null}var ci="android",hi="dynamicLinkDomain",fi="handleCodeInApp",di="iOS",pi="url",vi="installApp",gi="minimumVersion",yi="packageName",mi="bundleId";function _i(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var bi=null,wi=null;function Ci(e){this.f=e.sub,E(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.c=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function ki(e){return(e=Ei(e))&&e.sub&&e.iss&&e.aud&&e.exp?new Ci(e):null}function Ei(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse(function(e){var t="";return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=wi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!bi){bi={},wi={};for(var e=0;65>e;e++)bi[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),wi[bi[e]]=e,62<=e&&(wi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){t+=String.fromCharCode(e)})),t}(e))}catch(r){}return null}Ci.prototype.R=function(){return this.c},Ci.prototype.g=function(){return this.b};var Si,Ti={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Ii(e){for(var t in Ti)if(Ti[t].id===e)return{firebaseEndpoint:(e=Ti[t]).cb,secureTokenEndpoint:e.ib};return null}Si=Ii("__EID__")?"__EID__":void 0;var Ai="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Ni=["client_id","response_type","scope","redirect_uri","state"],Di={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:Ni},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:Ni},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:Ni},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Ai},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function xi(e){for(var t in Di)if(Di[t].Fa==e)return Di[t];return null}function Ri(e){var t={};t["facebook.com"]=Fi,t["google.com"]=Ui,t["github.com"]=Vi,t["twitter.com"]=qi;var n=e&&e[Pi];try{if(n)return t[n]?new t[n](e):new Li(e);if(void 0!==e[Oi])return new Mi(e)}catch(r){}return null}var Oi="idToken",Pi="providerId";function Mi(e){var t=e[Pi];if(!t&&e[Oi]){var n=ki(e[Oi]);n&&n.a&&(t=n.a)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Fr(this,"providerId",t),Fr(this,"isNewUser",n)}function Li(e){Mi.call(this,e),Fr(this,"profile",qr((e=Sr(e.rawUserInfo||"{}"))||{}))}function Fi(e){if(Li.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Vi(e){if(Li.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Fr(this,"username",this.profile&&this.profile.login||null)}function Ui(e){if(Li.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function qi(e){if(Li.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Fr(this,"username",e.screenName||null)}function Bi(e){var t=kn(e),n=Cn(t,"link"),r=Cn(kn(n),"link");return t=Cn(t,"deep_link_id"),Cn(kn(t),"link")||t||r||n||e}function ji(){}function Wi(e,t){return e.then((function(e){if(e[Na]){var n=ki(e[Na]);if(!n||t!=n.f)throw new Xr("user-mismatch");return e}throw new Xr("user-mismatch")})).s((function(e){throw e&&e.code&&e.code==$r+"user-not-found"?new Xr("user-mismatch"):e}))}function Hi(e,t){if(!t)throw new Xr("internal-error","failed to construct a credential");this.a=t,Fr(this,"providerId",e),Fr(this,"signInMethod",e)}function zi(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function Qi(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new Hi(e.providerId,e.pendingToken)}catch(t){}return null}function Gi(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&Fr(this,"idToken",t.idToken),t.accessToken&&Fr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&Fr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new Xr("internal-error","failed to construct a credential");Fr(this,"accessToken",t.oauthToken),Fr(this,"secret",t.oauthTokenSecret)}Fr(this,"providerId",e),Fr(this,"signInMethod",n)}function Ki(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Mn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function Yi(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new Gi(e.providerId,t,e.signInMethod)}catch(n){}}return null}function Xi(e,t){this.Fc=t||[],Vr(this,{providerId:e,isOAuthProvider:!0}),this.zb={},this.eb=(xi(e)||{}).Ea||null,this.bb=null}function Ji(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new Xr("argument-error",'SAML provider IDs must be prefixed with "saml."');Xi.call(this,e,[])}function $i(e){Xi.call(this,e,Ni),this.a=[]}function Zi(){$i.call(this,"facebook.com")}function eo(e){if(!e)throw new Xr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new Zi).credential({accessToken:t})}function to(){$i.call(this,"github.com")}function no(e){if(!e)throw new Xr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return y(e)&&(t=e.accessToken),(new to).credential({accessToken:t})}function ro(){$i.call(this,"google.com"),this.ya("profile")}function io(e,t){var n=e;return y(e)&&(n=e.idToken,t=e.accessToken),(new ro).credential({idToken:n,accessToken:t})}function oo(){Xi.call(this,"twitter.com",Ai)}function ao(e,t){var n=e;if(y(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new Xr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Gi("twitter.com",n,"twitter.com")}function so(e,t,n){this.a=e,this.c=t,Fr(this,"providerId","password"),Fr(this,"signInMethod",n===lo.EMAIL_LINK_SIGN_IN_METHOD?lo.EMAIL_LINK_SIGN_IN_METHOD:lo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function uo(e){return e&&e.email&&e.password?new so(e.email,e.password,e.signInMethod):null}function lo(){Vr(this,{providerId:"password",isOAuthProvider:!1})}function co(e,t){if(!(t=ho(t)))throw new Xr("argument-error","Invalid email link!");return new so(e,t.code,lo.EMAIL_LINK_SIGN_IN_METHOD)}function ho(e){return(e=ui(e=Bi(e)))&&e.operation===jr?e:null}function fo(e){if(!(e.Va&&e.Ua||e.Ha&&e.ba))throw new Xr("internal-error");this.a=e,Fr(this,"providerId","phone"),Fr(this,"signInMethod","phone")}function po(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return V(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){e[n]&&(t[n]=e[n])})),new fo(t)}return null}function vo(e){return e.a.Ha&&e.a.ba?{temporaryProof:e.a.Ha,phoneNumber:e.a.ba}:{sessionInfo:e.a.Va,code:e.a.Ua}}function go(e){try{this.a=e||Kv.a.auth()}catch(t){throw new Xr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Vr(this,{providerId:"phone",isOAuthProvider:!1})}function yo(e,t){if(!e)throw new Xr("missing-verification-id");if(!t)throw new Xr("missing-verification-code");return new fo({Va:e,Ua:t})}function mo(e){if(e.temporaryProof&&e.phoneNumber)return new fo({Ha:e.temporaryProof,ba:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return io(o,n);case"facebook.com":return eo(n);case"github.com":return no(n);case"twitter.com":return ao(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new Hi(t,a):new Gi(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new $i(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function _o(e){if(!e.isOAuthProvider)throw new Xr("invalid-oauth-provider")}function bo(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new Xr("invalid-auth-event");if(this.g&&this.a)throw new Xr("invalid-auth-event");if(this.g&&!this.f)throw new Xr("invalid-auth-event")}function wo(e){return(e=e||{}).type?new bo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&Jr(e.error),e.postBody,e.tenantId):null}function Co(){this.b=null,this.a=[]}S(Li,Mi),S(Fi,Li),S(Vi,Li),S(Ui,Li),S(qi,Li),Hi.prototype.na=function(e){return Ga(e,zi(this))},Hi.prototype.b=function(e,t){var n=zi(this);return n.idToken=t,Ka(e,n)},Hi.prototype.f=function(e,t){return Wi(Ya(e,zi(this)),t)},Hi.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Gi.prototype.na=function(e){return Ga(e,Ki(this))},Gi.prototype.b=function(e,t){var n=Ki(this);return n.idToken=t,Ka(e,n)},Gi.prototype.f=function(e,t){return Wi(Ya(e,Ki(this)),t)},Gi.prototype.A=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},Xi.prototype.Ga=function(e){return this.zb=K(e),this},S(Ji,Xi),S($i,Xi),$i.prototype.ya=function(e){return B(this.a,e)||this.a.push(e),this},$i.prototype.Hb=function(){return z(this.a)},$i.prototype.credential=function(e,t){var n;if(!(n=y(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new Xr("argument-error","credential failed: must provide the ID token and/or the access token.");return new Gi(this.providerId,n,this.providerId)},S(Zi,$i),Fr(Zi,"PROVIDER_ID","facebook.com"),Fr(Zi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(to,$i),Fr(to,"PROVIDER_ID","github.com"),Fr(to,"GITHUB_SIGN_IN_METHOD","github.com"),S(ro,$i),Fr(ro,"PROVIDER_ID","google.com"),Fr(ro,"GOOGLE_SIGN_IN_METHOD","google.com"),S(oo,Xi),Fr(oo,"PROVIDER_ID","twitter.com"),Fr(oo,"TWITTER_SIGN_IN_METHOD","twitter.com"),so.prototype.na=function(e){return this.signInMethod==lo.EMAIL_LINK_SIGN_IN_METHOD?Es(e,rs,{email:this.a,oobCode:this.c}):Es(e,bs,{email:this.a,password:this.c})},so.prototype.b=function(e,t){return this.signInMethod==lo.EMAIL_LINK_SIGN_IN_METHOD?Es(e,is,{idToken:t,email:this.a,oobCode:this.c}):Es(e,ps,{idToken:t,email:this.a,password:this.c})},so.prototype.f=function(e,t){return Wi(this.na(e),t)},so.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Vr(lo,{PROVIDER_ID:"password"}),Vr(lo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Vr(lo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),fo.prototype.na=function(e){return e.Wa(vo(this))},fo.prototype.b=function(e,t){var n=vo(this);return n.idToken=t,Es(e,Cs,n)},fo.prototype.f=function(e,t){var n=vo(this);return n.operation="REAUTH",Wi(e=Es(e,ks,n),t)},fo.prototype.A=function(){var e={providerId:"phone"};return this.a.Va&&(e.verificationId=this.a.Va),this.a.Ua&&(e.verificationCode=this.a.Ua),this.a.Ha&&(e.temporaryProof=this.a.Ha),this.a.ba&&(e.phoneNumber=this.a.ba),e},go.prototype.Wa=function(e,t){var n=this.a.b;return Xe(t.verify()).then((function(r){if(!s(r))throw new Xr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":return function(e,t){return Es(e,fs,t)}(n,{phoneNumber:e,recaptchaToken:r}).then((function(e){return"function"==typeof t.reset&&t.reset(),e}),(function(e){throw"function"==typeof t.reset&&t.reset(),e}));default:throw new Xr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Vr(go,{PROVIDER_ID:"phone"}),Vr(go,{PHONE_SIGN_IN_METHOD:"phone"}),bo.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},bo.prototype.R=function(){return this.h},bo.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var ko,Eo=null;function So(e){var t="unauthorized-domain",n=void 0,r=kn(e);e=r.b,"chrome-extension"==(r=r.f)?n=Le("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=Le("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",Xr.call(this,t,n)}function To(e,t,n){Xr.call(this,e,n),(e=t||{}).Ab&&Fr(this,"email",e.Ab),e.ba&&Fr(this,"phoneNumber",e.ba),e.credential&&Fr(this,"credential",e.credential),e.Qb&&Fr(this,"tenantId",e.Qb)}function Io(e){if(e.code){var t=e.code||"";0==t.indexOf($r)&&(t=t.substring($r.length));var n={credential:mo(e),Qb:e.tenantId};if(e.email)n.Ab=e.email;else if(e.phoneNumber)n.ba=e.phoneNumber;else if(!n.credential)return new Xr(t,e.message||void 0);return new To(t,n,e.message)}return null}function Ao(){}function No(){}function Do(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function xo(){}function Ro(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=C(this.fc,this),this.a.onerror=C(this.Ib,this),this.a.onprogress=C(this.gc,this),this.a.ontimeout=C(this.kc,this)}function Oo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Po(e,t,n){this.reset(e,t,n,void 0,void 0)}function Mo(e){this.f=e,this.b=this.c=this.a=null}function Lo(e,t){this.name=e,this.value=t}S(So,Xr),S(To,Xr),To.prototype.A=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.A();return t&&X(e,t),e},To.prototype.toJSON=function(){return this.A()},Ao.prototype.c=null,S(No,Ao),No.prototype.a=function(){var e=Do(this);return e?new ActiveXObject(e):new XMLHttpRequest},No.prototype.b=function(){var e={};return Do(this)&&(e[0]=!0,e[1]=!0),e},ko=new No,S(xo,Ao),xo.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Ro;throw Error("Unsupported browser")},xo.prototype.b=function(){return{}},(e=Ro.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Oo(this,4)},e.Ib=function(){this.status=500,this.response=this.responseText="",Oo(this,4)},e.kc=function(){this.Ib()},e.gc=function(){this.status=200,Oo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Po.prototype.a=null,Po.prototype.reset=function(e,t,n,r,i){r||E(),delete this.a},Lo.prototype.toString=function(){return this.name};var Fo=new Lo("SEVERE",1e3),Vo=new Lo("WARNING",900),Uo=new Lo("CONFIG",700),qo=new Lo("FINE",500);Mo.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c?t.c:t.a?e(t.a):(N("Root logger has no level set."),null)}(this).value)for(g(t)&&(t=t()),e=new Po(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Bo={},jo=null;function Wo(e){var t;if(jo||(jo=new Mo(""),Bo[""]=jo,jo.c=Uo),!(t=Bo[e])){t=new Mo(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=Wo(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,Bo[e]=t}return t}function Ho(e,t){e&&e.log(qo,t,void 0)}function zo(e){this.f=e}function Qo(e){on.call(this),this.o=e,this.readyState=Go,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Wo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}S(zo,Ao),zo.prototype.a=function(){return new Qo(this.f)},zo.prototype.b=function(e){return function(){return e}}({}),S(Qo,on);var Go=0;function Ko(e){e.c.read().then(e.ec.bind(e)).catch(e.Oa.bind(e))}function Yo(e,t){t&&e.f&&(e.status=e.f.status,e.statusText=e.f.statusText),e.readyState=4,e.f=null,e.c=null,e.l=null,Xo(e)}function Xo(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Jo(e){on.call(this),this.headers=new dn,this.B=e||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=$o,this.v=this.P=!1}(e=Qo.prototype).open=function(e,t){if(this.readyState!=Go)throw this.abort(),Error("Error reopening a connection");this.m=e,this.g=t,this.readyState=1,Xo(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.i,method:this.m,credentials:void 0,cache:void 0};e&&(t.body=e),this.o.fetch(new Request(this.g,t)).then(this.jc.bind(this),this.Oa.bind(this))},e.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Yo(this,!1)),this.readyState=Go},e.jc=function(e){this.a&&(this.f=e,this.b||(this.b=e.headers,this.readyState=2,Xo(this)),this.a&&(this.readyState=3,Xo(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):void 0!==a.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.l=new TextDecoder,Ko(this)):e.text().then(this.ic.bind(this),this.Oa.bind(this)))))},e.ec=function(e){if(this.a){var t=this.l.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?Yo(this,!0):Xo(this),3==this.readyState&&Ko(this)}},e.ic=function(e){this.a&&(this.response=this.responseText=e,Yo(this,!0))},e.hc=function(e){this.a&&(this.response=e,Yo(this,!0))},e.Oa=function(e){var t=this.h;t&&t.log(Vo,"Failed to fetch url "+this.g,e instanceof Error?e:Error(e)),this.a&&Yo(this,!0)},e.setRequestHeader=function(e,t){this.i.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.h)&&e.log(Vo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.h;return e&&e.log(Vo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},S(Jo,on);var $o="";Jo.prototype.b=Wo("goog.net.XhrIo");var Zo=/^https?$/i,ea=["POST","PUT"];function ta(e){return"content-type"==e.toLowerCase()}function na(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,ra(e),oa(e)}function ra(e){e.I||(e.I=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function ia(e){if(e.c&&void 0!==o)if(e.w[1]&&4==sa(e)&&2==ua(e))Ho(e.b,la(e,"Local request error detected and ignored"));else if(e.i&&4==sa(e))ln(e.Lb,0,e);else if(e.dispatchEvent("readystatechange"),4==sa(e)){Ho(e.b,la(e,"Request complete")),e.c=!1;try{var t,n=ua(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.l).match(gn)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!Zo.test(s?s.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var l=2<sa(e)?e.a.statusText:""}catch(c){Ho(e.b,"Can not get status: "+c.message),l=""}e.h=l+" ["+ua(e)+"]",ra(e)}}finally{oa(e)}}}function oa(e,t){if(e.a){aa(e);var n=e.a,r=e.w[0]?h:null;e.a=null,e.w=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(e=e.b)&&e.log(Fo,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function aa(e){e.a&&e.v&&(e.a.ontimeout=null),e.o&&(a.clearTimeout(e.o),e.o=null)}function sa(e){return e.a?e.a.readyState:0}function ua(e){try{return 2<sa(e)?e.a.status:-1}catch(t){return-1}}function la(e,t){return t+" ["+e.O+" "+e.l+" "+ua(e)+"]"}function ca(e){var t=wa;this.g=[],this.v=t,this.o=e||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ha(e,t,n){e.a=!0,e.c=n,e.f=!t,va(e)}function fa(e){if(e.a){if(!e.u)throw new ga(e);e.u=!1}}function da(e,t,n,r){e.g.push([t,n,r]),e.a&&va(e)}function pa(e){return q(e.g,(function(e){return g(e[1])}))}function va(e){if(e.h&&e.a&&pa(e)){var t=e.h,n=_a[t];n&&(a.clearTimeout(n.a),delete _a[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],s=i[1];if(i=i[2],o=e.f?s:o)try{var u=o.call(i||e.o,t);void 0!==u&&(e.f=e.f&&(u==t||u instanceof Error),e.c=t=u),(T(t)||"function"==typeof a.Promise&&t instanceof a.Promise)&&(r=!0,e.i=!0)}catch(l){t=l,e.f=!0,pa(e)||(n=!0)}}e.c=t,r&&(u=C(e.m,e,!0),r=C(e.m,e,!1),t instanceof ca?(da(t,u,r),t.w=!0):t.then(u,r)),n&&(t=new ma(t),_a[t.a]=t,e.h=t.a)}function ga(){I.call(this)}function ya(){I.call(this)}function ma(e){this.a=a.setTimeout(C(this.c,this),0),this.b=e}(e=Jo.prototype).Ia=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Ho(this.b,la(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Ho(this.b,la(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),oa(this))},e.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),oa(this,!0)),Jo.qb.za.call(this)},e.Lb=function(){this.va||(this.J||this.i||this.f?ia(this):this.yc())},e.yc=function(){ia(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case $o:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(Fo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return Ho(this.b,"Can not get response: "+t.message),null}},ca.prototype.cancel=function(e){if(this.a)this.c instanceof ca&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(e=new ya(this),fa(this),ha(this,!1,e))}},ca.prototype.m=function(e,t){this.i=!1,ha(this,e,t)},ca.prototype.then=function(e,t,n){var r,i,o=new We((function(e,t){r=e,i=t}));return da(this,r,(function(e){e instanceof ya?o.cancel():i(e)})),o.then(e,t,n)},ca.prototype.$goog_Thenable=!0,S(ga,I),ga.prototype.message="Deferred has already fired",ga.prototype.name="AlreadyCalledError",S(ya,I),ya.prototype.message="Deferred was canceled",ya.prototype.name="CanceledError",ma.prototype.c=function(){throw delete _a[this.a],this.b};var _a={};function ba(e){var t={},n=t.document||document,r=re(e).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},s=new ca(o),u=null,h=null!=t.timeout?t.timeout:5e3;return 0<h&&(u=window.setTimeout((function(){Ca(i,!0);var e=new Sa(Ea,"Timeout reached for loading script "+r);fa(s),ha(s,!1,e)}),h),o.Ia=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ca(i,t.hd||!1,u),fa(s),ha(s,!0,null))},i.onerror=function(){Ca(i,!0,u);var e=new Sa(ka,"Error while loading script "+r);fa(s),ha(s,!1,e)},X(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Wn(i,o),function(e,t){L(e,"HTMLScriptElement"),e.src=re(t),null===c&&(c=(t=(t=a.document).querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&l.test(t)?t:""),(t=c)&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),s}function wa(){if(this&&this.Nb){var e=this.Nb;e&&"SCRIPT"==e.tagName&&Ca(e,!0,this.Ia)}}function Ca(e,t,n){null!=n&&a.clearTimeout(n),e.onload=h,e.onerror=h,e.onreadystatechange=h,t&&window.setTimeout((function(){e&&e.parentNode&&e.parentNode.removeChild(e)}),0)}var ka=0,Ea=1;function Sa(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),I.call(this,n),this.code=e}function Ta(e){this.f=e}function Ia(e,t,n){if(this.c=e,this.l=(e=t||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=e.secureTokenTimeout||Da,this.g=K(e.secureTokenHeaders||xa),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.firebaseTimeout||Ra,this.a=K(e.firebaseHeaders||Oa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==lr(),!(n=a.XMLHttpRequest||n&&Kv.a.INTERNAL.node&&Kv.a.INTERNAL.node.XMLHttpRequest)&&!ur())throw new Xr("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=ur()?new zo(self):cr()?new Ta(n):new xo,this.b=null}S(Sa,I),S(Ta,Ao),Ta.prototype.a=function(){return new this.f},Ta.prototype.b=function(){return{}};var Aa,Na="idToken",Da=new Nr(3e4,6e4),xa={"Content-Type":"application/x-www-form-urlencoded"},Ra=new Nr(3e4,6e4),Oa={"Content-Type":"application/json"};function Pa(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Ma(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function La(e,t,n,r,i,o,s){(function(){var e=gr();return!((e=dr(e)!=fr?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e||mt&&It&&!(9<It))})()||ur()?e=C(e.o,e):(Aa||(Aa=new We((function(e,t){!function(e,t){((window.gapi||{}).client||{}).request?e():(a[Va]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){da(e,null,t,void 0)}(ba(ie(Fa,{onload:Va})),(function(){t(Error("CORS_UNSUPPORTED"))})))}(e,t)}))),e=C(e.m,e)),e(t,n,r,i,o,s)}Ia.prototype.R=function(){return this.b},Ia.prototype.o=function(e,t,n,r,i,o){if(ur()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new Xr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var u=new Jo(this.f);if(o){u.g=Math.max(0,o);var l=setTimeout((function(){u.dispatchEvent("timeout")}),o)}an(u,"complete",(function(){l&&clearTimeout(l);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return Ho(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(n){e=null}t&&t(e)})),sn(u,"ready",(function(){l&&clearTimeout(l),dt(this)})),sn(u,"timeout",(function(){l&&clearTimeout(l),dt(this),t&&t(null)})),function(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.O=n,e.I=!1,e.c=!0,e.a=e.B?e.B.a():ko.a(),e.w=function(e){return e.c||(e.c=e.b())}(e.B?e.B:ko),e.a.onreadystatechange=C(e.Lb,e);try{Ho(e.b,la(e,"Opening Xhr")),e.J=!0,e.a.open(n,String(t),!0),e.J=!1}catch(u){return Ho(e.b,la(e,"Error opening Xhr: "+u.message)),void na(e,u)}t=r||"";var o=new dn(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||s(e))V(e,t,void 0);else for(var n=fn(e),r=hn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,(function(e,t){o.set(t,e)})),i=function(e){e:{for(var t=ta,n=e.length,r=s(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:s(e)?e.charAt(t):e[t]}(o.X()),r=a.FormData&&t instanceof a.FormData,!B(ea,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(e,t){this.a.setRequestHeader(t,e)}),e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.P&&(e.a.withCredentials=e.P);try{aa(e),0<e.g&&(e.v=function(e){return mt&&Nt(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(e.a),Ho(e.b,la(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=C(e.Ia,e)):e.o=ln(e.Ia,e.g,e)),Ho(e.b,la(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(u){Ho(e.b,la(e,"Send error: "+u.message)),na(e,u)}}(u,e,n,r,i)};var Fa=new J(ee,"https://apis.google.com/js/client.js?onload=%{onload}"),Va="__fcb"+Math.floor(1e6*Math.random()).toString();function Ua(e){if(!s(e=e.email)||!ir.test(e))throw new Xr("invalid-email")}function qa(e){"email"in e&&Ua(e)}function Ba(e){if(!e[Na])throw new Xr("internal-error")}function ja(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new Xr("internal-error")}else{if(!e.sessionInfo)throw new Xr("missing-verification-id");if(!e.code)throw new Xr("missing-verification-code")}}Ia.prototype.m=function(e,t,n,r,i){var o=this;Aa.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a),t&&t(e)}})})).s((function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})}))},Ia.prototype.ob=function(){return Es(this,vs,{})},Ia.prototype.rb=function(e,t){return Es(this,ds,{idToken:e,email:t})},Ia.prototype.sb=function(e,t){return Es(this,ps,{idToken:e,password:t})};var Wa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Ha(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new Xr("internal-error")}function za(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&Fn(e=new On(e.postBody),"nonce")&&(t.nonce=e.get("nonce"))),t}function Qa(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Io(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Io(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Io(e)):e.errorMessage&&(t=Ss(e.errorMessage)),t)throw t;if(!e[Na])throw new Xr("internal-error")}function Ga(e,t){return t.returnIdpCredential=!0,Es(e,gs,t)}function Ka(e,t){return t.returnIdpCredential=!0,Es(e,ms,t)}function Ya(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Es(e,ys,t)}function Xa(e){if(!e.oobCode)throw new Xr("invalid-action-code")}(e=Ia.prototype).tb=function(e,t){var n={idToken:e},r=[];return Q(Wa,(function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),Es(this,ds,n)},e.kb=function(e,t){return X(e={requestType:"PASSWORD_RESET",email:e},t),Es(this,us,e)},e.lb=function(e,t){return X(e={requestType:"EMAIL_SIGNIN",email:e},t),Es(this,as,e)},e.jb=function(e,t){return X(e={requestType:"VERIFY_EMAIL",idToken:e},t),Es(this,ss,e)},e.Wa=function(e){return Es(this,ws,e)},e.ab=function(e,t){return Es(this,hs,{oobCode:e,newPassword:t})},e.Ma=function(e){return Es(this,$a,{oobCode:e})},e.Ya=function(e){return Es(this,Ja,{oobCode:e})};var Ja={endpoint:"setAccountInfo",D:Xa,fa:"email",F:!0},$a={endpoint:"resetPassword",D:Xa,K:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t)throw new Xr("internal-error")},F:!0},Za={endpoint:"signupNewUser",D:function(e){if(Ua(e),!e.password)throw new Xr("weak-password")},K:Ba,T:!0,F:!0},es={endpoint:"createAuthUri",F:!0},ts={endpoint:"deleteAccount",V:["idToken"]},ns={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(e){if(!p(e.deleteProvider))throw new Xr("internal-error")}},rs={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ua,K:Ba,T:!0,F:!0},is={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ua,K:Ba,T:!0},os={endpoint:"getAccountInfo"},as={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new Xr("internal-error");Ua(e)},fa:"email",F:!0},ss={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new Xr("internal-error")},fa:"email",F:!0},us={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(e){if("PASSWORD_RESET"!=e.requestType)throw new Xr("internal-error");Ua(e)},fa:"email",F:!0},ls={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},cs={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(e){if(!e.recaptchaSiteKey)throw new Xr("internal-error")}},hs={endpoint:"resetPassword",D:Xa,fa:"email",F:!0},fs={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},ds={endpoint:"setAccountInfo",V:["idToken"],D:qa,T:!0},ps={endpoint:"setAccountInfo",V:["idToken"],D:function(e){if(qa(e),!e.password)throw new Xr("weak-password")},K:Ba,T:!0},vs={endpoint:"signupNewUser",K:Ba,T:!0,F:!0},gs={endpoint:"verifyAssertion",D:Ha,Ra:za,K:Qa,T:!0,F:!0},ys={endpoint:"verifyAssertion",D:Ha,Ra:za,K:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new Xr("user-not-found");if(e.errorMessage)throw Ss(e.errorMessage);if(!e[Na])throw new Xr("internal-error")},T:!0,F:!0},ms={endpoint:"verifyAssertion",D:function(e){if(Ha(e),!e.idToken)throw new Xr("internal-error")},Ra:za,K:Qa,T:!0},_s={endpoint:"verifyCustomToken",D:function(e){if(!e.token)throw new Xr("invalid-custom-token")},K:Ba,T:!0,F:!0},bs={endpoint:"verifyPassword",D:function(e){if(Ua(e),!e.password)throw new Xr("wrong-password")},K:Ba,T:!0,F:!0},ws={endpoint:"verifyPhoneNumber",D:ja,K:Ba,F:!0},Cs={endpoint:"verifyPhoneNumber",D:function(e){if(!e.idToken)throw new Xr("internal-error");ja(e)},K:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Io(e);Ba(e)}},ks={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:ja,K:Ba,F:!0};function Es(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return!1}return!0}(n,t.V))return Je(new Xr("internal-error"));var r,i=t.Kb||"POST";return Xe(n).then(t.D).then((function(){return t.T&&(n.returnSecureToken=!0),t.F&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),function(e,t,n,r,i,o){var a=kn(e.h+t);wn(a,"key",e.c),o&&wn(a,"cb",E().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&wn(a,u,r[u]);return new We((function(t,o){La(e,a.toString(),(function(e){e?e.error?o(Ts(e,i||{})):t(e):o(new Xr("network-request-failed"))}),n,s?void 0:Qn(Er(r)),e.a,e.i.get())}))}(e,t.endpoint,i,n,t.Yb,t.wb||!1)})).then((function(e){return r=e,t.Ra?t.Ra(n,r):r})).then(t.K).then((function(){if(!t.fa)return r;if(!(t.fa in r))throw new Xr("internal-error");return r[t.fa]}))}function Ss(e){return Ts({error:{errors:[{message:e}],code:400,message:e}})}function Ts(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Xr(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",X(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new Xr(r[i],t);return!t&&e&&(t=kr(e)),new Xr("internal-error",t)}function Is(e){this.b=e,this.a=null,this.gb=function(e){return(xs||(xs=new We((function(e,t){function n(){Ar(),yr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Ar(),t(Error("Network Error"))},timeout:Ns.get()})}if(yr("gapi.iframes.Iframe"))e();else if(yr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){yr("gapi.load")?n():t(Error("Network Error"))},Xe(ba(r=ie(As,{onload:r}))).s((function(){t(Error("Network Error"))}))}})).s((function(e){throw xs=null,e})))).then((function(){return new We((function(t,n){yr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),Ds.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var As=new J(ee,"https://apis.google.com/js/api.js?onload=%{onload}"),Ns=new Nr(3e4,6e4),Ds=new Nr(5e3,15e3),xs=null;function Rs(e,t,n){this.i=e,this.g=t,this.h=n,this.f=null,this.a=En(this.i,"/__/auth/iframe"),wn(this.a,"apiKey",this.g),wn(this.a,"appName",this.h),this.b=null,this.c=[]}function Os(e,t,n,r,i){this.o=e,this.m=t,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function Ps(e){try{return Kv.a.app(e).auth().Ca()}catch(t){return[]}}function Ms(e,t,n,r,i){this.u=e,this.f=t,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function Ls(e){var t=$n();return function(e){return Es(e,ls,{}).then((function(e){return e.authorizedDomains||[]}))}(e).then((function(e){e:{var n=kn(t),r=n.f;n=n.b;for(var i=0;i<e.length;i++){var o=e[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=kn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:rr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){e=!0;break e}}e=!1}if(!e)throw new So($n())}))}function Fs(e){return e.l?e.l:(e.l=or().then((function(){if(!e.o){var t=e.c,n=e.h,r=Ps(e.b),i=new Rs(e.u,e.f,e.b);i.f=t,i.b=n,i.c=z(r||[]),e.o=i.toString()}e.i=new Is(e.o),function(e){if(!e.i)throw Error("IfcHandler must be initialized!");!function(e,t){e.gb.then((function(){e.a.register("authEvent",t,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(e.i,(function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=wo(t.authEvent),n=0;n<e.g.length;n++)r=e.g[n](t)||r;return(n={}).status=r?"ACK":"ERROR",Xe(n)}return n.status="ERROR",Xe(n)}))}(e)})),e.l)}function Vs(e){return e.m||(e.v=e.c?vr(e.c,Ps(e.b)):null,e.m=new Ia(e.f,Ii(e.h),e.v)),e.m}function Us(e,t,n,r,i,o,a,s,u,l,c){return(e=new Os(e,t,n,r,i)).l=o,e.g=a,e.i=s,e.b=K(u||null),e.f=l,e.nb(c).toString()}function qs(e){if(this.a=e||Kv.a.INTERNAL.reactNative&&Kv.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Xr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Bs(e){this.b=e,this.a={},this.f=C(this.c,this)}Rs.prototype.toString=function(){return this.f?wn(this.a,"v",this.f):Ln(this.a.a,"v"),this.b?wn(this.a,"eid",this.b):Ln(this.a.a,"eid"),this.c.length?wn(this.a,"fw",this.c.join(",")):Ln(this.a.a,"fw"),this.a.toString()},Os.prototype.nb=function(e){return this.h=e,this},Os.prototype.toString=function(){var e=En(this.o,"/__/auth/handler");if(wn(e,"apiKey",this.m),wn(e,"appName",this.c),wn(e,"authType",this.u),this.a.isOAuthProvider){var t=this.a;try{var n=Kv.a.app(this.c).auth().ha()}catch(s){n=null}for(var r in t.bb=n,wn(e,"providerId",this.a.providerId),n=Er((t=this.a).zb))n[r]=n[r].toString();r=t.Fc,n=K(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}t.eb&&t.bb&&!n[t.eb]&&(n[t.eb]=t.bb),G(n)||wn(e,"customParameters",kr(n))}if("function"==typeof this.a.Hb&&(t=this.a.Hb()).length&&wn(e,"scopes",t.join(",")),this.l?wn(e,"redirectUrl",this.l):Ln(e.a,"redirectUrl"),this.g?wn(e,"eventId",this.g):Ln(e.a,"eventId"),this.i?wn(e,"v",this.i):Ln(e.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Cn(e,a)&&wn(e,a,this.b[a]);return this.h?wn(e,"tid",this.h):Ln(e.a,"tid"),this.f?wn(e,"eid",this.f):Ln(e.a,"eid"),(a=Ps(this.c)).length&&wn(e,"fw",a.join(",")),e.toString()},(e=Ms.prototype).Fb=function(e,t,n){var r=new Xr("popup-closed-by-user"),i=new Xr("web-storage-unsupported"),o=this,a=!1;return this.ia().then((function(){(function(e){var t={type:"webStorageSupport"};return Fs(e).then((function(){return function(e,t){return e.gb.then((function(){return new We((function(n){e.a.send(t.type,t,n,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(e.i,t)})).then((function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(e&&tr(e),t(i),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(e){return new We((function(t){return function n(){cn(2e3).then((function(){if(e&&!e.closed)return n();t()}))}()}))}(e)})).then((function(){if(!a)return cn(n).then((function(){t(r)}))}))},e.Ob=function(){var e=gr();return!Cr(e)&&!Ir(e)},e.Jb=function(){return!1},e.Db=function(e,t,n,r,i,o,a,s){if(!e)return Je(new Xr("popup-blocked"));if(a&&!Cr())return this.ia().s((function(t){tr(e),i(t)})),r(),Xe();this.a||(this.a=Ls(Vs(this)));var u=this;return this.a.then((function(){var t=u.ia().s((function(t){throw tr(e),i(t),t}));return r(),t})).then((function(){_o(n),a||Zn(Us(u.u,u.f,u.b,t,n,null,o,u.c,void 0,u.h,s),e)})).s((function(e){throw"auth/network-request-failed"==e.code&&(u.a=null),e}))},e.Eb=function(e,t,n,r){this.a||(this.a=Ls(Vs(this)));var i=this;return this.a.then((function(){_o(t),Zn(Us(i.u,i.f,i.b,e,t,$n(),n,i.c,void 0,i.h,r))})).s((function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e}))},e.ia=function(){var e=this;return Fs(this).then((function(){return e.i.gb})).s((function(){throw e.a=null,new Xr("network-request-failed")}))},e.Rb=function(){return!0},e.Aa=function(e){this.g.push(e)},e.Na=function(e){W(this.g,(function(t){return t==e}))},(e=qs.prototype).get=function(e){return Xe(this.a.getItem(e)).then((function(e){return e&&Sr(e)}))},e.set=function(e,t){return Xe(this.a.setItem(e,kr(t)))},e.S=function(e){return Xe(this.a.removeItem(e))},e.$=function(){},e.ea=function(){};var js,Ws=[];function Hs(e,t,n){G(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function zs(e){this.a=e}function Qs(e){this.c=e,this.b=!1,this.a=[]}function Gs(e,t,n,r){var i,o,a,s,u=n||{},l=null;if(e.b)return Je(Error("connection_unavailable"));var c=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new We((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),c),e.a.push(l={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(t){return Ks(e,l),t})).s((function(t){throw Ks(e,l),t}))}function Ks(e,t){if(t){var n=t.messageChannel;n&&(n.port1.removeEventListener("message",t.onMessage),n.port1.close()),W(e.a,(function(e){return e==t}))}}function Ys(){if(!Js())throw new Xr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=a.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var e=this;ur()&&self?(this.l=function(){var e=ur()?self:null;if(V(Ws,(function(n){n.b==e&&(t=n)})),!t){var t=new Bs(e);Ws.push(t)}return t}(),Hs(this.l,"keyChanged",(function(t,n){return nu(e).then((function(t){return 0<t.length&&V(e.a,(function(e){e(t)})),{keyProcessed:B(t,n.key)}}))})),Hs(this.l,"ping",(function(){return Xe(["keyChanged"])}))):function(){var e=a.navigator;return e&&e.serviceWorker?Xe().then((function(){return e.serviceWorker.ready})).then((function(e){return e.active||null})).s((function(){return null})):Xe(null)}().then((function(t){(e.h=t)&&(e.g=new Qs(new zs(t)),Gs(e.g,"ping",null,!0).then((function(t){t[0].fulfilled&&B(t[0].value,"keyChanged")&&(e.o=!0)})).s((function(){})))}))}function Xs(e){return e.m||(e.m=function e(t){return new We((function(n,r){var i=t.u.open("firebaseLocalStorageDb",1);i.onerror=function(e){try{e.preventDefault()}catch(t){}r(Error(e.target.error))},i.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){r(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(e){return new We((function(t,n){var r=e.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}}))}(t).then((function(){return e(t)})).then((function(e){n(e)})).s((function(e){r(e)}))}}))}(e)),e.m}function Js(){try{return!!a.indexedDB}catch(gt){return!1}}function $s(e){return e.objectStore("firebaseLocalStorage")}function Zs(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function eu(e){return new We((function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}}))}function tu(e,t){return e.g&&e.h&&function(){var e=a.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?Gs(e.g,"keyChanged",{key:t},e.o).then((function(){})).s((function(){})):Xe()}function nu(e){return Xs(e).then((function(e){var t=$s(Zs(e,!1));return t.getAll?eu(t.getAll()):new We((function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}}))})).then((function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=function e(t,n){var r,i=[];for(r in t)r in n?typeof t[r]!=typeof n[r]?i.push(r):"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(e.c,n),e.c=n}return r}))}function ru(e){e.i&&e.i.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function iu(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=Xe().then((function(){if(Js()){var e=Tr(),r="__sak"+e;return js||(js=new Ys),(n=js).set(r,e).then((function(){return n.get(r)})).then((function(t){if(t!==e)throw Error("indexedDB not supported!");return n.S(r)})).then((function(){return n})).s((function(){return t.c}))}return t.c})).then((function(e){return t.type=e.type,e.$((function(e){V(t.a,(function(t){t(e)}))})),e}))}function ou(){this.a={},this.type="inMemory"}function au(){if(!function(){var e="Node"==lr();if(!(e=su()||e&&Kv.a.INTERNAL.node&&Kv.a.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==lr())throw new Xr("internal-error","The LocalStorage compatibility library was not found.");throw new Xr("web-storage-unsupported")}this.a=su()||Kv.a.INTERNAL.node.localStorage,this.type="localStorage"}function su(){try{var e=a.localStorage,t=Tr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function uu(){this.type="nullStorage"}function lu(){if(!function(){var e="Node"==lr();if(!(e=cu()||e&&Kv.a.INTERNAL.node&&Kv.a.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==lr())throw new Xr("internal-error","The SessionStorage compatibility library was not found.");throw new Xr("web-storage-unsupported")}this.a=cu()||Kv.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function cu(){try{var e=a.sessionStorage,t=Tr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function hu(){var e={};e.Browser=pu,e.Node=vu,e.ReactNative=gu,e.Worker=yu,this.a=e[lr()]}Bs.prototype.c=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];V(r,(function(t){i.push(Xe().then((function(){return t(e.origin,e.data.data)})))})),Ze(i).then((function(r){var i=[];V(r,(function(e){i.push({fulfilled:e.Gb,value:e.value,reason:e.reason?e.reason.message:void 0})})),V(i,(function(e){for(var t in e)void 0===e[t]&&delete e[t]})),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})}))}},zs.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},Qs.prototype.close=function(){for(;0<this.a.length;)Ks(this,this.a[0]);this.b=!0},(e=Ys.prototype).set=function(e,t){var n,r=!1,i=this;return Xs(this).then((function(t){return eu((t=$s(Zs(n=t,!0))).get(e))})).then((function(o){var a=$s(Zs(n,!0));return o?(o.value=t,eu(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=e,o.value=t,eu(a.add(o)))})).then((function(){return i.c[e]=t,tu(i,e)})).ka((function(){r&&i.b--}))},e.get=function(e){return Xs(this).then((function(t){return eu($s(Zs(t,!1)).get(e))})).then((function(e){return e&&e.value}))},e.S=function(e){var t=!1,n=this;return Xs(this).then((function(r){return t=!0,n.b++,eu($s(Zs(r,!0)).delete(e))})).then((function(){return delete n.c[e],tu(n,e)})).ka((function(){t&&n.b--}))},e.$=function(e){0==this.a.length&&function(e){ru(e),function t(){e.f=setTimeout((function(){e.i=nu(e).then((function(t){0<t.length&&V(e.a,(function(e){e(t)}))})).then((function(){t()})).s((function(e){"STOP_EVENT"!=e.message&&t()}))}),800)}()}(this),this.a.push(e)},e.ea=function(e){W(this.a,(function(t){return t==e})),0==this.a.length&&ru(this)},(e=iu.prototype).get=function(e){return this.b.then((function(t){return t.get(e)}))},e.set=function(e,t){return this.b.then((function(n){return n.set(e,t)}))},e.S=function(e){return this.b.then((function(t){return t.S(e)}))},e.$=function(e){this.a.push(e)},e.ea=function(e){W(this.a,(function(t){return t==e}))},(e=ou.prototype).get=function(e){return Xe(this.a[e])},e.set=function(e,t){return this.a[e]=t,Xe()},e.S=function(e){return delete this.a[e],Xe()},e.$=function(){},e.ea=function(){},(e=au.prototype).get=function(e){var t=this;return Xe().then((function(){return Sr(t.a.getItem(e))}))},e.set=function(e,t){var n=this;return Xe().then((function(){var r=kr(t);null===r?n.S(e):n.a.setItem(e,r)}))},e.S=function(e){var t=this;return Xe().then((function(){t.a.removeItem(e)}))},e.$=function(e){a.window&&Qt(a.window,"storage",e)},e.ea=function(e){a.window&&Yt(a.window,"storage",e)},(e=uu.prototype).get=function(){return Xe(null)},e.set=function(){return Xe()},e.S=function(){return Xe()},e.$=function(){},e.ea=function(){},(e=lu.prototype).get=function(e){var t=this;return Xe().then((function(){return Sr(t.a.getItem(e))}))},e.set=function(e,t){var n=this;return Xe().then((function(){var r=kr(t);null===r?n.S(e):n.a.setItem(e,r)}))},e.S=function(e){var t=this;return Xe().then((function(){t.a.removeItem(e)}))},e.$=function(){},e.ea=function(){};var fu,du,pu={C:au,Ta:lu},vu={C:au,Ta:lu},gu={C:qs,Ta:uu},yu={C:au,Ta:uu},mu={ad:"local",NONE:"none",cd:"session"};function _u(){var e=!(Ir(gr())||!sr()),t=Cr(),n=mr();this.m=e,this.h=t,this.l=n,this.a={},fu||(fu=new hu),e=fu;try{this.g=!Jn()&&Rr()||!a.indexedDB?new e.a.C:new iu(ur()?new ou:new e.a.C)}catch(r){this.g=new ou,this.h=!0}try{this.i=new e.a.Ta}catch(r){this.i=new ou}this.u=new ou,this.f=C(this.Pb,this),this.b={}}function bu(){return du||(du=new _u),du}function wu(e,t){switch(t){case"session":return e.i;case"none":return e.u;default:return e.g}}function Cu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function ku(e,t,n){return n=Cu(t,n),"local"==t.C&&(e.b[n]=null),wu(e,t.C).S(n)}function Eu(e){e.c&&(clearInterval(e.c),e.c=null)}function Su(e){this.a=e,this.b=bu()}(e=_u.prototype).get=function(e,t){return wu(this,e.C).get(Cu(e,t))},e.set=function(e,t,n){var r=Cu(e,n),i=this,o=wu(this,e.C);return o.set(r,t).then((function(){return o.get(r)})).then((function(t){"local"==e.C&&(i.b[r]=t)}))},e.addListener=function(e,t,n){e=Cu(e,t),this.l&&(this.b[e]=a.localStorage.getItem(e)),G(this.a)&&(wu(this,"local").$(this.f),this.h||(Jn()||!Rr())&&a.indexedDB||!this.l||function(e){Eu(e),e.c=setInterval((function(){for(var t in e.a){var n=a.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new Mt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Pb(n))}}),1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Cu(e,t),this.a[e]&&(W(this.a[e],(function(e){return e==n})),0==this.a[e].length&&delete this.a[e]),G(this.a)&&(wu(this,"local").ea(this.f),Eu(this))},e.Pb=function(e){if(e&&e.f){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?wu(this,"local").ea(this.f):Eu(this),this.m)if(n=a.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?a.localStorage.setItem(t,r):a.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===a.localStorage.getItem(t)||(o.b[t]=a.localStorage.getItem(t),o.$a(t))},mt&&It&&10==It&&a.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else V(e,C(this.$a,this))},e.$a=function(e){this.a[e]&&V(this.a[e],(function(e){e()}))};var Tu,Iu={name:"authEvent",C:"local"};function Au(){this.a=bu()}function Nu(e,t){this.b=Du,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0!==Tu||(Tu=a.Int32Array?new Int32Array(Fu):Fu),this.reset()}S(Nu,(function(){this.b=-1}));for(var Du=64,xu=Du-1,Ru=[],Ou=0;Ou<xu;Ou++)Ru[Ou]=0;var Pu=H(128,Ru);function Mu(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){var o=(0|n[t-16])+(((i=0|n[t-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+(((r=0|n[t-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],l=0|e.a[4],c=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))|0)+((a=(a=l&c^~l&h)+(0|Tu[t])|0)+(0|n[t])|0)|0,o=h,h=c,c=l,l=u+a|0,u=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+l|0,e.a[5]=e.a[5]+c|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function Lu(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if(s(t))for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(Mu(e),i=0);else{if(!v(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(Mu(e),i=0)}}e.c=i,e.g+=n}Nu.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):z(this.h)};var Fu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Vu(){Nu.call(this,8,Uu)}S(Vu,Nu);var Uu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function qu(e,t,n,r,i){this.u=e,this.i=t,this.l=n,this.m=r||null,this.o=i||null,this.h=t+":"+n,this.v=new Au,this.g=new Su(this.h),this.f=null,this.b=[],this.a=this.c=null}function Bu(e){return new Xr("invalid-cordova-configuration",e)}function ju(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(r){}}function Wu(e){return e.f||(e.f=e.ia().then((function(){return new We((function(t){e.Aa((function n(r){return t(r),e.Na(n),!1})),function(e){function t(t){r=!0,i&&i.cancel(),Hu(e).then((function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=Bi(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Sr(Cn(o=kn(i),"firebaseError")||null))?Jr(o):null)?new bo(r.c,r.b,null,null,o,null,r.R()):new bo(r.c,r.b,i,r.f,null,null,r.R())),i=o||n}ju(e,i)}))}var n=new bo("unknown",null,null,null,new Xr("no-auth-event")),r=!1,i=cn(500).then((function(){return Hu(e).then((function(){r||ju(e,n)}))})),o=a.handleOpenURL;a.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(yr("BuildInfo.packageName",a).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(n){console.error(n)}},Eo||(Eo=new Co),function(e){var t=Eo;t.a.push(e),t.b||(t.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=yr("universalLinks.subscribe",a))&&e(null,t.b))}(t)}(e)}))}))),e.f}function Hu(e){var t=null;return function(e){return e.b.get(Iu,e.a).then((function(e){return wo(e)}))}(e.g).then((function(n){return t=n,ku((n=e.g).b,Iu,n.a)})).then((function(){return t}))}function zu(e){this.a=e,this.b=bu()}(e=qu.prototype).ia=function(){return this.Da?this.Da:this.Da=(ar(void 0)?or().then((function(){return new We((function(e,t){var n=a.document,r=setTimeout((function(){t(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),e()}),!1)}))})):Je(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof yr("universalLinks.subscribe",a))throw Bu("cordova-universal-links-plugin-fix is not installed");if(void 0===yr("BuildInfo.packageName",a))throw Bu("cordova-plugin-buildinfo is not installed");if("function"!=typeof yr("cordova.plugins.browsertab.openUrl",a))throw Bu("cordova-plugin-browsertab is not installed");if("function"!=typeof yr("cordova.InAppBrowser.open",a))throw Bu("cordova-plugin-inappbrowser is not installed")}),(function(){throw new Xr("cordova-not-ready")}))},e.Fb=function(e,t){return t(new Xr("operation-not-supported-in-this-environment")),Xe()},e.Db=function(){return Je(new Xr("operation-not-supported-in-this-environment"))},e.Rb=function(){return!1},e.Ob=function(){return!0},e.Jb=function(){return!0},e.Eb=function(e,t,n,r){if(this.c)return Je(new Xr("redirect-operation-pending"));var i=this,o=a.document,s=null,u=null,l=null,c=null;return this.c=Xe().then((function(){return _o(t),Wu(i)})).then((function(){return function(e,t,n,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),s=new bo(t,r,null,o,new Xr("no-auth-event"),null,i),u=yr("BuildInfo.packageName",a);if("string"!=typeof u)throw new Xr("invalid-cordova-configuration");var l=yr("BuildInfo.displayName",a),c={};if(gr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=u;else{if(!gr().toLowerCase().match(/android/))return Je(new Xr("operation-not-supported-in-this-environment"));c.apn=u}l&&(c.appDisplayName=l),o=function(e){var t=new Vu;Lu(t,e),e=[];var n=8*t.g;Lu(t,Pu,56>t.c?56-t.c:t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(Mu(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return U(e,(function(e){return 1<(e=e.toString(16)).length?e:"0"+e})).join("")}(e)}(o),c.sessionId=o;var h=Us(e.u,e.i,e.l,t,n,null,r,e.m,c,e.o,i);return e.ia().then((function(){var t=e.h;return e.v.a.set(Iu,s.A(),t)})).then((function(){var t=yr("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof t)throw new Xr("invalid-cordova-configuration");var n=null;t((function(t){if(t){if("function"!=typeof(n=yr("cordova.plugins.browsertab.openUrl",a)))throw new Xr("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=yr("cordova.InAppBrowser.open",a)))throw new Xr("invalid-cordova-configuration");t=gr(),e.a=n(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,e,t,n,r)})).then((function(){return new We((function(e,t){u=function(){var t=yr("cordova.plugins.browsertab.close",a);return e(),"function"==typeof t&&t(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(u),c=function(){Dr()&&l()},o.addEventListener("resume",l=function(){s||(s=cn(2e3).then((function(){t(new Xr("redirect-cancelled-by-user"))})))},!1),gr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)})).s((function(e){return Hu(i).then((function(){throw e}))}))})).ka((function(){l&&o.removeEventListener("resume",l,!1),c&&o.removeEventListener("visibilitychange",c,!1),s&&s.cancel(),u&&i.Na(u),i.c=null}))},e.Aa=function(e){this.b.push(e),Wu(this).s((function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new bo("unknown",null,null,null,new Xr("no-auth-event")),e(t))}))},e.Na=function(e){W(this.b,(function(t){return t==e}))};var Qu={name:"pendingRedirect",C:"session"};function Gu(e){return ku(e.b,Qu,e.a)}function Ku(e,t,n){this.i={},this.v=0,this.B=e,this.u=t,this.m=n,this.h=[],this.f=!1,this.l=C(this.o,this),this.b=new ul,this.w=new dl,this.g=new zu(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=Yu(this.B,this.u,this.m,Si)}function Yu(e,t,n,r){var i=Kv.a.SDK_VERSION||null;return ar()?new qu(e,t,n,i,r):new Ms(e,t,n,i,r)}function Xu(e){e.f||(e.f=!0,e.a.Aa(e.l));var t=e.a;return e.a.ia().s((function(n){throw e.a==t&&e.reset(),n}))}function Ju(e){e.a.Ob()&&Xu(e).s((function(t){var n=new bo("unknown",null,null,null,new Xr("operation-not-supported-in-this-environment"));rl(t)&&e.o(n)})),e.a.Jb()||ll(e.b)}function $u(e,t){B(e.h,t)||e.h.push(t),e.f||function(e){return e.b.get(Qu,e.a).then((function(e){return"pending"==e}))}(e.g).then((function(t){t?Gu(e.g).then((function(){Xu(e).s((function(t){var n=new bo("unknown",null,null,null,new Xr("operation-not-supported-in-this-environment"));rl(t)&&e.o(n)}))})):Ju(e)})).s((function(){Ju(e)}))}function Zu(e,t){W(e.h,(function(e){return e==t}))}Ku.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=Yu(this.B,this.u,this.m),this.i={}},Ku.prototype.o=function(e){if(!e)throw new Xr("invalid-auth-event");if(6e5<=E()-this.v&&(this.i={},this.v=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.v=E())),t=!0;break}}return ll(this.b),t};var el=new Nr(2e3,1e4),tl=new Nr(3e4,6e4);function nl(e,t,n,r,i,o,a){return e.a.Db(t,n,r,(function(){e.f||(e.f=!0,e.a.Aa(e.l))}),(function(){e.reset()}),i,o,a)}function rl(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function il(e,t,n,r,i){var o;return function(e){return e.b.set(Qu,"pending",e.a)}(e.g).then((function(){return e.a.Eb(t,n,r,i).s((function(t){if(rl(t))throw new Xr("operation-not-supported-in-this-environment");return o=t,Gu(e.g).then((function(){throw o}))})).then((function(){return e.a.Rb()?new We((function(){})):Gu(e.g).then((function(){return e.oa()})).then((function(){})).s((function(){}))}))}))}function ol(e,t,n,r,i){return e.a.Fb(r,(function(e){t.ja(n,null,e,i)}),el.get())}Ku.prototype.oa=function(){return this.b.oa()};var al={};function sl(e,t,n){var r=t+":"+n;return al[r]||(al[r]=new Ku(e,t,n)),al[r]}function ul(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function ll(e){e.g||(e.g=!0,fl(e,!1,null,null))}function cl(e){e.g&&!e.i&&fl(e,!1,null,null)}function hl(e,t){if(e.b=function(){return Xe(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function fl(e,t,n,r){t?r?function(e,t){if(e.b=function(){return Je(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):hl(e,n):hl(e,{user:null}),e.f=[],e.c=[]}function dl(){}function pl(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(e){this.vb=e},enumerable:!1})}function vl(e,t){this.a=t,Fr(this,"verificationId",e)}function gl(e,t,n,r){return new go(e).Wa(t,n).then((function(e){return new vl(e,r)}))}function yl(e){var t=Ei(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new Xr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Vr(this,{token:e,expirationTime:xr(1e3*t.exp),authTime:xr(1e3*t.auth_time),issuedAtTime:xr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,claims:t})}function ml(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function _l(e){this.f=e,this.b=this.a=null,this.c=0}function bl(e,t){var n=t[Na],r=t.refreshToken;t=wl(t.expiresIn),e.b=n,e.c=t,e.a=r}function wl(e){return E()+1e3*parseInt(e,10)}function Cl(e,t){this.a=e||null,this.b=t||null,Vr(this,{lastSignInTime:xr(t||null),creationTime:xr(e||null)})}function kl(e,t,n,r,i,o){Vr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function El(e,t){for(var n in Pt.call(this,e),t)this[n]=t[n]}function Sl(e,t,n){this.I=[],this.l=e.apiKey,this.m=e.appName,this.o=e.authDomain||null,e=Kv.a.SDK_VERSION?vr(Kv.a.SDK_VERSION):null,this.a=new Ia(this.l,Ii(Si),e),this.b=new _l(this.a),Rl(this,t[Na]),bl(this.b,t),Fr(this,"refreshToken",this.b.a),Ml(this,n||{}),on.call(this),this.J=!1,this.o&&_r()&&(this.i=sl(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(e){return new ml((function(){return e.G(!0)}),(function(e){return!(!e||"auth/network-request-failed"!=e.code)}),(function(){var t=e.b.c-E()-3e5;return 0<t?t:0}))}(this),this.W=C(this.Ja,this);var r=this;this.ga=null,this.xa=function(e){r.ua(e.g)},this.Z=null,this.P=[],this.wa=function(e){Il(r,e.c)},this.Y=null}function Tl(e,t){e.Z&&Yt(e.Z,"languageCodeChanged",e.xa),(e.Z=t)&&Qt(t,"languageCodeChanged",e.xa)}function Il(e,t){e.P=t,Ma(e.a,Kv.a.SDK_VERSION?vr(Kv.a.SDK_VERSION,e.P):null)}function Al(e,t){e.Y&&Yt(e.Y,"frameworkChanged",e.wa),(e.Y=t)&&Qt(t,"frameworkChanged",e.wa)}function Nl(e){try{return Kv.a.app(e.m).auth()}catch(t){throw new Xr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function Dl(e){e.B||e.w.b||(e.w.start(),Yt(e,"tokenChanged",e.W),Qt(e,"tokenChanged",e.W))}function xl(e){Yt(e,"tokenChanged",e.W),e.w.stop()}function Rl(e,t){e.ma=t,Fr(e,"_lat",t)}function Ol(e){for(var t=[],n=0;n<e.O.length;n++)t.push(e.O[n](e));return Ze(t).then((function(){return e}))}function Pl(e){e.i&&!e.J&&(e.J=!0,$u(e.i,e))}function Ml(e,t){Vr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new Cl(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function Ll(){}function Fl(e){return Xe().then((function(){if(e.B)throw new Xr("app-deleted")}))}function Vl(e){return U(e.providerData,(function(e){return e.providerId}))}function Ul(e,t){t&&(ql(e,t.providerId),e.providerData.push(t))}function ql(e,t){W(e.providerData,(function(e){return e.providerId==t}))}function Bl(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Fr(e,t,n)}function jl(e,t){e!=t&&(Vr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),Fr(e,"metadata",t.metadata?function(e){return new Cl(e.a,e.b)}(t.metadata):new Cl),V(t.providerData,(function(t){Ul(e,t)})),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.b,t.b),Fr(e,"refreshToken",e.b.a))}function Wl(e){return e.G().then((function(t){var n=e.isAnonymous;return function(e,t){return Es(e.a,os,{idToken:t}).then(C(e.zc,e))}(e,t).then((function(){return n||Bl(e,"isAnonymous",!1),t}))}))}function Hl(e,t){t[Na]&&e.ma!=t[Na]&&(bl(e.b,t),e.dispatchEvent(new El("tokenChanged")),Rl(e,t[Na]),Bl(e,"refreshToken",e.b.a))}function zl(e,t){return Wl(e).then((function(){if(B(Vl(e),t))return Ol(e).then((function(){throw new Xr("provider-already-linked")}))}))}function Ql(e,t,n){return Ur({user:e,credential:mo(t),additionalUserInfo:t=Ri(t),operationType:n})}function Gl(e,t){return Hl(e,t),e.reload().then((function(){return e}))}function Kl(e,t,n,r,i){if(!_r())return Je(new Xr("operation-not-supported-in-this-environment"));if(e.h&&!i)return Je(e.h);var o=xi(n.providerId),a=Tr(e.uid+":::"),s=null;(!Cr()||sr())&&e.o&&n.isOAuthProvider&&(s=Us(e.o,e.l,e.m,t,n,null,a,Kv.a.SDK_VERSION||null,null,null,e.tenantId));var u=nr(s,o&&o.sa,o&&o.ra);return r=r().then((function(){if(Xl(e),!i)return e.G().then((function(){}))})).then((function(){return nl(e.i,u,t,n,a,!!s,e.tenantId)})).then((function(){return new We((function(n,r){e.ja(t,null,new Xr("cancelled-popup-request"),e.g||null),e.f=n,e.v=r,e.g=a,e.c=ol(e.i,e,t,u,a)}))})).then((function(e){return u&&tr(u),e?Ur(e):null})).s((function(e){throw u&&tr(u),e})),Jl(e,r,i)}function Yl(e,t,n,r,i){if(!_r())return Je(new Xr("operation-not-supported-in-this-environment"));if(e.h&&!i)return Je(e.h);var o=null,a=Tr(e.uid+":::");return r=r().then((function(){if(Xl(e),!i)return e.G().then((function(){}))})).then((function(){return e.ca=a,Ol(e)})).then((function(t){return e.da&&(t=(t=e.da).b.set(ec,e.A(),t.a)),t})).then((function(){return il(e.i,t,n,a,e.tenantId)})).s((function(t){if(o=t,e.da)return tc(e.da);throw o})).then((function(){if(o)throw o})),Jl(e,r,i)}function Xl(e){if(!e.i||!e.J){if(e.i&&!e.J)throw new Xr("internal-error");throw new Xr("auth-domain-config-required")}}function Jl(e,t,n){var r=function(e,t,n){return e.h&&!n?(t.cancel(),Je(e.h)):t.s((function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.h||e.dispatchEvent(new El("userInvalidated")),e.h=t),t}))}(e,t,n);return e.I.push(r),r.ka((function(){j(e.I,r)})),r}function $l(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.expirationTime))return null;n[Na]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null,n.expiresIn=(e.stsTokenManager.expirationTime-E())/1e3;var r=new Sl(t,n,e);return e.providerData&&V(e.providerData,(function(e){e&&Ul(r,Ur(e))})),e.redirectEventId&&(r.ca=e.redirectEventId),r}function Zl(e){this.a=e,this.b=bu()}ul.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},ul.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(fl(this,!0,null,e.a),Xe()):t.Ba(n,r)?function(e,t,n){n=n.Ba(t.c,t.b);var r=t.g,i=t.f,o=t.i,a=t.R(),s=!!t.c.match(/Redirect$/);n(r,i,a,o).then((function(t){fl(e,s,t,null)})).s((function(t){fl(e,s,null,t)}))}(this,e,t):Je(new Xr("invalid-auth-event")):(fl(this,!1,null,null),Xe())}else Je(new Xr("invalid-auth-event"))},ul.prototype.oa=function(){var e=this;return new We((function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new Xr("timeout");e.a&&e.a.cancel(),e.a=cn(tl.get()).then((function(){e.b||(e.g=!0,fl(e,!0,null,t))}))}(e))}))},dl.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.ja(e.c,null,e.a,e.b),Xe()):t.Ba(n,r)?function(e,t){var n=e.b,r=e.c;t.Ba(r,n)(e.g,e.f,e.R(),e.i).then((function(e){t.ja(r,e,null,n)})).s((function(e){t.ja(r,null,e,n)}))}(e,t):Je(new Xr("invalid-auth-event"))}else Je(new Xr("invalid-auth-event"))},vl.prototype.confirm=function(e){return e=yo(this.verificationId,e),this.a(e)},ml.prototype.start=function(){this.a=this.c,function e(t,n){t.stop(),t.b=cn(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(t,n)).then((function(){return function(){var e=a.document,t=null;return Dr()||!e?Xe():new We((function(n){t=function(){Dr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)})).s((function(n){throw e.removeEventListener("visibilitychange",t,!1),n}))}()})).then((function(){return t.h()})).then((function(){e(t,!0)})).s((function(n){t.i(n)&&e(t,!1)}))}(this,!0)},ml.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},_l.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},_l.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Je(new Xr("user-token-expired")):e||!this.b||E()>this.c-3e4?this.a?function(e,t){return function(e,t){return new We((function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?La(e,e.l+"?key="+encodeURIComponent(e.c),(function(e){e?e.error?r(Ts(e)):e.access_token&&e.refresh_token?n(e):r(new Xr("internal-error")):r(new Xr("network-request-failed"))}),"POST",Mn(t).toString(),e.g,e.u.get()):r(new Xr("internal-error"))}))}(e.f,t).then((function(t){return e.b=t.access_token,e.c=wl(t.expires_in),e.a=t.refresh_token,{accessToken:e.b,expirationTime:e.c,refreshToken:e.a}})).s((function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Xe(null):Xe({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Cl.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(El,Pt),S(Sl,on),Sl.prototype.ua=function(e){this.ga=e,Pa(this.a,e)},Sl.prototype.ha=function(){return this.ga},Sl.prototype.Ca=function(){return z(this.P)},Sl.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},Fr(Sl.prototype,"providerId","firebase"),(e=Sl.prototype).reload=function(){var e=this;return Jl(this,Fl(this).then((function(){return Wl(e).then((function(){return Ol(e)})).then(Ll)})))},e.dc=function(e){return this.G(e).then((function(e){return new yl(e)}))},e.G=function(e){var t=this;return Jl(this,Fl(this).then((function(){return t.b.getToken(e)})).then((function(e){if(!e)throw new Xr("internal-error");return e.accessToken!=t.ma&&(Rl(t,e.accessToken),t.dispatchEvent(new El("tokenChanged"))),Bl(t,"refreshToken",e.refreshToken),e.accessToken})))},e.zc=function(e){if(!(e=e.users)||!e.length)throw new Xr("internal-error");Ml(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?U(e,(function(e){return new kl(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)})):[]}(e),n=0;n<t.length;n++)Ul(this,t[n]);Bl(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length))},e.Ac=function(e){return Mr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(e)},e.hb=function(e){var t=this,n=null;return Jl(this,e.f(this.a,this.uid).then((function(e){return Hl(t,e),n=Ql(t,e,"reauthenticate"),t.h=null,t.reload()})).then((function(){return n})),!0)},e.rc=function(e){return Mr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(e)},e.fb=function(e){var t=this,n=null;return Jl(this,zl(this,e.providerId).then((function(){return t.G()})).then((function(n){return e.b(t.a,n)})).then((function(e){return n=Ql(t,e,"link"),Gl(t,e)})).then((function(){return n})))},e.sc=function(e,t){var n=this;return Jl(this,zl(this,"phone").then((function(){return gl(Nl(n),e,t,C(n.fb,n))})))},e.Bc=function(e,t){var n=this;return Jl(this,Xe().then((function(){return gl(Nl(n),e,t,C(n.hb,n))})),!0)},e.rb=function(e){var t=this;return Jl(this,this.G().then((function(n){return t.a.rb(n,e)})).then((function(e){return Hl(t,e),t.reload()})))},e.Sc=function(e){var t=this;return Jl(this,this.G().then((function(n){return e.b(t.a,n)})).then((function(e){return Hl(t,e),t.reload()})))},e.sb=function(e){var t=this;return Jl(this,this.G().then((function(n){return t.a.sb(n,e)})).then((function(e){return Hl(t,e),t.reload()})))},e.tb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Fl(this);var t=this;return Jl(this,this.G().then((function(n){return t.a.tb(n,{displayName:e.displayName,photoUrl:e.photoURL})})).then((function(e){return Hl(t,e),Bl(t,"displayName",e.displayName||null),Bl(t,"photoURL",e.photoUrl||null),V(t.providerData,(function(e){"password"===e.providerId&&(Fr(e,"displayName",t.displayName),Fr(e,"photoURL",t.photoURL))})),Ol(t)})).then(Ll))},e.Qc=function(e){var t=this;return Jl(this,Wl(this).then((function(n){return B(Vl(t),e)?function(e,t,n){return Es(e,ns,{idToken:t,deleteProvider:n})}(t.a,n,[e]).then((function(e){var n={};return V(e.providerUserInfo||[],(function(e){n[e.providerId]=!0})),V(Vl(t),(function(e){n[e]||ql(t,e)})),n[go.PROVIDER_ID]||Fr(t,"phoneNumber",null),Ol(t)})):Ol(t).then((function(){throw new Xr("no-such-provider")}))})))},e.delete=function(){var e=this;return Jl(this,this.G().then((function(t){return Es(e.a,ts,{idToken:t})})).then((function(){e.dispatchEvent(new El("userDeleted"))}))).then((function(){for(var t=0;t<e.I.length;t++)e.I[t].cancel("app-deleted");Tl(e,null),Al(e,null),e.I=[],e.B=!0,xl(e),Fr(e,"refreshToken",null),e.i&&Zu(e.i,e)}))},e.xb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.ca||null)==t||"reauthViaRedirect"==e&&(this.ca||null)==t)},e.ja=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?C(this.Bb,this):"reauthViaPopup"==e&&t==(this.g||null)?C(this.Cb,this):"linkViaRedirect"==e&&(this.ca||null)==t?C(this.Bb,this):"reauthViaRedirect"==e&&(this.ca||null)==t?C(this.Cb,this):null},e.tc=function(e){var t=this;return Kl(this,"linkViaPopup",e,(function(){return zl(t,e.providerId).then((function(){return Ol(t)}))}),!1)},e.Cc=function(e){return Kl(this,"reauthViaPopup",e,(function(){return Xe()}),!0)},e.uc=function(e){var t=this;return Yl(this,"linkViaRedirect",e,(function(){return zl(t,e.providerId)}),!1)},e.Dc=function(e){return Yl(this,"reauthViaRedirect",e,(function(){return Xe()}),!0)},e.Bb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,this.G().then((function(n){return Ka(i.a,{requestUri:e,postBody:r,sessionId:t,idToken:n})})).then((function(e){return o=Ql(i,e,"link"),Gl(i,e)})).then((function(){return o})))},e.Cb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,Xe().then((function(){return Wi(Ya(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)})).then((function(e){return o=Ql(i,e,"reauthenticate"),Hl(i,e),i.h=null,i.reload()})).then((function(){return o})),!0)},e.jb=function(e){var t=this,n=null;return Jl(this,this.G().then((function(t){return n=t,void 0===e||G(e)?{}:_i(new li(e))})).then((function(e){return t.a.jb(n,e)})).then((function(e){if(t.email!=e)return t.reload()})).then((function(){})))},e.toJSON=function(){return this.A()},e.A=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&X(e,this.metadata.A()),V(this.providerData,(function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))})),e};var ec={name:"redirectUser",C:"session"};function tc(e){return ku(e.b,ec,e.a)}function nc(e){this.a=e,this.b=bu(),this.c=null,this.f=function(e){var t=oc("local"),n=oc("session"),r=oc("none");return function(e,t,n){var r=Cu(t,n),i=wu(e,t.C);return e.get(t,n).then((function(o){var s=null;try{s=Sr(a.localStorage.getItem(r))}catch(u){}if(s&&!o)return a.localStorage.removeItem(r),e.set(t,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)}))}(e.b,t,e.a).then((function(){return e.b.get(n,e.a)})).then((function(i){return i?n:e.b.get(r,e.a).then((function(n){return n?r:e.b.get(t,e.a).then((function(n){return n?t:e.b.get(ic,e.a).then((function(e){return e?oc(e):t}))}))}))})).then((function(t){return e.c=t,rc(e,t.C)})).s((function(){e.c||(e.c=t)}))}(this),this.b.addListener(oc("local"),this.a,C(this.g,this))}function rc(e,t){var n,r=[];for(n in mu)mu[n]!==t&&r.push(ku(e.b,oc(mu[n]),e.a));return r.push(ku(e.b,ic,e.a)),function(e){return new We((function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},a=function(e){n(e)},s=0;s<e.length;s++)$e(e[s],k(o,s),a);else t(i)}))}(r)}nc.prototype.g=function(){var e=this,t=oc("local");lc(this,(function(){return Xe().then((function(){return e.c&&"local"!=e.c.C?e.b.get(t,e.a):null})).then((function(n){if(n)return rc(e,"local").then((function(){e.c=t}))}))}))};var ic={name:"persistence",C:"session"};function oc(e){return{name:"authUser",C:e}}function ac(e,t){return lc(e,(function(){return e.b.set(e.c,t.A(),e.a)}))}function sc(e){return lc(e,(function(){return ku(e.b,e.c,e.a)}))}function uc(e,t){return lc(e,(function(){return e.b.get(e.c,e.a).then((function(e){return e&&t&&(e.authDomain=t),$l(e||{})}))}))}function lc(e,t){return e.f=e.f.then(t,t),e.f}function cc(e){if(this.l=!1,Fr(this,"settings",new pl),Fr(this,"app",e),!mc(this).options||!mc(this).options.apiKey)throw new Xr("invalid-api-key");e=Kv.a.SDK_VERSION?vr(Kv.a.SDK_VERSION):null,this.b=new Ia(mc(this).options&&mc(this).options.apiKey,Ii(Si),e),this.O=[],this.m=[],this.J=[],this.Ub=Kv.a.INTERNAL.createSubscribe(C(this.oc,this)),this.W=void 0,this.Vb=Kv.a.INTERNAL.createSubscribe(C(this.pc,this)),gc(this,null),this.h=new nc(mc(this).options.apiKey+":"+mc(this).name),this.w=new Zl(mc(this).options.apiKey+":"+mc(this).name),this.Y=Cc(this,function(e){var t=mc(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get(ec,e.a).then((function(e){return e&&t&&(e.authDomain=t),$l(e||{})}))}(e.w,mc(e).options.authDomain).then((function(t){return(e.B=t)&&(t.da=e.w),tc(e.w)}));return Cc(e,t)}(e).then((function(){return uc(e.h,t)})).then((function(t){return t?(t.da=e.w,e.B&&(e.B.ca||null)==(t.ca||null)?t:t.reload().then((function(){return ac(e.h,t).then((function(){return t}))})).s((function(n){return"auth/network-request-failed"==n.code?t:sc(e.h)}))):null})).then((function(t){gc(e,t||null)}));return Cc(e,n)}(this)),this.i=Cc(this,function(e){return e.Y.then((function(){return pc(e)})).s((function(){})).then((function(){if(!e.l)return e.ma()})).s((function(){})).then((function(){if(!e.l){e.ga=!0;var t=e.h;t.b.addListener(oc("local"),t.a,e.ma)}}))}(this)),this.ga=!1,this.ma=C(this.Nc,this),this.ub=C(this.aa,this),this.wa=C(this.bc,this),this.xa=C(this.mc,this),this.Ja=C(this.nc,this),this.a=null,function(e){var t=mc(e).options.authDomain,n=mc(e).options.apiKey;t&&_r()&&(e.Tb=e.Y.then((function(){if(!e.l){if(e.a=sl(t,n,mc(e).name),$u(e.a,e),_c(e)&&Pl(_c(e)),e.B){Pl(e.B);var r=e.B;r.ua(e.ha()),Tl(r,e),Il(r=e.B,e.I),Al(r,e),e.B=null}return e.a}})))}(this),this.INTERNAL={},this.INTERNAL.delete=C(this.delete,this),this.INTERNAL.logFramework=C(this.vc,this),this.o=0,on.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.ha()},set:function(e){this.ua(e)},enumerable:!1}),e.Z=null,Object.defineProperty(e,"ti",{get:function(){return this.R()},set:function(e){this.nb(e)},enumerable:!1}),e.P=null}(this),this.I=[]}function hc(e){Pt.call(this,"languageCodeChanged"),this.g=e}function fc(e){Pt.call(this,"frameworkChanged"),this.c=e}function dc(e){return e.Tb||Je(new Xr("auth-domain-config-required"))}function pc(e){if(!_r())return Je(new Xr("operation-not-supported-in-this-environment"));var t=dc(e).then((function(){return e.a.oa()})).then((function(e){return e?Ur(e):null}));return Cc(e,t)}function vc(e,t){var n={};return n.apiKey=mc(e).options.apiKey,n.authDomain=mc(e).options.authDomain,n.appName=mc(e).name,e.Y.then((function(){return function(e,t,n,r){var i=new Sl(e,t);return n&&(i.da=n),r&&Il(i,r),i.reload().then((function(){return i}))}(n,t,e.w,e.Ca())})).then((function(t){return _c(e)&&t.uid==_c(e).uid?(jl(_c(e),t),e.aa(t)):(gc(e,t),Pl(t),e.aa(t))})).then((function(){wc(e)}))}function gc(e,t){_c(e)&&(function(e,t){W(e.O,(function(e){return e==t}))}(_c(e),e.ub),Yt(_c(e),"tokenChanged",e.wa),Yt(_c(e),"userDeleted",e.xa),Yt(_c(e),"userInvalidated",e.Ja),xl(_c(e))),t&&(t.O.push(e.ub),Qt(t,"tokenChanged",e.wa),Qt(t,"userDeleted",e.xa),Qt(t,"userInvalidated",e.Ja),0<e.o&&Dl(t)),Fr(e,"currentUser",t),t&&(t.ua(e.ha()),Tl(t,e),Il(t,e.I),Al(t,e))}function yc(e,t){var n=null,r=null;return Cc(e,t.then((function(t){return n=mo(t),r=Ri(t),vc(e,t)})).then((function(){return Ur({user:_c(e),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function mc(e){return e.app}function _c(e){return e.currentUser}function bc(e){return _c(e)&&_c(e)._lat||null}function wc(e){if(e.ga){for(var t=0;t<e.m.length;t++)e.m[t]&&e.m[t](bc(e));if(e.W!==e.getUid()&&e.J.length)for(e.W=e.getUid(),t=0;t<e.J.length;t++)e.J[t]&&e.J[t](bc(e))}}function Cc(e,t){return e.O.push(t),t.ka((function(){j(e.O,t)})),t}function kc(){}function Ec(){this.a={},this.b=1e12}nc.prototype.mb=function(e){var t=null,n=this;return function(e){var t=new Xr("invalid-persistence-type"),n=new Xr("unsupported-persistence-type");e:{for(r in mu)if(mu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(lr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;default:if(!mr()&&"none"!==e)throw n}}(e),lc(this,(function(){return e!=n.c.C?n.b.get(n.c,n.a).then((function(r){return t=r,rc(n,e)})).then((function(){if(n.c=oc(e),t)return n.b.set(n.c,t,n.a)})):Xe()}))},S(cc,on),S(hc,Pt),S(fc,Pt),(e=cc.prototype).mb=function(e){return Cc(this,e=this.h.mb(e))},e.ua=function(e){this.Z===e||this.l||(this.Z=e,Pa(this.b,this.Z),this.dispatchEvent(new hc(this.ha())))},e.ha=function(){return this.Z},e.Tc=function(){var e=a.navigator;this.ua(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.vc=function(e){this.I.push(e),Ma(this.b,Kv.a.SDK_VERSION?vr(Kv.a.SDK_VERSION,this.I):null),this.dispatchEvent(new fc(this.I))},e.Ca=function(){return z(this.I)},e.nb=function(e){this.P===e||this.l||(this.P=e,this.b.b=this.P)},e.R=function(){return this.P},e.toJSON=function(){return{apiKey:mc(this).options.apiKey,authDomain:mc(this).options.authDomain,appName:mc(this).name,currentUser:_c(this)&&_c(this).A()}},e.xb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},e.ja=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.Ba=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?C(this.ac,this):null},e.ac=function(e,t,n,r){var i=this;e={requestUri:e,postBody:r,sessionId:t,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=Ga(i.b,e).then((function(e){return o=mo(e),a=Ri(e),e}));return Cc(this,e=i.Y.then((function(){return s})).then((function(e){return vc(i,e)})).then((function(){return Ur({user:_c(i),credential:o,additionalUserInfo:a,operationType:"signIn"})})))},e.Lc=function(e){if(!_r())return Je(new Xr("operation-not-supported-in-this-environment"));var t=this,n=xi(e.providerId),r=Tr(),i=null;(!Cr()||sr())&&mc(this).options.authDomain&&e.isOAuthProvider&&(i=Us(mc(this).options.authDomain,mc(this).options.apiKey,mc(this).name,"signInViaPopup",e,null,r,Kv.a.SDK_VERSION||null,null,null,this.R()));var o=nr(i,n&&n.sa,n&&n.ra);return Cc(this,n=dc(this).then((function(n){return nl(n,o,"signInViaPopup",e,r,!!i,t.R())})).then((function(){return new We((function(e,n){t.ja("signInViaPopup",null,new Xr("cancelled-popup-request"),t.g),t.f=e,t.v=n,t.g=r,t.c=ol(t.a,t,"signInViaPopup",o,r)}))})).then((function(e){return o&&tr(o),e?Ur(e):null})).s((function(e){throw o&&tr(o),e})))},e.Mc=function(e){if(!_r())return Je(new Xr("operation-not-supported-in-this-environment"));var t=this;return Cc(this,dc(this).then((function(){return function(e){return lc(e,(function(){return e.b.set(ic,e.c.C,e.a)}))}(t.h)})).then((function(){return il(t.a,"signInViaRedirect",e,void 0,t.R())})))},e.oa=function(){var e=this;return pc(this).then((function(t){return e.a&&cl(e.a.b),t})).s((function(t){throw e.a&&cl(e.a.b),t}))},e.Rc=function(e){if(!e)return Je(new Xr("null-user"));if(this.P!=e.tenantId)return Je(new Xr("tenant-id-mismatch"));var t=this,n={};n.apiKey=mc(this).options.apiKey,n.authDomain=mc(this).options.authDomain,n.appName=mc(this).name;var r=function(e,t,n,r){t=t||{apiKey:e.l,authDomain:e.o,appName:e.m};var i=e.b,o={};return o[Na]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-E())/1e3,t=new Sl(t,o),n&&(t.da=n),r&&Il(t,r),jl(t,e),t}(e,n,t.w,t.Ca());return Cc(this,this.i.then((function(){if(mc(t).options.apiKey!=e.l)return r.reload()})).then((function(){return _c(t)&&e.uid==_c(t).uid?(jl(_c(t),e),t.aa(e)):(gc(t,r),Pl(r),t.aa(r))})).then((function(){wc(t)})))},e.pb=function(){var e=this;return Cc(this,this.i.then((function(){return e.a&&cl(e.a.b),_c(e)?(gc(e,null),sc(e.h).then((function(){wc(e)}))):Xe()})))},e.Nc=function(){var e=this;return uc(this.h,mc(this).options.authDomain).then((function(t){if(!e.l){var n;if(n=_c(e)&&t){n=_c(e).uid;var r=t.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return jl(_c(e),t),_c(e).G();(_c(e)||t)&&(gc(e,t),t&&(Pl(t),t.da=e.w),e.a&&$u(e.a,e),wc(e))}}))},e.aa=function(e){return ac(this.h,e)},e.bc=function(){wc(this),this.aa(_c(this))},e.mc=function(){this.pb()},e.nc=function(){this.pb()},e.oc=function(e){var t=this;this.addAuthTokenListener((function(){e.next(_c(t))}))},e.pc=function(e){var t=this;!function(e,t){e.J.push(t),Cc(e,e.i.then((function(){!e.l&&B(e.J,t)&&e.W!==e.getUid()&&(e.W=e.getUid(),t(bc(e)))})))}(this,(function(){e.next(_c(t))}))},e.xc=function(e,t,n){var r=this;return this.ga&&Promise.resolve().then((function(){g(e)?e(_c(r)):g(e.next)&&e.next(_c(r))})),this.Ub(e,t,n)},e.wc=function(e,t,n){var r=this;return this.ga&&Promise.resolve().then((function(){r.W=r.getUid(),g(e)?e(_c(r)):g(e.next)&&e.next(_c(r))})),this.Vb(e,t,n)},e.cc=function(e){var t=this;return Cc(this,this.i.then((function(){return _c(t)?_c(t).G(e).then((function(e){return{accessToken:e}})):null})))},e.Hc=function(e){var t=this;return this.i.then((function(){return yc(t,Es(t.b,_s,{token:e}))})).then((function(e){var n=e.user;return Bl(n,"isAnonymous",!1),t.aa(n),e}))},e.Ic=function(e,t){var n=this;return this.i.then((function(){return yc(n,Es(n.b,bs,{email:e,password:t}))}))},e.Xb=function(e,t){var n=this;return this.i.then((function(){return yc(n,Es(n.b,Za,{email:e,password:t}))}))},e.Sa=function(e){var t=this;return this.i.then((function(){return yc(t,e.na(t.b))}))},e.Gc=function(e){return Mr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(e)},e.ob=function(){var e=this;return this.i.then((function(){var t=_c(e);if(t&&t.isAnonymous){var n=Ur({providerId:null,isNewUser:!1});return Ur({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return yc(e,e.b.ob()).then((function(t){var n=t.user;return Bl(n,"isAnonymous",!0),e.aa(n),t}))}))},e.getUid=function(){return _c(this)&&_c(this).uid||null},e.Wb=function(e){this.addAuthTokenListener(e),this.o++,0<this.o&&_c(this)&&Dl(_c(this))},e.Ec=function(e){var t=this;V(this.m,(function(n){n==e&&t.o--})),0>this.o&&(this.o=0),0==this.o&&_c(this)&&xl(_c(this)),this.removeAuthTokenListener(e)},e.addAuthTokenListener=function(e){var t=this;this.m.push(e),Cc(this,this.i.then((function(){t.l||B(t.m,e)&&e(bc(t))})))},e.removeAuthTokenListener=function(e){W(this.m,(function(t){return t==e}))},e.delete=function(){this.l=!0;for(var e=0;e<this.O.length;e++)this.O[e].cancel("app-deleted");return this.O=[],this.h&&(e=this.h).b.removeListener(oc("local"),e.a,this.ma),this.a&&(Zu(this.a,this),cl(this.a.b)),Promise.resolve()},e.$b=function(e){return Cc(this,function(e,t){return Es(e,es,{identifier:t,continueUri:br()?$n():"http://localhost"}).then((function(e){return e.signinMethods||[]}))}(this.b,e))},e.qc=function(e){return!!ho(e)},e.lb=function(e,t){var n=this;return Cc(this,Xe().then((function(){var e=new li(t);if(!e.c)throw new Xr("argument-error",fi+" must be true when sending sign in link to email");return _i(e)})).then((function(t){return n.b.lb(e,t)})).then((function(){})))},e.Uc=function(e){return this.Ma(e).then((function(e){return e.data.email}))},e.ab=function(e,t){return Cc(this,this.b.ab(e,t).then((function(){})))},e.Ma=function(e){return Cc(this,this.b.Ma(e).then((function(e){return new Br(e)})))},e.Ya=function(e){return Cc(this,this.b.Ya(e).then((function(){})))},e.kb=function(e,t){var n=this;return Cc(this,Xe().then((function(){return void 0===t||G(t)?{}:_i(new li(t))})).then((function(t){return n.b.kb(e,t)})).then((function(){})))},e.Kc=function(e,t){return Cc(this,gl(this,e,t,C(this.Sa,this)))},e.Jc=function(e,t){var n=this;return Cc(this,Xe().then((function(){var r=t||$n(),i=co(e,r);if(!(r=ho(r)))throw new Xr("argument-error","Invalid email link!");if(r.tenantId!==n.R())throw new Xr("tenant-id-mismatch");return n.Sa(i)})))},kc.prototype.render=function(){},kc.prototype.reset=function(){},kc.prototype.getResponse=function(){},kc.prototype.execute=function(){};var Sc=null;function Tc(e,t){return(t=Ic(t))&&e.a[t]||null}function Ic(e){return(e=void 0===e?1e12:e)?e.toString():null}function Ac(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=jn(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():Qt(this.f,"click",this.i)}function Nc(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function Dc(){}Ec.prototype.render=function(e,t){return this.a[this.b.toString()]=new Ac(e,t),this.b++},Ec.prototype.reset=function(e){var t=Tc(this,e);e=Ic(e),t&&e&&(t.delete(),delete this.a[e])},Ec.prototype.getResponse=function(e){return(e=Tc(this,e))?e.getResponse():null},Ec.prototype.execute=function(e){(e=Tc(this,e))&&e.execute()},Ac.prototype.getResponse=function(){return Nc(this),this.b},Ac.prototype.execute=function(){Nc(this);var e=this;this.a||(this.a=setTimeout((function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(r){}e.a=setTimeout((function(){if(e.a=null,e.b=null,n)try{n()}catch(r){}e.h&&e.execute()}),6e4)}),500))},Ac.prototype.delete=function(){Nc(this),this.g=!0,clearTimeout(this.a),this.a=null,Yt(this.f,"click",this.i)},Dc.prototype.g=function(){return Sc||(Sc=new Ec),Xe(Sc)},Dc.prototype.c=function(){};var xc=null;function Rc(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Oc=new J(ee,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Pc=new Nr(3e4,6e4);Rc.prototype.g=function(e){var t=this;return new We((function(n,r){var i=setTimeout((function(){r(new Xr("network-request-failed"))}),Pc.get());!a.grecaptcha||e!==t.f&&!t.b?(a[t.a]=function(){if(a.grecaptcha){t.f=e;var o=a.grecaptcha.render;a.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new Xr("internal-error"));delete a[t.a]},Xe(ba(ie(Oc,{onload:t.a,hl:e||""}))).s((function(){clearTimeout(i),r(new Xr("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(a.grecaptcha))}))},Rc.prototype.c=function(){this.b--};var Mc=null;function Lc(e,t,n,r,i,o,s){if(Fr(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=t,this.g=null,s?(xc||(xc=new Dc),s=xc):(Mc||(Mc=new Rc),s=Mc),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Uc])throw new Xr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[qc],!a.document)throw new Xr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!jn(t)||!this.i&&jn(t).hasChildNodes())throw new Xr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Ia(e,o||null,i||null),this.v=r||function(){return null};var u=this;this.l=[];var l=this.a[Fc];this.a[Fc]=function(e){if(Bc(u,e),"function"==typeof l)l(e);else if("string"==typeof l){var t=yr(l,a);"function"==typeof t&&t(e)}};var c=this.a[Vc];this.a[Vc]=function(){if(Bc(u,null),"function"==typeof c)c();else if("string"==typeof c){var e=yr(c,a);"function"==typeof e&&e()}}}var Fc="callback",Vc="expired-callback",Uc="sitekey",qc="size";function Bc(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(r){}}function jc(e,t){return e.h.push(t),t.ka((function(){j(e.h,t)})),t}function Wc(e){if(e.B)throw new Xr("internal-error","RecaptchaVerifier instance has been destroyed.")}function Hc(e,t,n){var r=!1;try{this.b=n||Kv.a.app()}catch(a){throw new Xr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Xr("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ca()}catch(a){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=Kv.a.SDK_VERSION?vr(Kv.a.SDK_VERSION,o):null,Lc.call(this,n,e,t,(function(){try{var e=i.b.auth().ha()}catch(t){e=null}return e}),o,Ii(Si),r)}function zc(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new Xr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].N(n[i])&&!o){if(t=t[i],0>i||i>=Qc.length)throw new Xr("internal-error","Argument validator received an unsupported number of arguments.");n=Qc[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.M+".";break e}r=null}}if(r)throw new Xr("argument-error",e+" failed: "+r)}(e=Lc.prototype).Da=function(){var e=this;return this.f?this.f:this.f=jc(this,Xe().then((function(){if(br()&&!ur())return or();throw new Xr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return e.m.g(e.v())})).then((function(t){return e.g=t,Es(e.o,cs,{})})).then((function(t){e.a[Uc]=t.recaptchaSiteKey})).s((function(t){throw e.f=null,t})))},e.render=function(){Wc(this);var e=this;return jc(this,this.Da().then((function(){if(null===e.c){var t=e.u;if(!e.i){var n=jn(t);t=function(e,t,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!Bn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Fe(a.name),'"'),a.type){o.push(' type="',Fe(a.type),'"');var u={};X(u,a),delete u.type,a=u}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(s(a)?o.className=a:p(a)?o.className=a.join(" "):Wn(o,a)),2<r.length&&function(e,t,n){function r(n){n&&t.appendChild(s(n)?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!v(o)||y(o)&&0<o.nodeType?r(o):V(zn(o)?z(o):o,r)}}(i,o,r),o}("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c})))},e.verify=function(){Wc(this);var e=this;return jc(this,this.render().then((function(t){return new We((function(n){var r=e.g.getResponse(t);if(r)n(r);else{e.l.push((function t(r){r&&(function(e,t){W(e.l,(function(e){return e==t}))}(e,t),n(r))})),e.i&&e.g.execute(e.c)}}))})))},e.reset=function(){Wc(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Wc(this),this.B=!0,this.m.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=jn(this.u);for(var t;t=e.firstChild;)e.removeChild(t)}},S(Hc,Lc);var Qc="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Gc(e,t){return{name:e||"",M:"a valid string",optional:!!t,N:s}}function Kc(e,t){return{name:e||"",M:"a boolean",optional:!!t,N:u}}function Yc(e,t){return{name:e||"",M:"a valid object",optional:!!t,N:y}}function Xc(e,t){return{name:e||"",M:"a function",optional:!!t,N:g}}function Jc(e,t){return{name:e||"",M:"null",optional:!!t,N:d}}function $c(e){return{name:e?e+"Credential":"credential",M:e?"a valid "+e+" credential":"a valid credential",optional:!1,N:function(t){return!!t&&!(!t.na||e&&t.providerId!==e)}}}function Zc(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(e){return!!(e&&s(e.type)&&g(e.verify))}}}function eh(e,t,n,r){return{name:n||"",M:e.M+" or "+t.M,optional:!!r,N:function(n){return e.N(n)||t.N(n)}}}function th(e,t){for(var n in t){var r=t[n].name;e[r]=ih(r,e[n],t[n].j)}}function nh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:k((function(e){return this[e]}),n),set:k((function(e,t,n,r){zc(e,[n],[r],!0),this[t]=r}),r,n,t[n].Za),enumerable:!0})}}function rh(e,t,n,r){e[t]=ih(t,n,r)}function ih(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return zc(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}th(cc.prototype,{Ya:{name:"applyActionCode",j:[Gc("code")]},Ma:{name:"checkActionCode",j:[Gc("code")]},ab:{name:"confirmPasswordReset",j:[Gc("code"),Gc("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[Gc("email"),Gc("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[Gc("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[Gc("emailLink")]},wc:{name:"onAuthStateChanged",j:[eh(Yc(),Xc(),"nextOrObserver"),Xc("opt_error",!0),Xc("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[eh(Yc(),Xc(),"nextOrObserver"),Xc("opt_error",!0),Xc("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[Gc("email"),eh(Yc("opt_actionCodeSettings",!0),Jc(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[Gc("email"),Yc("actionCodeSettings")]},mb:{name:"setPersistence",j:[Gc("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[$c()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[$c()]},Hc:{name:"signInWithCustomToken",j:[Gc("token")]},Ic:{name:"signInWithEmailAndPassword",j:[Gc("email"),Gc("password")]},Jc:{name:"signInWithEmailLink",j:[Gc("email"),Gc("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[Gc("phoneNumber"),Zc()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[eh({name:"user",M:"an instance of Firebase User",optional:!1,N:function(e){return!!(e&&e instanceof Sl)}},Jc(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Gc(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[Gc("code")]}}),nh(cc.prototype,{lc:{name:"languageCode",Za:eh(Gc(),Jc(),"languageCode")},ti:{name:"tenantId",Za:eh(Gc(),Jc(),"tenantId")}}),(cc.Persistence=mu).LOCAL="local",cc.Persistence.SESSION="session",cc.Persistence.NONE="none",th(Sl.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[Kc("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[Kc("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[$c()]},fb:{name:"linkWithCredential",j:[$c()]},sc:{name:"linkWithPhoneNumber",j:[Gc("phoneNumber"),Zc()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[$c()]},hb:{name:"reauthenticateWithCredential",j:[$c()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[Gc("phoneNumber"),Zc()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[eh(Yc("opt_actionCodeSettings",!0),Jc(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Gc(null,!0)]},Qc:{name:"unlink",j:[Gc("provider")]},rb:{name:"updateEmail",j:[Gc("email")]},sb:{name:"updatePassword",j:[Gc("password")]},Sc:{name:"updatePhoneNumber",j:[$c("phone")]},tb:{name:"updateProfile",j:[Yc("profile")]}}),th(Ec.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),th(kc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),th(We.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),nh(pl.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:Kc("appVerificationDisabledForTesting")}}),th(vl.prototype,{confirm:{name:"confirm",j:[Gc("verificationCode")]}}),rh(ji,"fromJSON",(function(e){e=s(e)?JSON.parse(e):e;for(var t,n=[Yi,uo,po,Qi],r=0;r<n.length;r++)if(t=n[r](e))return t;return null}),[eh(Gc(),Yc(),"json")]),rh(lo,"credential",(function(e,t){return new so(e,t)}),[Gc("email"),Gc("password")]),th(so.prototype,{A:{name:"toJSON",j:[Gc(null,!0)]}}),th(Zi.prototype,{ya:{name:"addScope",j:[Gc("scope")]},Ga:{name:"setCustomParameters",j:[Yc("customOAuthParameters")]}}),rh(Zi,"credential",eo,[eh(Gc(),Yc(),"token")]),rh(lo,"credentialWithLink",co,[Gc("email"),Gc("emailLink")]),th(to.prototype,{ya:{name:"addScope",j:[Gc("scope")]},Ga:{name:"setCustomParameters",j:[Yc("customOAuthParameters")]}}),rh(to,"credential",no,[eh(Gc(),Yc(),"token")]),th(ro.prototype,{ya:{name:"addScope",j:[Gc("scope")]},Ga:{name:"setCustomParameters",j:[Yc("customOAuthParameters")]}}),rh(ro,"credential",io,[eh(Gc(),eh(Yc(),Jc()),"idToken"),eh(Gc(),Jc(),"accessToken",!0)]),th(oo.prototype,{Ga:{name:"setCustomParameters",j:[Yc("customOAuthParameters")]}}),rh(oo,"credential",ao,[eh(Gc(),Yc(),"token"),Gc("secret",!0)]),th($i.prototype,{ya:{name:"addScope",j:[Gc("scope")]},credential:{name:"credential",j:[eh(Gc(),eh(Yc(),Jc()),"optionsOrIdToken"),eh(Gc(),Jc(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[Yc("customOAuthParameters")]}}),th(Gi.prototype,{A:{name:"toJSON",j:[Gc(null,!0)]}}),th(Hi.prototype,{A:{name:"toJSON",j:[Gc(null,!0)]}}),rh(go,"credential",yo,[Gc("verificationId"),Gc("verificationCode")]),th(go.prototype,{Wa:{name:"verifyPhoneNumber",j:[Gc("phoneNumber"),Zc()]}}),th(fo.prototype,{A:{name:"toJSON",j:[Gc(null,!0)]}}),th(Xr.prototype,{toJSON:{name:"toJSON",j:[Gc(null,!0)]}}),th(To.prototype,{toJSON:{name:"toJSON",j:[Gc(null,!0)]}}),th(So.prototype,{toJSON:{name:"toJSON",j:[Gc(null,!0)]}}),th(Hc.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),rh(ei,"parseLink",ui,[Gc("link")]),function(){if(void 0===Kv.a||!Kv.a.INTERNAL||!Kv.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:jr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:cc,AuthCredential:ji,Error:Xr};rh(e,"EmailAuthProvider",lo,[]),rh(e,"FacebookAuthProvider",Zi,[]),rh(e,"GithubAuthProvider",to,[]),rh(e,"GoogleAuthProvider",ro,[]),rh(e,"TwitterAuthProvider",oo,[]),rh(e,"OAuthProvider",$i,[Gc("providerId")]),rh(e,"SAMLAuthProvider",Ji,[Gc("providerId")]),rh(e,"PhoneAuthProvider",go,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(e){return!!(e&&e instanceof cc)}}]),rh(e,"RecaptchaVerifier",Hc,[eh(Gc(),{name:"",M:"an HTML element",optional:!1,N:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Yc("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(e){return!!(e&&e instanceof Kv.a.app.App)}}]),rh(e,"ActionCodeURL",ei,[]),Kv.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new cc(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),Kv.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:C((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:C(e.cc,e),addAuthTokenListener:C(e.Wb,e),removeAuthTokenListener:C(e.Ec,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),Kv.a.registerVersion("@firebase/auth","0.13.3"),Kv.a.INTERNAL.extendNamespace({User:Sl})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Yv,Xv=function e(){_classCallCheck(this,e)};n("6Joi");var Jv=Yv=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"enablePersistence",value:function(e){return{ngModule:Yv,providers:[{provide:gd,useValue:!0},{provide:yd,useValue:e}]}}}]),e}();function $v(e){return null==e}function Zv(e){return"function"==typeof e.set}function eg(e,t){return Zv(t)?t:e.ref(t)}function tg(e,t){if("string"==typeof e)return t.stringCase();if(Zv(e))return t.firebaseCase();if("function"==typeof e.exportVal)return t.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: ".concat(typeof e))}var ng,rg=new Jf(Kf),ig=((ng=function(){function e(t,n,r){_classCallCheck(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return _createClass(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Js(this.value);case"E":return e=this.error,new k((function(t){return t.error(e)}));case"C":return Ys()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new ng("C"),ng.undefinedValueNotification=new ng("N",void 0),ng),og=function(){function e(t,n){_classCallCheck(this,e),this.delay=t,this.scheduler=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ag(e,this.delay,this.scheduler))}}]),e}(),ag=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return _inherits(t,e),_createClass(t,[{key:"_schedule",value:function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}},{key:"scheduleNotification",value:function(e){if(!0!==this.errored){var t=this.scheduler,n=new sg(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}}},{key:"_next",value:function(e){this.scheduleNotification(ig.createNext(e))}},{key:"_error",value:function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleNotification(ig.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1}}]),t}(g),sg=function e(t,n){_classCallCheck(this,e),this.time=t,this.notification=n};function ug(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"on";return new k((function(r){var i=e[n](t,(function(e,t){r.next({snapshot:e,prevKey:t}),"once"==n&&r.complete()}),r.error.bind(r));return"on"==n?{unsubscribe:function(){e.off(t,i)}}:{unsubscribe:function(){}}})).pipe(H((function(e){var n=e.snapshot,r=e.prevKey,i=null;return n.exists()&&(i=n.key),{type:t,payload:n,prevKey:r,key:i}})),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rg,r=(t=e)instanceof Date&&!isNaN(+t)?+e-n.now():Math.abs(e);return function(e){return e.lift(new og(r,n))}}(0),ue())}var lg=function(){function e(t,n){_classCallCheck(this,e),this.compare=t,this.keySelector=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new cg(e,this.compare,this.keySelector))}}]),e}(),cg=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return _inherits(t,e),_createClass(t,[{key:"compare",value:function(e,t){return e===t}},{key:"_next",value:function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(i){return this.destination.error(i)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(i){return this.destination.error(i)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))}}]),t}(g);function hg(e,t){for(var n=e.length,r=0;r<n;r++)if(e[r].payload.key===t)return r;return-1}function fg(e,t){var n=t.payload,r=t.prevKey,i=t.key,o=hg(e,i),a=function(e,t){if($v(t))return 0;var n=hg(e,t);return-1===n?e.length:n+1}(e,r);switch(t.type){case"value":if(t.payload&&t.payload.exists()){var s=null;t.payload.forEach((function(t){var n={payload:t,type:"value",prevKey:s,key:t.key};return s=t.key,e=[].concat(_toConsumableArray(e),[n]),!1}))}return e;case"child_added":if(o>-1){var u=e[o-1];(u&&u.key||null)!=r&&(e=e.filter((function(e){return e.payload.key!==n.key}))).splice(a,0,t)}else{if(null==r)return[t].concat(_toConsumableArray(e));(e=e.slice()).splice(a,0,t)}return e;case"child_removed":return e.filter((function(e){return e.payload.key!==n.key}));case"child_changed":return e.map((function(e){return e.payload.key===i?t:e}));case"child_moved":if(o>-1){var l=e.splice(o,1)[0];return(e=e.slice()).splice(a,0,l),e}return e;default:return e}}function dg(e){return($v(e)||0===e.length)&&(e=["child_added","child_removed","child_changed","child_moved"]),e}function pg(e,t){return function(e,t){return ug(e,"value","once").pipe(Ru((function(n){var r=[Js(n)];return t.forEach((function(t){return r.push(ug(e,t))})),ee.apply(void 0,r).pipe(Mu(fg,[]))})),(function(e){return e.lift(new lg(void 0,void 0))}))}(e,t=dg(t))}function vg(e,t){return ee.apply(void 0,_toConsumableArray((t=dg(t)).map((function(t){return ug(e,t)}))))}var gg=function(){function e(t,n){_classCallCheck(this,e),this.observables=t,this.project=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new yg(e,this.observables,this.project))}}]),e}(),yg=function(e){function t(e,n,r){var i;_classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var a=0;a<o;a++)i.toRespond.push(a);for(var s=0;s<o;s++){var u=n[s];i.add(j(_assertThisInitialized(i),u,u,s))}return i}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,i){this.values[n]=t;var o=this.toRespond;if(o.length>0){var a=o.indexOf(n);-1!==a&&o.splice(a,1)}}},{key:"notifyComplete",value:function(){}},{key:"_next",value:function(e){if(0===this.toRespond.length){var t=[e].concat(_toConsumableArray(this.values));this.project?this._tryProject(t):this.destination.next(t)}}},{key:"_tryProject",value:function(e){var t;try{t=this.project.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}(W),mg=function(){function e(t){_classCallCheck(this,e),this.predicate=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new _g(e,this.predicate))}}]),e}(),_g=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,r.skipping=!0,r.index=0,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)}},{key:"tryCallPredicate",value:function(e){try{var t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(n){this.destination.error(n)}}}]),t}(g);function bg(e,t){return function(n,r){return tg(n,{stringCase:function(){return e.child(n)[t](r)},firebaseCase:function(){return n[t](r)},snapshotCase:function(){return n.ref[t](r)}})}}function wg(e){return function(){return ug(e,"value")}}var Cg=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.scheduler=new ed(o,i),this.database=o.runOutsideAngular((function(){return pd(t,o,n).database(r||void 0)}))}return _createClass(e,[{key:"list",value:function(e,t){var n=eg(this.database,e),r=n;return t&&(r=t(n)),function(e,t){return{query:e,update:bg(e.ref,"update"),set:bg(e.ref,"set"),push:function(t){return e.ref.push(t)},remove:(n=e.ref,function(e){return e?tg(e,{stringCase:function(){return n.child(e).remove()},firebaseCase:function(){return e.remove()},snapshotCase:function(){return e.ref.remove()}}):n.remove()}),snapshotChanges:function(n){var r=pg(e,n);return t.scheduler.keepUnstableUntilFirst(t.scheduler.runOutsideAngular(r))},stateChanges:function(n){var r=vg(e,n);return t.scheduler.keepUnstableUntilFirst(t.scheduler.runOutsideAngular(r))},auditTrail:function(n){var r=function(e,t){return function(e,t){return function(e){return ug(e,"value").pipe(H((function(e){var t;return e.payload.forEach((function(e){return t=e.key,!1})),{data:e,lastKeyToLoad:t}})))}(e).pipe(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new gg(t,n))}}(t),H((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],i=n.lastKeyToLoad,o=r.map((function(e){return e.key}));return{actions:r,lastKeyToLoad:i,loadedKeys:o}})),(n=function(e){return-1===e.loadedKeys.indexOf(e.lastKeyToLoad)},function(e){return e.lift(new mg(n))}),H((function(e){return e.actions})));var n}(e,vg(e,t).pipe(Mu((function(e,t){return[].concat(_toConsumableArray(e),[t])}),[])))}(e,n);return t.scheduler.keepUnstableUntilFirst(t.scheduler.runOutsideAngular(r))},valueChanges:function(n){var r=pg(e,n);return t.scheduler.keepUnstableUntilFirst(t.scheduler.runOutsideAngular(r)).pipe(H((function(e){return e.map((function(e){return e.payload.val()}))})))}};var n}(r,this)}},{key:"object",value:function(e){var t,n,r=eg(this.database,e);return n=this,{query:t=r,snapshotChanges:function(){var e=wg(t)();return n.scheduler.keepUnstableUntilFirst(n.scheduler.runOutsideAngular(e))},update:function(e){return t.ref.update(e)},set:function(e){return t.ref.set(e)},remove:function(){return t.ref.remove()},valueChanges:function(){var e=wg(t)();return n.scheduler.keepUnstableUntilFirst(n.scheduler.runOutsideAngular(e)).pipe(H((function(e){return e.payload.exists()?e.payload.val():null})))}}}},{key:"createPushId",value:function(){return this.database.ref().push().key}}]),e}();n("NSPt");var kg=function e(){_classCallCheck(this,e)},Eg=function e(){_classCallCheck(this,e)},Sg=function e(){_classCallCheck(this,e)},Tg=function(){function e(t){var n=this;_classCallCheck(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach((function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),o=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(o):n.headers.set(i,[o])}}))}:function(){n.headers=new Map,Object.keys(t).forEach((function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))}))}:this.headers=new Map}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(e){return t.applyUpdate(e)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach((function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))}))}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,_toConsumableArray(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var o=this.headers.get(t);if(!o)return;0===(o=o.filter((function(e){return-1===i.indexOf(e)}))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return e(t.normalizedNames.get(n),t.headers.get(n))}))}}]),e}(),Ig=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return Ag(e)}},{key:"encodeValue",value:function(e){return Ag(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function Ag(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var Ng=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new Ig,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.split("&").forEach((function(e){var r=e.indexOf("="),i=_slicedToArray(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),o=i[0],a=i[1],s=n.get(o)||[];s.push(a),n.set(o,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])}))):this.map=null}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map((function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map((function(t){return n+"="+e.encoder.encodeValue(t)})).join("&")})).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([t]),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(t){return e.map.set(t,e.cloneFrom.map.get(t))})),this.updates.forEach((function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(t.value);-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}})),this.cloneFrom=this.updates=null)}}]),e}();function Dg(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function xg(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Rg(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Og=function(){function e(t,n,r,i){var o;if(_classCallCheck(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new Tg),this.params){var a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+a}}else this.params=new Ng,this.urlWithParams=n}return _createClass(e,[{key:"serializeBody",value:function(){return null===this.body?null:Dg(this.body)||xg(this.body)||Rg(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ng?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body?null:Rg(this.body)?null:xg(this.body)?this.body.type||null:Dg(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ng?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,u=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((function(e,n){return e.set(n,t.setHeaders[n])}),u)),t.setParams&&(l=Object.keys(t.setParams).reduce((function(e,n){return e.set(n,t.setParams[n])}),l)),new e(n,r,o,{params:l,headers:u,reportProgress:s,responseType:i,withCredentials:a})}}]),e}(),Pg=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),Mg=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,e),this.headers=t.headers||new Tg,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},Lg=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).type=Pg.ResponseHeader,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(Mg),Fg=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).type=Pg.Response,e.body=void 0!==n.body?n.body:null,e}return _inherits(t,e),_createClass(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),t}(Mg),Vg=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,0,"Unknown Error"))).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return _inherits(t,e),t}(Mg);function Ug(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var qg=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"request",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Og)n=e;else{var o=void 0;o=i.headers instanceof Tg?i.headers:new Tg(i.headers);var a=void 0;i.params&&(a=i.params instanceof Ng?i.params:new Ng({fromObject:i.params})),n=new Og(e,t,void 0!==i.body?i.body:null,{headers:o,params:a,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}var s=Js(n).pipe(Vu((function(e){return r.handler.handle(e)})));if(e instanceof Og||"events"===i.observe)return s;var u=s.pipe(au((function(e){return e instanceof Fg})));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(H((function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body})));case"blob":return u.pipe(H((function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body})));case"text":return u.pipe(H((function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body})));case"json":default:return u.pipe(H((function(e){return e.body})))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(i.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new Ng).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,Ug(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,Ug(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,Ug(n,t))}}]),e}(),Bg=function(){function e(t,n){_classCallCheck(this,e),this.next=t,this.interceptor=n}return _createClass(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),jg=new De("HTTP_INTERCEPTORS"),Wg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}(),Hg=/^\)\]\}',?\n/,zg=function e(){_classCallCheck(this,e)},Qg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}(),Gg=function(){function e(t){_classCallCheck(this,e),this.xhrFactory=t}return _createClass(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new k((function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((function(e,t){return r.setRequestHeader(e,t.join(","))})),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var o=e.responseType.toLowerCase();r.responseType="json"!==o?o:"text"}var a=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new Tg(r.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new Lg({headers:i,status:t,statusText:n,url:o})},l=function(){var t=u(),i=t.headers,o=t.status,a=t.statusText,s=t.url,l=null;204!==o&&(l=void 0===r.response?r.responseText:r.response),0===o&&(o=l?200:0);var c=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof l){var h=l;l=l.replace(Hg,"");try{l=""!==l?JSON.parse(l):null}catch(f){l=h,c&&(c=!1,l={error:f,text:l})}}c?(n.next(new Fg({body:l,headers:i,status:o,statusText:a,url:s||void 0})),n.complete()):n.error(new Vg({error:l,headers:i,status:o,statusText:a,url:s||void 0}))},c=function(e){var t=u().url,i=new Vg({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:Pg.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:Pg.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",l),r.addEventListener("error",c),e.reportProgress&&(r.addEventListener("progress",f),null!==a&&r.upload&&r.upload.addEventListener("progress",d)),r.send(a),n.next({type:Pg.Sent}),function(){r.removeEventListener("error",c),r.removeEventListener("load",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==a&&r.upload&&r.upload.removeEventListener("progress",d)),r.abort()}}))}}]),e}(),Kg=new De("XSRF_COOKIE_NAME"),Yg=new De("XSRF_HEADER_NAME"),Xg=function e(){_classCallCheck(this,e)},Jg=function(){function e(t,n,r){_classCallCheck(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Is(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}(),$g=function(){function e(t,n){_classCallCheck(this,e),this.tokenService=t,this.headerName=n}return _createClass(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}(),Zg=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.injector=n,this.chain=null}return _createClass(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(jg,[]);this.chain=t.reduceRight((function(e,t){return new Bg(e,t)}),this.backend)}return this.chain.handle(e)}}]),e}(),ey=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:$g,useClass:Wg}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:Kg,useValue:t.cookieName}:[],t.headerName?{provide:Yg,useValue:t.headerName}:[]]}}}]),e}(),ty=function e(){_classCallCheck(this,e)},ny=function e(){_classCallCheck(this,e)},ry=new fs(ds,[ps],(function(e){return function(e){for(var t={},n=[],r=!1,i=0;i<e.length;i++){var o=e[i];o.token===Pt&&!0===o.value&&(r=!0),1073741824&o.flags&&n.push(o.token),o.index=i,t[Xn(o.token)]=o}return{factory:null,providersByKey:t,providers:e,modules:n,isRoot:r}}([xr(512,sn,un,[[8,[jf,Zp,ov,hv,Sv,Lv,Qv]],[3,sn],We]),xr(5120,Wi,Wo,[[3,Wi]]),xr(4608,Ss,Ts,[Wi,[2,Es]]),xr(5120,Ei,Ho,[so]),xr(5120,Li,Fi,[]),xr(5120,An,Bo,[]),xr(5120,Nn,jo,[]),xr(4608,Vl,Ul,[js]),xr(6144,It,null,[Vl]),xr(4608,xl,Ol,[]),xr(5120,il,(function(e,t,n,r,i,o,a,s){return[new Nl(e,t,n),new Fl(r),new Pl(i,o,a,s)]}),[js,so,qi,js,js,xl,ji,[2,Rl]]),xr(4608,ol,ol,[il,so]),xr(135680,ul,ul,[js]),xr(4608,vl,vl,[ol,ul,Li]),xr(6144,dn,null,[vl]),xr(6144,sl,null,[ul]),xr(4608,go,go,[so]),xr(4608,Jd,Jd,[]),xr(5120,rh,Mf,[df]),xr(4608,Cf,Cf,[]),xr(6144,bf,null,[Cf]),xr(135680,kf,kf,[df,No,$i,Lt,bf]),xr(4608,wf,wf,[]),xr(5120,Ef,Df,[df,Qs,Sf]),xr(5120,Uf,Vf,[Lf]),xr(5120,Bi,(function(e){return[e]}),[Uf]),xr(5120,dd,pd,[ld,so,[2,cd]]),xr(4608,Td,Td,[ld,[2,cd],qi,so]),xr(4608,Ed,Ed,[ld,[2,cd],[2,gd],[2,md],qi,so,[2,yd]]),xr(4608,Cg,Cg,[ld,[2,cd],[2,Zf],qi,so]),xr(4608,Bp,Bp,[]),xr(4608,Xg,Jg,[js,qi,Kg]),xr(4608,$g,$g,[Xg,Yg]),xr(5120,jg,(function(e){return[e]}),[$g]),xr(4608,Qg,Qg,[]),xr(6144,zg,null,[Qg]),xr(4608,Gg,Gg,[zg]),xr(6144,Sg,null,[Gg]),xr(4608,Eg,Zg,[Sg,Lt]),xr(4608,qg,qg,[Eg]),xr(1073742336,Bs,Bs,[]),xr(1024,tt,Gl,[]),xr(1024,wo,(function(){return[Af()]}),[]),xr(512,Lf,Lf,[Lt]),xr(1024,Pi,(function(e,t){return[(n=e,tl("probe",rl),tl("coreTokens",Object.assign({},nl,(n||[]).reduce((function(e,t){return e[t.name]=t.token,e}),{}))),function(){return rl}),Ff(t)];var n}),[[2,wo],Lf]),xr(512,Mi,Mi,[[2,Pi]]),xr(131584,Io,Io,[so,ji,Lt,tt,sn,Mi]),xr(1073742336,zo,zo,[Io]),xr(1073742336,Kl,Kl,[[3,Kl]]),xr(1073742336,qp,qp,[]),xr(1073742336,jp,jp,[]),xr(1024,Tf,Rf,[[3,df]]),xr(512,Mc,Lc,[]),xr(512,yf,yf,[]),xr(256,Sf,{},[]),xr(1024,ys,xf,[vs,[2,ms],Sf]),xr(512,_s,_s,[ys,vs]),xr(512,$i,$i,[]),xr(512,No,Ro,[$i,[2,Do]]),xr(1024,af,(function(){return[[{path:"Courses",component:Kp},{path:"Registration",component:ev},{path:"Logging",component:av},{path:"Details/:id",component:_v},{path:"CoursesAdmin",component:Dv}]]}),[]),xr(1024,df,Pf,[Io,Mc,yf,_s,Lt,No,$i,af,Sf,[2,uf],[2,rf]]),xr(1073742336,Nf,Nf,[[2,Tf],[2,df]]),xr(1073742336,ny,ny,[]),xr(1073742336,vd,vd,[]),xr(1073742336,Xv,Xv,[]),xr(1073742336,Jv,Jv,[]),xr(1073742336,kg,kg,[]),xr(1073742336,Wp,Wp,[]),xr(1073742336,ey,ey,[]),xr(1073742336,ty,ty,[]),xr(1073742336,ds,ds,[]),xr(256,Pt,!0,[]),xr(256,ld,{apiKey:"AIzaSyA3g0in7WS-Vy_KGKhUv2oorDImxZOeiH0",authDomain:"pitrusapp.firebaseapp.com",databaseURL:"https://pitrusapp.firebaseio.com",projectId:"pitrusapp",storageBucket:"pitrusapp.appspot.com",messagingSenderId:"480731790493",appId:"1:480731790493:web:6c653a5bab1d41473c6874"},[]),xr(256,cd,void 0,[]),xr(256,Kg,"XSRF-TOKEN",[]),xr(256,Yg,"X-XSRF-TOKEN",[])])}));(function(){if(rt)throw new Error("Cannot enable prod mode after platform setup.");nt=!1})(),Ql().bootstrapModuleFactory(ry).catch((function(e){return console.error(e)}))},zVF4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mrSG"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,l=u?e[i+2]:0,c=(15&s)<<2|l>>6,h=63&l;u||(h=64,a||(c=64)),r.push(n[o>>2],n[(3&o)<<4|s>>4],n[c],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();r.push(o<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},l=function(e){try{return u.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=c(e[n],t[n]));return e}var h=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d="FirebaseError",p=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name=d,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,v.prototype.create),i}return r.__extends(t,e),t}(Error),v=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?g(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new p(i,s),l=0,c=Object.keys(r);l<c.length;l++){var h=c[l];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},e}();function g(e,t){return e.replace(y,(function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"}))}var y=/\{\$([^}]+)}/g;function m(e){return JSON.parse(e)}var _=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=m(l(o[0])||""),n=m(l(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:i}},b=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=l^s&(u^l),o=1518500249):(i=s^u^l,o=1859775393):r<60?(i=s&u|l&(s|u),o=2400959708):(i=s^u^l,o=3395469782);var h=(a<<5|a>>>27)+i+c+o+n[r]&4294967295;c=l,l=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(),w=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=C),void 0===r.error&&(r.error=C),void 0===r.complete&&(r.complete=C);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function C(){}function k(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+r+" argument "}t.CONSTANTS=i,t.Deferred=h,t.ErrorFactory=v,t.FirebaseError=p,t.Sha1=b,t.assert=o,t.assertionError=a,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){e.apply(void 0,n)})).catch((function(e){t&&t(e)}))}},t.base64=u,t.base64Decode=l,t.base64Encode=function(e){var t=s(e);return u.encodeByteArray(t,!0)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new w(e,t);return n.subscribe.bind(n)},t.decode=_,t.deepCopy=function(e){return c(void 0,e)},t.deepExtend=c,t.errorPrefix=k,t.getUA=f,t.isAdmin=function(e){var t=_(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isElectron=function(){return f().indexOf("Electron/")>=0},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){var e=f();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isUWP=function(){return f().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){var t=_(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=_(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=_(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=m,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;o(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(k(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(k(e,t,r)+"must be a valid context object.")},t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(k(e,t,r)+"must be a valid firebase namespace.")}},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0]]]);